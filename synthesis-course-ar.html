<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>عكس الأدلة: دورة التحليل التلوي</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&amp;family=Source+Sans+Pro:wght@300;400;600;700&amp;display=swap" rel="stylesheet"/>
<style>
    :root {
      --navy: #1E2761;
      --deep-navy: #141B3D;
      --gold: #D4AF37;
      --cream: #FAF8F5;
      --light-cream: #FFFFFF;
      --text: #2D3748;
      --light-text: #718096;
      --red: #C53030;
      --green: #22c55e;
      --transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      height: 100%;
      font-family: 'Source Sans Pro', sans-serif;
      background: var(--deep-navy);
      color: var(--cream);
    }

    /* ====== COURSE SHELL ====== */
    .course-container {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* ====== SIDEBAR NAV ====== */
    .sidebar {
      width: 280px;
      background: linear-gradient(180deg, var(--deep-navy) 0%, #0a0f1a 100%);
      border-left: 1px solid rgba(212,175,55,0.2);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(212,175,55,0.2);
    }

    .sidebar-header h1 {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 0.25rem;
    }

    .sidebar-header p {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
    }

    .module-list {
      flex: 1;
      overflow-y: auto;
      padding: 1rem 0;
    }

    .module-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
      border-right: 3px solid transparent;
    }

    .module-item:hover {
      background: rgba(212,175,55,0.1);
    }

    .module-item.active {
      background: rgba(212,175,55,0.15);
      border-right-color: var(--gold);
    }

    .module-item.completed .module-number {
      background: var(--green);
      color: white;
    }

    .module-number {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
      flex-shrink: 0;
    }

    .module-item.active .module-number {
      background: var(--gold);
      color: var(--navy);
    }

    .module-info {
      flex: 1;
      min-width: 0;
    }

    .module-title {
      font-size: 0.85rem;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .module-subtitle {
      font-size: 0.7rem;
      color: rgba(255,255,255,0.7); /* Increased for WCAG AA contrast */
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(212,175,55,0.2);
      font-size: 0.75rem;
      color: rgba(255,255,255,0.4);
    }

    /* ====== MAIN CONTENT ====== */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .content-header {
      padding: 1rem 2rem;
      background: rgba(0,0,0,0.3);
      border-bottom: 1px solid rgba(212,175,55,0.2);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .breadcrumb {
      font-size: 0.85rem;
      color: rgba(255,255,255,0.6);
    }

    .breadcrumb span {
      color: var(--gold);
    }

    .header-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn {
      padding: 0.5rem 1rem;
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 6px;
      background: rgba(255,255,255,0.05);
      color: var(--cream);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn:hover {
      background: rgba(212,175,55,0.2);
      border-color: var(--gold);
    }

    .btn.primary {
      background: var(--gold);
      color: var(--navy);
      border-color: var(--gold);
      font-weight: 600;
    }

    .content-body {
      flex: 1;
      overflow: hidden;
      display: flex;
    }

    /* ====== SLIDES AREA ====== */
    .slides-container {
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .module-slides {
      display: none;
      width: 100%;
      height: 100%;
    }

    .module-slides.active {
      display: block;
    }

    .slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: flex-start; /* Changed from center - prevents content clipping */
      align-items: center;
      padding: 2rem 2rem 5rem 2rem; /* Extra bottom clearance for nav bar */
      padding-top: 3rem;
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition), visibility var(--transition);
      overflow-y: auto; /* Allow scrolling if content is tall */
      overflow-x: hidden;
    }

    /* Center content vertically only when there's enough space */
    .slide .content,
    .slide .refrain,
    .slide .title {
      margin-top: auto;
      margin-bottom: auto;
    }

    /* Ensure content doesn't overflow horizontally */
    .slide > * {
      max-width: 100%;
      word-wrap: break-word;
    }

    .slide.active {
      opacity: 1;
      visibility: visible;
    }

    .slide.dark { background: var(--deep-navy); color: var(--cream); }
    .slide.light { background: var(--cream); color: var(--text); }
    .slide.black { background: #000; color: var(--cream); }

    /* Typography */
    .serif { font-family: 'Cormorant Garamond', Georgia, serif; }

    .title {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 700;
      margin-bottom: 1rem;
      line-height: 1.2;
    }

    .title.navy { color: var(--navy); }
    .title.gold { color: var(--gold); }
    .title.cream { color: var(--cream); }

    .subtitle {
      font-size: clamp(1rem, 2vw, 1.5rem);
      color: var(--light-text);
      margin-bottom: 2rem;
    }

    .slide.dark .subtitle { color: rgba(255,255,255,0.7); }

    .big-number {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(4rem, 15vw, 10rem);
      font-weight: 700;
      line-height: 1;
    }

    .big-number.navy { color: var(--navy); }
    .big-number.gold { color: var(--gold); }

    .refrain {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.5rem, 4vw, 2.5rem);
      font-style: italic;
      color: var(--gold);
      text-align: center;
      max-width: 800px;
    }

    /* Cards */
    .card {
      background: var(--light-cream);
      border: 1px solid var(--gold);
      padding: 1.5rem 2rem;
      margin: 0.75rem 0;
      max-width: 800px;
      width: 100%;
    }

    .card.navy-bg {
      background: var(--navy);
      color: var(--cream);
    }

    .card.red-border { border: 2px solid var(--red); }

    .card-label {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--gold);
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .card-text {
      font-size: clamp(0.9rem, 1.8vw, 1.1rem);
    }

    .card.navy-bg .card-text { color: var(--cream); }

    /* Stats grid */
    .stats-grid {
      display: flex;
      gap: 1rem;
      margin: 1.5rem 0;
      flex-wrap: wrap;
      justify-content: center;
    }

    .stat-box {
      background: var(--navy);
      color: var(--cream);
      padding: 1rem 1.5rem;
      text-align: center;
      min-width: 140px;
    }

    .stat-value {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.5rem, 3vw, 2rem);
      font-weight: 700;
    }

    .stat-label {
      font-size: 0.75rem;
      opacity: 0.8;
      margin-top: 0.25rem;
    }

    /* Design grid */
    .design-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      max-width: 900px;
      width: 100%;
    }

    @media (max-width: 768px) {
      .design-grid { grid-template-columns: repeat(2, 1fr); }
    }

    .design-item {
      background: var(--light-cream);
      border-right: 3px solid var(--gold);
      padding: 1rem;
    }

    .design-item-label {
      font-size: 0.7rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 0.5rem;
    }

    .design-item-value {
      font-size: 0.85rem;
      color: var(--text);
      line-height: 1.4;
    }

    /* Results table */
    .results-table {
      width: 100%;
      max-width: 700px;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    .results-table th {
      background: var(--navy);
      color: var(--cream);
      padding: 0.75rem 1rem;
      text-align: right;
      font-weight: 600;
    }

    .results-table th:not(:first-child) { text-align: center; }

    .results-table td {
      padding: 0.6rem 1rem;
      border-bottom: 1px solid #E2E8F0;
    }

    .results-table td:not(:first-child) { text-align: center; }
    .results-table .highlight { color: var(--red); font-weight: 700; }

    /* Result box */
    .result-box {
      background: var(--navy);
      padding: 1rem 2rem;
      text-align: center;
      margin: 1rem 0;
      max-width: 500px;
    }

    .result-box .value {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.5rem, 3vw, 2rem);
      font-weight: 700;
      color: var(--gold);
    }

    .result-box .label {
      font-size: 0.9rem;
      color: var(--cream);
      margin-top: 0.25rem;
    }

    /* Lesson items */
    .lesson-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin: 0.75rem 0;
      max-width: 800px;
    }

    .lesson-number {
      background: var(--gold);
      color: var(--navy);
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      flex-shrink: 0;
    }

    .lesson-content h4 {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 0.25rem;
    }

    .lesson-content p {
      font-size: 0.9rem;
      color: var(--light-text);
    }

    /* Gold line */
    .gold-line {
      width: 150px;
      height: 2px;
      background: var(--gold);
      margin: 1.5rem auto;
    }

    /* Closing lines */
    .closing-line {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.2rem, 2.5vw, 1.75rem);
      margin: 0.5rem 0;
      text-align: center;
    }

    .closing-line.gold { color: var(--gold); font-weight: 700; }
    .closing-line.italic { font-style: italic; opacity: 0.9; }

    /* Focus box */
    .focus-box {
      background: var(--navy);
      padding: 1rem 2rem;
      text-align: center;
      max-width: 600px;
    }

    .focus-box .main {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.3rem;
      font-style: italic;
      color: var(--gold);
    }

    .focus-box .sub {
      font-size: 0.9rem;
      color: var(--cream);
      margin-top: 0.5rem;
    }

    /* Arrow */
    .arrow { color: var(--light-text); font-size: 1.2rem; margin: 0.25rem 0; }
    .footnote { font-size: 0.75rem; color: var(--light-text); font-style: italic; text-align: center; margin-top: 1rem; }
    .red { color: var(--red); }
    .text-center { text-align: center; }
    .mb-1 { margin-bottom: 1rem; }
    .mb-2 { margin-bottom: 2rem; }
    .mt-1 { margin-top: 1rem; }
    .mt-2 { margin-top: 2rem; }

    /* Content wrapper */
    .content {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 1000px;
    }

    /* Animation */
    .slide.active .animate { animation: fadeUp 0.6s ease-out forwards; }
    .slide.active .animate.delay-1 { animation-delay: 0.1s; }
    .slide.active .animate.delay-2 { animation-delay: 0.2s; }
    .slide.active .animate.delay-3 { animation-delay: 0.3s; }
    .slide.active .animate.delay-4 { animation-delay: 0.4s; }
    .slide.active .animate.delay-5 { animation-delay: 0.5s; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate { opacity: 0; }

    /* ====== SLIDE NAV ====== */
    /* Minimal floating arrows - no background strip */
    .slide-nav {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      padding: 1rem 1rem 1.5rem 1rem;
      z-index: 100;
      pointer-events: none; /* Allow clicks through to content */
    }

    .nav-btn {
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.2);
      color: white;
      font-size: 1.25rem;
      cursor: pointer;
      opacity: 0.6;
      transition: all 0.2s;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      pointer-events: auto; /* Buttons are clickable */
    }

    .nav-btn:hover {
      opacity: 1;
      background: rgba(0,0,0,0.7);
      border-color: var(--gold);
    }
    .nav-btn:disabled { opacity: 0.2; cursor: not-allowed; }

    /* Center info (counter + progress) - compact */
    .nav-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      pointer-events: none; /* Don't block quiz/content clicks beneath */
    }

    .slide-counter {
      font-size: 0.75rem;
      opacity: 0.6;
    }

    .progress { display: flex; gap: 4px; }

    .progress-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.25);
      cursor: pointer;
      transition: all 0.2s;
      pointer-events: auto; /* Only dots are clickable, not the whole nav-center */
    }

    .progress-dot.active {
      background: var(--gold);
      transform: scale(1.3);
    }

    .progress-dot:hover {
      background: rgba(255,255,255,0.5);
    }

    .progress-dot:hover { background: rgba(255,255,255,0.6); }

    .slide-counter {
      color: rgba(255,255,255,0.6);
      font-size: 0.85rem;
      min-width: 50px;
      text-align: center;
    }

    /* ====== TOOLS PANEL ====== */
    .tools-panel {
      width: 380px;
      max-width: 40vw; /* Limit to 40% of viewport so content isn't squeezed too much */
      background: var(--cream);
      border-right: 1px solid rgba(0,0,0,0.1);
      display: none; /* Hidden by default */
      flex-direction: column;
      flex-shrink: 0;
      overflow-y: auto;
    }

    .tools-panel.visible {
      display: flex;
    }

    .tools-panel.collapsed {
      width: 50px;
    }

    /* Adjust slide padding when tools panel is open */
    .content-body.tools-open .slide {
      padding-right: 1.5rem;
      padding-right: 1.5rem;
    }

    .content-body.tools-open .slide .content {
      max-width: 100%;
    }

    .tools-header {
      padding: 1rem;
      background: var(--navy);
      color: var(--cream);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .tools-header h3 {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .tools-content {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }

    /* Live Story Data Panel */
    .story-data-panel {
      background: linear-gradient(135deg, #1E2761 0%, #141B3D 100%);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      color: white;
    }

    .story-data-panel h4 {
      color: var(--gold);
      font-size: 0.85rem;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .story-toggle {
      display: flex;
      background: rgba(255,255,255,0.1);
      border-radius: 25px;
      padding: 4px;
      margin-bottom: 1rem;
    }

    .story-toggle button {
      flex: 1;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 20px;
      background: transparent;
      color: rgba(255,255,255,0.7);
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .story-toggle button.active {
      background: var(--gold);
      color: var(--navy);
    }

    .story-toggle button:hover:not(.active) {
      background: rgba(255,255,255,0.15);
      color: white;
    }

    .story-viz {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      min-height: 200px;
      transition: all 0.5s ease;
    }

    .story-viz svg {
      transition: all 0.5s ease;
    }

    .story-metrics {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
    }

    .story-metric {
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 0.75rem;
      text-align: center;
      transition: all 0.3s ease;
    }

    .story-metric.highlight-good {
      background: rgba(34, 197, 94, 0.3);
      border: 1px solid rgba(34, 197, 94, 0.5);
    }

    .story-metric.highlight-bad {
      background: rgba(197, 48, 48, 0.3);
      border: 1px solid rgba(197, 48, 48, 0.5);
    }

    .story-metric .value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gold);
    }

    .story-metric .label {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.7);
      margin-top: 0.25rem;
    }

    .story-insight {
      background: rgba(212,175,55,0.2);
      border-right: 3px solid var(--gold);
      padding: 0.75rem;
      border-radius: 0 8px 8px 0;
      margin-top: 0.75rem;
      font-size: 0.75rem;
      line-height: 1.5;
    }

    /* ====== PREDICT FIRST INTERFACE ====== */
    .predict-first-panel {
      background: linear-gradient(135deg, rgba(212,175,55,0.2), rgba(30,39,97,0.3));
      border: 1px solid var(--gold);
      border-radius: 12px;
      padding: 1.25rem;
      text-align: center;
      margin-top: 0.5rem;
    }

    .predict-first-panel .predict-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .predict-first-panel h4 {
      color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
    }

    .predict-first-panel p {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.9);
      line-height: 1.4;
    }

    .predict-buttons {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .predict-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border: 2px solid;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      background: rgba(0,0,0,0.2);
    }

    .predict-btn.benefit {
      border-color: #22c55e;
      color: #22c55e;
    }

    .predict-btn.benefit:hover {
      background: rgba(34,197,94,0.2);
    }

    .predict-btn.neutral {
      border-color: #94a3b8;
      color: #94a3b8;
    }

    .predict-btn.neutral:hover {
      background: rgba(148,163,184,0.2);
    }

    .predict-btn.harm {
      border-color: #ef4444;
      color: #ef4444;
    }

    .predict-btn.harm:hover {
      background: rgba(239,68,68,0.2);
    }

    .predict-icon-small {
      font-size: 1rem;
    }

    /* Prediction Feedback */
    .prediction-feedback {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      font-size: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .prediction-feedback.correct {
      background: rgba(34,197,94,0.2);
      border: 1px solid #22c55e;
      color: #22c55e;
    }

    .prediction-feedback.incorrect {
      background: rgba(239,68,68,0.15);
      border: 1px solid #ef4444;
      color: #fca5a5;
    }

    .feedback-icon {
      font-size: 1rem;
    }

    /* ====== PROGRESS DASHBOARD ====== */
    .progress-dashboard {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(5px);
      z-index: 2000;
      display: none;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .progress-dashboard.open {
      display: flex;
    }

    .dashboard-content {
      background: linear-gradient(135deg, var(--deep-navy), #0a0f1a);
      border: 1px solid var(--gold);
      border-radius: 16px;
      max-width: 500px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      padding: 1.5rem;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(212,175,55,0.3);
    }

    .dashboard-header h2 {
      font-family: 'Cormorant Garamond', serif;
      color: var(--gold);
      font-size: 1.3rem;
    }

    .dashboard-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      opacity: 0.7;
    }

    .dashboard-close:hover { opacity: 1; }

    .level-display {
      background: linear-gradient(135deg, rgba(212,175,55,0.2), rgba(212,175,55,0.05));
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    .level-badge {
      display: inline-block;
      background: var(--gold);
      color: var(--navy);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-weight: 700;
      font-size: 0.8rem;
      margin-bottom: 0.5rem;
    }

    .points-display {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--gold);
    }

    .points-label {
      font-size: 0.7rem;
      color: rgba(255,255,255,0.6);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .stat-card {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 0.75rem;
      text-align: center;
    }

    .stat-value {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--gold);
    }

    .stat-label {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.6);
      margin-top: 0.25rem;
    }

    .principles-section h3, .badges-section h3, .streak-section h3 {
      font-family: 'Cormorant Garamond', serif;
      color: var(--gold);
      font-size: 1rem;
      margin-bottom: 0.5rem;
    }

    .principle-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4rem;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      margin-bottom: 0.35rem;
    }

    .principle-num {
      width: 20px;
      height: 20px;
      background: rgba(212,175,55,0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      color: var(--gold);
      flex-shrink: 0;
    }

    .principle-num.mastered {
      background: var(--gold);
      color: var(--navy);
    }

    .principle-text {
      flex: 1;
      font-size: 0.7rem;
      color: rgba(255,255,255,0.8);
    }

    .badges-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .badge {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      background: rgba(255,255,255,0.05);
      border: 2px solid rgba(255,255,255,0.1);
      opacity: 0.3;
      position: relative;
    }

    .badge.earned {
      opacity: 1;
      background: rgba(212,175,55,0.2);
      border-color: var(--gold);
    }

    .badge-tooltip {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--navy);
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.6rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
    }

    .badge:hover .badge-tooltip {
      opacity: 1;
    }

    .streak-display {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 0.75rem;
    }

    .streak-flame { font-size: 2rem; }

    .streak-count {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--gold);
    }

    .streak-label {
      font-size: 0.7rem;
      color: rgba(255,255,255,0.6);
    }

    .dashboard-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      padding: 0.6rem 0.75rem;
      background: linear-gradient(135deg, rgba(212,175,55,0.15), rgba(212,175,55,0.05));
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 6px;
      color: var(--gold);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 0.5rem;
    }

    .dashboard-btn:hover {
      background: linear-gradient(135deg, rgba(212,175,55,0.25), rgba(212,175,55,0.1));
      border-color: var(--gold);
    }

    /* ====== DAILY REVIEW MODAL ====== */
    .daily-review-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 1rem;
    }

    .daily-review-modal.open {
      display: flex;
    }

    .daily-review-content {
      background: linear-gradient(135deg, var(--deep-navy), #0a0f1a);
      border: 2px solid var(--gold);
      border-radius: 16px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 1.5rem;
    }

    .daily-review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(212,175,55,0.3);
    }

    .daily-review-header h2 {
      font-family: 'Cormorant Garamond', serif;
      color: var(--gold);
      font-size: 1.5rem;
      margin: 0;
    }

    .daily-review-close {
      background: none;
      border: none;
      color: rgba(255,255,255,0.6);
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.2s;
    }

    .daily-review-close:hover {
      color: white;
    }

    .review-timer {
      text-align: center;
      margin-bottom: 1rem;
    }

    .timer-display {
      font-size: 2rem;
      font-family: 'Cormorant Garamond', serif;
      color: var(--gold);
    }

    .timer-label {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.6);
    }

    .review-progress {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }

    .progress-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      transition: all 0.3s;
    }

    .progress-dot.current {
      background: var(--gold);
      transform: scale(1.2);
    }

    .progress-dot.completed {
      background: #22c55e;
    }

    .review-card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(212,175,55,0.2);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    .review-principle-num {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      background: rgba(212,175,55,0.2);
      border-radius: 50%;
      color: var(--gold);
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .review-principle-text {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.25rem;
      color: var(--cream);
      font-style: italic;
      margin-bottom: 1rem;
    }

    .review-question {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.8);
      margin-bottom: 1rem;
    }

    .review-options {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .review-option {
      padding: 0.75rem 1rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      color: white;
      cursor: pointer;
      transition: all 0.2s;
      text-align: right;
      font-size: 0.85rem;
    }

    .review-option:hover {
      background: rgba(212,175,55,0.15);
      border-color: var(--gold);
    }

    .review-option.correct {
      background: rgba(34,197,94,0.2);
      border-color: #22c55e;
    }

    .review-option.incorrect {
      background: rgba(239,68,68,0.2);
      border-color: #ef4444;
    }

    .review-option.selected {
      border-width: 2px;
    }

    .review-feedback {
      margin-top: 1rem;
      padding: 0.75rem;
      border-radius: 8px;
      font-size: 0.85rem;
    }

    .review-feedback.correct {
      background: rgba(34,197,94,0.15);
      border: 1px solid rgba(34,197,94,0.3);
      color: #86efac;
    }

    .review-feedback.incorrect {
      background: rgba(239,68,68,0.15);
      border: 1px solid rgba(239,68,68,0.3);
      color: #fca5a5;
    }

    .review-actions {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      margin-top: 1rem;
    }

    .review-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .review-btn.skip {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.3);
      color: rgba(255,255,255,0.6);
    }

    .review-btn.skip:hover {
      border-color: rgba(255,255,255,0.5);
      color: white;
    }

    .review-btn.next {
      background: var(--gold);
      border: none;
      color: var(--navy);
      font-weight: 600;
    }

    .review-btn.next:hover {
      background: #e6c94a;
    }

    .review-summary {
      text-align: center;
    }

    .summary-score {
      font-size: 3rem;
      font-family: 'Cormorant Garamond', serif;
      color: var(--gold);
    }

    .summary-text {
      color: rgba(255,255,255,0.8);
      margin-bottom: 1rem;
    }

    .summary-breakdown {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin: 1rem 0;
    }

    .summary-stat {
      text-align: center;
    }

    .summary-stat-value {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .summary-stat-value.correct-val { color: #22c55e; }
    .summary-stat-value.incorrect-val { color: #ef4444; }

    .summary-stat-label {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.6);
    }

    .review-streak-bonus {
      margin-top: 1rem;
      padding: 0.75rem;
      background: rgba(212,175,55,0.15);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .review-streak-bonus .flame { font-size: 1.5rem; }
    .review-streak-bonus .text { color: var(--gold); font-size: 0.9rem; }

    .daily-review-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      padding: 0.5rem 0.75rem;
      background: linear-gradient(135deg, rgba(34,197,94,0.15), rgba(34,197,94,0.05));
      border: 1px solid rgba(34,197,94,0.3);
      border-radius: 6px;
      color: #86efac;
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 0.75rem;
    }

    .daily-review-btn:hover {
      background: linear-gradient(135deg, rgba(34,197,94,0.25), rgba(34,197,94,0.1));
      border-color: #22c55e;
    }

    .daily-review-btn.pending {
      animation: gentlePulse 2s infinite;
    }

    @keyframes gentlePulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(34,197,94,0.3); }
      50% { box-shadow: 0 0 0 6px rgba(34,197,94,0); }
    }

    /* ====== BRANCHING SCENARIOS ====== */
    .scenario-panel {
      background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(30,39,97,0.2));
      border: 2px solid rgba(124,58,237,0.4);
      border-radius: 16px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .scenario-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .scenario-icon { font-size: 1.5rem; }
    .scenario-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      color: #7C3AED;
      font-weight: 600;
    }

    .scenario-situation {
      background: rgba(255,255,255,0.9);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      font-size: 0.95rem;
      line-height: 1.6;
      color: var(--navy);
    }

    .scenario-question {
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--navy);
    }

    .scenario-choices {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .scenario-choice {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: rgba(255,255,255,0.8);
      border: 2px solid rgba(124,58,237,0.2);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .scenario-choice:hover:not(.answered) { background: rgba(124,58,237,0.1); border-color: rgba(124,58,237,0.5); }
    .scenario-choice.selected { border-color: #7C3AED; background: rgba(124,58,237,0.15); }
    .scenario-choice.correct { border-color: #22c55e; background: rgba(34,197,94,0.15); }
    .scenario-choice.incorrect { border-color: #ef4444; background: rgba(239,68,68,0.1); }

    .choice-letter {
      min-width: 24px; height: 24px; border-radius: 50%;
      background: rgba(124,58,237,0.2); color: #7C3AED;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 0.8rem;
    }
    .scenario-choice.correct .choice-letter { background: #22c55e; color: white; }
    .scenario-choice.incorrect .choice-letter { background: #ef4444; color: white; }
    .choice-text { flex: 1; font-size: 0.9rem; color: var(--navy); }

    .scenario-consequence {
      margin-top: 1rem; padding: 1rem; border-radius: 10px; display: none;
    }
    .scenario-consequence.visible { display: block; }
    .scenario-consequence.good { background: rgba(34,197,94,0.15); border: 1px solid rgba(34,197,94,0.3); }
    .scenario-consequence.bad { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); }
    .scenario-consequence.neutral { background: rgba(217,119,6,0.1); border: 1px solid rgba(217,119,6,0.3); }

    .consequence-title { font-weight: 700; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
    .scenario-consequence.good .consequence-title { color: #059669; }
    .scenario-consequence.bad .consequence-title { color: #dc2626; }
    .scenario-consequence.neutral .consequence-title { color: #d97706; }
    .consequence-text { font-size: 0.9rem; line-height: 1.5; }
    .consequence-lesson { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px dashed currentColor; font-style: italic; opacity: 0.9; }

    /* ====== CONFIDENCE CALIBRATION ====== */
    .confidence-section {
      margin-top: 1rem; padding: 0.75rem;
      background: rgba(212,175,55,0.1); border-radius: 8px; border: 1px solid rgba(212,175,55,0.3);
    }
    .confidence-label { font-size: 0.8rem; color: var(--gold); margin-bottom: 0.5rem; }
    .confidence-slider-container { display: flex; align-items: center; gap: 0.75rem; }
    .confidence-slider {
      flex: 1; -webkit-appearance: none; height: 6px; border-radius: 3px;
      background: linear-gradient(to right, #ef4444, #eab308, #22c55e); outline: none;
    }
    .confidence-slider::-webkit-slider-thumb {
      -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
      background: white; border: 2px solid var(--gold); cursor: pointer;
    }
    .confidence-value { min-width: 45px; font-size: 0.85rem; font-weight: 700; color: var(--gold); }
    .confidence-labels { display: flex; justify-content: space-between; font-size: 0.65rem; color: rgba(255,255,255,0.6); margin-top: 0.25rem; }

    /* ====== ANALOGY SYSTEM ====== */
    .analogy-card {
      background: linear-gradient(135deg, rgba(212,175,55,0.15), rgba(30,39,97,0.1));
      border: 1px solid rgba(212,175,55,0.4);
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
    }
    .analogy-header { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
    .analogy-icon { font-size: 1.25rem; }
    .analogy-title { font-weight: 600; color: var(--gold); font-size: 0.9rem; }
    .analogy-concept { font-size: 0.75rem; color: rgba(255,255,255,0.6); }
    .analogy-text { font-size: 0.9rem; line-height: 1.5; font-style: italic; }

    /* ====== MISCONCEPTION CHALLENGE ====== */
    .misconception-challenge {
      background: linear-gradient(135deg, rgba(239,68,68,0.08), rgba(30,39,97,0.12));
      border: 2px solid rgba(239,68,68,0.25);
      border-radius: 12px;
      padding: 1.25rem;
      margin: 1rem 0;
    }
    .misconception-header { display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #dc2626; margin-bottom: 0.75rem; }
    .misconception-statement {
      font-size: 1rem; font-style: italic; color: var(--navy);
      margin-bottom: 1rem; padding: 0.75rem; background: rgba(255,255,255,0.85); border-radius: 8px;
    }
    .misconception-buttons { display: flex; gap: 0.75rem; justify-content: center; }
    .misconception-btn {
      padding: 0.6rem 1.5rem; border-radius: 8px; font-weight: 600;
      cursor: pointer; transition: all 0.2s; border: 2px solid;
    }
    .misconception-btn.true-btn { background: rgba(34,197,94,0.1); border-color: #22c55e; color: #059669; }
    .misconception-btn.false-btn { background: rgba(239,68,68,0.1); border-color: #ef4444; color: #dc2626; }
    .misconception-btn:hover { transform: scale(1.05); }
    .misconception-btn.correct { background: #22c55e; color: white; border-color: #22c55e; }
    .misconception-btn.wrong { background: #ef4444; color: white; border-color: #ef4444; }
    .misconception-result { margin-top: 1rem; padding: 0.75rem; border-radius: 8px; display: none; }
    .misconception-result.visible { display: block; }
    .misconception-result.correct { background: rgba(34,197,94,0.15); color: #059669; }
    .misconception-result.incorrect { background: rgba(239,68,68,0.1); color: #dc2626; }

    /* ====== PRACTICE PROBLEMS ====== */
    .practice-problem {
      background: linear-gradient(135deg, rgba(15,91,106,0.08), rgba(30,39,97,0.12));
      border: 2px solid rgba(15,91,106,0.3);
      border-radius: 16px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .practice-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .practice-category {
      background: rgba(15,91,106,0.2);
      color: #0f5b6a;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .practice-title {
      font-weight: 700;
      color: var(--navy);
      font-size: 1.1rem;
    }
    .practice-scenario {
      background: rgba(255,255,255,0.9);
      padding: 1rem;
      border-radius: 10px;
      font-size: 0.95rem;
      line-height: 1.6;
      color: var(--text);
      margin-bottom: 1rem;
    }
    .practice-question {
      color: var(--navy);
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    .practice-options {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .practice-option {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: rgba(255,255,255,0.95);
      border: 2px solid rgba(30,39,97,0.15);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: right;
      font-family: inherit;
      font-size: 0.9rem;
    }
    .practice-option:hover:not(:disabled) {
      border-color: var(--navy);
      transform: translateX(-4px);
    }
    .practice-option .option-letter {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--navy);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.8rem;
      flex-shrink: 0;
    }
    .practice-option.correct {
      border-color: #22c55e;
      background: rgba(34,197,94,0.1);
    }
    .practice-option.correct .option-letter {
      background: #22c55e;
    }
    .practice-option.incorrect {
      border-color: #ef4444;
      background: rgba(239,68,68,0.08);
    }
    .practice-option.incorrect .option-letter {
      background: #ef4444;
    }
    .practice-option:disabled {
      cursor: default;
      opacity: 0.8;
    }
    .practice-feedback {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 10px;
      display: none;
      line-height: 1.6;
    }
    .practice-feedback.visible {
      display: block;
    }
    .practice-feedback.correct {
      background: rgba(34,197,94,0.12);
      border: 1px solid rgba(34,197,94,0.3);
      color: #047857;
    }
    .practice-feedback.incorrect {
      background: rgba(239,68,68,0.08);
      border: 1px solid rgba(239,68,68,0.2);
      color: #b91c1c;
    }
    .practice-feedback p {
      margin: 0.5rem 0;
    }
    .practice-feedback .principle-link {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(0,0,0,0.1);
      font-size: 0.85rem;
      color: var(--navy);
    }

    .story-insight strong {
      color: var(--gold);
    }

    .no-story-data {
      text-align: center;
      padding: 2rem 1rem;
      color: rgba(255,255,255,0.5);
      font-size: 0.8rem;
    }

    @keyframes pulseGold {
      0%, 100% { box-shadow: 0 0 0 0 rgba(212,175,55,0.4); }
      50% { box-shadow: 0 0 0 10px rgba(212,175,55,0); }
    }

    .story-data-panel.updating {
      animation: pulseGold 0.5s ease;
    }

    .tool-section {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      margin-bottom: 1rem;
      overflow: hidden;
    }

    .tool-section-header {
      padding: 0.75rem 1rem;
      background: #f7fafc;
      border-bottom: 1px solid #e2e8f0;
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--navy);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .tool-section-body {
      padding: 1rem;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 0.25rem;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      font-size: 0.85rem;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--gold);
      box-shadow: 0 0 0 3px rgba(212,175,55,0.2);
    }

    .btn-small {
      padding: 0.4rem 0.8rem;
      font-size: 0.75rem;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid #e2e8f0;
      background: white;
      color: var(--text);
    }

    .btn-small.primary {
      background: var(--navy);
      color: white;
      border-color: var(--navy);
    }

    /* Study input table */
    .study-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .study-table th,
    .study-table td {
      padding: 0.4rem;
      border: 1px solid #e2e8f0;
      text-align: center;
    }

    .study-table th {
      background: #f7fafc;
      font-weight: 600;
    }

    .study-table input {
      width: 100%;
      padding: 0.25rem;
      border: 1px solid #e2e8f0;
      border-radius: 2px;
      font-size: 0.75rem;
      text-align: center;
    }

    /* Results display */
    .results-display {
      background: #f7fafc;
      border-radius: 6px;
      padding: 1rem;
      margin-top: 1rem;
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      padding: 0.4rem 0;
      font-size: 0.8rem;
      border-bottom: 1px solid #e2e8f0;
    }

    .result-row:last-child { border-bottom: none; }
    .result-row .label { color: var(--light-text); }
    .result-row .value { font-weight: 600; color: var(--navy); }

    /* Forest plot container */
    .forest-plot-container {
      margin-top: 1rem;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      padding: 1rem;
      overflow-x: auto;
    }

    /* Hide tools panel on small screens */
    @media (max-width: 1200px) {
      .tools-panel { display: none; }
      .sidebar { width: 60px; }
      .sidebar .module-info,
      .sidebar .sidebar-header p,
      .sidebar .sidebar-footer { display: none; }
      .sidebar .sidebar-header h1 { font-size: 1rem; }
    }

    /* Leap badge */
    .leap-badge {
      background: var(--red);
      color: white;
      padding: 0.5rem 1rem;
      font-size: 0.85rem;
      font-weight: 700;
      position: absolute;
      right: -10px;
      top: 50%;
      transform: translateY(-50%);
    }

    .card-wrapper {
      position: relative;
      max-width: 800px;
      width: 100%;
    }

    /* Wrong items */
    .wrong-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      background: var(--light-cream);
      padding: 1rem;
      margin: 0.5rem 0;
      max-width: 800px;
      width: 100%;
    }

    .wrong-number {
      background: var(--navy);
      color: var(--cream);
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      font-weight: 700;
      flex-shrink: 0;
    }

    /* Quiz styles */
    .quiz-container {
      max-width: 700px;
      width: 100%;
    }

    .quiz-question {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
    }

    .quiz-question h4 {
      font-size: 1rem;
      color: var(--navy);
      margin-bottom: 1rem;
    }

    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .quiz-option {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      /* Accessibility: make focusable for keyboard nav */
      padding: 0.75rem 1rem;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .quiz-option:hover {
      background: #f7fafc;
      border-color: var(--gold);
    }

    .quiz-option.selected {
      background: rgba(212,175,55,0.1);
      border-color: var(--gold);
    }

    .quiz-option.correct {
      background: rgba(34,197,94,0.1);
      border-color: var(--green);
    }

    .quiz-option.incorrect {
      background: rgba(197,48,48,0.1);
      border-color: var(--red);
    }

    /* RoB Domain Styles */
    .rob-domains {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .rob-domain {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .rob-domain label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text);
    }

    .rob-domain select {
      padding: 0.4rem;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      font-size: 0.8rem;
    }

    /* GRADE factor styles */
    .grade-factors .form-group label {
      font-size: 0.75rem;
      color: var(--text);
    }

    .grade-factors select {
      font-size: 0.75rem;
    }

    /* Red text utility */
    .result-row .value.red {
      color: var(--red);
      font-weight: 700;
    }

    /* Interactive Investigation Exercises */
    .investigation-box {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 1.5rem;
      max-width: 900px;
      width: 100%;
      margin: 1rem 0;
    }

    .investigation-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
      color: var(--gold);
    }

    .investigation-header .icon {
      font-size: 1.5rem;
    }

    .investigation-header h3 {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.3rem;
      font-weight: 600;
      margin: 0;
    }

    .investigation-prompt {
      font-style: italic;
      color: rgba(255,255,255,0.8);
      margin-bottom: 1rem;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .data-table-investigation {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      font-size: 0.85rem;
    }

    .data-table-investigation th,
    .data-table-investigation td {
      padding: 0.5rem 0.75rem;
      border: 1px solid rgba(212,175,55,0.3);
      text-align: center;
      color: var(--cream);
    }

    .data-table-investigation th {
      background: rgba(212,175,55,0.2);
      color: var(--gold);
      font-weight: 600;
    }

    .data-table-investigation tr:nth-child(even) {
      background: rgba(255,255,255,0.05);
    }

    .reveal-btn {
      background: var(--gold);
      color: var(--navy);
      border: none;
      padding: 0.75rem 1.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 1rem;
      transition: all 0.2s;
    }

    .reveal-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212,175,55,0.3);
    }

    .hidden-reveal {
      display: none;
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(197,48,48,0.1);
      border-right: 3px solid var(--red);
      color: var(--cream);
    }

    .hidden-reveal.visible {
      display: block;
      animation: fadeUp 0.4s ease-out;
    }

    .comparison-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin: 1rem 0;
    }

    .comparison-panel {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 1rem;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .comparison-panel h4 {
      color: var(--gold);
      margin-bottom: 0.75rem;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .comparison-panel.after {
      border-color: var(--red);
    }

    .comparison-panel.after h4 {
      color: var(--red);
    }

    /* Rhetorical question styling */
    .rhetorical {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.3rem, 3vw, 1.8rem);
      font-style: italic;
      color: rgba(255,255,255,0.9);
      text-align: center;
      max-width: 700px;
      margin: 1rem 0;
    }

    /* Direct address styling */
    .direct-address {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.2rem;
      color: var(--gold);
      border-right: 3px solid var(--gold);
      padding-right: 1rem;
      margin: 1rem 0;
      font-style: italic;
    }

    /* Mini forest plot for exercises */
    .mini-forest {
      background: white;
      border-radius: 8px;
      padding: 0.75rem;
      margin-top: 0.5rem;
    }

    /* ============================================================
       ACCESSIBILITY IMPROVEMENTS
       ============================================================ */

    /* Focus states for keyboard navigation */
    *:focus {
      outline: 2px solid var(--gold);
      outline-offset: 2px;
    }

    *:focus:not(:focus-visible) {
      outline: none;
    }

    *:focus-visible {
      outline: 2px solid var(--gold);
      outline-offset: 2px;
    }

    .quiz-option:focus-visible,
    .btn:focus-visible,
    .module-item:focus-visible,
    .nav-btn:focus-visible {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
    }

    /* Skip to content link */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--gold);
      color: var(--navy);
      padding: 8px 16px;
      z-index: 1000;
      font-weight: 600;
      text-decoration: none;
      border-radius: 0 0 4px 0;
    }

    .skip-link:focus {
      top: 0;
    }

    /* Screen reader only text */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Improved color contrast for accessibility */
    .light-text-accessible {
      color: #a0aec0; /* Lighter for better contrast on dark */
    }

    /* ============================================================
       MOBILE RESPONSIVE (< 768px)
       ============================================================ */

    .mobile-menu-btn {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1001;
      background: var(--gold);
      color: var(--navy);
      border: none;
      border-radius: 6px;
      padding: 0.5rem 0.75rem;
      font-size: 1.2rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .mobile-menu-btn {
        display: block;
      }

      .sidebar {
        position: fixed;
        left: -280px;
        top: 0;
        height: 100vh;
        z-index: 1000;
        transition: left 0.3s ease;
      }

      .sidebar.open {
        left: 0;
      }

      .sidebar-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 999;
      }

      .sidebar-overlay.open {
        display: block;
      }

      .content-header {
        padding-right: 4rem;
      }

      .tools-panel {
        width: 100%;
        right: -100%;
      }

      .tools-panel.open {
        right: 0;
      }

      .slide .content {
        padding: 1rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
        gap: 0.5rem;
      }
    }

    /* ============================================================
       GLOSSARY PANEL
       ============================================================ */

    .glossary-btn {
      position: fixed;
      bottom: 1rem;
      left: 1rem;
      background: var(--navy);
      color: var(--gold);
      border: 2px solid var(--gold);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .glossary-btn:hover {
      background: var(--gold);
      color: var(--navy);
    }

    /* Story Data Indicator Button */
    .story-indicator-btn {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      background: linear-gradient(135deg, #1E2761 0%, #141B3D 100%);
      color: var(--gold);
      border: 2px solid var(--gold);
      border-radius: 25px;
      padding: 0.5rem 1rem;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      z-index: 100;
      display: none;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .story-indicator-btn.visible {
      display: flex;
    }

    .story-indicator-btn:hover {
      background: var(--gold);
      color: var(--navy);
      transform: translateY(-2px);
    }

    .story-indicator-btn.pulse {
      animation: pulseBtn 2s infinite;
    }

    @keyframes pulseBtn {
      0%, 100% { box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 0 0 rgba(212,175,55,0.4); }
      50% { box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 0 8px rgba(212,175,55,0); }
    }

    .story-indicator-dot {
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
      animation: blink 1.5s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .glossary-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 0;
      background: var(--deep-navy);
      border-top: 2px solid var(--gold);
      z-index: 999;
      overflow: hidden;
      transition: height 0.3s ease;
    }

    .glossary-panel.open {
      height: 50vh;
    }

    .glossary-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid rgba(212,175,55,0.2);
    }

    .glossary-header h3 {
      color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
    }

    .glossary-close {
      background: none;
      border: none;
      color: var(--cream);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .glossary-search {
      padding: 0.75rem 1.5rem;
      border-bottom: 1px solid rgba(212,175,55,0.2);
    }

    .glossary-search input {
      width: 100%;
      padding: 0.5rem 1rem;
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 6px;
      background: rgba(255,255,255,0.05);
      color: var(--cream);
      font-size: 0.9rem;
    }

    .glossary-content {
      padding: 1rem 1.5rem;
      overflow-y: auto;
      height: calc(50vh - 120px);
    }

    .glossary-term {
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .glossary-term dt {
      color: var(--gold);
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 0.25rem;
    }

    .glossary-term dd {
      color: rgba(255,255,255,0.8);
      font-size: 0.9rem;
      line-height: 1.5;
    }

    /* ============================================================
       KEYBOARD SHORTCUTS HELP
       ============================================================ */

    .keyboard-help {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--deep-navy);
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 2rem;
      z-index: 1001;
      display: none;
      min-width: 300px;
      max-width: 90vw;
    }

    .keyboard-help.open {
      display: block;
    }

    .keyboard-help h3 {
      color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
      margin-bottom: 1rem;
      text-align: center;
    }

    .keyboard-help-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .keyboard-help-key {
      background: rgba(255,255,255,0.1);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.85rem;
    }

    /* ============================================================
       LEARNING OBJECTIVES BOX
       ============================================================ */

    .learning-objectives {
      background: rgba(212,175,55,0.1);
      border: 1px solid var(--gold);
      border-radius: 8px;
      padding: 1rem 1.5rem;
      margin: 1rem 0;
      max-width: 700px;
    }

    .learning-objectives h4 {
      color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .learning-objectives ul {
      margin: 0;
      padding-right: 1.25rem;
    }

    .learning-objectives li {
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    /* ============================================================
       DECISION TREE STORIES (Quranic Storytelling)
       ============================================================ */

    .story-box {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border: 2px solid var(--gold);
      border-radius: 16px;
      padding: 2rem;
      max-width: 900px;
      width: 100%;
      margin: 1rem 0;
    }

    .story-opener {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.4rem, 3vw, 2rem);
      font-style: italic;
      color: var(--gold);
      text-align: center;
      margin-bottom: 1.5rem;
      line-height: 1.4;
    }

    .story-opener::before {
      content: '"';
      font-size: 1.5em;
      opacity: 0.5;
    }

    .story-opener::after {
      content: '"';
      font-size: 1.5em;
      opacity: 0.5;
    }

    .real-data-box {
      background: rgba(255,255,255,0.05);
      border-right: 4px solid #3b82f6;
      padding: 1rem 1.5rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    .real-data-box h4 {
      color: #60a5fa;
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .real-data-box h4::before {
      content: '📊';
    }

    .real-data-box p {
      color: var(--cream);
      font-size: 0.95rem;
      line-height: 1.6;
    }

    .real-data-box .data-highlight {
      color: var(--gold);
      font-weight: 700;
    }

    .decision-tree {
      background: rgba(212,175,55,0.1);
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .decision-tree-header {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.2rem;
      color: var(--gold);
      margin-bottom: 1rem;
      text-align: center;
      font-weight: 600;
    }

    .decision-scenario {
      background: rgba(0,0,0,0.3);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-style: italic;
      color: rgba(255,255,255,0.9);
      text-align: center;
    }

    .decision-paths {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    @media (max-width: 768px) {
      .decision-paths {
        grid-template-columns: 1fr;
      }
    }

    .decision-path {
      padding: 1.25rem;
      border-radius: 8px;
      position: relative;
    }

    .decision-path.path-a {
      background: rgba(197, 48, 48, 0.15);
      border: 2px solid rgba(197, 48, 48, 0.5);
    }

    .decision-path.path-b {
      background: rgba(34, 197, 94, 0.15);
      border: 2px solid rgba(34, 197, 94, 0.5);
    }

    .path-label {
      font-weight: 700;
      font-size: 0.85rem;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .decision-path.path-a .path-label {
      color: #f87171;
    }

    .decision-path.path-b .path-label {
      color: #4ade80;
    }

    .path-choice {
      font-size: 0.95rem;
      color: var(--cream);
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .path-arrow {
      color: rgba(255,255,255,0.5);
      text-align: center;
      margin: 0.5rem 0;
      font-size: 1.2rem;
    }

    .path-consequence {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.8);
      line-height: 1.5;
    }

    .path-outcome {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(255,255,255,0.2);
      font-weight: 700;
    }

    .decision-path.path-a .path-outcome {
      color: #f87171;
    }

    .decision-path.path-b .path-outcome {
      color: #4ade80;
    }

    .decision-path:focus {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
    }

    .story-revelation {
      background: linear-gradient(135deg, rgba(212,175,55,0.3), rgba(212,175,55,0.1));
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1.5rem;
      text-align: center;
    }

    .revelation-label {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--gold);
      letter-spacing: 0.15em;
      margin-bottom: 0.75rem;
    }

    .revelation-text {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: clamp(1.1rem, 2.5vw, 1.4rem);
      color: var(--cream);
      line-height: 1.5;
      font-weight: 600;
    }

    .story-timeline {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin: 1rem 0;
      flex-wrap: wrap;
    }

    .timeline-point {
      background: rgba(255,255,255,0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.8rem;
      color: rgba(255,255,255,0.8);
    }

    .timeline-point.critical {
      background: rgba(197, 48, 48, 0.3);
      border: 1px solid rgba(197, 48, 48, 0.5);
      color: #fca5a5;
    }

    .timeline-point.resolution {
      background: rgba(34, 197, 94, 0.3);
      border: 1px solid rgba(34, 197, 94, 0.5);
      color: #86efac;
    }

    /* ============================================================
       REDUCED MOTION (Accessibility)
       ============================================================ */

    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }

      .animate {
        animation: none !important;
        opacity: 1 !important;
      }

      .slide {
        transition: none !important;
      }
    }

    /* ============================================================
       PRINT STYLESHEET
       ============================================================ */

    @media print {
      .sidebar,
      .content-header,
      .slide-nav,
      .tools-panel,
      .glossary-btn,
      .glossary-panel,
      .mobile-menu-btn,
      .keyboard-help,
      .btn,
      .nav-btn,
      .reveal-btn {
        display: none !important;
      }

      .course-container {
        display: block;
        height: auto;
      }

      .main-content {
        display: block;
      }

      .content-body {
        display: block;
      }

      .slides-container {
        display: block;
        height: auto;
        overflow: visible;
      }

      .module-slides {
        display: block !important;
      }

      .slide {
        display: block !important;
        page-break-inside: avoid;
        margin-bottom: 2rem;
        padding: 1rem;
        border: 1px solid #ccc;
      }

      .slide.dark,
      .slide.black {
        background: white !important;
        color: black !important;
      }

      .slide.dark *,
      .slide.black * {
        color: black !important;
      }

      .refrain,
      .title {
        color: #1E2761 !important;
      }

      .gold-line {
        background: #D4AF37 !important;
      }

      body {
        background: white;
        color: black;
      }
    }

    /* ============================================================
       TIER SYSTEM — Clinician | Researcher | Methodologist
       ============================================================ */
    .tier-selector {
      display: flex;
      gap: 2px;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid rgba(212,175,55,0.2);
    }
    .tier-btn {
      flex: 1;
      padding: 0.4rem 0.25rem;
      font-size: 0.65rem;
      font-weight: 600;
      text-align: center;
      border: 1px solid rgba(212,175,55,0.3);
      background: transparent;
      color: rgba(255,255,255,0.6);
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 4px;
    }
    .tier-btn:hover { background: rgba(212,175,55,0.1); color: var(--cream); }
    .tier-btn.active {
      background: var(--gold);
      color: var(--navy);
      border-color: var(--gold);
    }
    .tier-btn .tier-icon { display: block; font-size: 1rem; margin-bottom: 2px; }

    /* Tier visibility: slides tagged data-tier="methods" or "mastery" */
    [data-tier="methods"],
    [data-tier="mastery"] {
      display: none;
    }
    body.tier-researcher [data-tier="methods"] { display: flex; }
    body.tier-methodologist [data-tier="methods"],
    body.tier-methodologist [data-tier="mastery"] { display: flex; }
    /* Foundation slides always visible — no data-tier attr needed */

    /* Tier badge shown on slides */
    .tier-badge {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      font-size: 0.65rem;
      font-weight: 700;
      padding: 0.2rem 0.6rem;
      border-radius: 12px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      z-index: 2;
    }
    .tier-badge.methods {
      background: rgba(59,130,246,0.2);
      color: #60a5fa;
      border: 1px solid rgba(59,130,246,0.3);
    }
    .tier-badge.mastery {
      background: rgba(168,85,247,0.2);
      color: #c084fc;
      border: 1px solid rgba(168,85,247,0.3);
    }
    .slide.light .tier-badge.methods {
      background: rgba(59,130,246,0.1);
      color: #2563eb;
      border-color: rgba(59,130,246,0.3);
    }
    .slide.light .tier-badge.mastery {
      background: rgba(168,85,247,0.1);
      color: #7c3aed;
      border-color: rgba(168,85,247,0.3);
    }
  </style>
</head>
<body>
 انتقل إلى رابط المحتوى لسهولة الوصول 
<a class="skip-link" href="#main-content">انتقل إلى المحتوى</a>
 زر قائمة الهاتف المحمول 
<button aria-expanded="false" aria-label="Toggle navigation menu" class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>
 تراكب الشريط الجانبي المحمول 
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
 زر المسرد 
 مؤشر بيانات القصة 
<button aria-label="عرض بيانات القصة" class="story-indicator-btn pulse" id="storyIndicatorBtn" onclick="openToolsWithStory()">
<span class="story-indicator-dot"></span>
<span>📊 البيانات الحية المتاحة</span>
</button>
<button aria-label="Open glossary" class="glossary-btn" onclick="toggleGlossary()" title="Glossary (press G)">📖</button>
 لوحة المصطلحات 
<div aria-label="Glossary" class="glossary-panel" id="glossaryPanel" role="dialog">
<div class="glossary-header">
<h3>مسرد المصطلحات</h3>
<button aria-label="Close glossary" class="glossary-close" onclick="toggleGlossary()">×</button>
</div>
<div class="glossary-search">
<input aria-label="Search glossary" id="glossarySearch" onkeyup="filterGlossary()" placeholder="Search terms..." type="text"/>
</div>
<div class="glossary-content" id="glossaryContent">
<dl>
<div class="glossary-term" data-term="meta-analysis">
<dt>التحليل التلوي</dt>
<dd>طريقة إحصائية للجمع بين نتائج دراسات مستقلة متعددة تتناول نفس السؤال لإنتاج تقدير مجمع.</dd>
</div>
<div class="glossary-term" data-term="systematic review">
<dt>مراجعة منهجية</dt>
<dd>طريقة إحصائية شاملة مراجعة الأدبيات القابلة للتكرار والتي تستخدم طرقًا واضحة لتحديد واختيار وتقييم وتجميع جميع الدراسات ذات الصلة بسؤال محدد.</dd>
</div>
<div class="glossary-term" data-term="pico">
<dt>PICO</dt>
<dd>إطار صياغة الأسئلة السريرية: السكان، التدخل، المقارنة، النتيجة.</dd>
</div>
<div class="glossary-term" data-term="heterogeneity">
<dt>عدم التجانس</dt>
<dd>التباين في نتائج الدراسة بما يتجاوز ما يمكن توقعه عن طريق الصدفة. يتم القياس بإحصائيات I² وτ² وQ.</dd>
</div>
<div class="glossary-term" data-term="i-squared">
<dt>I² (I-مربع)</dt>
<dd>النسبة المئوية للتباين في تقديرات التأثير الذي يرجع إلى عدم التجانس بدلاً من خطأ أخذ العينات. 0-25%: منخفض، 25-50%: متوسط، 50-75%: كبير، 75-100%: كبير.</dd>
</div>
<div class="glossary-term" data-term="tau-squared">
<dt>τ² (مربع تاو)</dt>
<dd>التباين بين الدراسة في نموذج التأثيرات العشوائية. يقيس الحجم المطلق للتغايرية على مقياس حجم التأثير.</dd>
</div>
<div class="glossary-term" data-term="fixed effect">
<dt>نموذج التأثير الثابت</dt>
<dd>يفترض أن جميع الدراسات تقدر نفس التأثير الحقيقي. دراسات الأوزان بالتباين العكسي (الدقة). تهيمن الدراسات الكبيرة.</dd>
</div>
<div class="glossary-term" data-term="random effects">
<dt>نموذج التأثيرات العشوائية</dt>
<dd>يفترض أن الدراسات تقدر التأثيرات المختلفة ولكن ذات الصلة من التوزيع. يدمج التباين بين الدراسات (τ²) في الأوزان.</dd>
</div>
<div class="glossary-term" data-term="forest plot">
<dt>قطعة أرض الغابات</dt>
<dd>عرض رسومي لأحجام التأثير من الدراسات الفردية والتقدير المجمع، مع فترات الثقة.</dd>
</div>
<div class="glossary-term" data-term="funnel plot">
<dt>مخطط القمع</dt>
<dd>مخطط مبعثر بحجم التأثير مقابل الخطأ القياسي. قد يشير عدم التماثل إلى تحيز النشر أو تأثيرات الدراسة الصغيرة.</dd>
</div>
<div class="glossary-term" data-term="publication bias">
<dt>انحياز النشر</dt>
<dd>ميل الدراسات ذات النتائج الإيجابية/الهامة إلى النشر أكثر من الدراسات الخالية/السلبية.</dd>
</div>
<div class="glossary-term" data-term="egger test">
<dt>اختبار إيجر</dt>
<dd>اختبار الانحدار لعدم تناسق مخطط القمع. تشير P &lt;0.10 إلى تأثيرات محتملة للدراسات الصغيرة أو تحيز النشر.</dd>
</div>
<div class="glossary-term" data-term="trim and fill">
<dt>تقليم وملء</dt>
<dd>طريقة ل تقدير عدد الدراسات المفقودة بسبب تحيز النشر وضبط التأثير المجمع وفقًا لذلك.</dd>
</div>
<div class="glossary-term" data-term="risk of bias">
<dt>خطر التحيز (RoB)</dt>
<dd>تقييم الأخطاء المنهجية في تصميم الدراسة أو إجرائها أو إعداد التقارير التي قد تؤثر على النتائج. RoB 2.0 هي أداة كوكرين للتجارب المعشاة ذات الشواهد.</dd>
</div>
<div class="glossary-term" data-term="robins-i">
<dt>روبنز-آي</dt>
<dd>خطر التحيز في الدراسات غير العشوائية للتدخلات. أداة كوكرين لتقييم التحيز في الدراسات الرصدية.</dd>
</div>
<div class="glossary-term" data-term="grade">
<dt>الدرجة</dt>
<dd>تصنيف التوصيات والتقييم والتطوير والتقييمات. إطار عمل لتقييم يقين الأدلة (مرتفع، متوسط، منخفض، منخفض جدًا).</dd>
</div>
<div class="glossary-term" data-term="prediction interval">
<dt>الفاصل الزمني للتنبؤ</dt>
<dd>نطاق التأثيرات المتوقعة في دراسة جديدة، مع مراعاة عدم التجانس بين الدراسات. فاصل الثقة أوسع من.</dd>
</div>
 NNT محدد في قسم المسرد الجديد أدناه مع تعريف أكمل 
<div class="glossary-term" data-term="nnh">
<dt>NNH (العدد المطلوب للإضرار)</dt>
<dd>عدد المرضى الذين يحتاجون إلى العلاج لمريض إضافي واحد حتى يتعرض للأذى. NNH = 1/ARI.</dd>
</div>
<div class="glossary-term" data-term="hksj">
<dt>تعديل HKSJ</dt>
<dd>تعديل هارتونج-ناب-سيديك-جونكمان. يستخدم توزيع t لفترات الثقة في نماذج التأثيرات العشوائية، مما يوفر تغطية أفضل مع عدد قليل من الدراسات.</dd>
</div>
<div class="glossary-term" data-term="prospero">
<dt>بروسبيرو</dt>
<dd>السجل الدولي المحتمل للمراجعات المنهجية. التسجيل المسبق يمنع التغييرات المنهجية اللاحقة.</dd>
</div>
<div class="glossary-term" data-term="prisma">
<dt>بريسما</dt>
<dd>عناصر التقارير المفضلة للمراجعات المنهجية والتحليلات الوصفية. إرشادات إعداد التقارير مع مخطط التدفق وقائمة المراجعة.</dd>
</div>
<div class="glossary-term" data-term="nma">
<dt>التحليل التلوي للشبكة (NMA)</dt>
<dd>طريقة لمقارنة معالجات متعددة في وقت واحد باستخدام الأدلة المباشرة وغير المباشرة من خلال المقارنات المشتركة.</dd>
</div>
<div class="glossary-term" data-term="sucra">
<dt>سوكرا</dt>
<dd>السطح تحت منحنى التصنيف التراكمي. يصنف العلاجات في NMA من 0% (الأسوأ) إلى 100% (الأفضل).</dd>
</div>
<div class="glossary-term" data-term="ipd">
<dt>التحليل التلوي IPD</dt>
<dd>التحليل التلوي لبيانات المريض الفردية. يستخدم بيانات أولية على مستوى المريض من التجارب بدلاً من الملخصات المنشورة. المعيار الذهبي لتحليل المجموعات الفرعية.</dd>
</div>
<div class="glossary-term" data-term="dta">
<dt>التحليل التلوي DTA</dt>
<dd>التحليل التلوي لدقة الاختبار التشخيصي. تجميع الحساسية والخصوصية باستخدام نماذج ثنائية المتغير.</dd>
</div>
<div class="glossary-term" data-term="sroc">
<dt>منحنى SROC</dt>
<dd>ملخص منحنى خاصية تشغيل جهاز الاستقبال. يستخدم في التحليل التلوي DTA لعرض الحساسية/النوعية المجمعة.</dd>
</div>
<div class="glossary-term" data-term="iceman">
<dt>رجل الجليد</dt>
<dd>أداة لتقييم مصداقية تحليلات تعديل التأثير. يقيم مصداقية تحليل المجموعة الفرعية.</dd>
</div>
<div class="glossary-term" data-term="tsa">
<dt>التحليل التسلسلي التجريبي (TSA)</dt>
<dd>طريقة تطبيق حدود التوقف على التحليل التلوي التراكمي لتحديد وقت تراكم الأدلة الكافية.</dd>
</div>
<div class="glossary-term" data-term="living review">
<dt>المراجعة المنهجية الحية</dt>
<dd>مراجعة يتم تحديثه باستمرار مع ظهور أدلة جديدة، بدلاً من أن يكون منشورًا ثابتًا في وقت محدد.</dd>
</div>
 مصطلحات مسرد الوحدة المتقدمة 
<div class="glossary-term" data-term="bayesian"><dt>التحليل التلوي بايزي</dt>
<dd>التحليل التلوي باستخدام نظرية بايز: يجمع بين المعتقدات السابقة والبيانات (الاحتمالية) لإنتاج توزيعات لاحقة لمعلمات التأثير.</dd></div>
<div class="glossary-term" data-term="prior"><dt>التوزيع المسبق</dt>
<dd>التوزيع الاحتمالي الذي يمثل المعتقدات حول المعلمة قبل رؤية البيانات. يمكن أن تكون غامضة أو ضعيفة المعلومات أو غنية بالمعلومات.</dd></div>
<div class="glossary-term" data-term="posterior"><dt>التوزيع الخلفي</dt>
<dd>توزيع الاحتمالية المحدث بعد دمج التوزيع السابق مع احتمالية البيانات. أساس كل الاستدلال بايزي.</dd></div>
<div class="glossary-term" data-term="credible interval"><dt>الفاصل الزمني الموثوق</dt>
<dd>التناظرية البايزية لفترة الثقة. تعني نسبة 95% CrI أن هناك احتمالًا بنسبة 95% أن تقع المعلمة ضمن الفاصل الزمني.</dd></div>
<div class="glossary-term" data-term="mcmc"><dt>MCMC (سلسلة ماركوف مونت كارلو)</dt>
<dd>طريقة حسابية لسحب العينات من التوزيعات الخلفية عند عدم توفر الحلول التحليلية. الأدوات: JAGS، ستان، PyMC.</dd></div>
<div class="glossary-term" data-term="bayes factor"><dt>عامل بايز</dt>
<dd>نسبة الاحتمالات الهامشية لمقارنة الفرضيتين. BF10&gt; 10 = دليل قوي على H1. يستبدل القيم p في اختبار بايزي.</dd></div>
<div class="glossary-term" data-term="transitivity"><dt>العبور</dt>
<dd>افتراض NMA الأساسي: تكون المقارنات غير المباشرة صالحة عندما يتم توزيع معدلات التأثير بشكل مماثل عبر المقارنات في الشبكة.</dd></div>
<div class="glossary-term" data-term="consistency"><dt>الاتساق (NMA)</dt>
<dd>الاتفاق بين الأدلة المباشرة وغير المباشرة. تم اختباره عبر تقسيم العقد (محلي) أو التفاعل بين التصميم والعلاج (عالمي).</dd></div>
<div class="glossary-term" data-term="p-score"><dt>درجة P</dt>
<dd>التناظرية المتكررة لـ SUCRA في NMA. يقيس متوسط مدى اليقين بأن علاجًا واحدًا أفضل من جميع العلاجات الأخرى.</dd></div>
<div class="glossary-term" data-term="component nma"><dt>مكون NMA</dt>
<dd>يحلل التدخلات متعددة المكونات لتقدير تأثيرات المكونات الفردية. يستخدم نماذج مضافة.</dd></div>
<div class="glossary-term" data-term="ecological bias"><dt>التحيز البيئي</dt>
<dd>يحدث عندما تختلف الارتباطات على مستوى الدراسة عن الارتباطات على مستوى المريض. يمكن لـ IPD فقط فصل التأثيرات داخل الدراسة عن التأثيرات بين الدراسات.</dd></div>
<div class="glossary-term" data-term="one-stage"><dt>نموذج IPD ذو المرحلة الواحدة</dt>
<dd>نموذج واحد مختلط التأثيرات مُجهز لجميع بيانات المريض في وقت واحد. أقوى للتفاعلات والأحداث النادرة من المرحلتين.</dd></div>
<div class="glossary-term" data-term="two-stage"><dt>نموذج IPD ذو المرحلتين</dt>
<dd>قم بتحليل كل دراسة على حدة، ثم اجمع بين التقديرات. أبسط ولكن من المحتمل أن يفقد المعلومات مقارنة بمرحلة واحدة.</dd></div>
<div class="glossary-term" data-term="dose-response"><dt>التحليل التلوي للاستجابة للجرعة</dt>
<dd>نماذج العلاقة بين جرعة التعرض والنتيجة عبر الدراسات. يستخدم الانحدار الخطي، متعدد الحدود، أو الخط.</dd></div>
<div class="glossary-term" data-term="restricted cubic spline"><dt>الخطوط المكعبة المقيدة (RCS)</dt>
<dd>منحنيات متعددة الحدود مع عقد عند نقاط الجرعة المحددة مسبقًا. عقدة خطية وراء الحدود. تستخدم لنمذجة الاستجابة المرنة للجرعة.</dd></div>
<div class="glossary-term" data-term="fragility index"><dt>مؤشر الهشاشة</dt>
<dd>الحد الأدنى لعدد التغييرات في نتائج المريض اللازمة لقلب نتيجة ذات دلالة إحصائية إلى نتيجة غير مهمة. أقل = أكثر هشاشة.</dd></div>
<div class="glossary-term" data-term="gosh"><dt>مخطط GOSH</dt>
<dd>نظرة رسومية على عدم تجانس الدراسة. مؤامرات التأثير المجمع مقابل I² لجميع مجموعات الدراسة الفرعية الممكنة للكشف عن الدراسات والمجموعات المؤثرة.</dd></div>
<div class="glossary-term" data-term="contour funnel"><dt>مخطط قمع معزز للخطوط</dt>
<dd>مؤامرة قمع مع ملامح أهمية مظللة (P &lt;0.01، 0.05، 0.10). يساعد على التمييز بين تحيز النشر والأسباب الأخرى لعدم التماثل.</dd></div>
<div class="glossary-term" data-term="copas"><dt>نموذج اختيار Copas</dt>
<dd>نماذج احتمالية نشر الدراسة كدالة لـ SE وحجم التأثير. يقدر بشكل مشترك التأثير الحقيقي وآلية الاختيار.</dd></div>
<div class="glossary-term" data-term="pet-peese"><dt>الحيوانات الأليفة بيز</dt>
<dd>اختبار تأثير الدقة / تقدير تأثير الدقة مع الخطأ المعياري. اختبار قائم على الانحدار لتأثيرات الدراسة الصغيرة وتحيز النشر.</dd></div>
<div class="glossary-term" data-term="progress-plus"><dt>التقدم زائد</dt>
<dd>إطار لتقييم المساواة: المكان، العرق، المهنة، الجنس، الدين، التعليم، SES، رأس المال الاجتماعي، بالإضافة إلى العمر، والإعاقة، والتوجه.</dd></div>
<div class="glossary-term" data-term="prisma-equity"><dt>PRISMA-الأسهم</dt>
<dd>توسيع نطاق PRISMA للمراجعات المنهجية التي تركز على الأسهم. يتطلب الإبلاغ عن السكان المحرومين وقابلية التطبيق.</dd></div>
<div class="glossary-term" data-term="transportability"><dt>قابلية النقل</dt>
<dd>مدى تطبيق نتائج التجربة على مجموعة سكانية مستهدفة مختلفة عن عينة التجربة. توجد طرق لإعادة وزن بيانات التجربة.</dd></div>
<div class="glossary-term" data-term="active learning"><dt>التعلم النشط (الفحص)</dt>
<dd>نهج تعلم الآلة الذي يختار بشكل متكرر الاستشهادات الأكثر إفادة للمراجعة البشرية، والتعلم من كل قرار لتحسين التصنيف.</dd></div>
<div class="glossary-term" data-term="wss"><dt>دبليو إس إس @ 95%</dt>
<dd>تم حفظ العمل عبر أخذ العينات عند استدعاء 95%. يقيس كفاءة أتمتة الفحص: ما هي النسبة المئوية للاستشهادات التي يمكن تخطيها بأمان.</dd></div>
<div class="glossary-term" data-term="meta-ethnography"><dt>ميتا الاثنوغرافيا</dt>
<dd>طريقة التركيب النوعي (Noblit &amp; Hare 1988) التي تترجم المفاهيم عبر الدراسات لإنتاج أطر تفسيرية جديدة.</dd></div>
<div class="glossary-term" data-term="cerqual"><dt>CERQual</dt>
<dd>الثقة في الأدلة من مراجعات البحث النوعي. يقيم الثقة من خلال القيود المنهجية والتماسك والكفاية والأهمية.</dd></div>
<div class="glossary-term" data-term="thematic synthesis"><dt>التوليف الموضوعي</dt>
<dd>النهج النوعي الذي يرمز النتائج عبر الدراسات ويولد موضوعات تحليلية. يجمع بين عناصر الفوقية الاثنوغرافية والنظرية الراسخة.</dd></div>
<div class="glossary-term" data-term="rve"><dt>RVE (تقدير التباين القوي)</dt>
<dd>يوفر مُقدِّر من نوع ساندويتش أخطاء معيارية صالحة لأحجام التأثير التابعة دون معرفة الارتباط الحقيقي داخل الدراسة.</dd></div>
<div class="glossary-term" data-term="three-level model"><dt>نموذج ثلاثي المستويات</dt>
<dd>تباين تقسيم النموذج متعدد المستويات إلى مكونات أخذ العينات (L1)، وداخل الدراسة (L2)، وبين الدراسة (L3) لأحجام التأثير المتداخلة.</dd></div>
<div class="glossary-term" data-term="reproducibility"><dt>إمكانية تكرار نتائج</dt>
<dd>نفس البيانات + نفس الكود = نفس النتيجة. الحد الأدنى القياسي لأي تحليل كمي. تتميز عن إمكانية التكرار (بيانات جديدة، نفس الأساليب).</dd></div>
<div class="glossary-term" data-term="proof-carrying number"><dt>رقم يحمل الدليل</dt>
<dd>نتيجة رقمية مجمعة مع سلسلة مصدرها الكاملة: تجزئة بيانات الإدخال، ورمز التحويل، ونتائج التحقق من الصحة، ومسار التدقيق.</dd></div>
<div class="glossary-term" data-term="evidence hashing"><dt>تجزئة الأدلة</dt>
<dd>بصمة التشفير (SHA-256) لبيانات الإدخال والتعليمات البرمجية التي تكتشف أي تغيير. المكون الأساسي للأرقام الحاملة للإثبات.</dd></div>
<div class="glossary-term" data-term="bma"><dt>متوسط النماذج الافتراضية (BMA)</dt>
<dd>ترجيح نماذج متعددة (FE، RE، وما إلى ذلك) حسب احتماليتها الخلفية بدلاً من اختيار نموذج واحد. حسابات عدم اليقين النموذجي.</dd></div>
<div class="glossary-term" data-term="half-cauchy"><dt>جدول Half-Cauchy Prior</dt>
<dd>يشيع استخدام العائلة السابقة لمعلمة عدم التجانس تاو. فهو يسمح بقيم كبيرة مع تركيز الاحتمال بالقرب من الصفر، ولكن يجب تبرير اختيار المقياس لمقياس التأثير والسياق السريري.</dd></div>
<div class="glossary-term" data-term="league table"><dt>جدول الدوري</dt>
<dd>يُظهر مخرج NMA جميع المقارنات الزوجية في مصفوفة. تُظهر المثلثات العلوية/السفلية تقديرات التأثير وفترات زمنية موثوقة.</dd></div>
<div class="glossary-term" data-term="node-splitting"><dt>تقسيم العقدة</dt>
<dd>اختبار التناقض المحلي في NMA يقارن الأدلة المباشرة وغير المباشرة لكل مقارنة. يشير الاختلاف الكبير إلى انتهاك العبور.</dd></div>
<div class="glossary-term" data-term="sick-quitter bias"><dt>الانحياز المرضي</dt>
<dd>يحدث عندما يتم تصنيف المستخدمين السابقين (الذين توقفوا عن العمل بسبب المرض) على أنهم غير مستخدمين، مما يجعل مجموعة غير المستخدمين تبدو أكثر مرضًا مما هي عليه بالفعل.</dd></div>
<div class="glossary-term" data-term="knots"><dt>العقد (الخط)</dt>
<dd>نقاط الجرعة المحددة مسبقًا حيث تنضم الأجزاء متعددة الحدود إلى خطوط مكعبة مقيدة. عادة يتم وضع 3-5 عقدة عند كميات توزيع الجرعة.</dd></div>
<div class="glossary-term" data-term="scoping-review"><dt>مراجعة النطاق</dt>
<dd>نوع من تركيب الأدلة الذي يرسم نطاق ونطاق وطبيعة نشاط البحث في المجال. يستخدم إطار PCC (السكان، المفهوم، السياق). تم الإبلاغ عنها باستخدام PRISMA-ScR. لا يقيم الجودة أو النتائج المجمعة.</dd></div>
<div class="glossary-term" data-term="umbrella-review"><dt>مراجعة شاملة</dt>
<dd>مراجعة للمراجعات المنهجية الموجودة حول موضوع ما. يستخدم AMSTAR 2 لتقييم جودة المراجعة وROBIS لخطر التحيز. يُطلق عليها أيضًا "نظرة عامة على المراجعات". تتداخل تصحيحات الدراسة باستخدام طريقة المنطقة المغطاة المصححة (CCA).</dd></div>
<div class="glossary-term" data-term="cluster-rct"><dt>تجربة عشوائية عنقودية</dt>
<dd>تجربة تقوم بتوزيع المجموعات بشكل عشوائي (المستشفيات والمدارس والمجتمعات) بدلاً من الأفراد. يتطلب التعديل حسب تأثير التصميم = 1 + (m−1) × ICC، حيث m هو حجم المجموعة وICC هو الارتباط داخل المجموعة. يؤدي تجاهل التجميع إلى تضخيم الدقة.</dd></div>
<div class="glossary-term" data-term="crossover-trial"><dt>تجربة متقاطعة</dt>
<dd>تجربة يتلقى فيها كل مشارك كلا العلاجين بالتسلسل (مع فترة تبييض). التحليل المقترن يقلل من التباين. يتطلب الارتباط داخل المريض أو SE المقترن لتجميع التحليل التلوي الصحيح.</dd></div>
<div class="glossary-term" data-term="design-effect"><dt>تأثير التصميم (DEFF)</dt>
<dd>نسبة التباين تحت العينة العنقودية إلى التباين تحت العينة العشوائية البسيطة. DEFF = 1 + (m−1) × ICC. يستخدم لضبط حجم العينة والأخطاء القياسية من التجارب العشوائية العنقودية قبل التجميع في التحليل التلوي.</dd></div>
<div class="glossary-term" data-term="hazard-ratio"><dt>نسبة المخاطر (HR)</dt>
<dd>نسبة معدلات الخطر بين مجموعتين في التحليل من وقت إلى حدث. HR &lt;1 يفضل العلاج. يتم تجميعها على مقياس السجل باستخدام ترجيح التباين العكسي. SE مشتق من 95% CI: SE = (ln(upper) − ln(lower)) / 3.92.</dd></div>
<div class="glossary-term" data-term="masem"><dt>MASEM (تحليل ميتا SEM)</dt>
<dd>نمذجة المعادلات الهيكلية التحليلية التلوية. طريقة من مرحلتين: (1) مصفوفات الارتباط المجمعة عبر الدراسات، (2) تناسب نموذج المعادلة الهيكلية مع المصفوفة المجمعة. يستخدم لاختبار نماذج المسار النظري عبر دراسات متعددة.</dd></div>
<div class="glossary-term" data-term="nnt"><dt>العدد المطلوب لـ علاج (NNT)</dt>
<dd>عدد المرضى الذين يجب علاجهم لمريض إضافي واحد للاستفادة. NNT = 1 / تقليل المخاطر المطلقة. يعتمد على المخاطر الأساسية. قم دائمًا بالإبلاغ جنبًا إلى جنب مع OR أو RR لقابلية التفسير السريري.</dd></div>
<div class="glossary-term" data-term="power-ma"><dt>القوة في التحليل التلوي</dt>
<dd>احتمال اكتشاف تأثير حقيقي لحجم معين. يعتمد على عدد الدراسات وأحجام الدراسة وعدم التجانس (τ²) وحجم التأثير. توجد آلات حاسبة قوية للتحليل التلوي (على سبيل المثال، Valentine et al. 2010). القليل من الدراسات ذات التجانس العالي تقلل الطاقة بشكل كبير.</dd></div>
</dl>
</div>
</div>
 مساعدة اختصارات لوحة المفاتيح 
<div aria-label="Keyboard shortcuts" class="keyboard-help" id="keyboardHelp" role="dialog">
<h3>اختصارات لوحة المفاتيح</h3>
<div class="keyboard-help-item">
<span>الشريحة التالية</span>
<span class="keyboard-help-key">→ or Space</span>
</div>
<div class="keyboard-help-item">
<span>الشريحة السابقة</span>
<span class="keyboard-help-key">← or Backspace</span>
</div>
<div class="keyboard-help-item">
<span>الوحدة التالية</span>
<span class="keyboard-help-key">↓ or N</span>
</div>
<div class="keyboard-help-item">
<span>الوحدة السابقة</span>
<span class="keyboard-help-key">↑ or P</span>
</div>
<div class="keyboard-help-item">
<span>تبديل لوحة الأدوات</span>
<span class="keyboard-help-key">T</span>
</div>
<div class="keyboard-help-item">
<span>تبديل المسرد</span>
<span class="keyboard-help-key">G</span>
</div>
<div class="keyboard-help-item">
<span>هذه المساعدة</span>
<span class="keyboard-help-key">?</span>
</div>
<div class="keyboard-help-item">
<span>إغلاق مربعات الحوار</span>
<span class="keyboard-help-key">Esc</span>
</div>
<button class="btn" onclick="toggleKeyboardHelp()" style="margin-top: 1rem; width: 100%;">إغلاق</button>
</div>
<div class="course-container">
 التنقل في الشريط الجانبي 
<nav aria-label="التنقل في الوحدة" class="sidebar" role="navigation">
<div class="sidebar-header">
<a href="index-ar.html" onmouseout="this.style.color='rgba(212,175,55,0.7)'" onmouseover="this.style.color='#D4AF37'" style="display:block;font-size:0.7rem;color:rgba(212,175,55,0.7);text-decoration:none;margin-bottom:0.5rem;">← مكتبة الدورة</a>
<h1>دورة عكس الأدلة</h1>
<p>طرق التحليل التلوي</p>
</div>
<div class="module-list" id="moduleList">
 عناصر الوحدة التي تم إنشاؤها بواسطة JS 
</div>
 محدد المستوى 
<div aria-label="Content depth level" class="tier-selector" role="radiogroup">
<button aria-checked="true" class="tier-btn active" data-tier="foundation" onclick="setTier('foundation')" role="radio">
<span class="tier-icon">🩺</span>طبيب
        </button>
<button aria-checked="false" class="tier-btn" data-tier="researcher" onclick="setTier('researcher')" role="radio">
<span class="tier-icon">🔬</span>الباحث
        </button>
<button aria-checked="false" class="tier-btn" data-tier="methodologist" onclick="setTier('methodologist')" role="radio">
<span class="tier-icon">🧮</span>منهجي
        </button>
</div>
<div class="sidebar-footer">
<button class="dashboard-btn" onclick="openDashboard()">
<span>📊</span>
<span>لوحة معلومات التقدم</span>
<span id="sidebarPoints" style="margin-right: auto; font-weight: 700;">0 نقاط</span>
</button>
<button class="daily-review-btn" id="dailyReviewBtn" onclick="openDailyReview()">
<span>🧠</span>
<span>المراجعة اليومية</span>
<span id="reviewStatus" style="margin-right: auto;">مستعد</span>
</button>
<p style="text-align: center; margin-bottom: 0.5rem;">التقدم: <span id="progressPercent">0%</span></p>
<button class="btn" onclick="resetProgress()" style="padding: 0.25rem 0.5rem; font-size: 0.7rem; width: 100%;">إعادة ضبط التقدم</button>
</div>
</nav>
 لوحة معلومات التقدم Modal 
<div class="progress-dashboard" id="progressDashboard">
<div class="dashboard-content">
<div class="dashboard-header">
<h2>تقدمك</h2>
<button class="dashboard-close" onclick="closeDashboard()">×</button>
</div>
<div class="level-display">
<div class="level-badge" id="levelBadge">المستوى 1: المبتدئ</div>
<div class="points-display" id="totalPoints">0</div>
<div class="points-label">إجمالي النقاط</div>
</div>
<div class="stats-grid">
<div class="stat-card">
<div class="stat-value" id="modulesCompleted">0/25</div>
<div class="stat-label">الوحدات</div>
</div>
<div class="stat-card">
<div class="stat-value" id="predictionsCorrect">0/0</div>
<div class="stat-label">التنبؤات</div>
</div>
<div class="stat-card">
<div class="stat-value" id="quizzesCompleted">0</div>
<div class="stat-label">مسابقات</div>
</div>
</div>
<div class="principles-section">
<h3>المبادئ السبعة</h3>
<div id="principlesList"></div>
</div>
<div class="badges-section">
<h3>الشارات المكتسبة</h3>
<div class="badges-grid" id="badgesGrid"></div>
</div>
<div class="streak-section">
<h3>خط التعلم</h3>
<div class="streak-display">
<div class="streak-flame" id="streakFlame">🔥</div>
<div class="streak-info">
<div class="streak-count" id="streakCount">0 أيام</div>
<div class="streak-label">استمر في التعلم يوميًا!</div>
</div>
</div>
</div>
</div>
</div>
 المراجعة اليومية Modal 
<div aria-label="المراجعة اليومية" class="daily-review-modal" id="dailyReviewModal" role="dialog">
<div class="daily-review-content">
<div class="daily-review-header">
<h2>📚 المراجعة اليومية</h2>
<button class="daily-review-close" onclick="closeDailyReview()">×</button>
</div>
<div class="review-timer">
<div class="timer-display" id="reviewTimer">2:00</div>
<div class="timer-label">تقوية ذاكرتك</div>
</div>
<div class="review-progress" id="reviewProgress">
 تم إدراج نقاط التقدم بواسطة JS 
</div>
<div id="reviewCardContainer">
 مراجعة البطاقات التي تم إدراجها بواسطة JS 
</div>
<div class="review-actions" id="reviewActions">
<button class="review-btn skip" onclick="skipDailyReview()">تخطي لـ اليوم</button>
<button class="review-btn next" disabled="" id="reviewNextBtn" onclick="nextReviewQuestion()">يكمل</button>
</div>
</div>
</div>
 المحتوى الرئيسي 
<main class="main-content">
<header class="content-header">
<div class="breadcrumb">
          الوحدة <span id="currentModuleNum">0</span>: <span id="currentModuleName">الافتتاح</span>
</div>
<div class="header-actions">
<button class="btn" onclick="toggleToolsPanel()">الأدوات</button>
<button class="btn primary" onclick="nextModule()">الوحدة التالية</button>
</div>
</header>
<div class="content-body">
 إمكانية الوصول: إعلانات قارئ الشاشة لتغييرات الشرائح 
<div aria-atomic="true" aria-live="polite" class="sr-only" id="slideAnnouncer"></div>
 حاوية الشرائح 
<div aria-label="شرائح الدورة التدريبية" class="slides-container" id="main-content" role="region">
 الوحدة 0: الافتتاحية 
<div class="module-slides active" data-module="0">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 0: الافتتاحية</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تعريف التحليل التلوي وشرح دوره في تركيب الأدلة</li>
<li>تحديد متى لا ينبغي إجراء الدراسات مجمعة</li>
<li>وصف التسلسل الهرمي للأدلة وموقع المراجعات المنهجية</li>
<li>إدراك أن التحليل التلوي يمكن أن يكون مضللاً عندما يتم إجراؤه بشكل سيئ</li>
<li>تذكر المبادئ السبعة التي ترتكز عليها هذه الدورة</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">هذه الدورة موجودة لأن</p>
<p class="title gold animate delay-1 text-center">كان الطب خاطئًا.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                لا مرة واحدة. ليس نادرا. مرارا. بطرق قتلت المرضى الذين كانوا يثقون في صحة الأدلة.
              </p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">ما هو التحليل التلوي؟</h2>
<div class="card animate delay-1">
<p class="card-text text-center">
                    طريقة إحصائية للجمع بين نتائج دراسات مستقلة متعددة تتناول نفس السؤال.
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">1976</div>
<div class="stat-label">المصطلح الذي صاغه جين جلاس</div>
</div>
<div class="stat-box">
<div class="stat-value">~50,000</div>
<div class="stat-label">يُنشر سنويًا</div>
</div>
<div class="stat-box">
<div class="stat-value">#1</div>
<div class="stat-label">التسلسل الهرمي للأدلة*</div>
</div>
</div>
<p class="footnote animate delay-3">* عند إجرائه بشكل جيد. إن جودة السلوك لها أهمية أكبر من تصميم الدراسة وحده — كما تعترف GRADE.</p>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">لماذا دراسات البلياردو؟</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>زيادة القوة الإحصائية</h4>
<p>قد تكون الدراسات الفردية أصغر من أن تتمكن من اكتشاف التأثيرات.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>تحسين الدقة</h4>
<p>فترات ثقة أضيق حول تقديرات التأثير.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>حل الخلاف</h4>
<p>عندما تتعارض الدراسات، يمكن للتجميع توضيح الإشارة.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>استكشاف عدم التجانس</h4>
<p>حدد سبب اختلاف التأثيرات عبر المجموعات السكانية أو الإعدادات.</p>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<p class="title cream animate text-center">لكن التحليل التلوي يمكنه ذلك أيضًا</p>
<p class="big-number gold animate delay-1">مضلل</p>
<p class="animate delay-2" style="font-size: 1.1rem; text-align: center; max-width: 600px; margin-top: 1rem;">
                وعندما يتم القيام بذلك بشكل سيء، فإنه يؤدي إلى تضخيم التحيز بدلاً من الحقيقة.
              </p>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">عندما لا تجمع</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p>تقيس الدراسات أشياء مختلفة بشكل أساسي (التفاح والبرتقال)</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p>عدم التجانس الشديد الذي لا يمكن تفسيره</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p>دراسة واحدة تهيمن على جميع الدراسات الأخرى (مشكلة الدراسة الضخمة)</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p>تحتوي الدراسات على مخاطر عالية للتحيز لا يمكن تعديلها</p>
</div>
<div class="focus-box animate delay-5 mt-2">
<p class="main">التجميع هو امتياز وليس حق.</p>
<p class="sub">ويجب الدفاع عن قرار الدمج.</p>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">التسلسل الهرمي للأدلة</h2>
<div style="max-width: 600px; margin-top: 1.5rem;">
<div class="card animate delay-1" style="background: var(--gold); color: var(--navy);">
<p class="card-text text-center" style="font-weight: 700;">المراجعات المنهجية والتحليلات التلوية للتجارب المعشاة ذات الشواهد</p>
</div>
<div class="card animate delay-2">
<p class="card-text text-center">التجارب المعشاة ذات الشواهد</p>
</div>
<div class="card animate delay-3">
<p class="card-text text-center">دراسات الأتراب</p>
</div>
<div class="card animate delay-4">
<p class="card-text text-center">دراسات الحالات والشواهد</p>
</div>
<div class="card animate delay-5">
<p class="card-text text-center">سلسلة الحالات / رأي الخبراء</p>
</div>
</div>
<p class="footnote animate delay-5">ويعتمد الموقع في التسلسل الهرمي على جودة المنهجية، وليس على نوع الدراسة وحده.</p>
</div>
</div>
<div class="slide dark" data-index="7">
<p class="title cream animate text-center">يتم تدريس هذه الدورة من خلال</p>
<p class="title gold animate delay-1 text-center">عكس الأدلة.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1rem; text-align: center; max-width: 700px;">
                تبدأ كل وحدة بقصة توضح كيف أخطأ الطب في فهم الأمور. ثم نتعلم الطريقة التي كانت ستمنع الضرر.
              </p>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">المبادئ السبعة</h2>
<p class="animate delay-1" style="font-style: italic; margin-bottom: 1.5rem;">
                  ستعود هذه العبارات طوال رحلتك:
                </p>
<div style="text-align: right; max-width: 700px;">
<p class="animate delay-1" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">1.</span> "ليست كل إشارة هي الحقيقة."</p>
<p class="animate delay-2" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">2.</span> "أساليب تحمي المرضى من ثقتنا."</p>
<p class="animate delay-3" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">3.</span> "ما الذي كان مخفيا على مرأى من الجميع؟"</p>
<p class="animate delay-3" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">4.</span> "الرقم بدون مصدر ليس رقمًا."</p>
<p class="animate delay-4" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">5.</span> "التباين هو رسالة، وليس ضجيجا."</p>
<p class="animate delay-4" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">6.</span> "غياب الدليل ليس دليلاً على الغياب"</p>
<p class="animate delay-5" style="margin: 0.75rem 0; font-size: 1.1rem;"><span style="color: var(--gold);">7.</span> "اليقين يجب أن يُكتسب، لا أن يُفترض."</p>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">الوحدة 0 اختبار</h2>
<div class="quiz-container">
<div class="quiz-question" id="q0-1">
<h4>1. لماذا لا ينبغي عليك في بعض الأحيان تجميع الدراسات في التحليل التلوي؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q0-1', 0, 1, ['More is generally better but not always.', 'Correct! Extreme heterogeneity or comparing apples to oranges makes pooling misleading.', 'Pooling is always appropriate for clinical trials.', 'Statistical methods are powerful.'])">
<span>A.</span> التجميع دائمًا أفضل من الدراسات الفردية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-1', 1, 1, ['More is generally better but not always.', 'Correct! Extreme heterogeneity or comparing apples to oranges makes pooling misleading.', 'Pooling is always appropriate for clinical trials.', 'Statistical methods are powerful.'])">
<span>B.</span> عندما يكون عدم التجانس متطرفًا أو عندما تقيس الدراسات أشياء مختلفة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-1', 2, 1, ['More is generally better but not always.', 'Correct! Extreme heterogeneity or comparing apples to oranges makes pooling misleading.', 'Pooling is always appropriate for clinical trials.', 'Statistical methods are powerful.'])">
<span>C.</span> التجميع مناسب دائمًا للتجارب المعشاة ذات الشواهد
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-1', 3, 1, ['More is generally better but not always.', 'Correct! Extreme heterogeneity or comparing apples to oranges makes pooling misleading.', 'Pooling is always appropriate for clinical trials.', 'Statistical methods are powerful.'])">
<span>D.</span> الأساليب الإحصائية تتعامل مع أي موقف
                      </div>
</div>
<div id="q0-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q0-2" style="margin-top: 1.5rem;">
<h4>2. أين تقع المراجعات المنهجية للتجارب المعشاة ذات الشواهد في التسلسل الهرمي للأدلة؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q0-2', 0, 0, ['Correct! Well-conducted SRs/MAs of RCTs are at the top of the evidence hierarchy.', 'RCTs are second to their systematic reviews.', 'Cohort studies are observational.', 'Expert opinion is at the bottom.'])">
<span>A.</span> في الأعلى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-2', 1, 0, ['Correct! Well-conducted SRs/MAs of RCTs are at the top of the evidence hierarchy.', 'RCTs are second to their systematic reviews.', 'Cohort studies are observational.', 'Expert opinion is at the bottom.'])">
<span>B.</span> نفس مستوى المضبوطة الفردية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-2', 2, 0, ['Correct! Well-conducted SRs/MAs of RCTs are at the top of the evidence hierarchy.', 'RCTs are second to their systematic reviews.', 'Cohort studies are observational.', 'Expert opinion is at the bottom.'])">
<span>C.</span> أدناه دراسات الأتراب
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q0-2', 3, 0, ['Correct! Well-conducted SRs/MAs of RCTs are at the top of the evidence hierarchy.', 'RCTs are second to their systematic reviews.', 'Cohort studies are observational.', 'Expert opinion is at the bottom.'])">
<span>D.</span> نفس رأي الخبراء
                      </div>
</div>
<div id="q0-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="10">
<p class="refrain animate">ابدأ الرحلة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 1: السؤال</p>
</div>
 التنقل بين الشرائح الذي تم إنشاؤه بواسطة JS 
</div>
 الوحدة 1: السؤال (CAST) 
<div class="module-slides" data-module="1">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه ليست قصة عن الخطأ.</p>
<p class="title gold animate delay-1 text-center">إنها قصة عن اليقين.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 1: السؤال</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>قم بصياغة سؤال PICO مركّز لإجراء مراجعة منهجية</li>
<li>التمييز بين النتائج البديلة والنتائج المهمة للمريض</li>
<li>اشرح لماذا لا تعتبر المعقولية البيولوجية وحدها دليلا كافيا</li>
<li>وصف تجربة CAST وآثارها على الطب المبني على الأدلة</li>
<li>تطبيق قاعدة: "ليس كل إشارة مضيئة هدى"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">~9,000</p>
<p class="subtitle animate delay-1">الوفيات الزائدة سنويا</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">من العلاج الذي يعتقد الجميع أنه نجح.</p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">هذه هي قصة كيف آمنا، وكيف كنا مخطئين.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الملاحظة</h2>
<div class="card animate delay-1">
<p class="card-text text-center">كان المرضى الذين يعانون من الـ PVC المتكرر بعد احتشاء عضلة القلب لديهم معدل وفيات أعلى بمقدار 2-5 مرات.</p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">400,000+</div>
<div class="stat-label">الناجون من احتشاء عضلة القلب/السنة</div>
</div>
<div class="stat-box">
<div class="stat-value">~40%</div>
<div class="stat-label">مع PVC كبيرة</div>
</div>
<div class="stat-box">
<div class="stat-value">160,000</div>
<div class="stat-label">معرضون لخطر مرتفع</div>
</div>
</div>
<p class="footnote animate delay-3">حاجة سريرية هائلة. هدف واضح.</p>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">الاستجابة</h2>
<p class="animate delay-1" style="font-size: 1.2rem; text-align: center; margin: 1rem 0;">
                  تم تطوير أدوية مضادة لاضطراب النظم، ووافقت عليها إدارة الغذاء والدواء،<br/>ووصفت لحوالي 200000 مريض سنويًا.
                </p>
<div class="focus-box animate delay-2">
<p class="main">لا يظهر أي شرير في هذه القصة.</p>
<p class="sub">تصرف الجميع بناءً على أفضل الأدلة المتاحة.</p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">المنطق الذي أقنع الجميع</h2>
<div class="card animate delay-1">
<div class="card-label">الفرضية 1</div>
<p class="card-text">تتنبأ مضادات اضطراب النظم القلبي بعد احتشاء عضلة القلب بالموت القلبي المفاجئ</p>
</div>
<div class="arrow animate delay-1">↓</div>
<div class="card animate delay-2">
<div class="card-label">الفرضية 2</div>
<p class="card-text">الأدوية المضادة لاضطراب نظم القلب تقمع الـ PVCs</p>
</div>
<div class="arrow animate delay-2">↓</div>
<div class="card animate delay-3">
<div class="card-label">الفرضية 3</div>
<p class="card-text">قمع الـ PVCs يجب أن يمنع الموت المفاجئ</p>
</div>
<div class="arrow animate delay-3">↓</div>
<div class="card navy-bg animate delay-4">
<div class="card-label">خاتمة</div>
<p class="card-text">مضادات اضطراب النظم تنقذ حياة مرضى ما بعد احتشاء عضلة القلب</p>
</div>
<p class="footnote animate delay-5">كانت السلسلة منطقية. شعرت أن الاستنتاج لا مفر منه.</p>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">تجربة قمع اضطراب نظم القلب</h2>
<p class="serif animate delay-1" style="font-style: italic; color: var(--gold); margin-bottom: 1.5rem;">
                  أخيرًا، سأل أحدهم: "هل قمع الـ PVCs ينقذ الأرواح بالفعل؟"
                </p>
<div class="design-grid animate delay-2">
<div class="design-item">
<div class="design-item-label">التصميم</div>
<div class="design-item-value">عشوائية، مزدوجة التعمية، ومضبوطة بالعلاج الوهمي</div>
</div>
<div class="design-item">
<div class="design-item-label">سكان</div>
<div class="design-item-value">مرضى ما بعد MI الذين يعانون من PVC بدون أعراض</div>
</div>
<div class="design-item">
<div class="design-item-label">تدخل</div>
<div class="design-item-value">إنكاينيد، فليكاينيد، أو موريسيزين مقابل الدواء الوهمي</div>
</div>
<div class="design-item">
<div class="design-item-label">تشغيل</div>
<div class="design-item-value">فقط المرضى الذين يعانون من تثبيط PVC بنسبة ≥80% بشكل عشوائي</div>
</div>
<div class="design-item">
<div class="design-item-label">نقطة النهاية الأولية</div>
<div class="design-item-value">الوفاة أو السكتة القلبية مع الإنعاش</div>
</div>
<div class="design-item">
<div class="design-item-label">حجم العينة</div>
<div class="design-item-value">1,498 مريضًا (أذرع إنكايينيد/فليكاينيد)</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">النتائج: أبريل 1989</h2>
<p class="red animate delay-1" style="font-style: italic; margin-bottom: 1rem;">
                  يقوم مجلس مراقبة سلامة البيانات بإيقاف التجربة مبكرًا.
                </p>
<table class="results-table animate delay-2">
<thead>
<tr>
<th>حصيلة</th>
<th>المخدرات (ن = 755)</th>
<th>الدواء الوهمي (ن = 743)</th>
</tr>
</thead>
<tbody>
<tr>
<td>الوفيات الناجمة عن عدم انتظام ضربات القلب</td>
<td class="highlight">33</td>
<td>9</td>
</tr>
<tr>
<td>جميع الوفيات القلبية</td>
<td class="highlight">43</td>
<td>16</td>
</tr>
<tr>
<td>إجمالي الوفيات</td>
<td class="highlight">56</td>
<td>22</td>
</tr>
<tr>
<td><strong>معدل الوفيات</strong></td>
<td class="highlight">7.4%</td>
<td><strong>3.0%</strong></td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3">
<div class="value">الخطر النسبي للوفاة: 2.5</div>
<div class="label">95% CI: 1.6 - 4.5 | p &lt; 0.001</div>
</div>
<p class="footnote animate delay-4">الأدوية التي كبحت عدم انتظام ضربات القلب بشكل مثالي زادت معدل الوفيات بنسبة 150٪.</p>
</div>
</div>
<div class="slide dark" data-index="8">
<div class="content">
<h2 class="title cream animate">التكلفة البشرية</h2>
<p class="animate delay-1" style="margin-bottom: 1rem;">قبل CAST، كان حوالي 200.000 أمريكي يتلقون هذه الأدوية سنويًا.</p>
<p class="big-number gold animate delay-2">~9,000</p>
<p class="animate delay-2" style="font-size: 1.25rem;">الوفيات الزائدة سنويا - وربما أكثر</p>
<div class="animate delay-3" style="background: rgba(45,58,95,0.8); padding: 1rem 2rem; text-align: center; margin: 1rem 0;">
<p style="color: var(--cream);">حرب فيتنام: حوالي 6,000 حالة وفاة في الولايات المتحدة سنويًا. • هذه الأدوية: حوالي 9,000+ حالة وفاة سنويًا</p>
</div>
<p class="serif animate delay-4" style="font-style: italic; color: var(--gold); margin-top: 1.5rem; text-align: center;">
                  لكل رقم اسم لن نعرفه أبدًا.
                </p>
</div>
</div>
<div class="slide black" data-index="9">
<p class="serif animate" style="font-size: clamp(2rem, 5vw, 3rem);">انظر مرة أخرى.</p>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">المنطق – إعادة النظر</h2>
<div class="card animate delay-1">
<div class="card-label">الفرضية 1</div>
<p class="card-text">تتنبأ مضادات اضطراب النظم القلبي بعد احتشاء عضلة القلب بالموت القلبي المفاجئ</p>
</div>
<div class="arrow animate delay-1">↓</div>
<div class="card-wrapper animate delay-2">
<div class="card">
<div class="card-label">الفرضية 2</div>
<p class="card-text">الأدوية المضادة لاضطراب نظم القلب تقمع الـ PVCs</p>
</div>
<div class="leap-badge">← القفزة</div>
</div>
<div class="arrow animate delay-2">↓</div>
<div class="card red-border animate delay-3">
<div class="card-label">الفرضية 3</div>
<p class="card-text">قمع الـ PVCs يجب أن يمنع الموت المفاجئ</p>
</div>
<div class="arrow animate delay-3">↓</div>
<div class="card navy-bg animate delay-4">
<div class="card-label">خاتمة</div>
<p class="card-text">مضادات اضطراب النظم تنقذ حياة مرضى ما بعد احتشاء عضلة القلب</p>
</div>
<p class="footnote animate delay-5">لم يتم اختبار الافتراض القائل بأن قمع العلامة سيؤدي إلى إصلاح النتيجة.</p>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">ما الخطأ الذي حدث: الفخ البديل</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p>كانت الـ PVCs علامة على الأنسجة التالفة، وليست سببًا للوفاة</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p>كان للأدوية تأثيرات على عدم انتظام ضربات القلب، مما أدى إلى إيقاعات أكثر فتكًا</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p>تحسن البديل بينما ساءت النتيجة - بديل منفصل</p>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">لم يكذب البديل. لقد طرحنا عليه السؤال الخطأ.</p>
</div>
</div>
</div>
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">إطار عمل PICO</h2>
<p class="animate delay-1" style="margin-bottom: 1.5rem; font-style: italic;">
                  يحتوي كل سؤال سريري قابل للإجابة على أربعة مكونات:
                </p>
<div class="design-grid" style="grid-template-columns: repeat(2, 1fr);">
<div class="design-item animate delay-1" style="border-left-color: var(--navy);">
<div class="design-item-label" style="color: var(--navy);">ف - السكان</div>
<div class="design-item-value">من هم المرضى؟ ما هي خصائصها؟</div>
</div>
<div class="design-item animate delay-2" style="border-left-color: var(--green);">
<div class="design-item-label" style="color: var(--green);">أنا - التدخل</div>
<div class="design-item-value">ما هو العلاج أو التعرض الذي يتم تقييمه؟</div>
</div>
<div class="design-item animate delay-3" style="border-left-color: var(--red);">
<div class="design-item-label" style="color: var(--red);">ج - المقارنة</div>
<div class="design-item-value">ما هو البديل؟ الدواء الوهمي؟ الرعاية القياسية؟</div>
</div>
<div class="design-item animate delay-4" style="border-left-color: var(--gold);">
<div class="design-item-label" style="color: var(--gold);">O - النتيجة</div>
<div class="design-item-value">ما الذي يهم المرضى؟ نقاط النهاية الصعبة مقابل البدائل.</div>
</div>
</div>
<div class="result-box animate delay-5" style="margin-top: 1.5rem;">
<div class="label">كاست بيكو</div>
<div class="value" style="font-size: 1rem; line-height: 1.5;">
                    مرضى ما بعد MI الذين يعانون من PVC | مضادات اضطراب النظم | الدواء الوهمي | الوفيات
                  </div>
</div>
</div>
</div>
 تمرين التحقيق CAST 
<div class="slide dark" data-index="13">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>تمرين التحقيق: الدليل قبل CAST</h3>
</div>
<p class="direct-address">أنت طبيب قلب في عام 1988. نجا مريض من احتشاء عضلة القلب ولكنه يعاني من انقباضات قلبية متكررة. الأدب الرصدي واضح...</p>
<table class="data-table-investigation">
<thead>
<tr><th>دراسة</th><th>المرضى الذين يعانون من PVC</th><th>خطر الوفيات</th></tr>
</thead>
<tbody>
<tr><td>لون (1977)</td><td>مواد PVC عالية الجودة</td><td>أعلى بمقدار 2.4 مرة</td></tr>
<tr><td>أكبر (1984)</td><td>&gt; 10 PVC/ساعة</td><td>أعلى بمقدار 3.1 مرة</td></tr>
<tr><td>مخرجي (1984)</td><td>PVC المعقدة</td><td>أعلى بمقدار 4.8 مرة</td></tr>
</tbody>
</table>
<p class="rhetorical" style="margin-top: 1rem;">الإشارة واضحة. الآلية معقولة. هل تصف مضادات اضطراب النظم؟</p>
<button class="reveal-btn" onclick="revealAnswer('cast-reveal')">انظر ما كشفه CAST →</button>
<div class="hidden-reveal" id="cast-reveal">
<div class="comparison-grid">
<div class="comparison-panel">
<h4>قبل: المنطق الرصدي</h4>
<p>PVCs → ارتفاع معدل الوفيات</p>
<p>المخدرات قمع PVC</p>
<p><strong>∴ الأدوية يجب أن تقلل من معدل الوفيات</strong></p>
</div>
<div class="comparison-panel after">
<h4>بعد: CAST RCT (1989)</h4>
<p>معدل الوفيات بسبب المخدرات: <strong style="color: var(--red);">7.4%</strong></p>
<p>معدل الوفيات عند العلاج الوهمي: <strong>3.0%</strong></p>
<p><strong style="color: var(--red);">RR = 2.5 (زيادة بنسبة 150% في الوفيات)</strong></p>
</div>
</div>
<p style="margin-top: 1rem; font-style: italic; color: var(--gold);">تحسن البديل. مات المرضى. ولهذا السبب نسأل: "ما هي النتيجة المهمة؟"</p>
</div>
</div>
</div>
<div class="slide light" data-index="14">
<div class="content">
<h2 class="title navy animate">دروس تركيب الأدلة</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>المعقولية البيولوجية ليست دليلاً</h4>
<p>الآلية المنطقية لا تضمن التأثير المتوقع.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>نقاط النهاية البديلة يمكن أن تكون مضللة</h4>
<p>إن تحسين العلامة الحيوية لا يثبت تحسنًا في النتائج.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>توفر التجارب العشوائية أقوى الأدلة السببية</h4>
<p>بيانات المراقبة وحدها نادرًا ما يحدد السببية للتدخلات بسبب الخلط.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>الإجماع ليس دليلاً</h4>
<p>200000 وصفة طبية، وموافقة إدارة الغذاء والدواء الأمريكية، والمبادئ التوجيهية كانت كلها خاطئة.</p>
</div>
</div>
<p class="serif animate delay-5" style="font-style: italic; color: var(--gold); margin-top: 1.5rem; text-align: center;">
                  ولهذا السبب نقوم بالتحليل التلوي: لرؤية الحقائق الظاهرة الماضية.
                </p>
</div>
</div>
 القصة: بديل DES-II مأساة 
<div class="slide dark" data-index="14b">
<div class="story-box animate">
<p class="story-opener">ماذا لو كان السؤال الذي تطرحه يحدد من يعيش ومن يموت؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    في عام 1989، عرف أطباء القلب أن <span class="data-highlight">يمكن تحقيق قمع PVC</span> باستخدام الإنكايينيد والفليكاينيد. بدت نقطة النهاية البديلة مثالية: قامت الأدوية بقمع PVCs عن طريق <span class="data-highlight">80%+</span>. لكن CAST عشوائية <span class="data-highlight">1,498 مريض</span> للعقار النشط مقابل الدواء الوهمي. تم إيقاف التجربة مبكرًا: <span class="data-highlight">56 حالة وفاة في مجموعة الدواء مقابل 22 في العلاج الوهمي</span>. زادت الوفيات <span class="data-highlight">2.5 ضعف</span>. ما يقدر <span class="data-highlight">~ 9000 حالة وفاة أمريكية زائدة سنويًا</span> كانت تُعزى إلى هذه الأدوية.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">اختيار طبيب القلب: 1987</div>
<div class="decision-scenario">
                    يعاني مريض ما بعد احتشاء عضلة القلب من انقباضات متكررة في القلب. لديك أدوية تقمعها تمامًا. ماذا تفعل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: علاج البديل</div>
<div class="path-choice">وصف الإنكاينيد — تختفي PVC، ويبدو مخطط كهربية القلب نظيفًا</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تحسن المرقم الحيوي. تشعر بالثقة. يموت المريض.</div>
<div class="path-outcome">النتيجة: ما يقدر بنحو 50.000+ حالة وفاة زائدة في جميع أنحاء الولايات المتحدة خلال سنوات الاستخدام</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: المطالبة بمحاكمة الوفيات</div>
<div class="path-choice">الإصرار: "أرني أن البقاء على قيد الحياة يتحسن، وليس فقط تخطيط القلب"</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">التجربة تكشف الضرر. يتم سحب الأدوية. يتم إنقاذ الأرواح.</div>
<div class="path-outcome">النتيجة: سؤال PICO الصحيح يمنع وقوع كارثة</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    لم يكن السؤال أبدًا "هل يمكننا قمع PVCs؟" كان السؤال "هل ينقذ قمع PVC الأرواح؟" نقطة النهاية البديلة أجابت على السؤال الخطأ. كان PICO الصحيح سيطالب بالوفاة كنتيجة منذ البداية.
                  </div>
</div>
</div>
</div>
<div class="slide dark" data-index="14">
<p class="closing-line animate">ما يبدو مؤكدًا قد يكون خاطئًا.</p>
<p class="closing-line animate delay-1">ما يعتقده الجميع قد يكون كاذبا.</p>
<p class="closing-line gold animate delay-2">توجد طرق حتى لا يدفع المرضى ثمن ثقتنا.</p>
<div class="gold-line animate delay-3"></div>
<p class="closing-line italic animate delay-4">ولهذا السبب أنت هنا.</p>
</div>
 اختبار الوحدة 1 
<div class="slide light" data-index="16">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 1</h2>
<div class="quiz-container">
<div class="quiz-question" id="q1-1">
<h4>1. ما هو الخطأ الأساسي في منطق عدم انتظام ضربات القلب؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q1-1', 0, 1, ['The trials were conducted properly.', 'Correct! They assumed suppressing the marker (PVCs) would improve the outcome (mortality), but PVCs were just a marker, not a cause.', 'The sample size was large enough.', 'FDA approval followed proper procedures.'])">
<span>A.</span> لم تكن التجارب عشوائية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-1', 1, 1, ['The trials were conducted properly.', 'Correct! They assumed suppressing the marker (PVCs) would improve the outcome (mortality), but PVCs were just a marker, not a cause.', 'The sample size was large enough.', 'FDA approval followed proper procedures.'])">
<span>B.</span> كان من المفترض أن يؤدي علاج البديل (PVCs) إلى تحسين النتائج
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-1', 2, 1, ['The trials were conducted properly.', 'Correct! They assumed suppressing the marker (PVCs) would improve the outcome (mortality), but PVCs were just a marker, not a cause.', 'The sample size was large enough.', 'FDA approval followed proper procedures.'])">
<span>C.</span> كان حجم العينة صغيرًا جدًا
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-1', 3, 1, ['The trials were conducted properly.', 'Correct! They assumed suppressing the marker (PVCs) would improve the outcome (mortality), but PVCs were just a marker, not a cause.', 'The sample size was large enough.', 'FDA approval followed proper procedures.'])">
<span>D.</span> تم التعجيل بموافقة إدارة الغذاء والدواء
                      </div>
</div>
<div id="q1-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q1-2">
<h4>2. في PICO، ما الذي يرمز إليه الحرف "O" ولماذا يهم؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q1-2', 0, 2, ['O stands for Outcome, not Observation.', 'O stands for Outcome, not Objective.', 'Correct! The choice of outcome determines whether a treatment truly helps patients. CAST measured mortality (hard outcome) instead of just PVC suppression (surrogate).', 'O stands for Outcome, not Organization.'])">
<span>A.</span> الملاحظة - ما يراه الباحثون
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-2', 1, 2, ['O stands for Outcome, not Observation.', 'O stands for Outcome, not Objective.', 'Correct! The choice of outcome determines whether a treatment truly helps patients. CAST measured mortality (hard outcome) instead of just PVC suppression (surrogate).', 'O stands for Outcome, not Organization.'])">
<span>B.</span> الهدف - هدف البحث
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-2', 2, 2, ['O stands for Outcome, not Observation.', 'O stands for Outcome, not Objective.', 'Correct! The choice of outcome determines whether a treatment truly helps patients. CAST measured mortality (hard outcome) instead of just PVC suppression (surrogate).', 'O stands for Outcome, not Organization.'])">
<span>C.</span> النتيجة - ما يهم المرضى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q1-2', 3, 2, ['O stands for Outcome, not Observation.', 'O stands for Outcome, not Objective.', 'Correct! The choice of outcome determines whether a treatment truly helps patients. CAST measured mortality (hard outcome) instead of just PVC suppression (surrogate).', 'O stands for Outcome, not Organization.'])">
<span>D.</span> التنظيم - هيكل الدراسة
                      </div>
</div>
<div id="q1-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="17">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">
                الأساليب تحمي المرضى من ثقتنا.
              </p>
</div>
</div>
 الوحدة الثانية: البروتوكول (HRT) 
<div class="module-slides" data-module="2">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ما الذي كان مخفيا على مرأى من الجميع؟</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه قصة عن</p>
<p class="title gold animate delay-1 text-center">الأدلة الرصدية.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة الثانية: البروتوكول</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح لماذا يمنع التسجيل المسبق للبروتوكول التحيز</li>
<li>تحديد العناصر الأساسية لتسجيل PROSPERO</li>
<li>تمييز تحيز المستخدم الصحي عن تأثيرات العلاج الحقيقية</li>
<li>وصف لماذا بالغت الدراسات الرصدية في تقدير فوائد العلاج التعويضي بالهرمونات</li>
<li>تطبيق المبدأ: "الطرق تحمي المرضى من ثقتنا الثقة"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">30+</p>
<p class="subtitle animate delay-1">الدراسات الرصدية</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">
                جميعها تظهر أن العلاج بالهرمونات البديلة يحمي النساء بعد انقطاع الطمث من أمراض القلب.
              </p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">بدت الأدلة دامغة. بدا الاستنتاج مؤكدًا.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">دراسة صحة الممرضات</h2>
<div class="card animate delay-1">
<p class="card-text text-center">تمت متابعة 122,000 ممرضة لعقود من الزمن. كان لدى مستخدمي العلاج التعويضي بالهرمونات انخفاض في معدل الوفيات القلبية الوعائية بنسبة 40-50٪.</p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">RR 0.56</div>
<div class="stat-label">وفيات القلب والأوعية الدموية</div>
</div>
<div class="stat-box">
<div class="stat-value">122,000</div>
<div class="stat-label">تمت متابعة النساء</div>
</div>
<div class="stat-box">
<div class="stat-value">20+ سنة</div>
<div class="stat-label">المتابعة</div>
</div>
</div>
<p class="footnote animate delay-3">دراسة تاريخية. منهجية لا تشوبها شائبة. استنتاج خاطئ.</p>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">التحيز الخفي</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>انحياز المستخدم الصحي:</strong> النساء اللاتي اخترن العلاج التعويضي بالهرمونات كن أكثر صحة وأكثر ثراء وتعليمًا</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>انحياز الامتثال:</strong> النساء اللاتي تناولن العلاج التعويضي بالهرمونات باستمرار اعتنين بأنفسهن بشكل أفضل أيضًا</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>انحياز واصف الوصف:</strong> أعطى الأطباء العلاج التعويضي بالهرمونات لنساء أكثر صحة مع عوامل خطر أقل</p>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">لم يكن العلاج يحميهن. لقد كانوا محميين بالفعل.</p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">WHI: النساء مبادرة الصحة</h2>
<p class="serif animate delay-1" style="font-style: italic; color: var(--gold); margin-bottom: 1.5rem;">
                  أكبر تجربة عشوائية أجريت على العلاج التعويضي بالهرمونات على الإطلاق.
                </p>
<div class="design-grid animate delay-2">
<div class="design-item">
<div class="design-item-label">التصميم</div>
<div class="design-item-value">عشوائية، مزدوجة التعمية، ومضبوطة بالعلاج الوهمي</div>
</div>
<div class="design-item">
<div class="design-item-label">سكان</div>
<div class="design-item-value">النساء بعد انقطاع الطمث الذين تتراوح أعمارهم بين 50-79</div>
</div>
<div class="design-item">
<div class="design-item-label">تدخل</div>
<div class="design-item-value">هرمون الاستروجين + البروجستين مقابل الدواء الوهمي</div>
</div>
<div class="design-item">
<div class="design-item-label">حجم العينة</div>
<div class="design-item-value">16,608 امرأة</div>
</div>
<div class="design-item">
<div class="design-item-label">نقطة النهاية الأولية</div>
<div class="design-item-value">مرض القلب التاجي</div>
</div>
<div class="design-item">
<div class="design-item-label">المدة المخططة</div>
<div class="design-item-value">8.5 سنة</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">النتائج: يوليو 2002</h2>
<p class="red animate delay-1" style="font-style: italic; margin-bottom: 1rem;">
                  توقفت التجربة مبكرًا بعد 5.2 سنة. الضرر أكثر من المنافع.
                </p>
<table class="results-table animate delay-2">
<thead>
<tr>
<th>حصيلة</th>
<th>نسبة الخطر</th>
<th>الاتجاه</th>
</tr>
</thead>
<tbody>
<tr>
<td>مرض القلب التاجي</td>
<td class="highlight">1.29</td>
<td class="highlight">HARM</td>
</tr>
<tr>
<td>السكتة الدماغية</td>
<td class="highlight">1.41</td>
<td class="highlight">HARM</td>
</tr>
<tr>
<td>سرطان الثدي</td>
<td class="highlight">1.26</td>
<td class="highlight">HARM</td>
</tr>
<tr>
<td>الانسداد الرئوي</td>
<td class="highlight">2.13</td>
<td class="highlight">HARM</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3">
<div class="value">الانعكاس الكامل</div>
<div class="label">30 عامًا من الأدلة الرصدية انقلبت</div>
</div>
</div>
</div>
<div class="slide dark" data-index="7">
<p class="title cream animate">الدرس</p>
<p class="big-number gold animate delay-1" style="font-size: clamp(2rem, 8vw, 5rem);">التحديد المسبق</p>
<p class="animate delay-2" style="font-size: 1.1rem; text-align: center; max-width: 600px; margin-top: 1rem;">
                بروتوكول مكتوب قبل بدء البحث يمنع الصيد ويمنع التحيز ويمنع تشويه الإدراك المتأخر.
              </p>
</div>
 القصة: فرضية توقيت الهرمونات 
<div class="slide dark" data-index="7b">
<div class="story-box animate">
<p class="story-opener">ماذا لو نجح العلاج - ولكن فقط بعض؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    الذي أظهر أن العلاج التعويضي بالهرمونات <span class="data-highlight">يزيد من أحداث القلب والأوعية الدموية بشكل عام</span>. لكن التحليلات اللاحقة كشفت عن نمط حرج: النساء اللاتي بدأن العلاج التعويضي بالهرمونات
                    <span class="data-highlight">خلال 10 سنوات من انقطاع الطمث</span> had
                    <span class="data-highlight">قللن من خطر الإصابة بأمراض القلب والأوعية الدموية</span>. النساء اللاتي يبدأن <span class="data-highlight">بعد مرور 20 عامًا على انقطاع الطمث</span> had
                    <span class="data-highlight">زيادة المخاطر</span>. النتيجة الإجمالية الخالية/الضرر أخفت تأثير التوقيت.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">معضلة المحلل</div>
<div class="decision-scenario">
                    أنت تقوم بتحليل مجموعات WHI الفرعية. النتيجة الإجمالية تظهر الضرر. هل تبحث بشكل أعمق؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: التقرير بشكل عام فقط</div>
<div class="path-choice">استنتج أن العلاج التعويضي بالهرمونات ضار لجميع النساء بعد انقطاع الطمث</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">رسالة بسيطة. توصي الإرشادات بعدم استخدام العلاج التعويضي بالهرمونات بشكل عام.</div>
<div class="path-outcome">النتيجة: رفض الفوائد المحتملة للنساء الأصغر سنًا بعد انقطاع الطمث</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: مجموعات فرعية محددة مسبقًا للتوقيت</div>
<div class="path-choice">التحليل حسب السنوات منذ انقطاع الطمث (معقول بيولوجيًا)</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">اكتشف "نافذة التوقيت" لبدء العلاج التعويضي بالهرمونات بشكل آمن.</div>
<div class="path-outcome">النتيجة: تمكين التوصيات الشخصية</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    يعد تحليل المجموعة الفرعية خطيرًا عند الصيد. إنه ضروري عندما يتنبأ علم الأحياء بتعديل التأثير. كانت فرضية التوقيت معقولة من الناحية البيولوجية، وكان ينبغي تحديدها مسبقًا.
                  </div>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">تسجيل PROSPERO</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>سجل قبل البحث</h4>
<p>PROSPERO: دولي السجل المحتمل للمراجعات المنهجية</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>اقفل قراراتك</h4>
<p>PICO، استراتيجية البحث، النتائج، خطة التحليل - جميعها محددة مسبقًا</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>تعديلات الوثيقة</h4>
<p>مسموح بالتغييرات ولكن يجب أن تكون شفافة ومبررة</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>منع الازدواجية</h4>
<p>تحقق مما إذا كانت مراجعتك موجودة بالفعل من قبل البدء</p>
</div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 2</h2>
<div class="quiz-container">
<div class="quiz-question" id="q2-1">
<h4>1. لماذا أظهرت دراسة صحة الممرضات فائدة من العلاج التعويضي بالهرمونات لم تفعله WHI؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q2-1', 0, 1, ['Sample size was adequate in both.', 'Correct! Women who chose HRT were already healthier—confounding by indication.', 'Follow-up duration was similar.', 'The hormone formulations were the same.'])">
<span>A.</span> كان لدى صحة الممرضات عدد قليل جدًا من المرضى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-1', 1, 1, ['Sample size was adequate in both.', 'Correct! Women who chose HRT were already healthier—confounding by indication.', 'Follow-up duration was similar.', 'The hormone formulations were the same.'])">
<span>B.</span> تحيز المستخدم الصحي في الدراسات الرصدية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-1', 2, 1, ['Sample size was adequate in both.', 'Correct! Women who chose HRT were already healthier—confounding by indication.', 'Follow-up duration was similar.', 'The hormone formulations were the same.'])">
<span>C.</span> كانت صحة الممرضات ذات متابعة أقصر
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-1', 3, 1, ['Sample size was adequate in both.', 'Correct! Women who chose HRT were already healthier—confounding by indication.', 'Follow-up duration was similar.', 'The hormone formulations were the same.'])">
<span>D.</span> تم استخدام تركيبات هرمونية مختلفة
                      </div>
</div>
<div id="q2-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q2-2" style="margin-top: 1.5rem;">
<h4>2. ما هو الغرض الأساسي من تسجيل PROSPERO؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q2-2', 0, 2, ['PROSPERO is for reviews, not trials.', 'Faster completion is not the goal.', 'Correct! Pre-specifying methods prevents post-hoc changes that bias results.', 'Funding is separate from registration.'])">
<span>A.</span> لتسجيل التجارب السريرية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-2', 1, 2, ['PROSPERO is for reviews, not trials.', 'Faster completion is not the goal.', 'Correct! Pre-specifying methods prevents post-hoc changes that bias results.', 'Funding is separate from registration.'])">
<span>B.</span> لتسريع استكمال المراجعة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-2', 2, 2, ['PROSPERO is for reviews, not trials.', 'Faster completion is not the goal.', 'Correct! Pre-specifying methods prevents post-hoc changes that bias results.', 'Funding is separate from registration.'])">
<span>C.</span> للتحديد المسبق للطرق ومنع التحيز
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q2-2', 3, 2, ['PROSPERO is for reviews, not trials.', 'Faster completion is not the goal.', 'Correct! Pre-specifying methods prevents post-hoc changes that bias results.', 'Funding is separate from registration.'])">
<span>D.</span> للحصول على تمويل للمراجعات
                      </div>
</div>
<div id="q2-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="10">
<p class="closing-line animate">المواصفات المسبقة ليست كذلك البيروقراطية.</p>
<p class="closing-line animate delay-1">إنها حماية.</p>
<p class="closing-line gold animate delay-2">ضد ميلنا للعثور على ما نتوقعه.</p>
<div class="gold-line animate delay-3"></div>
<p class="closing-line italic animate delay-4">الأساليب تحمي المرضى من ثقتنا.</p>
</div>
<div class="slide black" data-index="11">
<p class="refrain animate">ما الذي كان مخفيا على مرأى من الجميع؟</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 3: البحث</p>
</div>
</div>
 الوحدة 3: البحث (روزيجليتازون) 
<div class="module-slides" data-module="3">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ما الذي كان مخفيا على مرأى من الجميع؟</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه قصة عن</p>
<p class="title gold animate delay-1 text-center">ما لم ينشروه.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 3: البحث</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>قم بتطوير استراتيجية بحث شاملة باستخدام إرشادات PRESS</li>
<li>ابحث في قواعد بيانات متعددة بما في ذلك مصادر الأدبيات الرمادية</li>
<li>تحديد سجلات التجارب وقواعد البيانات التنظيمية (ClinicalTrials.gov، FDA)</li>
<li>اشرح كيف كشفت قضية الروزيجليتازون عن أضرار خفية في القلب والأوعية الدموية</li>
<li>تطبيق المبدأ: "ما الذي كان مخفيًا على مرأى من الجميع؟"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">$3.2B</p>
<p class="subtitle animate delay-1">المبيعات السنوية في الذروة</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">كان أفانديا (روزيجليتازون) واحدًا من أدوية مرض السكري الأكثر مبيعًا في العالم.</p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">تبدو التجارب المنشورة مطمئنة. أما الكتب غير المنشورة فقد روت قصة مختلفة.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الأدلة المنشورة (ما قبل 2007)</h2>
<div class="card animate delay-1">
<p class="card-text text-center">وأظهرت التجارب المنشورة أن روزيجليتازون خفض بشكل فعال نسبة HbA1c. نادرا ما تم الإبلاغ عن نتائج القلب والأوعية الدموية.</p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">1999</div>
<div class="stat-label">موافقة ادارة الاغذية والعقاقير</div>
</div>
<div class="stat-box">
<div class="stat-value">6M+</div>
<div class="stat-label">المرضى الذين تم علاجهم</div>
</div>
<div class="stat-box">
<div class="stat-value">~0.7%</div>
<div class="stat-label">تخفيض HbA1c</div>
</div>
</div>
<p class="footnote animate delay-3">بدا البديل جيدًا. ولكن ماذا عن الأحداث القلبية الوعائية الفعلية؟</p>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">اكتشاف نيسن: مايو 2007</h2>
<p class="serif animate delay-1" style="font-style: italic; color: var(--gold); margin-bottom: 1rem;">د. حصل ستيفن نيسن على بيانات التجارب غير المنشورة من موقع الويب الخاص بشركة GSK.</p>
<div class="card animate delay-2">
<p class="card-text text-center">لقد طُلب من GSK، بموجب تسوية قانونية، نشر نتائج التجارب السريرية عبر الإنترنت. قام نيسن وولسكي بتحليل 42 تجربة - لم يتم نشر العديد منها مطلقًا في المجلات.</p>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">كانت البيانات علنية من الناحية الفنية.</p>
<p class="sub">لم يقم أحد بالبحث عنه بشكل منهجي.</p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">نتائج التحليل التلوي</h2>
<table class="results-table animate delay-1">
<thead>
<tr>
<th>حصيلة</th>
<th>نسبة الاحتمالات</th>
<th>95% CI</th>
</tr>
</thead>
<tbody>
<tr>
<td>احتشاء عضلة القلب</td>
<td class="highlight">1.43</td>
<td class="highlight">1.03 - 1.98</td>
</tr>
<tr>
<td>وفاة السيرة الذاتية</td>
<td>1.64</td>
<td>0.98 - 2.74</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-2">
<div class="value">43% زيادة في خطر الإصابة بالنوبات القلبية</div>
<div class="label">p = 0.03 لاحتشاء عضلة القلب</div>
</div>
<p class="footnote animate delay-3">نشرت في NEJM. دعت إدارة الغذاء والدواء الأمريكية إلى اجتماع للجنة الاستشارية الطارئة.</p>
</div>
</div>
<div class="slide dark" data-index="6">
<div class="content">
<h2 class="title cream animate">اللجنة الاستشارية لإدارة الغذاء والدواء: يوليو 2007</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box">
<div class="stat-value">22-1</div>
<div class="stat-label">التصويت: خطر السيرة الذاتية موجود</div>
</div>
<div class="stat-box">
<div class="stat-value">20-3</div>
<div class="stat-label">استمر السوق مع التحذيرات</div>
</div>
</div>
<p class="animate delay-2" style="margin-top: 1.5rem; text-align: center;">تم تقسيم اللجنة. ومنهم من أراد سحبها. ووصف البعض التحليل التلوي بأنه معيب.</p>
<p class="animate delay-3" style="margin-top: 1rem; font-size: 1.1rem; text-align: center; color: var(--gold);">لكن لا يمكن إخفاء الإشارة.</p>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">العواقب</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>تحذير الصندوق الأسود</strong> تمت إضافته لمخاطر قصور القلب (2007)</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>قيود شديدة</strong> بشأن وصف الأدوية في الولايات المتحدة (2010)</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>منشور</strong> من السوق الأوروبية بالكامل (2010)</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p><strong>تتطلب إدارة الغذاء والدواء الآن</strong> تجارب نتائج القلب والأوعية الدموية لجميع أدوية مرض السكري</p>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">ما يتطلبه البحث الشامل</h2>
<div class="design-grid animate delay-1">
<div class="design-item">
<div class="design-item-label">منشور</div>
<div class="design-item-value">PubMed, Embase, CENTRAL, Web of Science</div>
</div>
<div class="design-item">
<div class="design-item-label">الأدب الرمادي</div>
<div class="design-item-value">ملخصات المؤتمرات، والرسائل العلمية، والمستندات التنظيمية</div>
</div>
<div class="design-item">
<div class="design-item-label">سجلات التجارب</div>
<div class="design-item-value">ClinicalTrials.gov, WHO ICTRP، EU CTR</div>
</div>
<div class="design-item">
<div class="design-item-label">التنظيمية</div>
<div class="design-item-value">التقديمات المقدمة من إدارة الغذاء والدواء الأمريكية (FDA)، وEMA، ووزارة الصحة الكندية</div>
</div>
<div class="design-item">
<div class="design-item-label">بيانات الشركة</div>
<div class="design-item-value">سجلات التجارب السريرية GSK، وPfizer، وRoche</div>
</div>
<div class="design-item">
<div class="design-item-label">البحث اليدوي</div>
<div class="design-item-value">قوائم المراجع، ومؤلفو الاتصال، والخبراء</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">قائمة التحقق من الصحافة</h2>
<p class="animate delay-1" style="font-style: italic; margin-bottom: 1rem;">مراجعة النظراء لاستراتيجيات البحث الإلكتروني</p>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>ترجمة سؤال البحث</h4>
<p>هل يعكس البحث PICO العناصر؟</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>عوامل التشغيل المنطقية والتقريبية</h4>
<p>هل لا يتم استخدام AND أو OR بشكل صحيح؟</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>عناوين الموضوع</h4>
<p>هل مصطلحات MeSH/Emtree مناسبة ومفصلة؟</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>الكلمات النصية</h4>
<p>المرادفات، المتغيرات الإملائية، الاقتطاع؟</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">قائمة PRESS المرجعية (تابع)</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">5</div>
<div class="lesson-content">
<h4>التهجئة وبناء الجملة وأرقام الأسطر</h4>
<p>هل هناك أخطاء قد تؤدي إلى استرجاعها</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">6</div>
<div class="lesson-content">
<h4>الحدود والمرشحات</h4>
<p>هل حدود التاريخ واللغة وتصميم الدراسة مناسبة؟</p>
</div>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">تعمل عمليات البحث التي يراجعها النظراء على تحسين استرجاع الدراسات الرئيسية بشكل كبير.</p>
<p class="sub">المبادئ التوجيهية الصحفية: McGowan et al., 2016</p>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">ترجمة قاعدة البيانات</h2>
<p class="animate delay-1" style="margin-bottom: 1rem;">يجب تعديل نفس البحث لكل قاعدة بيانات:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 700px;">
<div class="card animate delay-2">
<div class="card-label">مجلات</div>
<p class="card-text" style="font-family: monospace; font-size: 0.8rem;">"داء السكري، النوع 2"[MeSH] OR "مرض السكري من النوع 2"[tiab]</p>
</div>
<div class="card animate delay-3">
<div class="card-label">إمباس</div>
<p class="card-text" style="font-family: monospace; font-size: 0.8rem;">'مرض السكري غير المعتمد على الأنسولين'/exp OR 'مرض السكري من النوع 2':ti,ab</p>
</div>
</div>
<p class="footnote animate delay-4">عناوين المواضيع، الحقل العلامات، والمشغلين تختلف بين قواعد البيانات.</p>
</div>
</div>
 القصة: شفافية تاميفلو الحملة 
<div class="slide dark" data-index="12b">
<div class="story-box animate">
<p class="story-opener">ماذا يحدث عندما تبحث - ولا تجد شيئًا؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    الحكومات المخزونة <span class="data-highlight">9 مليارات دولار</span> للأوسيلتاميفير (تاميفلو) لعلاج جائحة الأنفلونزا. حاولت مؤسسة كوكرين مراجعة الأدلة. من <span class="data-highlight">77 تجربة سريرية</span>، التقارير الكاملة موجودة فقط <span class="data-highlight">20</span>. رفضت شركة Roche مشاركة البيانات الخاصة بـ <span class="data-highlight">5 سنوات</span>. عندما حصلت BMJ وCochrane أخيرًا على <span class="data-highlight">أكثر من 160.000 صفحة</span> ومن خلال تقارير الدراسات السريرية، وجدوا أن عقار تاميفلو قلل الأعراض بنسبة <span class="data-highlight">أقل من يوم واحد</span>، مع <span class="data-highlight">لا يوجد دليل</span> منع دخول المستشفى أو المضاعفات.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">معضلة المراجع: 2009</div>
<div class="decision-scenario">
                    أنت تقوم بتحديث مراجعة كوكرين لعقار تاميفلو. تبدو التجارب المنشورة إيجابية. لكن 57 تجربة ليس لديها تقارير كاملة يمكن الوصول إليها. ماذا تفعل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: تحليل ما تم نشره</div>
<div class="path-choice">استخدم 20 التجارب المتاحة. استنتج أن عقار تاميفلو فعال.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">مراجعتك تدعم التخزين المستمر. تم إنفاق 9 مليارات دولار على أدلة ضعيفة.</div>
<div class="path-outcome">النتيجة: إهدار المليارات، والفعالية الحقيقية غير معروفة</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: طلب البيانات الكاملة</div>
<div class="path-choice">ارفض النشر حتى تصبح جميع بيانات التجربة متاحة</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">حملة 5 سنوات. تم أخيرًا الحصول على أكثر من 160.000 صفحة. الحقيقة تظهر.</div>
<div class="path-outcome">النتيجة: تغيرت سياسة الأدلة؛ تنشر EMA الآن جميع التقارير التجريبية</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    تكون جودة البحث فقط بقدر ما يمكن العثور عليه. عندما يتم إخفاء الأدبيات الرمادية خلف جدران الشركات، فإن حتى البحث الأكثر شمولاً في PubMed سوف يغيب عن الحقيقة. لقد غيرت ملحمة تاميفلو السياسة العالمية: تنشر وكالة الأدوية الأوروبية الآن تقارير الدراسات السريرية لجميع الأدوية.
                  </div>
</div>
</div>
</div>
<div class="slide dark" data-index="12">
<p class="closing-line animate">إذا بحثت شركة Nissen في PubMed فقط،</p>
<p class="closing-line animate delay-1">لكانت الإشارة مخفية.</p>
<p class="closing-line gold animate delay-2">البحث الشامل هو البقاء.</p>
<div class="gold-line animate delay-3"></div>
<p class="closing-line italic animate delay-4">ما الذي كان مخفيا على مرأى من الجميع؟</p>
</div>
<!-- Quiz -->
<div class="slide light" data-index="13">
<div class="content">
<h2 class="title navy animate">الوحدة 3 مسابقة</h2>
<div class="quiz-container">
<div class="quiz-question" id="q3-1">
<h4>1. ما نوع مصدر الأدلة الذي كشف عن إشارة القلب والأوعية الدموية للروزيجليتازون؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q3-1', 0, 2, ['Published trials alone did not reveal the signal.', 'The Cochrane Library compiles existing reviews but did not contain this data.', 'Correct! GSK had posted trial data on their website as part of a legal settlement.', 'FDA approval documents did not contain this analysis.'])">
<span>A.</span> المقالات الصحفية المنشورة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-1', 1, 2, ['Published trials alone did not reveal the signal.', 'The Cochrane Library compiles existing reviews but did not contain this data.', 'Correct! GSK had posted trial data on their website as part of a legal settlement.', 'FDA approval documents did not contain this analysis.'])">
<span>B.</span> مكتبة كوكرين
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-1', 2, 2, ['Published trials alone did not reveal the signal.', 'The Cochrane Library compiles existing reviews but did not contain this data.', 'Correct! GSK had posted trial data on their website as part of a legal settlement.', 'FDA approval documents did not contain this analysis.'])">
<span>C.</span> سجل التجارب السريرية للشركة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-1', 3, 2, ['Published trials alone did not reveal the signal.', 'The Cochrane Library compiles existing reviews but did not contain this data.', 'Correct! GSK had posted trial data on their website as part of a legal settlement.', 'FDA approval documents did not contain this analysis.'])">
<span>D.</span> وثائق موافقة إدارة الغذاء والدواء
                      </div>
</div>
<div id="q3-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q3-2">
<h4>2. ما الذي تعنيه كلمة PRESS؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q3-2', 0, 1, ['This is not what PRESS stands for.', 'Correct! PRESS is a guideline for having search strategies reviewed by a second expert.', 'This is not what PRESS stands for.', 'This is not what PRESS stands for.'])">
<span>A.</span> مراجعة المنشورات لمعايير البحث عن الأدلة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-2', 1, 1, ['This is not what PRESS stands for.', 'Correct! PRESS is a guideline for having search strategies reviewed by a second expert.', 'This is not what PRESS stands for.', 'This is not what PRESS stands for.'])">
<span>B.</span> مراجعة النظراء لاستراتيجيات البحث الإلكتروني
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-2', 2, 1, ['This is not what PRESS stands for.', 'Correct! PRESS is a guideline for having search strategies reviewed by a second expert.', 'This is not what PRESS stands for.', 'This is not what PRESS stands for.'])">
<span>C.</span> بروتوكول الإبلاغ عن دراسات تركيب الأدلة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q3-2', 3, 1, ['This is not what PRESS stands for.', 'Correct! PRESS is a guideline for having search strategies reviewed by a second expert.', 'This is not what PRESS stands for.', 'This is not what PRESS stands for.'])">
<span>D.</span> نظام البحث عن الأدلة البحثية الأولية
                      </div>
</div>
<div id="q3-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="14">
<p class="refrain animate">ما الذي كان مخفيا على مرأى من الجميع؟</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 4: الفحص</p>
</div>
</div>
 الوحدة النمطية 4: الفحص (Vioxx) 
<div class="module-slides" data-module="4">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه قصة عن</p>
<p class="title gold animate delay-1 text-center">ما اختاروا الإبلاغ عنه.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 4: الفحص</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تطبيق مخطط تدفق PRISMA لتوثيق اختيار الدراسة</li>
<li>تنفيذ فحص المراجع المزدوج مع حل النزاعات</li>
<li>تحديد تقارير النتائج الانتقائية ومعالجة البيانات</li>
<li>حساب الموثوقية بين التقييمات (كابا كوهين)</li>
<li>تطبيق المبدأ: "الرقم بدون مصدر ليس رقمًا"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">88,000</p>
<p class="subtitle animate delay-1">النوبات القلبية المنسوبة إلى Vioxx</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">دواء رائج. إشارة مخفية. كارثة يمكن الوقاية منها.</p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">بين في عامي 1999 و2004، تناول الملايين هذا المسكن. لم يعد البعض إلى المنزل مطلقًا.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">ظهور Vioxx</h2>
<div class="card animate delay-1">
<p class="card-text text-center">كان Rofecoxib (Vioxx) أحد مضادات الالتهاب غير الستيروئيدية الانتقائية لـ COX-2. تم تسويقه على أنه أكثر أمانًا للمعدة من مسكنات الألم التقليدية.</p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">1999</div>
<div class="stat-label">موافقة ادارة الاغذية والعقاقير</div>
</div>
<div class="stat-box">
<div class="stat-value">$2.5B</div>
<div class="stat-label">ذروة المبيعات السنوية</div>
</div>
<div class="stat-box">
<div class="stat-value">80M+</div>
<div class="stat-label">الموصوف للمرضى</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">تجربة VIGOR (2000)</h2>
<p class="serif animate delay-1" style="font-style: italic; color: var(--gold); margin-bottom: 1rem;">أبحاث نتائج الجهاز الهضمي فيوكس</p>
<div class="design-grid animate delay-2">
<div class="design-item">
<div class="design-item-label">التصميم</div>
<div class="design-item-value">عشوائية، مزدوجة التعمية</div>
</div>
<div class="design-item">
<div class="design-item-label">مقارنة</div>
<div class="design-item-value">فيوكس مقابل نابروكسين</div>
</div>
<div class="design-item">
<div class="design-item-label">سكان</div>
<div class="design-item-value">التهاب المفاصل الروماتويدي</div>
</div>
<div class="design-item">
<div class="design-item-label">عينة</div>
<div class="design-item-value">8076 مريضا</div>
</div>
<div class="design-item">
<div class="design-item-label">النتيجة الأولية</div>
<div class="design-item-value">أحداث جي آي</div>
</div>
<div class="design-item">
<div class="design-item-label">تم النشر</div>
<div class="design-item-value">NEJM، نوفمبر 2000</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">ما نشرته VIGOR</h2>
<table class="results-table animate delay-1">
<thead>
<tr>
<th>نتيجة جي آي</th>
<th>فيوكس</th>
<th>نابروكسين</th>
</tr>
</thead>
<tbody>
<tr>
<td>أحداث الجهاز الهضمي المؤكدة</td>
<td style="color: var(--green);">2.1 لكل 100 نقطة سنة</td>
<td>4.5 لكل 100 نقطة سنة</td>
</tr>
<tr>
<td>تخفيض</td>
<td colspan="2" style="color: var(--green); font-weight: 700;">أحداث الجهاز الهضمي أقل بنسبة 54%</td>
</tr>
</tbody>
</table>
<div class="card navy-bg animate delay-2">
<p class="card-text text-center">العنوان: فيوكس أكثر أمانًا لمعدتك!</p>
</div>
<p class="footnote animate delay-3">هذا ما قيل للأطباء. هذا ما يعتقده المرضى.</p>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">ما دفنه VIGOR</h2>
<table class="results-table animate delay-1">
<thead>
<tr>
<th>نتيجة السيرة الذاتية</th>
<th>فيوكس</th>
<th>نابروكسين</th>
</tr>
</thead>
<tbody>
<tr>
<td>احتشاء عضلة القلب</td>
<td class="highlight">20 حدثا</td>
<td>4 أحداث</td>
</tr>
<tr>
<td>المخاطر النسبية</td>
<td class="highlight" colspan="2">أعلى بمقدار 5 مرات في مجموعة Vioxx</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-2">
<div class="value">زيادة بمقدار 5 أضعاف في النوبات القلبية</div>
<div class="label">تم ذكرها باختصار فقط، وتعزى إلى كون النابروكسين "واقي للقلب"</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">التقارير الانتقائية</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>التلاعب بقطع البيانات:</strong> حدثت 3 نوبات قلبية إضافية بعد القطع المستخدم في المنشور</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>يلف:</strong> تم شرح إشارة السيرة الذاتية بعيدًا عن كون النابروكسين واقيًا للقلب (لا يوجد دليل)</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>تبديل النتائج:</strong> تم تحديد أحداث السيرة الذاتية مسبقًا ولكن لم يتم التأكيد عليها</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p><strong>المعرفة الداخلية:</strong> تُظهر رسائل البريد الإلكتروني لشركة Merck أنهم كانوا على علم بالإشارة</p>
</div>
</div>
</div>
<div class="slide dark" data-index="8">
<div class="content">
<h2 class="title cream animate">تجربة APPROVe (2004)</h2>
<p class="animate delay-1">تجربة للوقاية من سلائل القولون والمستقيم - توقفت مبكرًا من أجل السلامة.</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">RR 1.92</div>
<div class="stat-label">أحداث السيرة الذاتية مقابل الدواء الوهمي</div>
</div>
<div class="stat-box">
<div class="stat-value">سبتمبر 2004</div>
<div class="stat-label">تم سحب Vioxx</div>
</div>
</div>
<p class="animate delay-3" style="margin-top: 1.5rem; color: var(--gold); font-style: italic; text-align: center;">
                  بعد أربع سنوات من ظهور VIGOR لخطر 5x. أربع سنوات متأخرة جداً.
                </p>
</div>
</div>
 القصة: شجرة قرار Vioxx 
<div class="slide dark" data-index="8b">
<div class="story-box animate">
<p class="story-opener">هل فكرت في ذلك ماذا يحدث عندما تختبئ الإشارة في الضوضاء؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    تمت الموافقة على Vioxx (rofecoxib) في <span class="data-highlight">1999</span>.
                    By <span class="data-highlight">2004</span>، تشير التقديرات
                    <span class="data-highlight">88.000-140.000 نوبة قلبية زائدة</span> and
                    <span class="data-highlight">30.000-40.000 حالة وفاة</span>. أظهرت تجربة VIGOR الخاصة بشركة Merck <span class="data-highlight">5x خطر على القلب والأوعية الدموية</span> في عام 2000، ولكن تم رفضه باعتباره "تأثير النابروكسين الواقي للقلب".
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">الشوكة في الطريق</div>
<div class="decision-scenario">
                    أنت أحد مراجعي إدارة الغذاء والدواء في عام 2001. تُظهر بيانات VIGOR خطر الإصابة بنوبة قلبية 5x مع Vioxx مقابل نابروكسين.
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: قبول الشرح</div>
<div class="path-choice">صدق فرضية ميرك: النابروكسين واقي للقلب</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">لا توجد دراسات سلامة إضافية مطلوبة. يبقى الدواء في السوق بأقصى سرعة.</div>
<div class="path-outcome">النتيجة: أكثر من 40,000 حالة وفاة على مدى 4 سنوات</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: طلب الأدلة</div>
<div class="path-choice">تتطلب تجربة سلامة السيرة الذاتية المخصصة قبل مواصلة التسويق</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تأخير أو تقييد التسويق حتى يتم التأكد من سلامة القلب والأوعية الدموية.</div>
<div class="path-outcome">النتيجة: تم اكتشاف الإشارة مبكرًا، مما أدى إلى إنقاذ الأرواح</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    كانت الإشارة موجودة في عام 2000. الخطأ تفسير تأخير العمل لمدة 4 سنوات. فرضية بديلة - تم قبولها بدون دليل - كلفت عشرات الآلاف من الأرواح.
                  </div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">مخطط تدفق PRISMA</h2>
<p class="animate delay-1" style="font-style: italic; margin-bottom: 1rem;">يجب أن تكون كل خطوة من خطوات الفحص موثقة وشفافة.</p>
<div style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
<div class="stat-box animate delay-1" style="width: 300px;"><div class="stat-value">تعريف</div><div class="stat-label">سجلات من قواعد البيانات + مصادر أخرى</div></div>
<div class="arrow animate delay-1" style="font-size: 1.5rem;">↓</div>
<div class="stat-box animate delay-2" style="width: 300px;"><div class="stat-value">الفحص</div><div class="stat-label">مراجعة العنوان/الملخص (تمت إزالة التكرارات)</div></div>
<div class="arrow animate delay-2" style="font-size: 1.5rem;">↓</div>
<div class="stat-box animate delay-3" style="width: 300px;"><div class="stat-value">الأهلية</div><div class="stat-label">تقييم النص الكامل (مع أسباب الاستبعاد)</div></div>
<div class="arrow animate delay-3" style="font-size: 1.5rem;">↓</div>
<div class="stat-box animate delay-4" style="width: 300px; background: var(--gold); color: var(--navy);"><div class="stat-value">متضمنة</div><div class="stat-label">دراسات في التركيب</div></div>
</div>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">الفحص المزدوج: لماذا مراجعان؟</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>يقلل من تحيز الاختيار</h4>
<p>قد يفضل أحد المراجعين دون وعي دراسات معينة</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>يصيد الأخطاء</h4>
<p>الإرهاق وسوء القراءة والأخطاء أمر لا مفر منه</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>القوى معايير صريحة</h4>
<p>تكشف الخلافات الغموض في قواعد الإدماج</p>
</div>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">اتفاق نموذجي: κ = 0.6-0.8</p>
<p class="sub">يتم حل الخلافات عن طريق المناقشة أو المراجع الثالث</p>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">المعايرة: المرحلة التجريبية</h2>
<div class="card animate delay-1">
<p class="card-text text-center">قبل فحص آلاف السجلات، يجب على المراجعين معايرة عينة مكونة من 50 إلى 100 سجل.</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">1</div>
<p>شاشة نفس المجموعة بشكل مستقل</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">2</div>
<p>مقارنة القرارات ومناقشة الخلافات</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">3</div>
<p>تحسين معايير الاشتمال حتى κ &gt; 0.7</p>
</div>
<div class="wrong-item animate delay-5">
<div class="wrong-number">4</div>
<p>توثيق عملية المعايرة وأي تغييرات في القواعد</p>
</div>
</div>
</div>
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">تحديثات بريسما 2020</h2>
<div class="design-grid animate delay-1" style="grid-template-columns: 1fr 1fr;">
<div class="design-item">
<div class="design-item-label">جديد في عام 2020</div>
<div class="design-item-value">تقارير منفصلة عن قاعدة البيانات مقابل عمليات البحث في التسجيل</div>
</div>
<div class="design-item">
<div class="design-item-label">جديد في عام 2020</div>
<div class="design-item-value">يجب الإبلاغ عن أدوات التشغيل الآلي</div>
</div>
<div class="design-item">
<div class="design-item-label">جديد في عام 2020</div>
<div class="design-item-value">تم توثيق البحث عن الاقتباس بشكل منفصل</div>
</div>
<div class="design-item">
<div class="design-item-label">جديد في عام 2020</div>
<div class="design-item-value">أسباب الاستبعاد في النص الكامل إلزامية</div>
</div>
</div>
<p class="footnote animate delay-2">قامت PRISMA 2020 بمراجعة قائمة المراجعة بشكل جوهري مع إعداد تقارير موسعة حول طرق التوليف وتقييم اليقين وتسجيل البروتوكول.</p>
</div>
</div>
<div class="slide dark" data-index="13">
<p class="closing-line animate">إذا تم فحص بيانات القلب والأوعية الدموية الخاصة بـ Vioxx من قبل مراجعين مستقلين،</p>
<p class="closing-line animate delay-1">إذا كان مطلوبًا الإبلاغ عن جميع النتائج المحددة مسبقًا،</p>
<p class="closing-line gold animate delay-2">كان من الممكن منع 88000 نوبة قلبية.</p>
<div class="gold-line animate delay-3"></div>
<p class="closing-line italic animate delay-4">الرقم بدون مصدر ليس رقمًا.</p>
</div>
<!-- Quiz -->
<div class="slide light" data-index="14">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 4</h2>
<div class="quiz-container">
<div class="quiz-question" id="q4-1">
<h4>1. في تجربة VIGOR، ما هو الخطر النسبي لـ MI في مجموعة Vioxx مقارنةً بالنابروكسين؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q4-1', 0, 2, ['The risk was much higher than 1.5x.', 'The risk was higher than 2x.', 'Correct! 20 events vs 4 events = 5-fold higher risk.', 'The risk increase was substantial, not 10x.'])">
<span>A.</span> أعلى بمقدار 1.5 مرة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-1', 1, 2, ['The risk was much higher than 1.5x.', 'The risk was higher than 2x.', 'Correct! 20 events vs 4 events = 5-fold higher risk.', 'The risk increase was substantial, not 10x.'])">
<span>B.</span> 2x أعلى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-1', 2, 2, ['The risk was much higher than 1.5x.', 'The risk was higher than 2x.', 'Correct! 20 events vs 4 events = 5-fold higher risk.', 'The risk increase was substantial, not 10x.'])">
<span>C.</span> أعلى بمقدار 5 مرات
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-1', 3, 2, ['The risk was much higher than 1.5x.', 'The risk was higher than 2x.', 'Correct! 20 events vs 4 events = 5-fold higher risk.', 'The risk increase was substantial, not 10x.'])">
<span>D.</span> أعلى بـ 10 مرات
                      </div>
</div>
<div id="q4-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q4-2">
<h4>2. ما أهمية الفحص المزدوج (مراجعان مستقلان)؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q4-2', 0, 1, ['Speed is not the primary goal of dual screening.', 'Correct! Dual screening reduces individual bias and catches errors.', 'Dual screening adds work, not reduces it.', 'This is backwards - dual screening improves quality.'])">
<span>A.</span> يجعل الفحص أسرع
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-2', 1, 1, ['Speed is not the primary goal of dual screening.', 'Correct! Dual screening reduces individual bias and catches errors.', 'Dual screening adds work, not reduces it.', 'This is backwards - dual screening improves quality.'])">
<span>B.</span> فهو يقلل من التحيز في الاختيار ويكتشف الأخطاء
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-2', 2, 1, ['Speed is not the primary goal of dual screening.', 'Correct! Dual screening reduces individual bias and catches errors.', 'Dual screening adds work, not reduces it.', 'This is backwards - dual screening improves quality.'])">
<span>C.</span> إنه يقلل من عدد الدراسات التي يجب مراجعتها
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q4-2', 3, 1, ['Speed is not the primary goal of dual screening.', 'Correct! Dual screening reduces individual bias and catches errors.', 'Dual screening adds work, not reduces it.', 'This is backwards - dual screening improves quality.'])">
<span>D.</span> يسمح للمراجعين بتخطي مراجعة النص الكامل
                      </div>
</div>
<div id="q4-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="15">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 5: الاستخلاص</p>
</div>
</div>
 الوحدة 5: الاستخلاص (DECREASE) 
<div class="module-slides" data-module="5">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه قصة عن</p>
<p class="title gold animate delay-1 text-center">الأرقام التي لم تكن موجودة من قبل.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 5: الاستخلاص</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تصميم نموذج موحد لاستخراج البيانات مع حقول المصدر</li>
<li>حساب أحجام التأثير من مختلف الإحصاءات المبلغ عنها (OR، RR، HR، SMD)</li>
<li>تنفيذ الاستخراج المزدوج مع حل التناقض</li>
<li>تحديد العلامات الحمراء لتلفيق البيانات وسوء السلوك</li>
<li>اشرح كيف أثر الاحتيال في DECREASE على الإرشادات السريرية</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">~10,000</p>
<p class="subtitle animate delay-1">الوفيات الزائدة المحتملة في أوروبا</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">من الإرشادات المستندة إلى التجارب السريرية الملفقة البيانات.</p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">أثرت تجارب DECREASE على الرعاية المحيطة بالجراحة في جميع أنحاء العالم. تم اختراع البيانات.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">دون بولدرمانز: باحث نجم</h2>
<div class="card animate delay-1">
<p class="card-text text-center">أستاذ في مركز إيراسموس الطبي، روتردام. مؤلف أكثر من 500 ورقة. المؤلف الرئيسي للمبادئ التوجيهية ESC بشأن رعاية القلب المحيطة بالجراحة.</p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">500+</div>
<div class="stat-label">المنشورات</div>
</div>
<div class="stat-box">
<div class="stat-value">ينقص</div>
<div class="stat-label">سلسلة المحاكمة من الأول إلى السادس</div>
</div>
<div class="stat-box">
<div class="stat-value">ESC</div>
<div class="stat-label">كرسي التوجيهي</div>
</div>
</div>
<p class="footnote animate delay-3">يبدو أنه مصدر لا يرقى إليه الشك. حتى ينظر شخص ما إلى البيانات.</p>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">تجارب DECREASE: المطالبة</h2>
<table class="results-table animate delay-1">
<thead>
<tr>
<th>محاكمة</th>
<th>العثور على</th>
<th>تأثير</th>
</tr>
</thead>
<tbody>
<tr>
<td>انخفاض-I (1999)</td>
<td>انخفاض بنسبة 90% في حالات الوفاة القلبية</td>
<td>المبادئ التوجيهية المتغيرة</td>
</tr>
<tr>
<td>التخفيض الرابع (2009)</td>
<td>حاصرات بيتا آمنة في المخاطر المنخفضة</td>
<td>توصيات موسعة</td>
</tr>
</tbody>
</table>
<div class="focus-box animate delay-2 mt-2">
<p class="main">وكانت أحجام التأثير كبيرة بشكل غير معقول.</p>
<p class="sub">تخفيض 90%؟ لا يوجد شيء تقريبًا في الطب يعمل بشكل جيد.</p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">التحقيق: 2011</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p>تم التحقيق في Erasmus MC بعد شكاوى المبلغين عن المخالفات</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>بيانات المرضى الملفقة:</strong> المرضى الذين لم يكونوا موجودين أو لم يتم تسجيلهم</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>لا توجد موافقة مستنيرة:</strong> لم يوافق العديد من "المشاركين" أبدًا</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p><strong>تم طرد Poldermans:</strong> من Erasmus MC في عام 2011</p>
</div>
</div>
</div>
<div class="slide dark" data-index="6">
<div class="content">
<h2 class="title cream animate">سلسلة الضرر</h2>
<p class="animate delay-1" style="margin-bottom: 1rem;">عندما تمت إزالة DECREASE من التحليلات الوصفية...</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">المنفعة → الضرر</div>
<div class="stat-label">الاتجاه المعكوس</div>
</div>
<div class="stat-box">
<div class="stat-value">27% ↑</div>
<div class="stat-label">زيادة خطر السكتة الدماغية</div>
</div>
</div>
<p class="animate delay-3" style="margin-top: 1.5rem; color: var(--gold); font-style: italic; text-align: center;">
                  لقد أظهرت تجربة POISE (2008) ضررًا. تم رفضه لأنه يتعارض مع DECREASE.
                </p>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">لماذا لم يتم اكتشاف هذا؟</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>الثقة في السلطة:</strong> كان بولديرمانز مؤلف المبادئ التوجيهية الذي قام بمراجعة الأدلة الخاصة به</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>لا يوجد التحقق من البيانات:</strong> لم يطلب أحد بيانات المريض الفردية</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>مكانة النشر:</strong> منشور في أفضل المجلات، ويفترض أنه صالح</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p><strong>قبول التأثيرات غير المعقولة:</strong> يجب أن تثير التخفيضات بنسبة 90% الشكوك</p>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">استخراج البيانات: الدفاع ضد الاحتيال</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>الاستخراج المزدوج</h4>
<p>مستخرجان بشكل مستقل - يكتشفان أخطاء النسخ ويفرضان التدقيق</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>مصدر السجل</h4>
<p>جدول، صفحة، فقرة - كل رقم يمكن تتبعه إلى المصدر</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>التحقق من التسجيل</h4>
<p>ClinicalTrials.gov النتائج مقابل النشر - التناقضات هي علامات حمراء</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>طلب IPD</h4>
<p>تكشف بيانات المريض الفردية ما تخفيه الملخصات الإجمالية</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">حساب حجم التأثير</h2>
<p class="animate delay-1" style="margin-bottom: 1rem;">أثناء الاستخراج، يمكنك حساب أحجام التأثير من البيانات المبلغ عنها:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 700px;">
<div class="card animate delay-2">
<div class="card-label">النتائج الثنائية</div>
<p class="card-text" style="font-size: 0.85rem;">نسبة الأرجحية، نسبة المخاطرة، فرق المخاطرة من جداول 2x2</p>
</div>
<div class="card animate delay-3">
<div class="card-label">نتائج مستمرة</div>
<p class="card-text" style="font-size: 0.85rem;">الفرق المتوسط، الفرق المتوسط الموحد من الوسائل وSD</p>
</div>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">استخرج دائمًا من المصدر الأكثر موثوقية.</p>
<p class="sub">تفضل: نتائج ITT &gt; لكل بروتوكول &gt; المجموعات الفرعية</p>
</div>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">الأعلام الحمراء أثناء الاستخراج</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">!</div>
<p><strong>أحجام التأثير غير المعقول:</strong> يجب أن تؤدي التخفيضات بنسبة 80-90% إلى التدقيق</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">!</div>
<p><strong>الاختلالات الأساسية:</strong> المجموعات التي تمت مطابقتها "بشكل مثالي جدًا"</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">!</div>
<p><strong>أرقام الجولة:</strong> "بالضبط 50" أو "بالضبط 100" مريض لكل ذراع</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">!</div>
<p><strong>تناقضات التسجيل:</strong> تختلف N المنشورة عن N المسجلة</p>
</div>
</div>
</div>
<div class="slide light" data-index="11c" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">تحويلات حجم التأثير</h2>
<div class="card animate delay-1">
<p class="card-text">
                    نتائج تقرير الدراسات في مقاييس مختلفة. لتجميعها، غالبًا ما تحتاج إلى تحويلات:
                  </p>
</div>
<table class="results-table animate delay-2" style="font-size: 0.9rem;">
<thead><tr><th>From</th><th>To</th><th>صيغة</th></tr></thead>
<tbody>
<tr><td>مصلحة الارصاد الجوية (د)</td><td>سجل-أو</td><td>سجل-OR = د × π / √3</td></tr>
<tr><td>سجل-أو</td><td>مصلحة الارصاد الجوية (د)</td><td>د = سجل-OR × √3 / π</td></tr>
<tr><td>الارتباط (ص)</td><td>فيشر ز</td><td>z = 0.5 × ln((1+r)/(1−r))</td></tr>
<tr><td>OR</td><td>RR</td><td>RR = OR / (1 − P₀ + P₀ × OR)</td></tr>
<tr><td>OR</td><td>NNT</td><td>NNT = 1 / (P₀ − OR×P₀ / (1−P₀+OR×P₀))</td></tr>
</tbody>
</table>
<p class="footnote animate delay-3">
                  P₀ = خطر خط الأساس في مجموعة التحكم. تفترض هذه الصيغ شروطًا تقريبية؛ انظر بورنشتاين وآخرون. (الفصل 7) للاشتقاقات الدقيقة.
                </p>
</div>
</div>
<div class="slide light" data-index="11d" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">بيانات الوقت حتى الحدث (البقاء)</h2>
<div class="card animate delay-1">
<p class="card-text">
                    أبلغت العديد من التجارب عن نتائج الوقت حتى الحدث باستخدام <strong>نسب الخطر</strong> (الموارد البشرية). يتطلب تجميع الموارد البشرية في التحليل التلوي معالجة خاصة:
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>السجل (HR) + طريقة SE</h4>
<p>
                      استخرج السجل (HR) وSE الخاص به من التجربة. إذا لم يتم الإبلاغ عنها، فاشتق SE من CI: SE = (ln(upper) - ln(lower)) / (2 × 1.96). التجمع باستخدام طرق التباين العكسي القياسية.
                    </p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>عندما لا يتم الإبلاغ عن الموارد البشرية</h4>
<p>
                      توجد طرق لإعادة بناء IPD من منحنيات كابلان-ماير (Guyot et al. 2012) أو تقدير الموارد البشرية من القيم p وأعداد الأحداث (Parmar et al. 1998). تفضل دائمًا معدل الموارد البشرية المعدل الذي تم الإبلاغ عنه مباشرة عندما يكون متاحًا.
                    </p>
</div>
</div>
<p class="footnote animate delay-4">
                  HR &lt;1 يفضل العلاج؛ الموارد البشرية &gt; 1 تفضل التحكم. يفعل <strong>not</strong> تحويل الموارد البشرية إلى ORs أو RRs - فهي تقيس كميات مختلفة بشكل أساسي.
                </p>
</div>
</div>
 القصة: فضيحة بولدت الغروانية 
<div class="slide dark" data-index="11b">
<div class="story-box animate">
<p class="story-opener">ماذا لو لم تكن البيانات التي تستخرجها حقيقية على الإطلاق؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    كان يواكيم بولدت هو الباحث الأكثر إنتاجًا في إدارة سوائل التخدير. تم سحب أكثر من <span class="data-highlight">180 من منشوراته</span> — وهي واحدة من أكبر حالات التراجع في التاريخ الطبي. وأظهرت بياناته الملفقة أن نشا هيدروكسي إيثيل (HES) آمن. خلصت التحليلات التلوية التي شملت دراساته إلى أن HES غير ضار. عندما تمت إزالة دراسات بولدت، <span class="data-highlight">انعكس التأثير المجمع</span>: زاد HES <span class="data-highlight">إصابة الكلى بنسبة 59%</span> (RR 1.59، 95٪ CI 1.26-2.00) و <span class="data-highlight">الوفيات بنسبة ~ 9٪</span> (RR 1.09). يقدر
                    <span class="data-highlight">آلاف المرضى</span> تلقى سائلاً ضاراً بناءً على أدلة ملفقة.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">يقظة المستخرج: 2010</div>
<div class="decision-scenario">
                    أنت تقوم باستخراج بيانات للتحليل التلوي لإنعاش السوائل. تهيمن دراسات بولدت على الأدبيات (أكثر من 90 ورقة). وقد أثار المبلغين عن المخالفات المخاوف. ماذا تفعل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: استخراج كما تم نشره</div>
<div class="path-choice">ثق بالمنشورات التي يراجعها النظراء. استخرج بيانات بولدت مثل أي شيء آخر.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">يظهر التحليل التلوي الخاص بك أن HES آمن. المبادئ التوجيهية توصي بذلك.</div>
<div class="path-outcome">النتيجة: الآلاف يحصلون على سائل سام للكلى</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: التحقق من المصدر</div>
<div class="path-choice">التحقق من الموافقات الأخلاقية، وطلب بيانات المصدر، وإجراء تحليل الحساسية باستثناء الدراسات المشبوهة</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">اكتشف الموافقات الأخلاقية المفقودة. دراسات العلم. إعادة التحليل بدونهم.</div>
<div class="path-outcome">النتيجة: ظهور إشارة حقيقية - يسبب HES ضررًا</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    المصدر ليس بيروقراطية. وهذا هو الفرق بين الأدلة والخيال. يجب أن يتبع كل رقم مستخرج دراسة معتمدة من الناحية الأخلاقية، مع بيانات مريض يمكن التحقق منها. بدون مصدر، يمكن أن يصبح الرقم بدون مالك سلاحًا.
                  </div>
</div>
</div>
</div>
<div class="slide dark" data-index="11">
<p class="closing-line animate">كل رقم في تحليلك التلوي</p>
<p class="closing-line animate delay-1">يجب أن يعود إلى مصدر يمكن التحقق منه.</p>
<p class="closing-line gold animate delay-2">الرقم بدون مصدر ليس رقمًا.</p>
<div class="gold-line animate delay-3"></div>
<p class="closing-line italic animate delay-4">من الممكن أن تؤدي البيانات الاحتيالية إلى الوفاة تمامًا مثل الأدوية الاحتيالية.</p>
</div>
<!-- Quiz -->
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 5</h2>
<div class="quiz-container">
<div class="quiz-question" id="q5-1">
<h4>1. ماذا حدث عندما تمت إزالة بيانات تجربة DECREASE من التحليلات الوصفية لحاصرات بيتا؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q5-1', 0, 2, ['DECREASE data inflated benefits, not reduced them.', 'The effect size changed substantially.', 'Correct! Without DECREASE, the remaining evidence showed potential harm, not benefit.', 'The findings were not unchanged.'])">
<span>A.</span> أصبحت الفائدة أكبر
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-1', 1, 2, ['DECREASE data inflated benefits, not reduced them.', 'The effect size changed substantially.', 'Correct! Without DECREASE, the remaining evidence showed potential harm, not benefit.', 'The findings were not unchanged.'])">
<span>B.</span> لا يوجد تغيير في الاستنتاجات
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-1', 2, 2, ['DECREASE data inflated benefits, not reduced them.', 'The effect size changed substantially.', 'Correct! Without DECREASE, the remaining evidence showed potential harm, not benefit.', 'The findings were not unchanged.'])">
<span>C.</span> الاتجاه المعاكس لإظهار الضرر المحتمل
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-1', 3, 2, ['DECREASE data inflated benefits, not reduced them.', 'The effect size changed substantially.', 'Correct! Without DECREASE, the remaining evidence showed potential harm, not benefit.', 'The findings were not unchanged.'])">
<span>D.</span> أصبحت النتائج غير حاسمة
                      </div>
</div>
<div id="q5-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q5-2">
<h4>2. لماذا يجب أن يكون الاستخراج المزدوج ممارسة قياسية؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q5-2', 0, 0, ['Correct! Dual extraction catches errors and forces careful scrutiny of each data point.', 'Dual extraction is about accuracy, not speed.', 'Dual extraction is about data quality, not detection.', 'Dual extraction adds work but improves quality.'])">
<span>A.</span> يرصد أخطاء النسخ ويفرض التدقيق
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-2', 1, 0, ['Correct! Dual extraction catches errors and forces careful scrutiny of each data point.', 'Dual extraction is about accuracy, not speed.', 'Dual extraction is about data quality, not detection.', 'Dual extraction adds work but improves quality.'])">
<span>B.</span> يجعل الاستخراج أسرع
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-2', 2, 0, ['Correct! Dual extraction catches errors and forces careful scrutiny of each data point.', 'Dual extraction is about accuracy, not speed.', 'Dual extraction is about data quality, not detection.', 'Dual extraction adds work but improves quality.'])">
<span>C.</span> إنها تساعد في العثور على المزيد من الدراسات
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q5-2', 3, 0, ['Correct! Dual extraction catches errors and forces careful scrutiny of each data point.', 'Dual extraction is about accuracy, not speed.', 'Dual extraction is about data quality, not detection.', 'Dual extraction adds work but improves quality.'])">
<span>D.</span> يقلل من مقدار العمل المطلوب
                      </div>
</div>
<div id="q5-2-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 6: التحيز</p>
</div>
</div>
 الوحدة 6: التحيز (Aprotinin/BART) 
<div class="module-slides" data-module="6">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">هذه قصة عن</p>
<p class="title gold animate delay-1 text-center">التحيز الذي لا يمكننا رؤيته.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 6: التحيز</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تطبيق خطر التحيز 2.0 (RoB 2) على التجارب العشوائية</li>
<li>تطبيق ROBINS-I على الدراسات غير العشوائية</li>
<li>تقييم جميع مجالات RoB 2 الخمسة (العشوائية، والانحرافات، والبيانات المفقودة، والقياس، والاختيار)</li>
<li>التمييز بين الإرباك من خلال الإشارة من آثار العلاج الحقيقية</li>
<li>اشرح كيف كشف تحليل بارت عن الأضرار الخفية للأبروتينين</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<p class="big-number navy animate">20+</p>
<p class="subtitle animate delay-1">سنوات في السوق</p>
<p class="serif animate delay-2" style="font-size: 1.25rem; font-style: italic; color: var(--text);">كان الأبروتينين هو المعيار الذهبي لتقليل العمليات الجراحية نزيف.</p>
<div class="gold-line animate delay-3"></div>
<p class="animate delay-4" style="color: var(--light-text);">ثم أجرى شخص ما تجربة معشاة ذات شواهد. الحقيقة كانت مختلفة.</p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">التحيز الخفي: الإرباك من خلال الإشارة</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>حصل المرضى المرضى على أبروتينين:</strong> استخدمه الجراحون في الحالات المعقدة عالية الخطورة</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>انحياز الناجين:</strong> لا يمكن للمرضى المتوفين الإبلاغ عن المضاعفات</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>تحيز النشر:</strong> لم يتم نشر الدراسات السلبية</p>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">لم تتمكن الدراسات الرصدية من فصل تأثير الدواء عن المخاطر الأساسية للمريض.</p>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">بارت: الحقيقة العشوائية</h2>
<p class="red animate delay-1" style="font-style: italic; margin-bottom: 1rem;">الحفاظ على الدم باستخدام مضادات انحلال الفيبرين في تجربة عشوائية</p>
<table class="results-table animate delay-2">
<thead><tr><th>حصيلة</th><th>أبروتينين</th><th>البدائل</th></tr></thead>
<tbody>
<tr><td>معدل الوفيات لمدة 30 يومًا</td><td class="highlight">6.0%</td><td>3.9%</td></tr>
<tr><td>المخاطر النسبية</td><td class="highlight" colspan="2">1.53 (53% زيادة في الوفيات)</td></tr>
</tbody>
</table>
<div class="result-box animate delay-3">
<div class="value">إيقاف التجربة مبكرًا بسبب الضرر</div>
<div class="label">تم سحبها من السوق في نوفمبر 2007</div>
</div>
</div>
</div>
 تمرين التحقيق 
<div class="slide dark" data-index="5">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>التحقيق: تقييم التحيز</h3>
</div>
<p class="direct-address">أنت تقوم بمراجعة الدراسات الرصدية. تطبيق خطر التفكير المتحيز:</p>
<table class="data-table-investigation">
<thead><tr><th>سؤال</th><th>رصدي</th><th>بارت (RCT)</th></tr></thead>
<tbody>
<tr><td>تخصيص عشوائي؟</td><td>❌ اختيار الجراح</td><td>✓ نعم</td></tr>
<tr><td>يمكن مقارنة خط الأساس؟</td><td>❌ تعاطي سيكر</td><td>✓ متوازن</td></tr>
<tr><td>المسببة للعمى؟</td><td>❌ التسمية المفتوحة</td><td>✓ مزدوج التعمية</td></tr>
</tbody>
</table>
<button class="reveal-btn" onclick="revealAnswer('bias-reveal')">راجع الرؤية الأساسية →</button>
<div class="hidden-reveal" id="bias-reveal">
<p><strong>الخلط بالإشارة:</strong> أعطى الجراحون أبروتينين للمرضى الأكثر مرضًا. عزت الدراسات الرصدية البقاء على قيد الحياة إلى الدواء، عندما كانت تقيس تحيز البقاء على قيد الحياة.</p>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">خطر التحيز 2.0: المجالات الخمسة</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">D1</div>
<div class="lesson-content"><h4>عملية التوزيع العشوائي</h4></div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">D2</div>
<div class="lesson-content"><h4>الانحرافات عن التدخلات المقصودة</h4></div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">D3</div>
<div class="lesson-content"><h4>بيانات النتائج المفقودة</h4></div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">D4</div>
<div class="lesson-content"><h4>قياس النتيجة</h4></div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number">D5</div>
<div class="lesson-content"><h4>اختيار النتيجة المبلغ عنها</h4></div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">ROBINS-I: للدراسات غير العشوائية</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">عندما لا تكون التجارب المعشاة ذات الشواهد متاحة، استخدم ROBINS-I (خطر التحيز في الدراسات غير العشوائية التدخلات)</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #7c3aed;">1</div>
<div class="lesson-content"><h4>مربك</h4><p>الاختلافات الأساسية بين المجموعات</p></div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #7c3aed;">2</div>
<div class="lesson-content"><h4>اختيار المشاركين</h4><p>الاستثناءات ذات الصلة للتدخل</p></div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #7c3aed;">3</div>
<div class="lesson-content"><h4>تصنيف التدخلات</h4><p>سوء تصنيف حالة التعرض</p></div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #7c3aed;">4</div>
<div class="lesson-content"><h4>الانحرافات عن التدخلات المقصودة</h4><p>التدخلات المشتركة، التلوث</p></div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #7c3aed;">5</div>
<div class="lesson-content"><h4>البيانات المفقودة</h4><p>الخسارة التفاضلية للمتابعة</p></div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #7c3aed;">6</div>
<div class="lesson-content"><h4>قياس النتائج</h4><p>انحياز التأكد</p></div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number" style="background: #7c3aed;">7</div>
<div class="lesson-content"><h4>اختيار النتيجة المبلغ عنها</h4><p>تقارير انتقائية</p></div>
</div>
<p class="footnote animate delay-5" style="margin-top: 1rem;">التقييمات: منخفضة / متوسطة / خطيرة / حرجة / لا توجد معلومات</p>
</div>
</div>
 القصة: تجربة Aprotinin BART 
<div class="slide dark" data-index="8b">
<div class="story-box animate">
<p class="story-opener">ماذا يحدث عندما تتفق 64 دراسة - وكلها خاطئة؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    تم استخدام الأبروتينين في جراحة القلب لتقليل النزيف لـ <span class="data-highlight">20 سنة</span>.
                    <span class="data-highlight">64 تجربة عشوائية صغيرة</span> اقترح أنه آمن و فعالة. وأكدت التحليلات التلوية فائدة. ثم <span class="data-highlight">تجربة BART</span> (2008) عشوائية <span class="data-highlight">2331 مريضا</span>: أبروتينين مقابل حمض الترانيكساميك مقابل حمض الأمينوكابرويك. النتيجة: زيادة الأبروتينين <span class="data-highlight">الوفيات بنسبة 53%</span> (RR 1.53، 95% CI 1.06-2.22). تم <span class="data-highlight">إيقاف المحاكمة مبكرًا بسبب الضرر</span>. قامت شركة باير بسحب الأبروتينين من السوق خلال أشهر.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">دليل الجراح: 2006</div>
<div class="decision-scenario">
                    أنت جراح قلب يختار مضادًا لتحلل الفيبرين. 64 تجربة صغيرة تفضل الأبروتينين، لكن لم تكن أي منها قادرة على اكتشاف الوفيات. يتم الآن تسجيل RCT (BART) كبير. هل تنتظر؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: ثق في التحليل التلوي</div>
<div class="path-choice">64 تجربة لا يمكن أن تكون جميعها خاطئة. استمر في وصف الأبروتينين.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تجارب صغيرة تقيس النزيف، وليس الموت. لم يكن لدى أي منهم القوة الكافية للوفيات. قام التحليل التلوي بتجميع النتائج البديلة الضعيفة.</div>
<div class="path-outcome">النتيجة: الوفيات الزائدة في مرضى جراحة القلب</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: تقييم خطر التحيز أولاً</div>
<div class="path-choice">قم بتقييم جميع التجارب الـ 64 باستخدام RoB. لاحظ أنها صغيرة، وتستخدم نتائج بديلة، ولها استنزاف مرتفع. انتظر التجارب المعشاة ذات الشواهد التي تم تشغيلها بشكل مناسب.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">يكشف بارت الحقيقة. التحول إلى بدائل أكثر أمانا.</div>
<div class="path-outcome">النتيجة: إنقاذ الأرواح من خلال المطالبة بأدلة مدعومة بشكل مناسب</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    كمية الأدلة لا تساوي الجودة. إن أربع وستين تجربة ضعيفة القوة تقيس النتائج الخاطئة لا تتفوق على تجربة واحدة كافية لقياس معدل الوفيات. إن خطر تقييم التحيز ليس إجراءً شكليًا - فهو بمثابة الدرع الفاصل بين المرضى والاستنتاجات المضللة من الأدلة الصغيرة المستندة إلى أدلة بديلة.
                  </div>
</div>
</div>
</div>
<div class="slide dark" data-index="8">
<p class="closing-line animate">قامت أربع وستون تجربة صغيرة بقياس النزيف، وليس الموت.</p>
<p class="closing-line animate delay-1">كشفت إحدى التجارب التي تم تشغيلها بشكل كافٍ عن زيادة في معدل الوفيات بنسبة 53٪.</p>
<p class="closing-line gold animate delay-2">لا يمكن أن تحل كمية الأدلة محل الجودة والقوة.</p>
<div class="gold-line animate delay-3"></div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 6</h2>
<div class="quiz-container">
<div class="quiz-question" id="q6-1">
<h4>1. لماذا أخطأت 64 تجربة صغيرة ضرر الأبروتينين؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q6-1', 0, 0, ['Correct! Small trials measured surrogate outcomes (bleeding) without adequate power to detect mortality differences.', 'They were randomized, though too small for mortality. The issue was power and outcome choice.', 'Outcomes were measured, but the wrong ones for safety.', 'Duration was adequate for bleeding, not for detecting rare harms.'])">
<span>A.</span> ضعيف القدرة على مواجهة الوفيات؛ النتائج البديلة المستخدمة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q6-1', 1, 0, ['Correct! Small trials measured surrogate outcomes (bleeding) without adequate power to detect mortality differences.', 'They were randomized, though too small for mortality. The issue was power and outcome choice.', 'Outcomes were measured, but the wrong ones for safety.', 'Duration was adequate for bleeding, not for detecting rare harms.'])">
<span>B.</span> مربكة بالإشارة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q6-1', 2, 0, ['Correct! Small trials measured surrogate outcomes (bleeding) without adequate power to detect mortality differences.', 'They were randomized, though too small for mortality. The issue was power and outcome choice.', 'Outcomes were measured, but the wrong ones for safety.', 'Duration was adequate for bleeding, not for detecting rare harms.'])">
<span>C.</span> تم قياس النتيجة بشكل غير صحيح
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q6-1', 3, 0, ['Correct! Small trials measured surrogate outcomes (bleeding) without adequate power to detect mortality differences.', 'They were randomized, though too small for mortality. The issue was power and outcome choice.', 'Outcomes were measured, but the wrong ones for safety.', 'Duration was adequate for bleeding, not for detecting rare harms.'])">
<span>D.</span> المتابعة قصيرة جدًا
                      </div>
</div>
<div id="q6-1-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide black" data-index="9">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة السابعة: التركيب</p>
</div>
</div>
 الوحدة السابعة: التركيب (المغنيسيوم/ISIS-4) 
<div class="module-slides" data-module="7">
<div class="slide dark active" data-index="0">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">الجدل حول المغنيسيوم: 1991-1995</p>
<p class="title gold animate delay-1 text-center">عندما يؤدي التجميع إلى الضلال.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة السابعة: التركيب</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>احسب أحجام التأثير المجمعة باستخدام نماذج التأثير الثابت والتأثيرات العشوائية</li>
<li>اختر بين مقدرات DerSimonian-Laird وHKSJ بشكل مناسب</li>
<li>تفسير مخططات الغابة بما في ذلك الأوزان وفترات الثقة والماس</li>
<li>اشرح لماذا يمكن لتأثيرات الدراسات الصغيرة أن تضلل التحليلات الوصفية</li>
<li>طبق المبدأ: "التباين رسالة، وليس ضجيج"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">السنة: 1991</h2>
<p class="direct-address animate delay-1">
                  "أنت تقف على مفترق طرق الأمل والأدلة..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    تقتل أمراض القلب عددًا أكبر من الأشخاص في جميع أنحاء العالم مقارنة بأي سبب آخر. في عام 1991، ظهر أمل جديد: هل يمكن لشيء بسيط ورخيص مثل
                    <strong>المغنيسيوم الوريدي</strong> أن ينقذ الأرواح بعد احتشاء عضلة القلب؟
                  </p>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">كان الأساس المنطقي البيولوجي سليمًا:</p>
<p class="sub">يعمل المغنيسيوم على استقرار أغشية القلب، ويمنع عدم انتظام ضربات القلب، ويوسع الأوعية الدموية للشرايين التاجية.</p>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الحد -2: التجربة التاريخية</h2>
<p class="animate delay-1" style="font-style: italic;">تجربة التدخل الوريدي للمغنيسيوم في ليستر، 1992</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">2,316</div>
<div class="stat-label">المرضى المسجلون</div>
</div>
<div class="stat-box" style="background: rgba(34, 197, 94, 0.2); border-color: #22c55e;">
<div class="stat-value">24%</div>
<div class="stat-label">خفض معدل الوفيات</div>
</div>
<div class="stat-box">
<div class="stat-value">p = 0.04</div>
<div class="stat-label">ذات دلالة إحصائية</div>
</div>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">تدخل رخيص وآمن يمكن أن ينقذ حياة 250 ألف شخص سنويا على مستوى العالم.</p>
<p class="sub">كان المجتمع الطبي مكهرب.</p>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">التحليل التلوي: 1993</h2>
<p class="animate delay-1">تجمع الباحثون <strong>سبع تجارب عشوائية</strong> من المغنيسيوم الرابع في MI:</p>
<table class="results-table animate delay-2">
<thead>
<tr>
<th>محاكمة</th>
<th>Year</th>
<th>N</th>
<th>نسبة الاحتمالات</th>
</tr>
</thead>
<tbody>
<tr><td>مورتون 1984</td><td>1984</td><td>40</td><td style="color: var(--green);">0.10</td></tr>
<tr><td>راسموسن 1986</td><td>1986</td><td>273</td><td style="color: var(--green);">0.35</td></tr>
<tr><td>سميث 1986</td><td>1986</td><td>400</td><td style="color: var(--green);">0.48</td></tr>
<tr><td>ابراهيم 1987</td><td>1987</td><td>94</td><td>0.87</td></tr>
<tr><td>شيشتر 1990</td><td>1990</td><td>103</td><td style="color: var(--green);">0.27</td></tr>
<tr><td>سيريموزينسكي 1989</td><td>1989</td><td>48</td><td style="color: var(--green);">0.22</td></tr>
<tr><td>الحد-2</td><td>1992</td><td>2,316</td><td style="color: var(--green);">0.74</td></tr>
</tbody>
</table>
</div>
</div>
<div class="slide dark" data-index="5">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>تمرين التحقيق: معضلة المحلل التلوي</h3>
</div>
<p class="direct-address">
                  أنت أحد مراجعي كوكرين في عام 1993. لقد طُلب منك تجميع الأدلة المتعلقة بالمغنيسيوم من أجل MI. البيانات من سبع تجارب موجودة أمامك.
                </p>
<p class="rhetorical" style="margin: 1rem 0;">
                  هل ترى النمط في مخطط الغابة هذا؟
                </p>
<div id="magnesium-forest-small" style="background: white; border-radius: 8px; padding: 1rem; margin: 1rem 0;"></div>
<div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 1rem;">
<button class="reveal-btn" onclick="drawMagnesiumForest('small')">إنشاء قطعة أرض للغابات →</button>
<button class="reveal-btn" onclick="revealAnswer('mag-pooled')">تجميع الأدلة →</button>
</div>
<div class="hidden-reveal" id="mag-pooled">
<div class="result-box" style="background: rgba(34, 197, 94, 0.2); border-color: #22c55e;">
<div class="value">نسبة الأرجحية المجمعة = 0.44 (فاصل الثقة 95%: 0.27-0.71)</div>
<div class="label">تخفيض معدل الوفيات بنسبة 55%! نشر في مجلة لانسيت؟</div>
</div>
<p style="text-align: center; margin-top: 1rem; font-style: italic;">
                    ولكن انتظر... هل لاحظت أي شيء عن أحجام التجارب؟
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">التحذير العلامات</h2>
<p class="rhetorical animate">ما الذي كان يجب أن يمنحنا وقفة؟</p>
<div class="wrong-item animate delay-1">
<div class="wrong-number">1</div>
<p><strong>أحجام العينات الصغيرة:</strong> كان لدى ستة من سبع تجارب أقل من 500 مريض</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number">2</div>
<p><strong>التأثيرات القصوى:</strong> أو 0.10 (تخفيض بنسبة 90%) غير قابل للتصديق لأي دواء</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number">3</div>
<p><strong>الكل إيجابي:</strong> أين كانت التجارب السلبية؟ مشكلة درج الملفات...</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number">4</div>
<p><strong>عدم تناسق القمع:</strong> أظهرت التجارب الصغيرة تأثيرات أكبر بكثير من التجارب الأكبر</p>
</div>
</div>
</div>
<div class="slide dark" data-index="7">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>اختبار مخطط التحويل</h3>
</div>
<p class="direct-address">
                  قبل أن نقوم بالتجميع، يجب علينا التحقق من تحيز النشر. دعونا نتفحص المخطط القمعي.
                </p>
<div id="magnesium-funnel-small" style="background: white; border-radius: 8px; padding: 1rem; margin: 1rem 0;"></div>
<button class="reveal-btn" onclick="drawMagnesiumFunnel('small')">إنشاء مخطط قمع →</button>
<div id="mag-funnel-interpretation" style="display: none; margin-top: 1rem;">
<div class="focus-box" style="border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">⚠️ قمع غير متماثل</p>
<p class="sub">تتجمع التجارب الصغيرة على اليسار (تظهر الفائدة). أين التجارب السلبية الصغيرة؟</p>
<p class="sub">اختبار إيجر ع = 0.04 — عدم تناسق ذو دلالة إحصائية.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">العام: 1995 — تقارير داعش-4</h2>
<p class="direct-address animate delay-1">
                  "ثم جاءت الحقيقة..."
                </p>
<div class="card animate delay-2">
<p class="card-text text-center">
                    The <strong>الدراسة الدولية الرابعة للبقاء على قيد الحياة أثناء الاحتشاء (ISIS-4)</strong>
                    تم تسجيل 58,050 مريضًا في 1,086 مستشفى في 31 دولة.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">58,050</div>
<div class="stat-label">مرضى</div>
</div>
<div class="stat-box">
<div class="stat-value">2,216</div>
<div class="stat-label">الوفيات في مجموعة ملغ</div>
</div>
<div class="stat-box">
<div class="stat-value">2,103</div>
<div class="stat-label">الوفيات في العلاج الوهمي</div>
</div>
</div>
<div class="result-box animate delay-4" style="background: rgba(197, 48, 48, 0.2); border-color: #C53030;">
<div class="value">OR = 1.06 (95% CI: 1.00–1.12)</div>
<div class="label">لا فائدة. إذا كان هناك أي شيء، فإن الاتجاه نحو الأذى.</div>
</div>
</div>
</div>
<div class="slide dark" data-index="9">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">📊</span>
<h3>قبل وبعد: الصورة الكاملة</h3>
</div>
<p class="direct-address">
                  شاهد ما يحدث عندما نضيف التجربة الضخمة إلى غابتنا مؤامرة ...
                </p>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">قبل داعش-4</h4>
<p>7 تجارب صغيرة (العدد = 3,274)</p>
<p style="color: #22c55e; font-weight: bold;">OR = 0.44</p>
<p style="font-size: 0.9rem;">إشارة فائدة قوية</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">بعد إيزيس-4</h4>
<p>8 تجارب (ن = 61,324)</p>
<p style="color: #C53030; font-weight: bold;">OR = 1.02</p>
<p style="font-size: 0.9rem;">لا تأثير</p>
</div>
</div>
<div id="magnesium-forest-full" style="background: white; border-radius: 8px; padding: 1rem; margin: 1rem 0;"></div>
<button class="reveal-btn" onclick="drawMagnesiumForest('full')">عرض مخطط الغابة الكامل →</button>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">لماذا كانت التجارب الصغيرة مضللة؟</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>انحياز النشر</h4>
<p>لم تُنشر التجارب السلبية الصغيرة مطلقًا، بل ظلت في أدراج الملفات</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>تأثيرات الدراسات الصغيرة</h4>
<p>تميل التجارب الأصغر إلى إظهار تأثيرات أكبر بسبب نقاط الضعف المنهجية</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>التحيز العشوائي العالي</h4>
<p>بالصدفة، حققت بعض التجارب الصغيرة نتائج متطرفة - وتم نشر تلك التجارب</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>تضخيم التأثيرات العشوائية</h4>
<p>تعطي نماذج التأثيرات العشوائية وزنًا أكبر للتجارب الصغيرة، مما يؤدي إلى تضخيم التحيز</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">تأثير واحد ثابت مقابل تأثيرات عشوائية</h2>
<p class="rhetorical animate">ما هو النموذج الذي يجب أن تختاره؟</p>
<div class="animate delay-1" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 850px;">
<div class="card" style="border-right: 4px solid #3b82f6;">
<div class="card-label">نموذج التأثير الثابت</div>
<p class="card-text">يفترض <strong>تأثير حقيقي واحد</strong>. دراسات الأوزان بالتباين العكسي (الدقة). المحاكمات الكبيرة تهيمن.</p>
<p style="font-size: 0.85rem; color: var(--navy); margin-top: 0.5rem;">
<strong>نتيجة المغنيسيوم :</strong> OR = 0.96 (p = 0.52)
                    </p>
</div>
<div class="card" style="border-right: 4px solid #f59e0b;">
<div class="card-label">نموذج التأثيرات العشوائية</div>
<p class="card-text">يفترض <strong>توزيع التأثيرات</strong>. يعطي وزنا أكبر للتجارب الصغيرة. فترات ثقة أوسع.</p>
<p style="font-size: 0.85rem; color: var(--navy); margin-top: 0.5rem;">
<strong>نتيجة المغنيسيوم :</strong> OR = 0.59 (p = 0.01)
                    </p>
</div>
</div>
<div class="focus-box animate delay-2 mt-2" style="border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">⚠️ حدد اختيار النموذج النتيجة!</p>
<p class="sub">التأثيرات العشوائية لا تعمل على إصلاح التحيز؛ مع تأثيرات الدراسات الصغيرة، قد يؤدي ذلك إلى تحويل الوزن نحو تجارب أصغر وتغيير الاستنتاجات.</p>
</div>
</div>
</div>
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">دروس المغنيسيوم</h2>
<div class="card animate delay-1">
<p class="card-text" style="font-size: 1.1rem;">
<strong>1. تحقق من تحيز النشر</strong> قبل الوثوق في التقدير المجمع. المخططات القمعية واختبار إيجر هي أدواتك.
                  </p>
</div>
<div class="card animate delay-2">
<p class="card-text" style="font-size: 1.1rem;">
<strong>2. كن حذرًا من تأثيرات الدراسة الصغيرة.</strong> إذا أظهرت التجارب الصغيرة فقط فائدة، فانتظر تجربة كبيرة جيدة التنفيذ.
                  </p>
</div>
<div class="card animate delay-3">
<p class="card-text" style="font-size: 1.1rem;">
<strong>3. اختيار النموذج مهم.</strong> التأثيرات العشوائية يمكن أن تؤدي إلى تضخيم الأدلة المتحيزة. فكر في كلا النموذجين وافهم الآثار المترتبة.
                  </p>
</div>
<div class="card animate delay-4">
<p class="card-text" style="font-size: 1.1rem;">
<strong>4. يمكن لمحاكمة واحدة كبيرة أن تقلب الكثير من التجارب الصغيرة.</strong>
                    وهذا هو السبب في أن التجارب الضخمة مثل إيزيس-4 ذات قيمة كبيرة.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="12c" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">تصاميم الدراسات الخاصة في التحليل التلوي</h2>
<div class="card animate delay-1">
<p class="card-text">
                    لا تستخدم جميع التجارب المعشاة ذات الشواهد تصميمات المجموعة المتوازية القياسية. هناك بديلان شائعان يتطلبان معالجة خاصة عند تجميع النتائج:
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>التجارب العشوائية العنقودية</h4>
<p>
                      المجموعات العشوائية (المستشفيات والمدارس)، وليس الأفراد. يقلل <strong>تأثير التصميم</strong>
                      = 1 + (m−1) × ICC من حجم العينة الفعال. قم بتقسيم N على تأثير التصميم قبل التجميع، أو استخدم SE المعدل من التجربة. يؤدي تجاهل التجميع إلى إنتاج CIs ضيقة بشكل مصطنع.
                    </p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>التجارب المتقاطعة</h4>
<p>
                      يتلقى كل مريض كلا العلاجين. يعمل التصميم المقترن على تقليل التباين، لكنك تحتاج إلى <strong>الارتباط داخل المريض</strong> (أو التحليل المقترن SE) للتجميع بشكل صحيح. يعد استخدام المجموعة الموازية SE أمرًا محافظًا. استخدام عدد مزدوج غير صحيح من المرضى.
                    </p>
</div>
</div>
<p class="footnote animate delay-4">راجع دليل كوكرين الإصدار 6.4، الفصل 23 للحصول على صيغ مفصلة وأمثلة عملية.</p>
</div>
</div>
 القصة: عكس الفاعل بالسطح المبكر 
<div class="slide dark" data-index="12b">
<div class="story-box animate">
<p class="story-opener">ماذا لو كانت الطريقة التي تجمع بها الدراسات تحدد ما إذا كان العلاج يبدو منقذًا للحياة أم لا عديمة الفائدة؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    تم دعم الفاعل بالسطح المبكر للأطفال المبتسرين بواسطة <span class="data-highlight">6 تجارب صغيرة</span>
                    عرض <span class="data-highlight">انخفاض معدل الوفيات</span> (RR 0.84).
                    A <span class="data-highlight">التحليل التلوي ذو التأثير الثابت</span> فائدة مؤكدة (P = 0.04). لكن <span class="data-highlight">نموذج التأثيرات العشوائية</span> لم يظهر أي أهمية (p=0.12) - تجاوز فاصل الثقة 1.0. لاحقًا، وجدت <span class="data-highlight">الدعم (2010)</span> and <span class="data-highlight">فون (2012)</span>، تجربتان عمليتان كبيرتان مع <span class="data-highlight">~ 2000 حديثي الولادة</span> مجتمعة، <span class="data-highlight">لا فائدة</span> من الفاعل بالسطح المبكر مقابل الخافض للتوتر السطحي اللاحق. تم تغيير الممارسة السريرية بناءً على تجارب صغيرة ونموذج خاطئ.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">اختيار نموذج طبيب حديثي الولادة: 2005</div>
<div class="decision-scenario">
                    أنت تقوم بتحديث مراجعة كوكرين للفاعل بالسطح المبكر. أظهرت ست تجارب صغيرة فائدة مع نموذج التأثير الثابت. نموذج التأثيرات العشوائية غير مهم. ما الذي تقوم بالإبلاغ عنه؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: تقرير التأثير الثابت فقط</div>
<div class="path-choice">التأثير الثابت مهم. الإبلاغ عن النتيجة الإيجابية. تغيير الممارسة.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تعتمد وحدات العناية المركزة لحديثي الولادة المواد الخافضة للتوتر السطحي في وقت مبكر. التجارب اللاحقة لا تظهر أي فائدة. عكس الممارسة.</div>
<div class="path-outcome">النتيجة: سنوات من التنبيب غير الضروري للأطفال المبتسرين</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: الإبلاغ عن كلا النموذجين</div>
<div class="path-choice">إظهار نتائج FE وRE. ضع علامة على أن الأهمية تعتمد على اختيار النموذج. دعوة لإجراء تجارب كبيرة.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">عدم اليقين الصادق. أعطيت الأولوية للتجارب الكبيرة. الجواب الحقيقي يظهر بشكل أسرع.</div>
<div class="path-outcome">النتيجة: تجنب الأطفال الخدج التدخل غير الضروري</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    عندما يتغير الاستنتاج اعتمادًا على ما إذا كنت تستخدم التأثير الثابت أو التأثيرات العشوائية، يكون الاستنتاج هشًا. الإبلاغ عن كليهما. الاعتراف بعدم اليقين. وتذكر: النتيجة الهشة من التجارب الصغيرة ليست تفويضًا لتغيير الممارسة.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="13">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة السابعة</h2>
<div class="quiz-container">
<div class="quiz-question" id="q7-1">
<h4>1. لماذا أظهر التحليل التلوي للمغنيسيوم فائدة لم يجدها ISIS-4؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q7-1', 0, 2, ['ISIS-4 used wrong methods.', 'The pooled effect was calculated correctly.', 'Correct! Small negative trials were never published, creating a biased sample.', 'LIMIT-2 had adequate power.'])">
<span>A.</span> كانت منهجية ISIS-4 معيبة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-1', 1, 2, ['ISIS-4 used wrong methods.', 'The pooled effect was calculated correctly.', 'Correct! Small negative trials were never published, creating a biased sample.', 'LIMIT-2 had adequate power.'])">
<span>B.</span> خطأ في الحساب في التحليل التلوي
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-1', 2, 2, ['ISIS-4 used wrong methods.', 'The pooled effect was calculated correctly.', 'Correct! Small negative trials were never published, creating a biased sample.', 'LIMIT-2 had adequate power.'])">
<span>C.</span> تحيز النشر في التجارب الصغيرة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-1', 3, 2, ['ISIS-4 used wrong methods.', 'The pooled effect was calculated correctly.', 'Correct! Small negative trials were never published, creating a biased sample.', 'LIMIT-2 had adequate power.'])">
<span>D.</span> كان LIMIT-2 ضعيفًا
                      </div>
</div>
<div id="q7-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q7-2" style="margin-top: 1.5rem;">
<h4>2. ما هي العلامة التحذيرية التي ينبغي أن تنبه المراجعين إلى التحيز المحتمل؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q7-2', 0, 0, ['Correct! Small trials showed much larger effects than larger ones—a classic sign of small-study effects; publication bias is one explanation.', 'All trials showed consistent effects.', 'The biological mechanism was valid.', 'More trials needed to be published.'])">
<span>A.</span> مخطط قمع غير متماثل (تجارب صغيرة تظهر تأثيرات أكبر)
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-2', 1, 0, ['Correct! Small trials showed much larger effects than larger ones—a classic sign of small-study effects; publication bias is one explanation.', 'All trials showed consistent effects.', 'The biological mechanism was valid.', 'More trials needed to be published.'])">
<span>B.</span> عدم تجانس منخفض (I² = 0%)
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-2', 2, 0, ['Correct! Small trials showed much larger effects than larger ones—a classic sign of small-study effects; publication bias is one explanation.', 'All trials showed consistent effects.', 'The biological mechanism was valid.', 'More trials needed to be published.'])">
<span>C.</span> معقولية بيولوجية قوية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-2', 3, 0, ['Correct! Small trials showed much larger effects than larger ones—a classic sign of small-study effects; publication bias is one explanation.', 'All trials showed consistent effects.', 'The biological mechanism was valid.', 'More trials needed to be published.'])">
<span>D.</span> عدد قليل جدًا من التجارب التي يمكن تحليلها
                      </div>
</div>
<div id="q7-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q7-3" style="margin-top: 1.5rem;">
<h4>3. عند الاشتباه في تحيز النشر، ما النموذج الذي قد يؤدي إلى تضخيم التحيز؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q7-3', 0, 1, ['Fixed effects weights by precision, so large trials dominate.', 'Correct! Random effects gives more weight to small trials, which may be biased.', 'Bayesian models would be preferable.', 'Network meta-analysis handles bias differently.'])">
<span>A.</span> نموذج التأثير الثابت
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-3', 1, 1, ['Fixed effects weights by precision, so large trials dominate.', 'Correct! Random effects gives more weight to small trials, which may be biased.', 'Bayesian models would be preferable.', 'Network meta-analysis handles bias differently.'])">
<span>B.</span> نموذج التأثيرات العشوائية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-3', 2, 1, ['Fixed effects weights by precision, so large trials dominate.', 'Correct! Random effects gives more weight to small trials, which may be biased.', 'Bayesian models would be preferable.', 'Network meta-analysis handles bias differently.'])">
<span>C.</span> النموذج البايزي
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q7-3', 3, 1, ['Fixed effects weights by precision, so large trials dominate.', 'Correct! Random effects gives more weight to small trials, which may be biased.', 'Bayesian models would be preferable.', 'Network meta-analysis handles bias differently.'])">
<span>D.</span> التحليل التلوي للشبكة
                      </div>
</div>
<div id="q7-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="14">
<p class="closing-line animate">يمكن أن تظهر التجارب الصغيرة إشارات خاطئة.</p>
<p class="closing-line animate delay-1">المحاكمات الكبيرة تثبت الحقيقة.</p>
<p class="closing-line gold animate delay-2">التباين رسالة وليس ضجيج.</p>
<div class="gold-line animate delay-3"></div>
</div>
<div class="slide black" data-index="15">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 8: عدم التجانس</p>
</div>
</div>
 الوحدة 8: عدم التجانس (ACCORD) 
<div class="module-slides" data-module="8">
<div class="slide dark active" data-index="0">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">ACCORD: 2008</p>
<p class="title gold animate delay-1 text-center">عندما يخفي المتوسط الحقيقة.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 8: عدم التجانس</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>احسب وفسر I² وτ² وفترات التنبؤ</li>
<li>تطبيق معايير ICEMAN لتقييم مصداقية المجموعة الفرعية</li>
<li>التمييز بين عدم التجانس السريري والمنهجي والإحصائي</li>
<li>إجراء وتفسير تحليلات حساسية الإجازة الواحدة</li>
<li>اشرح كيف كشف ACCORD عن التأثيرات التفاضلية عبر المجموعات الفرعية</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">السنة: 2008</h2>
<p class="direct-address animate delay-1">
                  "أنت على وشك أن تشهد واحدة من أكثر حالات إنهاء المحاكمات إثارة للصدمة في التاريخ..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    على مدى عقود من الزمن، كان لدى مجتمع مرضى السكري مبدأ توجيهي واحد: <strong>انخفاض نسبة السكر في الدم هو الأفضل</strong>. أظهر DCCT (1993) وUKPDS (1998) أن التحكم المكثف في الجلوكوز يقلل من مضاعفات الأوعية الدموية الدقيقة - العمى، الفشل الكلوي، تلف الأعصاب.
                  </p>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">الاستقراء المنطقي:</p>
<p class="sub">إذا كان التحكم في الجلوكوز يمنع حدوث مضاعفات، ألا ينبغي أن يمنع التحكم المكثف أمراض القلب والأوعية الدموية أيضًا؟</p>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">ACCORD: إجراء للسيطرة على مخاطر القلب والأوعية الدموية في مرض السكري</h2>
<p class="animate delay-1" style="font-style: italic;">الاختبار النهائي للتحكم المكثف في الجلوكوز</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">10,251</div>
<div class="stat-label">مرضى السكري من النوع 2</div>
</div>
<div class="stat-box">
<div class="stat-value">HbA1c &lt;6%</div>
<div class="stat-label">الهدف المكثف</div>
</div>
<div class="stat-box">
<div class="stat-value">HbA1c 7-7.9%</div>
<div class="stat-label">الهدف القياسي</div>
</div>
</div>
<div class="card animate delay-3">
<p class="card-text">
                    كان جميع المرضى مصابين بداء السكري من النوع 2 مع ارتفاع خطر الإصابة بأمراض القلب والأوعية الدموية - إما أمراض القلب والأوعية الدموية المثبتة أو عوامل الخطر المتعددة. تم تصميم التجربة لمدة 5.6 سنوات.
                  </p>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<p class="rhetorical animate" style="font-size: 2rem;">
                6 فبراير 2008
              </p>
<p class="animate delay-1" style="font-size: 1.3rem; margin-top: 2rem;">
                يدعو مجلس مراقبة سلامة البيانات إلى اجتماع طارئ.
              </p>
<p class="animate delay-2" style="font-size: 1.3rem; margin-top: 1rem;">
                بعد 3.5 سنوات، يتخذون قرارًا غير مسبوق:
              </p>
<p class="title gold animate delay-3" style="font-size: 2.5rem; margin-top: 1.5rem;">
                أوقف التجربة.
              </p>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">النتائج المروعة</h2>
<table class="results-table animate delay-1">
<thead>
<tr>
<th>حصيلة</th>
<th>مكثف</th>
<th>معيار</th>
<th>HR (95% CI)</th>
</tr>
</thead>
<tbody>
<tr>
<td>نقطة نهاية السيرة الذاتية الأولية</td>
<td>352 حدثًا</td>
<td>371 حدثًا</td>
<td>0.90 (0.78–1.04)</td>
</tr>
<tr style="background: rgba(197, 48, 48, 0.15);">
<td><strong>الوفيات الناجمة عن جميع الأسباب</strong></td>
<td><strong>257 حالة وفاة</strong></td>
<td><strong>203 حالة وفاة</strong></td>
<td class="highlight"><strong>1.22 (1.01–1.46)</strong></td>
</tr>
<tr>
<td>نقص السكر في الدم الشديد</td>
<td>10.5%</td>
<td>3.5%</td>
<td>3.0× أعلى</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-2" style="background: rgba(197, 48, 48, 0.2); border-color: #C53030;">
<div class="value">زيادة بنسبة 22% في معدل الوفيات</div>
<div class="label">54 حالة وفاة زائدة في ذراع العناية المركزة</div>
</div>
</div>
</div>
<div class="slide dark" data-index="6">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>تمرين التحقيق: معضلة الطبيب</h3>
</div>
<p class="direct-address">
                  أنت طبيب غدد صماء ولديك 500 مريض بالسكري. تم نشر نتائج أكورد. ماذا تقول لمرضاك الذين يسعون جاهدين للحصول على نسبة HbA1c &lt;6%؟
                </p>
<p class="rhetorical" style="margin: 1.5rem 0;">
                  هل المراقبة المكثفة ضارة للجميع؟ أم فقط للبعض؟
                </p>
<div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 1rem;">
<button class="reveal-btn" onclick="revealAnswer('accord-subgroup')">افحص المجموعات الفرعية →</button>
</div>
<div class="hidden-reveal" id="accord-subgroup">
<h4 style="color: var(--gold); margin-top: 1rem;">كشف تحليل المجموعة الفرعية:</h4>
<table class="data-table-investigation" style="margin-top: 0.5rem;">
<thead><tr><th>مجموعة فرعية</th><th>الموارد البشرية المكثفة</th><th>التفسير</th></tr></thead>
<tbody>
<tr><td>عدم وجود أمراض القلب والأوعية الدموية السابقة</td><td>1.00 (0.76–1.32)</td><td>لا تأثير</td></tr>
<tr><td>أمراض القلب والأوعية الدموية السابقة</td><td style="color: #C53030;">1.45 (1.15–1.84)</td><td>ضرر كبير</td></tr>
<tr><td>خط الأساس لنسبة HbA1c &lt;8%</td><td>1.02 (0.75–1.40)</td><td>لا تأثير</td></tr>
<tr><td>خط الأساس لنسبة HbA1c ≥8%</td><td style="color: #C53030;">1.29 (1.03–1.60)</td><td>Harm</td></tr>
</tbody>
</table>
<div class="focus-box" style="margin-top: 1rem; border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">متوسط التأثير ملثمين عدم التجانس الحرج!</p>
<p class="sub">بالنسبة للمرضى الذين يعانون من أمراض القلب والأوعية الدموية أو التحكم الأساسي الضعيف، كان العلاج المكثف ضارًا.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">فهم عدم التجانس: I² وما بعده</h2>
<p class="animate delay-1">عند الدراسات (أو المجموعات الفرعية) تظهر تأثيرات مختلفة، يجب علينا قياس هذا الاختلاف.</p>
<div class="animate delay-2" style="max-width: 700px;">
<div class="card" style="border-right: 4px solid #22c55e;">
<p class="card-text"><strong>I² = 0–25%:</strong> عدم التجانس المنخفض. تكون التأثيرات متسقة عبر الدراسات.</p>
</div>
<div class="card" style="border-right: 4px solid #3b82f6; margin-top: 0.5rem;">
<p class="card-text"><strong>I² = 25–50%:</strong> معتدل. ابحث عن مصادر الاختلاف.</p>
</div>
<div class="card" style="border-right: 4px solid #f59e0b; margin-top: 0.5rem;">
<p class="card-text"><strong>I² = 50–75%:</strong> جوهري. فكر فيما إذا كان التجميع مناسبًا.</p>
</div>
<div class="card" style="border-right: 4px solid #C53030; margin-top: 0.5rem;">
<p class="card-text"><strong>I² = 75–100%:</strong> كبير. قد يكون التقدير المجمع الواحد مضللاً.</p>
</div>
</div>
<p class="footnote animate delay-3">لكن I² وحده لا يخبرك بما يجب فعله — فهو يشير إلى أنك بحاجة إلى مزيد من البحث.</p>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">Tau² (τ²): التباين بين الدراسة</h2>
<p class="animate delay-1">بينما يخبرك I² بنسبة التباين الناتج عن عدم التجانس، τ² يخبرك بالحجم.</p>
<div class="animate delay-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; max-width: 800px;">
<div class="card">
<div class="card-label">I² (نسبة مئوية)</div>
<p class="card-text">"ما هو جزء التباين الإجمالي الناتج عن الاختلافات الحقيقية بين الدراسات؟"</p>
<p style="font-size: 0.85rem;">المقياس: من 0% إلى 100%</p>
</div>
<div class="card">
<div class="card-label">τ² (مطلق)</div>
<p class="card-text">"ما مدى اختلاف التأثيرات الحقيقية بين الدراسات؟"</p>
<p style="font-size: 0.85rem;">نفس مقياس قياس التأثير</p>
</div>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">استخدم τ² للحساب <strong>فترات التنبؤ</strong></p>
<p class="sub">يُظهر الفاصل الزمني للتنبؤ نطاق التأثيرات التي تتوقعها في دراسة جديدة - غالبًا ما يكون أوسع بكثير من الثقة الفاصل الزمني.</p>
</div>
</div>
</div>
<div class="slide dark" data-index="9">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">📊</span>
<h3>الفاصل الزمني للتنبؤ: ما يخبرنا به ACCORD حقًا</h3>
</div>
<p class="direct-address">
                  النظر في التحليل التلوي للتحكم المكثف في الجلوكوز عبر تجارب متعددة...
                </p>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">فاصل الثقة</h4>
<p style="font-size: 1.2rem; font-weight: bold;">HR 1.10 (0.95–1.27)</p>
<p style="font-size: 0.9rem;">"أفضل تقدير لدينا لمتوسط التأثير"</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">الفاصل الزمني للتنبؤ</h4>
<p style="font-size: 1.2rem; font-weight: bold;">HR 1.10 (0.70–1.73)</p>
<p style="font-size: 0.9rem;">"نطاق التأثيرات في بيئة جديدة"</p>
</div>
</div>
<div class="focus-box" style="margin-top: 1rem; border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">يشمل الفاصل الزمني للتنبؤ كلاً من المنفعة والضرر!</p>
<p class="sub">في بعض الإعدادات، قد يكون التحكم المكثف مفيدًا. وفي حالات أخرى، يمكن أن يقتل.</p>
</div>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">متى يكون تأثير المجموعة الفرعية ذا مصداقية؟</h2>
<p class="animate delay-1" style="font-style: italic;">معايير مصداقية المجموعة الفرعية (مقتبسة من ICEMAN, Schandelmaier 2020 &amp; Sun 2012)</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>هل كان تحليل المجموعة الفرعية محددًا مسبقًا؟</h4>
<p>المجموعات الفرعية اللاحقة عرضة للبيانات التجريف</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>هل هناك مبرر بيولوجي معقول؟</h4>
<p>يجب أن تكون الآلية واضحة ومستقلة عن البيانات</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>هل التأثير ثابت عبر النتائج ذات الصلة؟</h4>
<p>إذا ظهر ضرر للوفيات، فهل هناك ضرر مماثل للاحتشاء الدماغي أو السكتة الدماغية؟</p>
</div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>هل هناك تكرار مستقل؟</h4>
<p>هل تم تأكيد تأثير المجموعة الفرعية في دراسات أخرى؟</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">تم تطبيق ICEMAN على ACCORD</h2>
<table class="results-table animate delay-1">
<thead>
<tr><th>المعيار</th><th>التقييم</th><th>النتيجة</th></tr>
</thead>
<tbody>
<tr>
<td>محددة مسبقًا؟</td>
<td>نعم - كانت أمراض القلب والأوعية الدموية السابقة في البروتوكول</td>
<td style="color: #22c55e;">✓</td>
</tr>
<tr>
<td>المنطق البيولوجي؟</td>
<td>نعم، نقص السكر في الدم أكثر خطورة مع الأمراض القلبية الوعائية</td>
<td style="color: #22c55e;">✓</td>
</tr>
<tr>
<td>نتائج متسقة؟</td>
<td>نعم - تمت محاذاة معدل الوفيات الناجمة عن السيرة الذاتية والوفيات الناجمة عن جميع الأسباب</td>
<td style="color: #22c55e;">✓</td>
</tr>
<tr>
<td>النسخ المتماثل المستقل؟</td>
<td>جزئيًا - ADVANCE، أظهر VADT أنماطًا مماثلة</td>
<td style="color: #f59e0b;">~</td>
</tr>
</tbody>
</table>
<div class="focus-box animate delay-2 mt-2">
<p class="main">تصنيف ICEMAN: مصداقية عالية</p>
<p class="sub">يبدو أن الضرر التفاضلي لدى المرضى المعرضين لمخاطر عالية حقيقي.</p>
</div>
</div>
</div>
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">الآثار السريرية</h2>
<div class="card animate delay-1">
<p class="card-text" style="font-size: 1.1rem;">
<strong>بالنسبة للمرضى الذين لا يعانون من أمراض القلب والأوعية الدموية:</strong> يظل التحكم المعتدل في الجلوكوز (نسبة HbA1c ~ 7%) هو الهدف. السيطرة المكثفة قد تقلل من مضاعفات الأوعية الدموية الدقيقة.
                  </p>
</div>
<div class="card animate delay-2">
<p class="card-text" style="font-size: 1.1rem;">
<strong>بالنسبة للمرضى الذين يعانون من أمراض القلب والأوعية الدموية المثبتة:</strong> تجنب الأهداف المكثفة. نقص السكر في الدم يشكل خطرا على القلوب المتضررة.
                  </p>
</div>
<div class="card animate delay-3">
<p class="card-text" style="font-size: 1.1rem;">
<strong>بالنسبة للمرضى المسنين:</strong> أهداف مريحة. نوعية الحياة مهمة. السيطرة الصارمة تسبب السقوط والارتباك والوفيات الزائدة.
                  </p>
</div>
<p class="footnote animate delay-4" style="font-size: 1rem; font-style: italic;">
                  العلاج "مقاس واحد يناسب الجميع" ليس دواءً يركز على المريض.
                </p>
</div>
</div>
 الانحدار التلوي 
<div class="slide light" data-index="13">
<div class="content">
<h2 class="title navy animate">الانحدار التلوي: شرح عدم التجانس</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  عندما يكون عدم التجانس مرتفعًا، يمكن للانحدار التلوي تحديد المتغيرات المشتركة على مستوى الدراسة التي تفسر التباين.
                </p>
<div class="card animate delay-2" style="margin-bottom: 1rem;">
<div class="card-label">السؤال</div>
<p class="card-text">هل يختلف حجم التأثير بشكل منهجي مع الدراسة الخصائص؟</p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value" style="font-size: 1.1rem;">المتغيرات المصاحبة</div>
<div class="stat-label">السنة، الجرعة، المدة، المخاطر الأساسية، جودة الدراسة</div>
</div>
<div class="stat-box">
<div class="stat-value" style="font-size: 1.1rem;">المخرجات</div>
<div class="stat-label">معامل الانحدار (المنحدر)، R²، عدم التجانس المتبقي</div>
</div>
</div>
<div class="focus-box animate delay-4">
<p class="main" style="color: var(--red);">الحذر</p>
<p class="sub">يتطلب الانحدار التلوي ≥10 دراسات لكل متغير مشترك. مع القليل من الدراسات، فهي استكشافية فقط. مغالطة بيئية: الارتباطات على مستوى الدراسة قد لا تنطبق على الأفراد.</p>
</div>
<p class="footnote animate delay-5" style="margin-top: 1rem;">
<strong>مثال:</strong> في ACCORD، قد يختبر الانحدار التلوي ما إذا كان تأثير العلاج يختلف حسب خط الأساس لـ HbA1c، مما يظهر الضرر يتركز في المرضى الذين يعانون من مستويات عالية جدًا.
                </p>
</div>
</div>
 القصة: ثورة ضغط الدم SPRINT 
<div class="slide dark" data-index="13b">
<div class="story-box animate">
<p class="story-opener">ما هو الرقم الذي ينقذ الأرواح؟ من يقرر؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    لعقود من الزمن، كان الهدف: علاج ضغط الدم <span class="data-highlight">&lt;140 ملم زئبق الانقباضي</span>. ثم جاء <span class="data-highlight">SPRINT (2015)</span>: <span class="data-highlight">9,361 مريضًا شديد الخطورة</span>
                    عشوائية إلى أهداف مكثفة (&lt;120) مقابل أهداف قياسية (&lt;140). تم تخفيض العلاج المكثف <span class="data-highlight">أحداث السيرة الذاتية بنسبة 25%</span> and
                    <span class="data-highlight">الوفاة بنسبة 27%</span>. توقفت المحاكمة مبكرا من أجل الفائدة. تغيرت المبادئ التوجيهية في جميع أنحاء العالم.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">قبل SPRINT: لجنة المبادئ التوجيهية</div>
<div class="decision-scenario">
                    لقد قمت بوضع إرشادات لضغط الدم في عام 2014. وكان الهدف أقل من 140 لسنوات. هل يجب عليك الانتظار للحصول على أدلة أفضل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: الحفاظ على الوضع الراهن</div>
<div class="path-choice">احتفظ بالهدف &lt;140 (الممارسة المتبعة، الحد الأدنى من الجدل)</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">المبادئ التوجيهية دون تغيير. يستمر الأطباء في العلاج إلى أقل من 140.</div>
<div class="path-outcome">النتيجة: تفويت الفرصة لمنع الوفيات</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: تمويل التجربة النهائية</div>
<div class="path-choice">انتظر نتائج SPRINT قبل تحديث الأهداف</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">SPRINT يوضح الفائدة. قم بتحديث الهدف إلى &lt;120 للمرضى المعرضين لمخاطر عالية.</div>
<div class="path-outcome">النتيجة: ما يقدر بأكثر من 100.000 حياة تم إنقاذها على مستوى العالم</div>
</div>
</div>
</div>
<div class="story-timeline">
<div class="timeline-point">JNC 7 (2003): &lt;140</div>
<div class="timeline-point critical">سنوات من عدم اليقين</div>
<div class="timeline-point resolution">SPRINT (2015): &lt;120 للحالات عالية الخطورة</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    "معيار الرعاية" غير ثابت. ويتغير عندما تتحدى التجارب الافتراضات. على مدى عقد من الزمن، ربما لم يتم علاج المرضى بشكل كاف لأنه لم يختبر أحد السؤال الواضح.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="14">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 8</h2>
<div class="quiz-container">
<div class="quiz-question" id="q8-1">
<h4>1. لماذا تم إيقاف تجربة ACCORD مبكرًا؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q8-1', 0, 1, ['Incorrect. Intensive glycemic control actually increased mortality by 22%.', 'Correct! The intensive arm had 22% higher mortality, triggering early termination.', 'Enrollment was adequate; the issue was excess mortality.', 'Budget was not the reason for early termination.'])">
<span>A.</span> أظهرت المراقبة المكثفة فائدة واضحة للقلب والأوعية الدموية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-1', 1, 1, ['Incorrect. Intensive glycemic control actually increased mortality by 22%.', 'Correct! The intensive arm had 22% higher mortality, triggering early termination.', 'Enrollment was adequate; the issue was excess mortality.', 'Budget was not the reason for early termination.'])">
<span>B.</span> أدت السيطرة المكثفة إلى زيادة معدل الوفيات
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-1', 2, 1, ['Incorrect. Intensive glycemic control actually increased mortality by 22%.', 'Correct! The intensive arm had 22% higher mortality, triggering early termination.', 'Enrollment was adequate; the issue was excess mortality.', 'Budget was not the reason for early termination.'])">
<span>C.</span> كان التسجيل بطيئًا جدًا
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-1', 3, 1, ['Incorrect. Intensive glycemic control actually increased mortality by 22%.', 'Correct! The intensive arm had 22% higher mortality, triggering early termination.', 'Enrollment was adequate; the issue was excess mortality.', 'Budget was not the reason for early termination.'])">
<span>D.</span> نفدت الميزانية
                      </div>
</div>
<div id="q8-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q8-2" style="margin-top: 1.5rem;">
<h4>2. ما الذي يخبرنا به الفاصل الزمني للتنبؤ والذي لا يخبرنا به فاصل الثقة؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q8-2', 0, 2, ['Both are estimates, but PI includes heterogeneity.', 'Sample size affects precision.', 'Correct! The prediction interval shows what effects we might see in a new setting, accounting for between-study variance.', 'The formula is indeed different.'])">
<span>A.</span> يتم تقدير التأثير الحقيقي بشكل أكثر دقة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-2', 1, 2, ['Both are estimates, but PI includes heterogeneity.', 'Sample size affects precision.', 'Correct! The prediction interval shows what effects we might see in a new setting, accounting for between-study variance.', 'The formula is indeed different.'])">
<span>B.</span> حجم العينة مناسب
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-2', 2, 2, ['Both are estimates, but PI includes heterogeneity.', 'Sample size affects precision.', 'Correct! The prediction interval shows what effects we might see in a new setting, accounting for between-study variance.', 'The formula is indeed different.'])">
<span>C.</span> نطاق التأثيرات التي نتوقعها في دراسة جديدة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-2', 3, 2, ['Both are estimates, but PI includes heterogeneity.', 'Sample size affects precision.', 'Correct! The prediction interval shows what effects we might see in a new setting, accounting for between-study variance.', 'The formula is indeed different.'])">
<span>D.</span> الصيغة الرياضية تستخدم
                      </div>
</div>
<div id="q8-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q8-3" style="margin-top: 1.5rem;">
<h4>3. وفقًا لـ ICEMAN، ما هو العامل الأكثر أهمية لمصداقية المجموعة الفرعية؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q8-3', 0, 0, ['Correct! Pre-specification protects against data dredging. All other criteria support but don\\'t replace it.', 'Sample size matters, but pre-specification is paramount.', 'P-values can be gamed.', 'Multiple outcomes can be misleading.'])">
<span>A.</span> المواصفات المسبقة لفرضية المجموعة الفرعية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-3', 1, 0, ['Correct! Pre-specification protects against data dredging. All other criteria support but don\\'t replace it.', 'Sample size matters, but pre-specification is paramount.', 'P-values can be gamed.', 'Multiple outcomes can be misleading.'])">
<span>B.</span> حجم عينة كبير في المجموعة الفرعية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-3', 2, 0, ['Correct! Pre-specification protects against data dredging. All other criteria support but don\\'t replace it.', 'Sample size matters, but pre-specification is paramount.', 'P-values can be gamed.', 'Multiple outcomes can be misleading.'])">
<span>C.</span> قيمة p ذات دلالة إحصائية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q8-3', 3, 0, ['Correct! Pre-specification protects against data dredging. All other criteria support but don\\'t replace it.', 'Sample size matters, but pre-specification is paramount.', 'P-values can be gamed.', 'Multiple outcomes can be misleading.'])">
<span>D.</span> نتائج متعددة تظهر نفس الاتجاه
                      </div>
</div>
<div id="q8-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="15">
<p class="closing-line animate">عندما تختلف الدراسات،</p>
<p class="closing-line animate delay-1">استمع إلى الخلاف.</p>
<p class="closing-line gold animate delay-2">التباين رسالة وليس ضجيج.</p>
<div class="gold-line animate delay-3"></div>
</div>
<div class="slide black" data-index="16">
<p class="refrain animate">غياب الدليل ليس دليلاً على الغياب.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 9: الدراسات المخفية</p>
</div>
</div>
 الوحدة 9: الدراسات المخفية (Reboxetine) 
<div class="module-slides" data-module="9">
<div class="slide dark active" data-index="0">
<p class="refrain animate">غياب الدليل ليس دليلاً على الغياب.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">ريبوكسيتين: 2010</p>
<p class="title gold animate delay-1 text-center">الـ 74% التي لم تر النور أبدًا.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 9: الدراسات المخفية</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تفسير المخططات القمعية لاكتشاف عدم التماثل</li>
<li>تطبيق اختبار إيجر و اختبارات إحصائية أخرى لتحيز النشر</li>
<li>تنفيذ طريقة القطع والتعبئة لتعديل التحيز</li>
<li>تقييم نقدي لقيود اختبارات تحيز النشر</li>
<li>تطبيق المبدأ: "غياب الدليل ليس دليلاً على الغياب"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">السنة: 1997</h2>
<p class="direct-address animate delay-1">
                  "أمل جديد لمرضى الاكتئاب الذين لا يستطيعون تحمل مثبطات استرداد السيروتونين الانتقائية..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    كان Reboxetine (Edronax) مضادًا جديدًا للاكتئاب - وهو مثبط انتقائي لإعادة امتصاص النوربينفرين (NRI). وعلى عكس مثبطات استرداد السيروتونين الانتقائية، فقد استهدف نظامًا مختلفًا من الناقلات العصبية. بالنسبة للمرضى الذين فشلوا أو لم يتمكنوا من تحمل فلوكستين أو سيرترالين، فقد قدم آلية جديدة.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">1997</div>
<div class="stat-label">موافقة الاتحاد الأوروبي</div>
</div>
<div class="stat-box">
<div class="stat-value">50+</div>
<div class="stat-label">البلدان المعتمدة</div>
</div>
<div class="stat-box">
<div class="stat-value">الملايين</div>
<div class="stat-label">الوصفات الطبية المكتوبة</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الأدلة المنشورة</h2>
<p class="animate delay-1" style="font-style: italic;">ما يمكن للأطباء العثور عليه في المجلات الطبية:</p>
<table class="results-table animate delay-2">
<thead>
<tr><th>مقارنة</th><th>التجارب المنشورة</th><th>النتيجة المنشورة</th></tr>
</thead>
<tbody>
<tr>
<td>ريبوكسيتين مقابل الدواء الوهمي</td>
<td>3 تجارب (العدد = 507)</td>
<td style="color: #22c55e;">أفضل بكثير (SMD = 0.56)</td>
</tr>
<tr>
<td>ريبوكسيتين مقابل SSRIs</td>
<td>4 تجارب (العدد = 628)</td>
<td style="color: #22c55e;">ما يعادل أو أفضل</td>
</tr>
</tbody>
</table>
<div class="focus-box animate delay-3 mt-2">
<p class="main">تحكي الأدبيات المنشورة قصة واضحة:</p>
<p class="sub">يعمل Reboxetine. يستفيد المرضى. يصف بثقة.</p>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<p class="rhetorical animate" style="font-size: 2rem;">
                ولكن ماذا عن التجارب التي لم تتمكن من رؤيتها؟
              </p>
<p class="animate delay-1" style="font-size: 1.3rem; margin-top: 2rem;">
                في عام 2010، قدم الباحثون الألمان في IQWiG طلبًا إلى وكالة الأدوية الأوروبية...
              </p>
<p class="animate delay-2" style="font-size: 1.3rem; margin-top: 1rem;">
                وطالبوا بالوصول إلى <strong>all</strong> التجربة البيانات - منشورة وغير منشورة.
              </p>
<p class="title gold animate delay-3" style="font-size: 2rem; margin-top: 1.5rem;">
                ما وجدوه غيَّر كل شيء.
              </p>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">الصورة الكاملة</h2>
<p class="animate delay-1" style="color: #C53030; font-weight: bold; font-style: italic;">Eyding et al., BMJ 2010</p>
<table class="results-table animate delay-2">
<thead>
<tr><th>مقارنة</th><th>تم النشر فقط</th><th>جميع البيانات</th></tr>
</thead>
<tbody>
<tr>
<td><strong>ريبوكسيتين مقابل الدواء الوهمي</strong></td>
<td style="color: #22c55e;">SMD 0.56 (فائدة)</td>
<td style="color: #C53030;"><strong>SMD 0.10 (بدون فائدة)</strong></td>
</tr>
<tr>
<td>المرضى قيد التحليل</td>
<td>507 (14%)</td>
<td><strong>2,731 (100%)</strong></td>
</tr>
<tr>
<td><strong>ريبوكسيتين مقابل SSRIs</strong></td>
<td style="color: #22c55e;">ما يعادل</td>
<td style="color: #C53030;"><strong>أدنى (RR 1.23 للضرر)</strong></td>
</tr>
<tr>
<td>المرضى قيد التحليل</td>
<td>628 (26%)</td>
<td><strong>2,411 (100%)</strong></td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3" style="background: rgba(197, 48, 48, 0.2); border-color: #C53030;">
<div class="value">لم يتم نشر 74% من بيانات المرضى مطلقًا</div>
<div class="label">لم تظهر التجارب المخفية أي فائدة وأكثر من ذلك ضرر</div>
</div>
</div>
</div>
<div class="slide dark" data-index="6">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>تمرين التحقيق: درج الملفات</h3>
</div>
<p class="direct-address">
                  أنت مراجع منهجي في عام 2008. تبحث في PubMed وEmbase ومكتبة كوكرين عن جميع تجارب الريبوكسيتين. وجدت 7 تجارب منشورة تظهر الفائدة.
                </p>
<p class="rhetorical" style="margin: 1.5rem 0;">
                  هل يمكنك الوثوق بهذا الدليل؟
                </p>
<div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 1rem;">
<button class="reveal-btn" onclick="revealAnswer('rebox-funnel')">إنشاء مخطط قمع →</button>
</div>
<div class="hidden-reveal" id="rebox-funnel">
<div id="reboxetine-funnel" style="background: white; border-radius: 8px; padding: 1rem; margin: 1rem 0;"></div>
<script>
                    // This will be called when revealed
                    setTimeout(() => {
                      if (document.getElementById('rebox-funnel').classList.contains('hidden-reveal') === false) {
                        drawReboxetineFunnel();
                      }
                    }, 100);
                  </script>
<button class="reveal-btn" onclick="drawReboxetineFunnel()" style="margin-top: 0.5rem;">مسار الرسم →</button>
<div class="focus-box" style="margin-top: 1rem; border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">⚠️ مسار التحويل غير متماثل بشكل كبير!</p>
<p class="sub">جميع الدراسات المنشورة تتجمع في جانب واحد. أين التجارب الفارغة والسلبية؟</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">مجموعة أدوات تحيز النشر</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>مخطط القمع</h4>
<p>حجم تأثير المؤامرة مقابل الخطأ القياسي. يشير القمع المتماثل إلى عدم وجود أي تحيز؛ عدم التماثل يثير الإنذارات.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>اختبار انحدار إيجر</h4>
<p>تأثير الانحدار/SE على 1/SE. يشير التقاطع غير الصفري (P &lt;0.10) إلى تأثيرات دراسة صغيرة. ملاحظة: تضخم معدل الإيجابية الكاذبة مع النتائج الثنائية؛ استخدم اختبار بيترز بدلاً من ذلك.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>اختبار بيترز</h4>
<p>بالنسبة للنتائج الثنائية، سجل التراجعات أو على عكس إجمالي حجم العينة. أقل عرضة للإيجابيات الكاذبة.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>تقليم وملء</h4>
<p>تحسب الدراسات "المفقودة" لجعل مسار التحويل متماثلًا، ثم تعيد حساب التأثير المجمع.</p>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="8">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">📊</span>
<h3>تفاعلية: القطع والتعبئة التحليل</h3>
</div>
<p class="direct-address">
                  دعونا نطبق القطع والتعبئة على بيانات reboxetine ونرى ما سيكون عليه التقدير المعدل...
                </p>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">تم النشر فقط</h4>
<p>7 تجارب</p>
<p style="font-size: 1.2rem; font-weight: bold; color: #22c55e;">SMD = 0.56</p>
<p style="font-size: 0.9rem;">فائدة كبيرة</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">تقليم وملء</h4>
<p>7 + 5 محسوبة = 12 تجربة</p>
<p style="font-size: 1.2rem; font-weight: bold; color: #f59e0b;">SMD = 0.23</p>
<p style="font-size: 0.9rem;">منخفضة، لا تزال ذات أهمية اسمية</p>
</div>
</div>
<div class="focus-box" style="margin-top: 1rem; border-color: #C53030;">
<p class="main" style="color: #C53030;">ولكن حتى التشذيب والملء قلل من أهمية المشكلة!</p>
<p class="sub">التأثير الحقيقي مع جميع البيانات هو SMD = 0.10 (فارغ في الأساس).<br/>يعد الاقتطاع والتعبئة أمرًا متحفظًا — فهو لا يصحح بشكل كامل للنشر الانتقائي.</p>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">أفضل دفاع: سجلات المحاكمة</h2>
<p class="animate delay-1">طرق اكتشاف تحيز النشر غير كاملة. الحل الحقيقي هو <strong>التسجيل المحتمل</strong>.</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">ClinicalTrials.gov</div>
<div class="stat-label">السجل الأمريكي (2000)</div>
</div>
<div class="stat-box">
<div class="stat-value">منظمة الصحة العالمية ICTRP</div>
<div class="stat-label">البوابة العالمية</div>
</div>
<div class="stat-box">
<div class="stat-value">بروسبيرو</div>
<div class="stat-label">مراجعة التسجيل</div>
</div>
</div>
<div class="card animate delay-3">
<p class="card-text">
                    عند البحث عن التجارب، تحقق دائمًا من السجلات. قارن عدد <strong>مسجل</strong> المحاولات بالرقم <strong>منشور</strong>. هذه الفجوة هي إشارة التحذير الخاصة بك.
                  </p>
</div>
<p class="footnote animate delay-4">
                  منذ عام 2005، يتطلب ICMJE التسجيل التجريبي كشرط للنشر.
                </p>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">حملة AllTrials</h2>
<div class="card animate delay-1">
<p class="card-text" style="font-size: 1.2rem; text-align: center;">
<strong>"تم تسجيل جميع التجارب. تم الإبلاغ عن جميع النتائج."</strong>
</p>
</div>
<p class="animate delay-2" style="margin-top: 1rem;">
                  فضيحة الريبوكسيتين، إلى جانب حالات مماثلة في أدوية أخرى، حفزت حركة عالمية:
                </p>
<div class="lesson-item animate delay-3">
<div class="lesson-number">✓</div>
<div class="lesson-content">
<h4>2013: سياسة البيانات السريرية لوكالة الأدوية الأوروبية</h4>
<p>تلتزم وكالة الأدوية الأوروبية بنشر تقارير الدراسات السريرية</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">✓</div>
<div class="lesson-content">
<h4>2016: إنفاذ قانون تعديلات إدارة الغذاء والدواء</h4>
<p>الإبلاغ عن النتائج الإلزامية على موقع ClinicalTrials.gov في غضون 12 شهرًا</p>
</div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number">✓</div>
<div class="lesson-content">
<h4>تحالف AllTrials</h4>
<p>أكثر من 90.000 مؤيد وأكثر من 700 منظمة تطالب بالشفافية</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">الريبوكسيتين</h2>
<div class="wrong-item animate delay-1">
<div class="wrong-number" style="background: #C53030;">!</div>
<p>ألمانيا أوصى IQWiG ضد الريبوكستين لعلاج الاكتئاب</p>
</div>
<div class="wrong-item animate delay-2">
<div class="wrong-number" style="background: #C53030;">!</div>
<p>خفضت NICE في المملكة المتحدة تصنيفه إلى "غير مستحسن"</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number" style="background: #C53030;">!</div>
<p>رفضت إدارة الغذاء والدواء عقار الريبوكستين في عام 2001 (كان لديهم إمكانية الوصول إلى بيانات غير منشورة)</p>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">لأكثر من عقد من الزمان، تلقى المرضى دواءً ليس أفضل من الدواء الوهمي.</p>
<p class="sub">لأنه تم نشر التجارب الإيجابية فقط.</p>
</div>
</div>
</div>
 القصة: الخداع في دراسة الباروكستين 329 
<div class="slide dark" data-index="11b">
<div class="story-box animate">
<p class="story-opener">ماذا لو كان الاستنتاج المنشور هو عكس البيانات الفعلية؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    دراسة جلاكسو سميث كلاين 329 اختبار الباروكستين في <span class="data-highlight">اكتئاب المراهقين</span>. خلصت الورقة المنشورة (2001) إلى أن الباروكستين كان <span class="data-highlight">"جيد التحمل وفعال بشكل عام". فشل</span>
                    البيانات الفعلية: الباروكستين <span class="data-highlight">في جميع النتائج الثمانية المحددة مسبقًا</span>. عند إعادة التحليل (RIAT 2015)، أحداث الانتحار/إيذاء النفس: <span class="data-highlight">23 في مجموعة الباروكستين مقابل 5 في العلاج الوهمي</span>. أعادت الورقة المنشورة تحديد النتائج اللاحقة لتصنيع الأهمية. في عام 2015، تم إعادة تحليل RIAT (استعادة التجارب غير المرئية والمهجورة) باستخدام <span class="data-highlight">تقرير الدراسة السريرية الأصلي</span>
                    وخلص إلى أن الباروكستين كان <span class="data-highlight">ليست آمنة ولا فعالة</span> للمراهقين.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">لغز واضع الوصفات: 2003</div>
<div class="decision-scenario">
                    أنت طبيب نفسي للأطفال. تقول الدراسة رقم 329 - وهي التجربة الكبيرة الوحيدة - إن الباروكستين يعمل لدى المراهقين. لكن إدارة الغذاء والدواء الأمريكية لم توافق عليه للمراهقين. يطلب منك أحد الوالدين وصفه. ماذا تفعل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: ثق بالمنشور</div>
<div class="path-choice">تشير ورقة JAACAP التي تمت مراجعتها من قبل النظراء إلى أنها فعالة. يصف خارج التسمية.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">ملايين الوصفات الطبية في جميع أنحاء العالم. الأحداث الانتحارية عند المراهقين.</div>
<div class="path-outcome">النتيجة: أصدرت إدارة الغذاء والدواء تحذيرًا من الصندوق الأسود لمثبطات استرداد السيروتونين الانتقائية في الشباب (2004)</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: التحقق من سجل التجارب</div>
<div class="path-choice">ابحث في ClinicalTrials.gov عن نقاط النهاية الأصلية. لاحظ أن النتائج المنشورة لا تتطابق مع البروتوكول المسجل.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">علامة حمراء: تم اكتشاف تبديل النتائج. أنت تحجب الدواء. أصبح المريض أكثر أمانًا.</div>
<div class="path-outcome">النتيجة: تحديد تحيز النشر قبل الضرر</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    لا يقتصر تحيز النشر على الدراسات المفقودة فقط. يتعلق الأمر بفقدان الحقيقة في الدراسات المنشورة. يمكن أن يؤدي تبديل النتائج والكتابة الشبحية والتقارير الانتقائية إلى تحويل التجربة الفاشلة إلى أداة تسويقية. قم دائمًا بمقارنة النتائج المنشورة ببروتوكولات التسجيل التجريبية.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 9</h2>
<div class="quiz-container">
<div class="quiz-question" id="q9-1">
<h4>1. ما هي النسبة المئوية لبيانات تجربة الريبوكسيتين التي تم إخفاؤها من الأدبيات المنشورة؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q9-1', 0, 2, ['Some data was hidden but much less.', 'About half was hidden.', 'Correct! 74% of patient data was in unpublished trials.', 'A larger fraction was hidden.'])">
<span>A.</span> 25%
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-1', 1, 2, ['Some data was hidden but much less.', 'About half was hidden.', 'Correct! 74% of patient data was in unpublished trials.', 'A larger fraction was hidden.'])">
<span>B.</span> 50%
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-1', 2, 2, ['Some data was hidden but much less.', 'About half was hidden.', 'Correct! 74% of patient data was in unpublished trials.', 'A larger fraction was hidden.'])">
<span>C.</span> 74%
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-1', 3, 2, ['Some data was hidden but much less.', 'About half was hidden.', 'Correct! 74% of patient data was in unpublished trials.', 'A larger fraction was hidden.'])">
<span>D.</span> 90%
                      </div>
</div>
<div id="q9-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q9-2" style="margin-top: 1.5rem;">
<h4>2. لماذا يمكن أن يقلل القص والملء من التصحيح المطلوب؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q9-2', 0, 1, ['Trim-and-fill does not require normality.', 'Correct! It estimates missing studies but makes assumptions that may not hold when publication bias is severe.', 'Funnel plots can work with fewer studies.', 'More studies generally help.'])">
<span>A.</span> ويفترض أن التأثيرات موزعة بشكل طبيعي
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-2', 1, 1, ['Trim-and-fill does not require normality.', 'Correct! It estimates missing studies but makes assumptions that may not hold when publication bias is severe.', 'Funnel plots can work with fewer studies.', 'More studies generally help.'])">
<span>B.</span> إنها تنسب فقط الدراسات لتحقيق التماثل، والتي قد لا تعكس الواقع بشكل كامل
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-2', 2, 1, ['Trim-and-fill does not require normality.', 'Correct! It estimates missing studies but makes assumptions that may not hold when publication bias is severe.', 'Funnel plots can work with fewer studies.', 'More studies generally help.'])">
<span>C.</span> يتطلب 20 دراسة على الأقل
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-2', 3, 1, ['Trim-and-fill does not require normality.', 'Correct! It estimates missing studies but makes assumptions that may not hold when publication bias is severe.', 'Funnel plots can work with fewer studies.', 'More studies generally help.'])">
<span>D.</span> إنها تعمل فقط مع دراسات كبيرة جدًا
                      </div>
</div>
<div id="q9-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q9-3" style="margin-top: 1.5rem;">
<h4>3. ما هو أفضل دفاع محتمل ضد تحيز النشر؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q9-3', 0, 2, ['Funnel plots detect, not prevent, bias.', 'Egger\\'s test detects, not prevents.', 'Correct! Registering all trials upfront ensures we know what exists, even if not all are published.', 'More journals doesn\\'t ensure negative trials get published.'])">
<span>A.</span> المخططات القمعية في جميع التحليلات التلوية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-3', 1, 2, ['Funnel plots detect, not prevent, bias.', 'Egger\\'s test detects, not prevents.', 'Correct! Registering all trials upfront ensures we know what exists, even if not all are published.', 'More journals doesn\\'t ensure negative trials get published.'])">
<span>B.</span> اختبار إيجر قبل التجميع
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-3', 2, 2, ['Funnel plots detect, not prevent, bias.', 'Egger\\'s test detects, not prevents.', 'Correct! Registering all trials upfront ensures we know what exists, even if not all are published.', 'More journals doesn\\'t ensure negative trials get published.'])">
<span>C.</span> تسجيل التجارب المحتملة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q9-3', 3, 2, ['Funnel plots detect, not prevent, bias.', 'Egger\\'s test detects, not prevents.', 'Correct! Registering all trials upfront ensures we know what exists, even if not all are published.', 'More journals doesn\\'t ensure negative trials get published.'])">
<span>D.</span> قد يكون المزيد من المجلات الطبية
                      </div>
</div>
<div id="q9-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="13">
<p class="closing-line animate">ما لا يمكنك فعله راجع</p>
<p class="closing-line animate delay-1">أكثر أهمية مما تستطيع.</p>
<p class="closing-line gold animate delay-2">غياب الدليل ليس دليلاً على الغياب.</p>
<div class="gold-line animate delay-3"></div>
</div>
<div class="slide black" data-index="14">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 10: اليقين</p>
</div>
</div>
 الوحدة 10: اليقين (الفاعل بالسطح المبكر) 
<div class="module-slides" data-module="10">
<div class="slide dark active" data-index="0">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">الفاعل بالسطح المبكر: 2012</p>
<p class="title gold animate delay-1 text-center">عندما تتطور الأدلة عالية الجودة.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 10: اليقين</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تطبيق إطار GRADE الكامل لتقييم اليقين الدليل</li>
<li>تقييم جميع عوامل التخفيض الخمسة (RoB، عدم الاتساق، عدم المباشرة، عدم الدقة، تحيز النشر)</li>
<li>تحديد متى يجب الترقية للتأثير الكبير، أو الاستجابة للجرعة، أو الإرباك</li>
<li>إنشاء ملخص جداول النتائج مع تقديرات التأثير المطلق</li>
<li>تطبيق المبدأ: "يجب اكتساب اليقين، وليس افتراضه"</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">العام: التسعينيات</h2>
<p class="direct-address animate delay-1">
                  "ثورة في رعاية الأطفال حديثي الولادة..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    كانت متلازمة الضائقة التنفسية (RDS) هي السبب الرئيسي للوفاة بين الأطفال الخدج. كان تطوير المادة الخارجية <strong>مادة خافضة للتوتر السطحي</strong>— وهي المادة التي تحافظ على الحويصلات الهوائية من الانهيار — واحدًا من التقدم الكبير في طب الأطفال حديثي الولادة.
                  </p>
</div>
<div class="focus-box animate delay-3 mt-2">
<p class="main">أصبح السؤال: متى يجب أن نعطي الفاعل بالسطح؟</p>
<p class="sub">وقائيًا (لجميع الرضع المعرضين لمخاطر عالية) أم بشكل انتقائي (فقط بعد تطور متلازمة الضائقة التنفسية)؟</p>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">مراجعة كوكرين الأصلية (2003)</h2>
<p class="animate delay-1" style="font-style: italic;">أجريت تجارب معشاة ذات شواهد متعددة قبل عصر CPAP الروتيني</p>
<table class="results-table animate delay-2">
<thead>
<tr><th>حصيلة</th><th>وقائي مقابل انتقائي</th><th>يقين</th></tr>
</thead>
<tbody>
<tr>
<td>وفيات الأطفال حديثي الولادة</td>
<td style="color: #22c55e;">RR 0.73 (يفضل وقائي)</td>
<td>High</td>
</tr>
<tr>
<td>اضطراب الشخصية الحدية أو الوفاة</td>
<td style="color: #22c55e;">RR 0.84 (يفضل وقائي)</td>
<td>High</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3">
<div class="value">توصية: إعطاء الفاعل بالسطح بشكل وقائي</div>
<div class="label">اعتمدت المبادئ التوجيهية في جميع أنحاء العالم هذا النهج</div>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<p class="rhetorical animate" style="font-size: 2rem;">
                لكن عالم رعاية الأطفال حديثي الولادة كان يتغير...
              </p>
<p class="animate delay-1" style="font-size: 1.3rem; margin-top: 2rem;">
                ظهرت تقنية جديدة: <strong>ضغط مجرى الهواء الإيجابي المستمر (CPAP)</strong>
</p>
<p class="animate delay-2" style="font-size: 1.3rem; margin-top: 1rem;">
                دعم غير جراحي يمكن أن يساعد الرئتين المبتسرين دون التنبيب.
              </p>
<p class="title gold animate delay-3" style="font-size: 1.5rem; margin-top: 1.5rem;">
                هل ستظل الأدلة القديمة سارية؟
              </p>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">تحديث كوكرين لعام 2012</h2>
<p class="animate delay-1" style="color: #C53030; font-weight: bold;">تجارب جديدة أجريت في عصر CPAP</p>
<table class="results-table animate delay-2">
<thead>
<tr><th>حصيلة</th><th>تجارب قديمة</th><th>تجارب جديدة</th></tr>
</thead>
<tbody>
<tr>
<td>اضطراب الشخصية الحدية أو الوفاة</td>
<td style="color: #22c55e;">RR 0.84 (يفضل وقائي)</td>
<td style="color: #C53030;">RR 1.12 (تفضيلات انتقائية)</td>
</tr>
<tr>
<td>الحاجة إلى إصلاحات ميكانيكية التهوية</td>
<td style="color: #22c55e;">السفلى مع وقائي</td>
<td style="color: #C53030;">أعلى مع وقائي!</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3" style="background: rgba(197, 48, 48, 0.2); border-color: #C53030;">
<div class="value">الانعكاس الكامل</div>
<div class="label">في عصر جهاز CPAP، يسبب الفاعل بالسطح الوقائي مزيدًا من الضرر</div>
</div>
</div>
</div>
<div class="slide dark" data-index="6">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>التحقيق: لماذا تطورت الأدلة؟</h3>
</div>
<p class="direct-address">
                  أنت طبيب حديثي الولادة. يسأل أحد الزملاء: "كيف يمكن للتجارب العشوائية أن تتناقض مع بعضها البعض؟"
                </p>
<p class="rhetorical" style="margin: 1rem 0;">
                  هل كان الدليل الأصلي خاطئًا؟
                </p>
<button class="reveal-btn" onclick="revealAnswer('surfactant-explain')">فهم التطور →</button>
<div class="hidden-reveal" id="surfactant-explain">
<div class="lesson-item" style="margin-top: 1rem;">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>تغيرت غير المباشرة</h4>
<p>التجارب القديمة: لا يتوفر جهاز CPAP. تجارب جديدة: معيار رعاية CPAP.</p>
</div>
</div>
<div class="lesson-item">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>تحسين المقارنة</h4>
<p>الفاعل بالسطح الانتقائي + CPAP أفضل من التنبيب الوقائي.</p>
</div>
</div>
<div class="lesson-item">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>مسائل السياق</h4>
<p>قد لا تنطبق الأدلة من عصر واحد على آخر.</p>
</div>
</div>
<div class="focus-box" style="margin-top: 1rem; border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">ولهذا السبب يقوم GRADE بتقييم عدم المباشرة!</p>
<p class="sub">قد تصبح الأدلة عالية الجودة غير قابلة للتطبيق عندما يتغير السياق.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">إطار عمل GRADE</h2>
<p class="animate delay-1" style="margin-bottom: 1rem; font-style: italic;">
                  تصنيف التوصيات والتقييم والتطوير والتقييمات
                </p>
<p class="animate delay-2">GRADE يجيب على السؤال: <strong>ما مدى ثقتنا في هذا التقدير؟</strong></p>
<div class="animate delay-3" style="max-width: 700px;">
<div class="card" style="background: rgba(34,197,94,0.15); border-right: 4px solid #22c55e;">
<p class="card-text"><strong>⊕⊕⊕⊕ مرتفع:</strong> واثق جدا. التأثير الحقيقي قريب من التقدير.</p>
</div>
<div class="card" style="background: rgba(59,130,246,0.15); border-right: 4px solid #3b82f6; margin-top: 0.5rem;">
<p class="card-text"><strong>⊕⊕⊕◯ متوسط:</strong> واثق إلى حد ما. من المحتمل أن يكون التأثير الحقيقي قريبًا، ولكنه قد يختلف بشكل كبير.</p>
</div>
<div class="card" style="background: rgba(245,158,11,0.15); border-right: 4px solid #f59e0b; margin-top: 0.5rem;">
<p class="card-text"><strong>⊕⊕◯◯ منخفض:</strong> ثقة محدودة. قد يختلف التأثير الحقيقي بشكل كبير.</p>
</div>
<div class="card" style="background: rgba(197,48,48,0.15); border-right: 4px solid #C53030; margin-top: 0.5rem;">
<p class="card-text"><strong>⊕◯◯◯ منخفض جدًا:</strong> ثقة قليلة جدًا. من المحتمل أن يكون التأثير الحقيقي مختلفًا إلى حد كبير.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">الدرجة: العوامل التي تقلل من درجة اليقين</h2>
<p class="animate delay-1">تبدأ أدلة RCT عند المستوى العالي. يمكن تخفيض تصنيفها إلى ما يلي:</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #C53030;">1</div>
<div class="lesson-content">
<h4>خطر التحيز</h4>
<p>التوزيع العشوائي المعيب، ونقص التعمية، والمتابعة غير الكاملة، والتقارير الانتقائية</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #C53030;">2</div>
<div class="lesson-content">
<h4>التناقض</h4>
<p>عدم التجانس غير المبرر عبر الدراسات (I² كبير، CIs غير متداخلة)</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #C53030;">3</div>
<div class="lesson-content">
<h4>عدم المباشرة</h4>
<p>الاختلافات في عدد السكان أو التدخل أو المقارنة أو النتائج من السؤال</p>
</div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number" style="background: #C53030;">4</div>
<div class="lesson-content">
<h4>عدم الدقة</h4>
<p>فترات ثقة واسعة، حجم عينة صغير، أحداث قليلة</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">الدرجة: العامل الخامس</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number" style="background: #C53030;">5</div>
<div class="lesson-content">
<h4>انحياز النشر</h4>
<p>مؤامرة قمع غير متماثلة، تجارب مسجلة مفقودة، تأثير الراعي</p>
</div>
</div>
<div class="focus-box animate delay-2 mt-2">
<p class="main">يمكن تخفيض كل عامل بمقدار مستوى واحد أو مستويين</p>
<p class="sub">مرتفع → معتدل → منخفض → منخفض جدًا</p>
</div>
<div class="card animate delay-3" style="margin-top: 1rem;">
<p class="card-text">
<strong>مثال:</strong> تحليل تلوي للتجارب المعشاة ذات الشواهد (يبدأ مرتفعًا) مع ارتفاع خطر التحيز (↓1) وعدم المباشرة الخطيرة (↓1) سيتم تصنيفها <strong>LOW</strong>.
                  </p>
</div>
</div>
</div>
<div class="slide dark" data-index="10">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">📊</span>
<h3>تفاعلي: قم بتطبيق GRADE على الفاعل بالسطح</h3>
</div>
<p class="direct-address">
                  دعونا نقيم مدى يقين الأدلة الخاصة بالفاعل بالسطح الوقائي باستخدام التجارب القديمة مقابل التجارب الجديدة.
                </p>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">التجارب القديمة (ما قبل CPAP)</h4>
<p><strong>البداية:</strong> عالية (المضبوطة)</p>
<p><strong>خطر التحيز:</strong> منخفض (−0)</p>
<p><strong>التناقض:</strong> لا شيء (−0)</p>
<p><strong>عدم المباشرة:</strong> جدي (−1)</p>
<p style="font-size: 0.85rem; color: #f59e0b;">معايير رعاية مختلفة اليوم</p>
<p><strong>نهائي:</strong> ⊕⊕⊕◯ معتدل</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">تجارب جديدة (عصر CPAP)</h4>
<p><strong>البداية:</strong> عالية (المضبوطة)</p>
<p><strong>خطر التحيز:</strong> منخفض (−0)</p>
<p><strong>التناقض:</strong> لا شيء (−0)</p>
<p><strong>عدم المباشرة:</strong> لا شيء (−0)</p>
<p style="font-size: 0.85rem; color: #22c55e;">تتطابق مع الممارسة الحالية</p>
<p><strong>نهائي:</strong> ⊕⊕⊕⊕ مرتفع</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">الدرجة: العوامل التي تعمل على تحسين اليقين</h2>
<p class="animate delay-1">تبدأ الأدلة الرصدية عند LOW. يمكن ترقيتها لـ:</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #22c55e;">+1</div>
<div class="lesson-content">
<h4>حجم كبير من التأثير</h4>
<p>RR &gt;2 أو &lt;0.5 بدون أي إرباك معقول</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #22c55e;">+1</div>
<div class="lesson-content">
<h4>تدرج الاستجابة للجرعة</h4>
<p>تعرض أعلى = تأثير أكبر في نمط ثابت</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #22c55e;">+1</div>
<div class="lesson-content">
<h4>الإرباك المتبقي</h4>
<p>جميع الإرباكات المعقولة من شأنها أن تقلل من التأثير (تقوي الاستدلال السببي)</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">توصيل اليقين</h2>
<p class="animate delay-1">يتطلب GRADE لغة شفافة حول الثقة:</p>
<div class="card animate delay-2">
<p class="card-text"><strong>عالي:</strong> "الفاعل بالسطح الوقائي <em>يقلل من وفيات</em> ..."</p>
</div>
<div class="card animate delay-3">
<p class="card-text"><strong>معتدل:</strong> "الفاعل بالسطح الوقائي <em>ربما يقلل</em> ..."</p>
</div>
<div class="card animate delay-4">
<p class="card-text"><strong>LOW:</strong> "الفاعل بالسطح الوقائي <em>قد يقلل</em> ..."</p>
</div>
<div class="card animate delay-5">
<p class="card-text"><strong>منخفض جدًا:</strong> "نحن <em>غير متأكد ما إذا كان</em> الفاعل بالسطح الوقائي يقلل معدل الوفيات..."</p>
</div>
<p class="footnote animate delay-6">
                  تضمن هذه اللغة فهم الأطباء لقوة الأدلة.
                </p>
</div>
</div>
 القصة: مفارقة الأكسجين عند الأطفال المبتسرين 
<div class="slide dark" data-index="12b">
<div class="story-box animate">
<p class="story-opener">هل يمكن أن يصبح الكثير من المنقذ قاتلاً؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
<span class="data-highlight">1940s-50s:</span> أنقذت تركيزات الأكسجين العالية الأطفال المبتسرين من فشل الجهاز التنفسي. ثم جاء <span class="data-highlight">وباء العمى</span>— التنسج الليفي القهقري (يسمى الآن ROP). الأطباء <span class="data-highlight">خفضوا الأكسجين بشكل كبير</span>. انخفض العمى. ولكن بعد ذلك: <span class="data-highlight">زيادة الوفيات وتلف الدماغ</span> من نقص الأكسجة. مستوى الأكسجين الأمثل المطلوب <span class="data-highlight">عقود من التجارب</span> للعثور على. أخيرًا حددت تجارب SUPPORT/BOOST II النافذة العلاجية: SpO2 <span class="data-highlight">91-95%</span>.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">معضلة طبيب حديثي الولادة: 1955</div>
<div class="decision-scenario">
                    أنت طبيب حديثي الولادة. الأطفال الخدج الذين يعانون من نسبة عالية من الأكسجين يصابون بالعمى. ماذا تفعل؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: التخفيض الدراماتيكي</div>
<div class="path-choice">تقليل الأكسجين بشكل كبير لمنع العمى</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">انخفاض معدلات العمى. لكن بعض الأطفال يموتون أو يعانون من تلف في الدماغ بسبب نقص الأكسجة.</div>
<div class="path-outcome">النتيجة: مقايضة ضرر بآخر</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: دراسة منهجية</div>
<div class="path-choice">معايرة الأكسجين بعناية، ودراسة العلاقة بين الجرعة والاستجابة</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">يستغرق عقودًا من الزمن ولكنه يحدد في النهاية النطاق الأمثل.</div>
<div class="path-outcome">النتيجة: تحسين البقاء والرؤية</div>
</div>
</div>
</div>
<div class="story-timeline">
<div class="timeline-point">الأربعينيات: ارتفاع الأكسجين ينقذ الأرواح</div>
<div class="timeline-point critical">الخمسينيات: وباء العمى</div>
<div class="timeline-point critical">من الستينيات إلى السبعينيات: الوفيات الناجمة عن انخفاض الأكسجين</div>
<div class="timeline-point resolution">2010: الدعم/التعزيز يحدد النطاق الأمثل</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    كل تدخل له نافذة علاجية. فالعثور عليه يتطلب القياس وليس الافتراض. لقد تأرجح البندول لمدة 60 عامًا قبل أن تحدد الأدلة التوازن.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="13">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 10</h2>
<div class="quiz-container">
<div class="quiz-question" id="q10-1">
<h4>1. لماذا تم عكس توصية الفاعل بالسطح بين عامي 2003 و2012؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q10-1', 0, 1, ['The original trials were well-conducted.', 'Correct! CPAP changed the standard of care, making old evidence indirect.', 'Sample size was adequate.', 'The outcome definition stayed the same.'])">
<span>A.</span> كانت التجارب الأصلية احتيالية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-1', 1, 1, ['The original trials were well-conducted.', 'Correct! CPAP changed the standard of care, making old evidence indirect.', 'Sample size was adequate.', 'The outcome definition stayed the same.'])">
<span>B.</span> غيّر CPAP المقارنة (غير مباشر)
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-1', 2, 1, ['The original trials were well-conducted.', 'Correct! CPAP changed the standard of care, making old evidence indirect.', 'Sample size was adequate.', 'The outcome definition stayed the same.'])">
<span>C.</span> لا يوجد عدد كافٍ من المرضى في التجارب الأصلية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-1', 3, 1, ['The original trials were well-conducted.', 'Correct! CPAP changed the standard of care, making old evidence indirect.', 'Sample size was adequate.', 'The outcome definition stayed the same.'])">
<span>D.</span> تم قياس النتيجة بشكل مختلف
                      </div>
</div>
<div id="q10-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q10-2" style="margin-top: 1.5rem;">
<h4>2. أي مما يلي لا يعد عامل تخفيض درجة؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q10-2', 0, 3, ['Risk of bias downgrades certainty.', 'Imprecision downgrades certainty.', 'Publication bias downgrades certainty.', 'Correct! Large effect is an upgrade factor for observational studies, not a downgrade factor.'])">
<span>A.</span> خطر التحيز
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-2', 1, 3, ['Risk of bias downgrades certainty.', 'Imprecision downgrades certainty.', 'Publication bias downgrades certainty.', 'Correct! Large effect is an upgrade factor for observational studies, not a downgrade factor.'])">
<span>B.</span> عدم الدقة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-2', 2, 3, ['Risk of bias downgrades certainty.', 'Imprecision downgrades certainty.', 'Publication bias downgrades certainty.', 'Correct! Large effect is an upgrade factor for observational studies, not a downgrade factor.'])">
<span>C.</span> تحيز النشر
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q10-2', 3, 3, ['Risk of bias downgrades certainty.', 'Imprecision downgrades certainty.', 'Publication bias downgrades certainty.', 'Correct! Large effect is an upgrade factor for observational studies, not a downgrade factor.'])">
<span>D.</span> حجم كبير من التأثير
                      </div>
</div>
<div id="q10-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q10-3" style="margin-top: 1.5rem;">
<h4>3. ما اللغة التي يجب استخدامها لأدلة اليقين المنخفضة؟</h4>
<div class="quiz-options">
<div '\"probably="" '\"uncertain\"="" 'correct!="" \"may="" class="quiz-option" confidence.',="" confidence.'])"="" for="" high="" implies="" is="" low="" moderate="" onclick="checkQuizAnswer('q10-3', 0, 2, ['\" reduce\"="" reduces\"="" signals="" very="">
<span>A.</span> "التدخل يقلل..."
                      </div>
<div '\"probably="" '\"uncertain\"="" 'correct!="" \"may="" class="quiz-option" confidence.',="" confidence.'])"="" for="" high="" implies="" is="" low="" moderate="" onclick="checkQuizAnswer('q10-3', 1, 2, ['\" reduce\"="" reduces\"="" signals="" very="">
<span>B.</span> "من المحتمل أن التدخل يقلل..."
                      </div>
<div '\"probably="" '\"uncertain\"="" 'correct!="" \"may="" class="quiz-option" confidence.',="" confidence.'])"="" for="" high="" implies="" is="" low="" moderate="" onclick="checkQuizAnswer('q10-3', 2, 2, ['\" reduce\"="" reduces\"="" signals="" very="">
<span>C.</span> "التدخل قد يقلل..."
                      </div>
<div '\"probably="" '\"uncertain\"="" 'correct!="" \"may="" class="quiz-option" confidence.',="" confidence.'])"="" for="" high="" implies="" is="" low="" moderate="" onclick="checkQuizAnswer('q10-3', 3, 2, ['\" reduce\"="" reduces\"="" signals="" very="">
<span>D.</span> "نحن غير متأكدين سواء..."
                      </div>
</div>
<div id="q10-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="14">
<p class="closing-line animate">الرقم ليس كافيًا.</p>
<p class="closing-line animate delay-1">يجب عليك التعبير عن مدى تأكدك.</p>
<p class="closing-line gold animate delay-2">يجب اكتساب اليقين وليس افتراضه.</p>
<div class="gold-line animate delay-3"></div>
</div>
<div class="slide black" data-index="15">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 11: المراجعة الحية</p>
</div>
</div>
 الوحدة 11: المراجعة الحية (COVID-19) 
<div class="module-slides" data-module="11">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">كوفيد-19 هيدروكسي كلوروكين: 2020</p>
<p class="title gold animate delay-1 text-center">عند تلبية الضرورة الملحة للأدلة.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 11: المراجعة الحية</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تطبيق التحليل التسلسلي التجريبي لتحديد متى تكون الأدلة كافية</li>
<li>تصميم مراجعة منهجية حية والحفاظ عليها</li>
<li>إنشاء مشغلات التحديث وحدود العبث/الضرر</li>
<li>إدارة التعددية وإنفاق ألفا في التحليلات المتسلسلة</li>
<li>اشرح كيف تطور التوليف السريع للأدلة خلال كوفيد-19</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">مارس 2020: عالم في أزمة</h2>
<p class="direct-address animate delay-1">
                  "ينتشر الفيروس بشكل أسرع من انتشارنا فهم..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    كان فيروس كورونا (COVID-19) يقتل الآلاف. امتلأت وحدات العناية المركزة. ولم يكن هناك لقاح ولا علاج. ثم بصيص من الأمل: <strong>أظهر هيدروكسي كلوروكين (HCQ)</strong>- وهو دواء قديم للملاريا - نشاطًا مضادًا للفيروسات في الدراسات المعملية.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">مارس 20</div>
<div class="stat-label">دراسة غوتريت (فرنسا)</div>
</div>
<div class="stat-box">
<div class="stat-value">36 نقطة</div>
<div class="stat-label">غير عشوائية</div>
</div>
<div class="stat-box">
<div class="stat-value">الفيروسي</div>
<div class="stat-label">تحسين التخليص</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">التعجل للتبني</h2>
<p class="animate delay-1" style="font-style: italic;">في غضون أسابيع من دراسة غوتريت:</p>
<div class="wrong-item animate delay-2">
<div class="wrong-number" style="background: #f59e0b;">!</div>
<p><strong>28 مارس:</strong> تصدر إدارة الغذاء والدواء الأمريكية ترخيص الاستخدام في حالات الطوارئ لـ HCQ</p>
</div>
<div class="wrong-item animate delay-3">
<div class="wrong-number" style="background: #f59e0b;">!</div>
<p><strong>4 أبريل:</strong> الهند تحظر تصدير HCQ (مخاوف من الاكتناز)</p>
</div>
<div class="wrong-item animate delay-4">
<div class="wrong-number" style="background: #f59e0b;">!</div>
<p><strong>عالمي:</strong> يؤثر النقص على مرضى الذئبة والتهاب المفاصل الروماتويدي</p>
</div>
<div class="focus-box animate delay-5 mt-2" style="border-color: #f59e0b;">
<p class="main" style="color: #f59e0b;">تلقى الملايين HCQ بناءً على دراسة مراقبة أجريت على 36 مريضًا</p>
<p class="sub">ما الخطأ الذي يمكن أن يحدث؟</p>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>التحقيق: غوتريت الدراسة</h3>
</div>
<p class="direct-address">
                  أنت أحد خبراء EBM المطلوب منك تقييم دراسة HCQ الفرنسية. فحص التصميم...
                </p>
<button class="reveal-btn" onclick="revealAnswer('hcq-flaws')">تحديد العيوب →</button>
<div class="hidden-reveal" id="hcq-flaws">
<table class="data-table-investigation" style="margin-top: 1rem;">
<thead><tr><th>المشكلة</th><th>تأثير</th></tr></thead>
<tbody>
<tr><td><strong>غير عشوائية</strong></td><td>تحيز الاختيار – من حصل على HCQ؟</td></tr>
<tr><td><strong>تم استبعاد 6 مرضى</strong></td><td>ذهب 3 إلى وحدة العناية المركزة، وتوفي واحد، وانسحب واحد، وأصيب واحد بالغثيان</td></tr>
<tr><td><strong>نتيجة بديلة</strong></td><td>الحمل الفيروسي، وليس النتائج السريرية</td></tr>
<tr><td><strong>التحكم من مستشفيات مختلفة</strong></td><td>رعاية مختلفة واختبارات مختلفة</td></tr>
<tr><td><strong>لا يسبب العمى</strong></td><td>التحيز في التوقعات في الاختبارات المعملية</td></tr>
</tbody>
</table>
<div class="focus-box" style="margin-top: 1rem; border-color: #C53030;">
<p class="main" style="color: #C53030;">ستسجل هذه الدراسة خطرًا كبيرًا للتحيز على RoB 2.0</p>
<p class="sub">درجة اليقين: منخفض جدًا. ومع ذلك فقد غيرت السياسة العالمية.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">لماذا تم تضليل دراسات رصد كوفيد؟</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number" style="background: #C53030;">1</div>
<div class="lesson-content">
<h4>التحيز الزمني الخالد</h4>
<p>يجب على المرضى البقاء على قيد الحياة لفترة كافية لتلقي العلاج. تتم مقارنة الناجين بغير الناجين.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #C53030;">2</div>
<div class="lesson-content">
<h4>الخلط عن طريق الإشارة</h4>
<p>قد يحصل المرضى الأكثر مرضًا على علاجات مختلفة. تلقى المرضى الأكثر صحة HCQ في وقت مبكر.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #C53030;">3</div>
<div class="lesson-content">
<h4>تأثير المستخدم الصحي</h4>
<p>يميل المرضى الذين يطلبون العلاج إلى أن يكونوا أكثر صحة بشكل عام.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #C53030;">4</div>
<div class="lesson-content">
<h4>الإبلاغ عن النتائج</h4>
<p>تم نشر الدراسات ذات النتائج الإيجابية بشكل أسرع.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">يونيو 2020: تقرير التجارب المعشاة ذات الشواهد</h2>
<p class="animate delay-1" style="font-style: italic;">تم الانتهاء من التجارب الكبيرة والصارمة بسرعة ملحوظة</p>
<table class="results-table animate delay-2">
<thead>
<tr><th>محاكمة</th><th>N</th><th>النتيجة</th></tr>
</thead>
<tbody>
<tr>
<td>التعافي (المملكة المتحدة)</td>
<td>4,716</td>
<td style="color: #C53030;">لا فائدة من الوفيات (RR 1.09)</td>
</tr>
<tr>
<td>تضامن منظمة الصحة العالمية</td>
<td>954</td>
<td style="color: #C53030;">لا فائدة (RR 1.19)</td>
</tr>
<tr>
<td>الأوركيد (الولايات المتحدة)</td>
<td>479</td>
<td style="color: #C53030;">توقف لمدة عدم الجدوى</td>
</tr>
</tbody>
</table>
<div class="result-box animate delay-3" style="background: rgba(197, 48, 48, 0.2); border-color: #C53030;">
<div class="value">لم يقدم HCQ أي فائدة، وربما تسبب في ضرر</div>
<div class="label">15 يونيو 2020: إدارة الغذاء والدواء الأمريكية تلغي ترخيص الاستخدام في حالات الطوارئ</div>
</div>
</div>
</div>
<div class="slide dark" data-index="7">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">📊</span>
<h3>الجدول الزمني: الأدلة الرصدية مقابل الأدلة المعشاة ذات الشواهد</h3>
</div>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">مارس-مايو 2020</h4>
<p><strong>رصدي:</strong> ~20 دراسة</p>
<p style="color: #22c55e;">اقترح فائدة</p>
<p style="font-size: 0.85rem;">مجمعة أو ~0.65</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">يونيو-يوليو 2020</h4>
<p><strong>التجارب المعشاة ذات الشواهد:</strong> التعافي والتضامن</p>
<p style="color: #C53030;">لا تظهر أي فائدة/ضرر</p>
<p style="font-size: 0.85rem;">RR المجمعة ~ 1.10</p>
</div>
</div>
<div class="focus-box" style="margin-top: 1rem;">
<p class="main">من "واعد" إلى "غير فعال" في 3 أشهر</p>
<p class="sub">لهذا السبب نحتاج إلى التوزيع العشوائي - والمراجعات الحية لتتبع الأدلة المتطورة.</p>
</div>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">مراجعات منهجية حية</h2>
<p class="animate delay-1">نهج جديد لـ الأدلة سريعة التطور:</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #22c55e;">1</div>
<div class="lesson-content">
<h4>المراقبة المستمرة</h4>
<p>ابحث في الأدبيات أسبوعيًا أو حتى يوميًا للحصول على أدلة جديدة</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #22c55e;">2</div>
<div class="lesson-content">
<h4>التحليل التلوي التراكمي</h4>
<p>تحديث التقديرات المجمعة مع كل تقارير تجربة جديدة</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #22c55e;">3</div>
<div class="lesson-content">
<h4>التحليل التسلسلي التجريبي (TSA)</h4>
<p>تحديد متى تتراكم معلومات كافية لاستنتاج</p>
</div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number" style="background: #22c55e;">4</div>
<div class="lesson-content">
<h4>الإصدار الشفاف</h4>
<p>تتبع كل تغيير، والحفاظ على مسار التدقيق الكامل</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">التحليل التسلسلي التجريبي (TSA)</h2>
<p class="animate delay-1" style="font-style: italic;">متى تعلمنا ما يكفي؟</p>
<div class="card animate delay-2">
<p class="card-text">
                    تطبق إدارة أمن المواصلات حدود التوقف على التحليل التلوي - على غرار التحليل المؤقت في تجربة واحدة. إنه يمثل <strong>حجم المعلومات المطلوبة (RIS)</strong> اللازمة لاكتشاف أو استبعاد تأثير ذي معنى سريريًا.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">RIS</div>
<div class="stat-label">حجم العينة المطلوب</div>
</div>
<div class="stat-box">
<div class="stat-value">α-الإنفاق</div>
<div class="stat-label">يتحكم في خطأ النوع الأول</div>
</div>
<div class="stat-box">
<div class="stat-value">حدود</div>
<div class="stat-label">المنفعة / الضرر / العبث</div>
</div>
</div>
<p class="footnote animate delay-4">
                  بالنسبة لـ HCQ في فيروس كورونا، أظهرت إدارة أمن النقل أنه تم تجاوز حدود عدم الجدوى بحلول يونيو 2020.
                </p>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">الدروس المستفادة من ملحمة HCQ</h2>
<div class="card animate delay-1">
<p class="card-text" style="font-size: 1.1rem;">
<strong>1. يمكن أن تكون الدراسات الرصدية مضللة بشكل مذهل</strong> عندما يكون التحيز سائدًا. حتى أن العديد من الدراسات التي تشير إلى نفس الاتجاه يمكن أن تكون خاطئة.
                  </p>
</div>
<div class="card animate delay-2">
<p class="card-text" style="font-size: 1.1rem;">
<strong>2. يمكن إجراء التجارب المعشاة ذات الشواهد بسرعة</strong> عند وجود الإرادة. تم تسجيل أكثر من 5000 مريض في برنامج RECOVERY خلال أسابيع.
                  </p>
</div>
<div class="card animate delay-3">
<p class="card-text" style="font-size: 1.1rem;">
<strong>3. المراجعات الحية ضرورية</strong> للمواضيع المتطورة. تصبح المراجعات ذات النقاط الزمنية الثابتة قديمة الطراز على الفور.
                  </p>
</div>
<div class="card animate delay-4">
<p class="card-text" style="font-size: 1.1rem;">
<strong>4. الضغط السياسي لا يغير علم الأحياء.</strong>
                    الأساليب الصارمة تحمي المرضى حتى عندما يكونون تحت الضغط.
                  </p>
</div>
</div>
</div>
 القصة: ثورة حساسية الفول السوداني LEAP 
<div class="slide dark" data-index="10b">
<div class="story-box animate">
<p class="story-opener">ماذا لو كانت الوقاية هي السبب؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    لعقود من الزمن، أوصت إرشادات طب الأطفال بما يلي: <span class="data-highlight">تجنب تناول الفول السوداني في مرحلة الطفولة</span> لمنع الحساسية. وفي الوقت نفسه، معدلات حساسية الفول السوداني <span class="data-highlight">تضاعف ثلاث مرات</span> من عام 1997 إلى عام 2008. ثم جاء <span class="data-highlight">قفزة (2015)</span>: 640 رضيعًا معرضين لخطر شديد تم اختيارهم بصورة عشوائية لإدخال الفول السوداني مبكرًا مقابل تجنبه. النتيجة: الإدخال المبكر <span class="data-highlight">أدى إلى تقليل حساسية الفول السوداني بنسبة 81%</span> (1.9% مقابل 13.7%). كانت استراتيجية الوقاية هي التي تسببت في انتشار الوباء.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">مفترق طرق أخصائي الحساسية: 2010</div>
<div class="decision-scenario">
                    أنت طبيب حساسية أطفال. حساسية الفول السوداني آخذة في الارتفاع على الرغم من المبادئ التوجيهية لتجنبها. هل تشكك في العقيدة؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: اتبع الإرشادات</div>
<div class="path-choice">استمر في التوصية بتجنب الفول السوداني عند الرضع المعرضين لمخاطر عالية</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">المبادئ التوجيهية "قائمة على الأدلة". من الآمن اتباع الإجماع.</div>
<div class="path-outcome">النتيجة: تستمر حساسية الفول السوداني في الارتفاع</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: تشكك في العقيدة</div>
<div class="path-choice">صمم تجربة لاختبار ما إذا كان التقديم المبكر قد يكون وقائيًا</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تجربة LEAP تكشف الحقيقة. المبادئ التوجيهية عكس في جميع أنحاء العالم.</div>
<div class="path-outcome">النتيجة: منع الوباء</div>
</div>
</div>
</div>
<div class="story-timeline">
<div class="timeline-point">2000: توصي AAP بتجنبه</div>
<div class="timeline-point critical">2008: معدلات الحساسية ثلاث مرات</div>
<div class="timeline-point resolution">2015: LEAP يعكس الدليل</div>
<div class="timeline-point resolution">2017: المبادئ التوجيهية تتحول إلى التقديم المبكر</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    يتطلب "أولاً، لا ضرر ولا ضرار" دليلاً. إن الافتراضات، حتى لو كانت حسنة النية، يمكن أن تسبب ضررا على نطاق واسع. يحتاج الجهاز المناعي إلى التعرض لتطوير القدرة على التحمل، وقد أدى التجنب إلى حدوث حساسية.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 11</h2>
<div class="quiz-container">
<div class="quiz-question" id="q11-1">
<h4>1. ما هو الخلل الرئيسي في دراسة غوتريت هيدروكسي كلوروكين؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q11-1', 0, 2, ['Sample size was indeed small but not the main issue.', 'Blinding was missing but not the main issue.', 'Correct! Excluding 6 patients (including ICU/death) from HCQ group created severe selection bias.', 'Follow-up was adequate.'])">
<span>A.</span> عدد قليل جدًا من المرضى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-1', 1, 2, ['Sample size was indeed small but not the main issue.', 'Blinding was missing but not the main issue.', 'Correct! Excluding 6 patients (including ICU/death) from HCQ group created severe selection bias.', 'Follow-up was adequate.'])">
<span>B.</span> لا يسبب العمى
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-1', 2, 2, ['Sample size was indeed small but not the main issue.', 'Blinding was missing but not the main issue.', 'Correct! Excluding 6 patients (including ICU/death) from HCQ group created severe selection bias.', 'Follow-up was adequate.'])">
<span>C.</span> باستثناء المرضى الذين تدهورت حالتهم
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-1', 3, 2, ['Sample size was indeed small but not the main issue.', 'Blinding was missing but not the main issue.', 'Correct! Excluding 6 patients (including ICU/death) from HCQ group created severe selection bias.', 'Follow-up was adequate.'])">
<span>D.</span> متابعة قصيرة جدًا
                      </div>
</div>
<div id="q11-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q11-2" style="margin-top: 1.5rem;">
<h4>2. ما الذي يساعد التحليل التسلسلي للمحاكمة في تحديده؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q11-2', 0, 1, ['TSA doesn\\'t identify bias directly.', 'Correct! TSA determines when cumulative evidence reaches required information size.', 'Heterogeneity is assessed separately.', 'TSA doesn\\'t rank treatments.'])">
<span>A.</span> ما هي الدراسات التي تنطوي على مخاطر عالية للتحيز
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-2', 1, 1, ['TSA doesn\\'t identify bias directly.', 'Correct! TSA determines when cumulative evidence reaches required information size.', 'Heterogeneity is assessed separately.', 'TSA doesn\\'t rank treatments.'])">
<span>B.</span> عندما تتراكم أدلة كافية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-2', 2, 1, ['TSA doesn\\'t identify bias directly.', 'Correct! TSA determines when cumulative evidence reaches required information size.', 'Heterogeneity is assessed separately.', 'TSA doesn\\'t rank treatments.'])">
<span>C.</span> درجة عدم التجانس
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-2', 3, 1, ['TSA doesn\\'t identify bias directly.', 'Correct! TSA determines when cumulative evidence reaches required information size.', 'Heterogeneity is assessed separately.', 'TSA doesn\\'t rank treatments.'])">
<span>D.</span> ما هو العلاج الأفضل
                      </div>
</div>
<div id="q11-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q11-3" style="margin-top: 1.5rem;">
<h4>3. لماذا أظهرت دراسات COVID الرصدية فائدة HCQ بينما لم تظهر التجارب المعشاة ذات الشواهد؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q11-3', 0, 2, ['Patient populations were similar.', 'RCTs measured the same outcomes.', 'Correct! Immortal time bias and confounding by indication created false apparent benefit.', 'Observational data quality was adequate.'])">
<span>A.</span> سجلت التجارب المعشاة ذات الشواهد مرضى أكثر مرضًا
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-3', 1, 2, ['Patient populations were similar.', 'RCTs measured the same outcomes.', 'Correct! Immortal time bias and confounding by indication created false apparent benefit.', 'Observational data quality was adequate.'])">
<span>B.</span> استخدمت التجارب المعشاة ذات الشواهد نتائج مختلفة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-3', 2, 2, ['Patient populations were similar.', 'RCTs measured the same outcomes.', 'Correct! Immortal time bias and confounding by indication created false apparent benefit.', 'Observational data quality was adequate.'])">
<span>C.</span> التحيز في الدراسات الرصدية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q11-3', 3, 2, ['Patient populations were similar.', 'RCTs measured the same outcomes.', 'Correct! Immortal time bias and confounding by indication created false apparent benefit.', 'Observational data quality was adequate.'])">
<span>D.</span> الدراسات الرصدية لديها بيانات أفضل
                      </div>
</div>
<div id="q11-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="12">
<p class="closing-line animate">لا يمكن للسرعة أن تحل محل الدقة.</p>
<p class="closing-line animate delay-1">لكن الصرامة يمكن أن تكون سريعة.</p>
<p class="closing-line gold animate delay-2">توازن المراجعات الحية بين كليهما.</p>
<div class="gold-line animate delay-3"></div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 12: الأساليب المتقدمة</p>
</div>
</div>
 الوحدة 12: الأساليب المتقدمة 
<div class="module-slides" data-module="12">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
</div>
<div class="slide dark" data-index="1">
<p class="title cream animate text-center">الأساليب المتقدمة</p>
<p class="title gold animate delay-1 text-center">ما وراء التحليل التلوي الزوجي.</p>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الوحدة 12: الأساليب المتقدمة</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>تفسير هندسة التحليل التلوي للشبكة وتصنيفات SUCRA</li>
<li>تطبيق النماذج ثنائية المتغير للتحليل التلوي لدقة الاختبار التشخيصي</li>
<li>قم بإجراء تحليل تلوي للاستجابة للجرعة باستخدام شرائح مرنة</li>
<li>فهم متى تكون هناك حاجة إلى تحليل تلوي لبيانات المريض الفردية (IPD)</li>
<li>التعرف على الافتراضات والقيود كل طريقة متقدمة</li>
</ul>
</div>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">عندما لا يكون الاقتران كافيًا</h2>
<p class="direct-address animate delay-1">
                  "في بعض الأحيان يكون السؤال أكثر تعقيدًا من السؤال A مقابل B..."
                </p>
<div class="card animate delay-2">
<p class="card-text">
                    تشكل الأساليب التي تعلمتها الأساس. لكن الواقع السريري يتطلب في كثير من الأحيان المزيد:
                    <strong>أي من مضادات الاكتئاب العشرة هو الأفضل؟</strong> <strong>ما هي الجرعة المثالية من الستاتين؟</strong>
<strong>هل يشخص هذا الاختبار السرطان المبكر بدقة؟</strong>
</p>
</div>
<p class="footnote animate delay-3">
                  تقدم هذه الوحدة أربع طرق متقدمة - كل منها يجيب على أسئلة معقدة مختلفة.
                </p>
</div>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">التحليل التلوي للشبكة (NMA)</h2>
<p class="animate delay-1" style="font-style: italic;">عندما يكون لديك العديد من العلاجات ولكن القليل من التجارب المباشرة</p>
<div class="card animate delay-2">
<p class="card-text">
                    يجمع NMA <strong>الأدلة المباشرة</strong> (أ ضد ب) مع <strong>الأدلة غير المباشرة</strong>
                    (A vs C، B vs C → المستنتج A vs B) لمقارنة علاجات متعددة في وقت واحد.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">سوكرا</div>
<div class="stat-label">احتمالات الترتيب، وليس حجم التأثير</div>
</div>
<div class="stat-box">
<div class="stat-value">تناسق</div>
<div class="stat-label">مباشر = غير مباشر؟</div>
</div>
<div class="stat-box">
<div class="stat-value">الشبكات</div>
<div class="stat-label">تصور الأدلة</div>
</div>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<div class="investigation-box animate">
<div class="investigation-header">
<span class="icon">🔍</span>
<h3>مثال NMA: مضادات الاكتئاب</h3>
</div>
<p class="direct-address">
                  قام Cipriani 2018 NMA البارز بمقارنة 21 مضادًا للاكتئاب باستخدام 522 تجربة.
                </p>
<div class="comparison-grid" style="margin-top: 1rem;">
<div class="comparison-box">
<h4 style="color: var(--gold);">التحدي</h4>
<p>21 عقارًا، ولكن لم يتم اختبار كل زوج وجهاً لوجه</p>
<p style="font-size: 0.85rem;">الكثير مقابل الدواء الوهمي، القليل مقابل بعضها البعض</p>
</div>
<div class="comparison-box">
<h4 style="color: var(--gold);">الحل</h4>
<p>يجمع NMA بين الأدلة المباشرة وغير المباشرة عبر الشبكة</p>
<p style="font-size: 0.85rem;">يصنف كل 21 طريقة من حيث الفعالية والمقبولية</p>
</div>
</div>
<div class="focus-box" style="margin-top: 1rem;">
<p class="main">النتيجة: حصلت بعض الأدوية على تصنيف أعلى من حيث الفعالية، والبعض الآخر من حيث المقبولية</p>
<p class="sub">لا يوجد دواء واحد هو "الأفضل" عالميًا؛ تفسير التصنيفات بفواصل زمنية موثوقة، وعبورية، ومقايضات سريرية.</p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">NMA: الافتراضات الحرجة</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number" style="background: #f59e0b;">1</div>
<div class="lesson-content">
<h4>العبور</h4>
<p>ينبغي توزيع معدِّلات التأثير بالمثل عبر المقارنات؛ وإلا فإن المقارنات غير المباشرة قد تكون متحيزة</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #f59e0b;">2</div>
<div class="lesson-content">
<h4>تناسق</h4>
<p>تتفق الأدلة المباشرة وغير المباشرة (قابلة للاختبار)</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #f59e0b;">3</div>
<div class="lesson-content">
<h4>الشبكة المتصلة</h4>
<p>جميع المعالجات مرتبطة من خلال مقارنة مشتركة واحدة على الأقل</p>
</div>
</div>
<div class="focus-box animate delay-4 mt-2">
<p class="main">عندما تفشل الافتراضات، يمكن أن يكون NMA مضللاً</p>
<p class="sub">قم دائمًا بتقييم العبورية واختبار عدم الاتساق.</p>
</div>
</div>
</div>
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">التحليل التلوي للاستجابة للجرعة</h2>
<p class="animate delay-1" style="font-style: italic;">العثور على الجرعة المثالية</p>
<div class="card animate delay-2">
<p class="card-text">
                    يستخدم <strong>طريقة جرينلاند-لونجنيكر</strong> مع خطوط مكعبة مقيدة لنموذج العلاقات غير الخطية بين الجرعة والتأثير.
                  </p>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>الأنماط غير الخطية</h4>
<p>على شكل J (الكحول والوفيات)، على شكل U (فيتامين د)، العتبة (الأسبرين)</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>الأهمية السريرية</h4>
<p>ابحث عن الجرعة التي تحقق أفضل توازن بين الفوائد والأضرار، وليس فقط "الأكثر هو الأفضل"</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">بيانات المريض الفردية (IPD)</h2>
<p class="animate delay-1" style="font-style: italic;">المعيار الذهبي لتحليل المجموعات الفرعية</p>
<div class="card animate delay-2">
<p class="card-text">
                    بدلاً من البيانات الموجزة المنشورة، احصل على <strong>البيانات الأولية على مستوى المريض</strong> من المحاكمين. يتيح إجراء تحليلات دقيقة للمجموعات الفرعية، ونمذجة الوقت حتى الحدث، والتعريفات الموحدة.
                  </p>
</div>
<div class="stats-grid animate delay-3">
<div class="stat-box">
<div class="stat-value">مرحلة واحدة</div>
<div class="stat-label">نموذج هرمي واحد (وليس تجربة ضخمة)</div>
</div>
<div class="stat-box">
<div class="stat-value">مرحلتين</div>
<div class="stat-label">التحليل ثم التجميع</div>
</div>
<div class="stat-box">
<div class="stat-value">80%+ هدف</div>
<div class="stat-label">هدف توفر البيانات</div>
</div>
</div>
<p class="footnote animate delay-4">
                  كانت المجموعة التعاونية لتجارب سرطان الثدي المبكرة رائدة في برنامج IPD MA في الثمانينات.
                </p>
</div>
</div>
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">دقة الاختبار التشخيصي (DTA)</h2>
<p class="animate delay-1" style="font-style: italic;">عندما يكون "التدخل" بمثابة اختبار</p>
<div class="card animate delay-2">
<p class="card-text">
                    تجميع التحليل التلوي DTA <strong>حساسية</strong> (المعدل الإيجابي الحقيقي) و
                    <strong>خصوصية</strong> (المعدل السلبي الحقيقي) - نتيجتان مترابطتان تتطلبان نماذج ثنائية المتغير.
                  </p>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>نموذج ثنائي المتغير/HSROC</h4>
<p>حسابات الارتباط بين الحساسية والخصوصية</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>منحنى SROC</h4>
<p>ملخص منحنى ROC مع مناطق الثقة والتنبؤ بنسبة 95٪</p>
</div>
</div>
<div class="lesson-item animate delay-5">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>كواداس-2</h4>
<p>تقييم جودة دراسات الدقة التشخيصية</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">اختيار الطريقة الصحيحة</h2>
<table class="results-table animate delay-1">
<thead>
<tr><th>سؤال</th><th>طريقة</th></tr>
</thead>
<tbody>
<tr><td>هل يتغلب "أ" على "ب"؟</td><td><strong>MA الزوجي</strong></td></tr>
<tr><td>أي من العلاجات العديدة هو الأفضل؟</td><td><strong>ماجستير الشبكة (NMA)</strong></td></tr>
<tr><td>ما هي الجرعة المثالية؟</td><td><strong>الجرعة والاستجابة ماجستير</strong></td></tr>
<tr><td>من يستفيد أكثر؟ (مجموعات فرعية)</td><td><strong>إي بي دي ما</strong></td></tr>
<tr><td>ما مدى دقة هذا الاختبار؟</td><td><strong>دي تي ايه ما</strong></td></tr>
<tr><td>كيف يتطور التأثير مع مرور الوقت؟</td><td><strong>البقاء على قيد الحياة/الوقت إلى الحدث MA</strong></td></tr>
</tbody>
</table>
<p class="footnote animate delay-2">يجب أن تتطابق الطريقة مع السؤال. لا تجبر أبدًا على طرح سؤال بطريقة خاطئة.</p>
</div>
</div>
 القصة: المنشطات في ملحمة الإنتان 
<div class="slide dark" data-index="9b">
<div class="story-box animate">
<p class="story-opener">ثلاث محاكمات كبيرة. ثلاث إجابات مختلفة. ماذا تعتقد؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
<span class="data-highlight">كورتيكوس (2008):</span> 499 مريضا. الهيدروكورتيزون في الصدمة الإنتانية. <span class="data-highlight">لا فائدة من الوفيات</span>.
                    <span class="data-highlight">الغدة الكظرية (2018):</span> 3658 مريضا. الهيدروكورتيزون. <span class="data-highlight">لا فائدة من الوفيات</span>.
                    <span class="data-highlight">أبروشس (2018):</span> 1241 مريضا. هيدروكورتيزون + فلودروكورتيزون. <span class="data-highlight">انخفض معدل الوفيات</span> (43% مقابل 49.1%، ع=0.03). نفس فئة التدخل بروتوكولات مختلفة. نتائج مختلفة.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">تحدي الكاتب المبادئ التوجيهية</div>
<div class="decision-scenario">
                    أنت تكتب إرشادات الإنتان. ثلاث محاكمات كبرى تختلف. كيف توصي؟
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: المتوسط البسيط</div>
<div class="path-choice">تجميع كافة التجارب الثلاث. التأثير الكلي غير مؤكد. استنتج "الأدلة غير واضحة".</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تقول الإرشادات أن المنشطات اختيارية. لا توجد توصية قوية.</div>
<div class="path-outcome">النتيجة: ترك الأطباء دون توجيه واضح</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: التحقيق في عدم التجانس</div>
<div class="path-choice">تحليل سبب اختلاف APROCCHSS (فلودروكورتيزون، مدة أطول، مجموعات سكانية مختلفة)</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">تحديد أن البروتوكول الفعال يختلف عن البروتوكولات غير الفعالة.</div>
<div class="path-outcome">النتيجة: التوصية بالبروتوكول الفعال المحدد</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    التجارب المتضاربة ليست فشلا. إنها خرائط توضح الأماكن التي يعمل فيها العلاج والأماكن التي لا يعمل فيها. إن الاختلافات بين التجارب - الجرعة، والمدة، والتدخلات المشتركة، والسكان - هي مفتاح الفهم.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 12</h2>
<div class="quiz-container">
<div class="quiz-question" id="q12-1">
<h4>1. ما هي الميزة الرئيسية للتحليل التلوي للشبكة مقارنة بالتحليل الزوجي؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q12-1', 0, 1, ['All MA requires data extraction.', 'Correct! NMA combines direct and indirect evidence to compare treatments without head-to-head trials.', 'NMA still requires quality assessment.', 'Forest plots work differently.'])">
<span>A.</span> لا يتطلب استخراج البيانات
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-1', 1, 1, ['All MA requires data extraction.', 'Correct! NMA combines direct and indirect evidence to compare treatments without head-to-head trials.', 'NMA still requires quality assessment.', 'Forest plots work differently.'])">
<span>B.</span> يقارن المعالجات التي لم يتم اختبارها بشكل مباشر ضد بعضها البعض
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-1', 2, 1, ['All MA requires data extraction.', 'Correct! NMA combines direct and indirect evidence to compare treatments without head-to-head trials.', 'NMA still requires quality assessment.', 'Forest plots work differently.'])">
<span>C.</span> إنه يلغي الحاجة إلى تقييم خطر التحيز
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-1', 3, 1, ['All MA requires data extraction.', 'Correct! NMA combines direct and indirect evidence to compare treatments without head-to-head trials.', 'NMA still requires quality assessment.', 'Forest plots work differently.'])">
<span>D.</span> وينتج قطعًا أفضل للغابات
                      </div>
</div>
<div id="q12-1-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q12-2" style="margin-top: 1.5rem;">
<h4>2. لماذا يتطلب التحليل التلوي DTA نماذج ثنائية المتغير؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q12-2', 0, 2, ['Univariate models can sometimes be appropriate.', 'DTA has other specific requirements.', 'Correct! Sensitivity and specificity trade off against each other and must be modeled together.', 'Forest plots are used differently.'])">
<span>A.</span> للتعامل مع أكثر من دراستين
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-2', 1, 2, ['Univariate models can sometimes be appropriate.', 'DTA has other specific requirements.', 'Correct! Sensitivity and specificity trade off against each other and must be modeled together.', 'Forest plots are used differently.'])">
<span>B.</span> لضبط تحيز النشر
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-2', 2, 2, ['Univariate models can sometimes be appropriate.', 'DTA has other specific requirements.', 'Correct! Sensitivity and specificity trade off against each other and must be modeled together.', 'Forest plots are used differently.'])">
<span>C.</span> ترتبط الحساسية والنوعية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-2', 3, 2, ['Univariate models can sometimes be appropriate.', 'DTA has other specific requirements.', 'Correct! Sensitivity and specificity trade off against each other and must be modeled together.', 'Forest plots are used differently.'])">
<span>D.</span> لإنشاء قطع أراضي الغابات
                      </div>
</div>
<div id="q12-2-feedback" style="display: none;"></div>
</div>
<div class="quiz-question" id="q12-3" style="margin-top: 1.5rem;">
<h4>3. ما الذي يتطلبه افتراض "الاتساق" في NMA؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q12-3', 0, 1, ['Quality is assessed separately.', 'Correct! If direct evidence says A beats B by X, indirect evidence should agree.', 'Sample sizes vary in real networks.', 'Missing studies are a separate concern.'])">
<span>A.</span> يجب أن تكون جميع الدراسات ذات جودة عالية
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-3', 1, 1, ['Quality is assessed separately.', 'Correct! If direct evidence says A beats B by X, indirect evidence should agree.', 'Sample sizes vary in real networks.', 'Missing studies are a separate concern.'])">
<span>B.</span> يجب أن تتفق الأدلة المباشرة وغير المباشرة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-3', 2, 1, ['Quality is assessed separately.', 'Correct! If direct evidence says A beats B by X, indirect evidence should agree.', 'Sample sizes vary in real networks.', 'Missing studies are a separate concern.'])">
<span>C.</span> يجب أن تكون أحجام العينات متشابهة
                      </div>
<div class="quiz-option" onclick="checkQuizAnswer('q12-3', 3, 1, ['Quality is assessed separately.', 'Correct! If direct evidence says A beats B by X, indirect evidence should agree.', 'Sample sizes vary in real networks.', 'Missing studies are a separate concern.'])">
<span>D.</span> لا توجد دراسات مفقودة
                      </div>
</div>
<div id="q12-3-feedback" style="display: none;"></div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="11" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">النظام البيئي للدورة</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  تغطي هذه الدورة سير عمل المراجعة المنهجية الكاملة. للتعمق أكثر، استكشف الدورات المصاحبة:
                </p>
<div class="animate delay-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; max-width: 700px; font-size: 0.85rem;">
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>دورة DTA</strong><br/>منحنيات ثنائية المتغير/HSROC، SROC، QUADAS-2</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>خطر إتقان التحيز</strong><br/>RoB 2، ROBINS-I/E، تقييم على مستوى المجال</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>درجة اليقين</strong><br/>جداول SoF كاملة، GRADE-CERQual</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>التحليل التلوي IPD</strong><br/>نماذج ذات مرحلة واحدة/مرحلتين، ذات تأثيرات مختلطة</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>مخبر تحيز النشر</strong><br/>Copas، PET-PEESE، منحنى p، نماذج مختارة</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>مراجعات المظلة</strong><br/>AMSTAR 2، ROBIS، تصحيح التداخل</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>المراجعات النذير</strong><br/>CHARMS، PROBAST، تجميع الإحصائيات c</div>
<div class="card" style="padding: 0.5rem 0.75rem;"><strong>المراجعات الحية + المراجعات السريعة</strong><br/>TSA، مشغلات التحديث، الطرق المختصرة</div>
</div>
</div>
</div>
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 12 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "يجب أن تتطابق الطريقة مع السؤال. الأساليب المتقدمة تجيب على الأسئلة المتقدمة، لكن الأساسيات لا تتغير أبدًا."
                </p>
<p class="animate delay-3" style="font-size: 1rem; margin-top: 1.5rem; opacity: 0.8;">
                  لقد أتقنت سير العمل الأساسي. تستكشف الوحدات العشر التالية الحدود: الاستدلال البايزي، والتحليل التلوي للشبكة، وبيانات المرضى الفردية، ونمذجة الاستجابة للجرعة، والمتانة والهشاشة، والإنصاف، والتوليف بمساعدة الذكاء الاصطناعي، والأدلة النوعية، والأساليب متعددة المتغيرات، وقابلية التكرار.
                </p>
</div>
</div>
<div class="slide black" data-index="12">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 13: المنعطف البايزي</p>
</div>
</div>
 ================ الوحدة 13: المنعطف البايزي (تجربة منصة التدافع) ============================================================================================================== 
<div class="module-slides" data-module="13">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 13: المنعطف البايزي</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 13: المنعطف البايزي</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح الفرق بين الاستدلال المتكرر والاستدلال البايزي</li>
<li>تفسير التوزيعات السابقة والاحتمالات والتوزيعات اللاحقة</li>
<li>التمييز فواصل موثوقة من فواصل الثقة</li>
<li>فهم متى يقدم التحليل التلوي بايزي المزايا</li>
<li>التعرف على كيفية تأثير الاختيار المسبق على الاستنتاجات</li>
</ul>
</div>
</div>
</div>
 افتتاحية القصة: التدافع 
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">في عام 2005، بدأت تجربة</p>
<p class="title gold animate delay-1 text-center">التي لن تنتهي أبدًا.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                استخدمت تجربة STAMPEDE لسرطان البروستاتا تصميم منصة متعدد الأذرع ومتعدد المراحل (MAMS). يمكن إضافة الأسلحة أو إسقاطها مع تراكم الأدلة. وعلى الرغم من أن إحصاءاتها كانت متكررة، إلا أن الفلسفة التكيفية جسدت الروح الافتراضية: تحديث القرارات مع تراكم البيانات.
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">النظرة العالمية المتكررة</h2>
<div class="card animate delay-1">
<p class="card-text">
                    في الإحصائيات المتكررة، يعني الاحتمال <strong>التردد على المدى الطويل</strong>. 95% CI لا يعني "احتمال 95% أن التأثير الحقيقي موجود في الداخل". يعني: لو كررنا الدراسة إلى ما لا نهاية، لكانت 95% من الفترات تحتوي على الحقيقة.
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">القيمة p</div>
<div class="stat-label">P(بيانات | H₀)، وليس P(H₀ | بيانات)</div>
</div>
<div class="stat-box">
<div class="stat-value">95% CI</div>
<div class="stat-label">خاصية التغطية، وليس الاعتقاد</div>
</div>
<div class="stat-box">
<div class="stat-value">مُثَبَّت</div>
<div class="stat-label">تم إصلاح المعلمة الحقيقية</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">النظرة الافتراضية للعالم</h2>
<div class="card animate delay-1">
<p class="card-text">
                    في الإحصائيات الافتراضية، يمثل الاحتمال <strong>درجة الاعتقاد</strong>. نبدأ بـ <strong>قبل</strong> (ما نؤمن به قبل البيانات)، قم بالتحديث باستخدام
                    <strong>احتمالية</strong> (ما تخبرنا به البيانات)، واحصل على أ <strong>الخلفي</strong> (الاعتقاد المحدث).
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>السابقة × الاحتمالية = الخلفية</h4>
<p>نظرية بايز: P(θ|data) ∝ P(data|θ) × P(θ)</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>الفترات الموثوقة</h4>
<p>الفاصل الزمني الموثوق به بنسبة 95% قابل للتفسير احتماليًا، ومشروط بالنموذج المحدد والسابق.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="5" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">اختيار الأسبقية</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>غير معلوماتية (غامضة)</h4>
<p>عادي(0, 10000) أو منتظم. يتيح للبيانات السيطرة. يحاكي النتائج المتكررة.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>معلوماتية ضعيفة</h4>
<p>عادية (0, 1) لسجل OR. ينظم التقديرات المتطرفة مع الحفاظ على المرونة.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>إعلامية</h4>
<p>بناءً على الأدلة السابقة. قوية ولكنها مثيرة للجدل. يجب أن تكون محددة مسبقا.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content">
<h4>نصف كوشي لـ τ</h4>
<p>الموصى بها لعدم التجانس. يسمح نصف كوشي (0، 0.5) بـ τ كبيرة ولكنه يركز بالقرب من الصفر.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">أخذ عينات MCMC</h2>
<div class="card animate delay-1">
<p class="card-text">
                    لا يمكن حل معظم النماذج الافتراضية تحليليًا. نستخدم
                    <strong>سلسلة ماركوف مونت كارلو</strong> (MCMC) لسحب عينات من الجزء الخلفي. الأدوات: JAGS، Stan، brms (R)، PyMC (Python).
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">السلاسل</div>
<div class="stat-label">سلاسل مستقلة متعددة (عادة 4)</div>
</div>
<div class="stat-box">
<div class="stat-value">R̂</div>
<div class="stat-label">التقارب: R̂ &lt; 1.01 (صارم؛ النصوص الأقدم تستخدم &lt;1.1)</div>
</div>
<div class="stat-box">
<div class="stat-value">ESS</div>
<div class="stat-label">Bulk-ESS&gt; 400 للوسائل؛ tail-ESS &gt; 400 لـ CIs</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="7" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">متوسط النموذج البايزي</h2>
<div class="card animate delay-1">
<p class="card-text">
                    بدلاً من الاختيار بين نماذج التأثير الثابت والتأثيرات العشوائية،
                    <strong>بايزي متوسط النموذج</strong> (BMA) يزن كل نموذج حسب احتماله الخلفي. وهذا يفسر عدم اليقين في النموذج في التقدير النهائي.
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">BF</div>
<div class="lesson-content">
<h4>عوامل بايز</h4>
<p>BF₁₀ &gt; 10 = دليل قوي على H₁. BF₁₀ &lt; 1/10 = دليل قوي على H₀.</p>
</div>
</div>
</div>
</div>
 العنصر النائب للأداة التفاعلية 
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">التفاعلية: المتخيل الخلفي</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  اضبط القوة السابقة لترى كيف تؤثر على القوة الخلفية. شاهد كيف يطغى المزيد من البيانات على ما سبق.
                </p>
<div class="animate delay-2" id="bayesianPosteriorTool" style="min-height: 300px; background: rgba(30,39,97,0.05); border-radius: 8px; padding: 1rem;">
<div style="margin-bottom: 1rem;">
<label style="font-weight:600;">القوة السابقة: <span id="priorStrengthLabel">غامضة</span></label><br/>
<input id="priorStrengthSlider" max="100" min="0" oninput="updateBayesianPosterior()" style="width:100%;" type="range" value="10"/>
</div>
<div style="margin-bottom: 1rem;">
<label style="font-weight:600;">المتوسط السابق (سجل-OR): <span id="priorMeanLabel">0.00</span></label><br/>
<input id="priorMeanSlider" max="200" min="-200" oninput="updateBayesianPosterior()" style="width:100%;" type="range" value="0"/>
</div>
<div id="bayesianPlotArea" style="width:100%; min-height:220px;"></div>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="9">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">قصة STAMPEDE</h3>
<p style="margin-bottom: 0.75rem;">
                    تم إطلاق STAMPEDE في عام 2005 مع 5 أذرع بحثية تقارن علاجات سرطان البروستاتا المتقدم. بحلول عام 2016، أضافت دواء أبيراتيرون وأظهر انخفاضًا بنسبة 37% في الوفيات (HR 0.63، 95% CI 0.52–0.76).
                  </p>
<p style="margin-bottom: 0.75rem;">
                    يجسد تصميم المنصة التفكير التكيفي بايزي: التحليلات المؤقتة توجه اختيار الذراع، ويمكن إدخال أذرع جديدة مع ظهور العلاجات، وإسقاط الأذرع غير المجدية مبكرًا - مما ينقذ المرضى من المرضى غير الفعالين. العلاجات.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    سجل STAMPEDE أكثر من 10000 مريض في أكثر من 100 مركز وأحدث تغييرًا جذريًا في رعاية سرطان البروستاتا. تسمح العقلية الافتراضية بتراكم الأدلة واتخاذ القرارات في الوقت الفعلي.
                  </p>
</div>
</div>
</div>
 شجرة القرار 
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">شجرة القرار: متى يجب الانتقال إلى النظرية الافتراضية؟</h2>
<div class="decision-tree animate delay-1">
<div class="decision-tree-header">التحليل التلوي المتكرر مقابل التحليل بايزي</div>
<div class="decision-scenario">
                    اختر النظرية الافتراضية عندما: (1) لديك معلومات مسبقة حقيقية، (2) تحتاج إلى بيانات احتمالية ("تأثير فرصة بنسبة 80% &gt; 0")، (3) تجعل بعض الدراسات الخصائص المتكررة غير موثوقة، أو (4) تريد حساب متوسط النموذج.
                  </div>
<div class="decision-options">
<div class="decision-option correct">
<div class="decision-label">بايزي مع معلومات سابقة ضعيفة</div>
<div class="decision-detail">افتراضي عملي شائع. ينظم التقديرات المتطرفة دون فرض استنتاجات مسبقة قوية.</div>
</div>
<div class="decision-option">
<div class="decision-label">النظرية الافتراضية مع معلومات سابقة</div>
<div class="decision-detail">فقط عندما تكون الأدلة المسبقة قوية ومحددة مسبقًا. يجب إجراء تحليل الحساسية.</div>
</div>
<div class="decision-option">
<div class="decision-label">كن متكررًا</div>
<div class="decision-detail">أبسط ومفهوم جيدًا. يُفضل عندما يكون k كبيرًا ولا توجد معلومات مسبقة.</div>
</div>
</div>
</div>
</div>
</div>
 رد اتصال 
<div class="slide dark" data-index="11">
<div class="content" style="text-align: center;">
<p class="animate" style="font-size: 1.1rem; opacity: 0.7;">هل تتذكر الوحدة 1؟</p>
<p class="title gold animate delay-1">الإرسال من خلال عدسة بايزي</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="max-width: 600px; font-size: 1.05rem;">
                  لو استخدم تحليل بايزي لـ CAST معلومات سابقة من العلوم الأساسية (مضادات اضطراب النظم تقمع PVCs)، فإن الجزء الخلفي سيظل يتحول بقوة نحو الأذى. ومع وجود ما يكفي من البيانات، حتى النتائج السابقة القوية تؤدي إلى الاحتمالية. الدرس المستفاد: الأساليب الافتراضية لا تحمي من المقدمات السيئة - ولكنها تضع الافتراضات <em>شفاف</em>.
                </p>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 13</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ماذا يعني الفاصل الزمني المعقول بنسبة 95% بايزي؟</p>
<div class="quiz-options" id="m13-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m13-q1', 0, 1, ['That is the frequentist interpretation of a confidence interval.', 'Correct! Under the specified model and prior, a credible interval gives posterior probability for the parameter range.', 'Credible intervals have a direct probabilistic interpretation conditional on assumptions.', 'Bayesian intervals are about the parameter, not future data.'])">
<span>A.</span> 95% من التجارب المتكررة ستنتج فواصل تحتوي على القيمة الحقيقية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q1', 1, 1, ['That is the frequentist interpretation of a confidence interval.', 'Correct! Under the specified model and prior, a credible interval gives posterior probability for the parameter range.', 'Credible intervals have a direct probabilistic interpretation conditional on assumptions.', 'Bayesian intervals are about the parameter, not future data.'])">
<span>B.</span> هناك احتمال بنسبة 95% أن تقع المعلمة الحقيقية ضمن هذا الفاصل الزمني
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q1', 2, 1, ['That is the frequentist interpretation of a confidence interval.', 'Correct! Under the specified model and prior, a credible interval gives posterior probability for the parameter range.', 'Credible intervals have a direct probabilistic interpretation conditional on assumptions.', 'Bayesian intervals are about the parameter, not future data.'])">
<span>C.</span> الفاصل الزمني لديه فرصة 95% ليكون صحيحًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q1', 3, 1, ['That is the frequentist interpretation of a confidence interval.', 'Correct! Under the specified model and prior, a credible interval gives posterior probability for the parameter range.', 'Credible intervals have a direct probabilistic interpretation conditional on assumptions.', 'Bayesian intervals are about the parameter, not future data.'])">
<span>D.</span> سوف تقع 95% من البيانات المستقبلية في هذا النطاق
                    </div>
</div>
<div id="m13-q1-feedback" style="display: none;"></div>
</div>
<div class="quiz-box animate delay-2">
<p class="quiz-question"><strong>Q2.</strong> ما هو المستوى المسبق الموصى به للتغاير بين الدراسات (τ)?</p>
<div class="quiz-options" id="m13-q2">
<div class="quiz-option" onclick="checkQuizAnswer('m13-q2', 0, 2, ['Uniform priors on variance can be improper and favor large heterogeneity.', 'Normal priors are used for effect parameters, not variance.', 'Correct! Half-Cauchy priors are commonly used and should be justified with sensitivity analyses.', 'Fixed values eliminate uncertainty about heterogeneity, defeating the purpose.'])">
<span>A.</span> موحد (0, 100)
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q2', 1, 2, ['Uniform priors on variance can be improper and favor large heterogeneity.', 'Normal priors are used for effect parameters, not variance.', 'Correct! Half-Cauchy priors are commonly used and should be justified with sensitivity analyses.', 'Fixed values eliminate uncertainty about heterogeneity, defeating the purpose.'])">
<span>B.</span> عادي (0, 1)
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q2', 2, 2, ['Uniform priors on variance can be improper and favor large heterogeneity.', 'Normal priors are used for effect parameters, not variance.', 'Correct! Half-Cauchy priors are commonly used and should be justified with sensitivity analyses.', 'Fixed values eliminate uncertainty about heterogeneity, defeating the purpose.'])">
<span>C.</span> نصف كوشي (0, 0.5)
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m13-q2', 3, 2, ['Uniform priors on variance can be improper and favor large heterogeneity.', 'Normal priors are used for effect parameters, not variance.', 'Correct! Half-Cauchy priors are commonly used and should be justified with sensitivity analyses.', 'Fixed values eliminate uncertainty about heterogeneity, defeating the purpose.'])">
<span>D.</span> ثابت عند 0.5
                    </div>
</div>
<div id="m13-q2-feedback" style="display: none;"></div>
</div>
</div>
</div>
 الحفل الختامي 
<div class="slide dark" data-index="13">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 13 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "لا يتعلق المنعطف البايزي بالرياضيات. بل يتعلق بالصدق - مما يجعل افتراضاتنا مرئية."
                </p>
</div>
</div>
 انتقال 
<div class="slide black" data-index="14">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 14: الشبكة</p>
</div>
</div>
 ====================================================== الوحدة 14: الشبكة (Cipriani 2018 — 21 مضادات الاكتئاب) ========= 
<div class="module-slides" data-module="14">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 14: الشبكة</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 14: الشبكة</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح سبب عدم كفاية المقارنات الزوجية عند وجود العديد من المعالجات</li>
<li>فسر هندسة الشبكة (العقد، الحواف، السُمك)</li>
<li>فهم العبور والاتساق ودور الأدلة غير المباشرة</li>
<li>فسر تصنيفات SUCRA وجداول الدوري</li>
<li>التعرف على متى يتم انتهاك افتراضات NMA</li>
</ul>
</div>
</div>
</div>
 القصة: Cipriani 2018 
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">يواجه الطبيب مريضًا</p>
<p class="title gold animate delay-1 text-center">في الاكتئاب. أي دواء؟</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                هناك 21 مضادًا للاكتئاب موصوفة بشكل شائع. تقارن معظم التجارب المباشرة بين 2 أو 3 فقط. Cipriani et al. (2018، Lancet) ربطت 522 تجربة و116,477 مريضًا في شبكة واحدة.
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">منطق التحليل التلوي للشبكة</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>دليل مباشر</h4>
<p>التجارب التي تقارن بشكل مباشر بين A وB تعطي التقدير الأكثر موثوقية.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>الأدلة غير المباشرة</h4>
<p>في حالة وجود A مقابل C وB مقابل C، يمكننا استنتاج A مقابل B. هذا هو "المتعد" الافتراض.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>الأدلة المختلطة</h4>
<p>يجمع NMA بين الاثنين، مرجحًا بالدقة، لتصنيف جميع المعالجات في وقت واحد.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">تفاعلي: الرسم البياني للشبكة</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  كل عقدة هي علاج. يمثل سمك الحافة عدد الدراسات التي تقارن هاتين المعالجتين.
                </p>
<div class="animate delay-2" id="nmaNetworkTool" style="min-height: 350px; background: rgba(30,39,97,0.05); border-radius: 8px; padding: 1rem;">
<div id="nmaNetworkArea" style="width:100%; min-height:320px;"></div>
</div>
</div>
</div>
<div class="slide light" data-index="5" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">العبورية والاتساق</h2>
<div class="card animate delay-1">
<p class="card-text">
<strong>العبور</strong>: يجب أن يقترب التقدير غير المباشر (عبر المقارنة المشتركة) من التقدير المباشر. وهذا يتطلب أن يتم توزيع معدّلات التأثير بشكل مماثل عبر المقارنات.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text">
<strong>تناسق</strong>: اختبار إحصائي لمقارنة الأدلة المباشرة وغير المباشرة. تساعد الاختبارات العالمية (التفاعل بين التصميم والمعالجة) والاختبارات المحلية (تقسيم العقدة) على تحديد حلقات عدم الاتساق.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">SUCRA وP-scores</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box">
<div class="stat-value">سوكرا</div>
<div class="stat-label">السطح تحت الترتيب التراكمي. تشير القيم الأعلى إلى احتمالية تصنيف أفضل، وليس تفوقًا مضمونًا.</div>
</div>
<div class="stat-box">
<div class="stat-value">درجة P</div>
<div class="stat-label">التناظرية المتكررة لملخصات احتمالية الترتيب. تفسير مع أحجام التأثير وعدم اليقين.</div>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text">
<strong>الحذر:</strong> يكون الترتيب مغريًا ولكنه مضلل عندما تكون الاختلافات بين المعالجات صغيرة أو غير مؤكدة. قم دائمًا بالإبلاغ عن فترات المصداقية/الثقة جنبًا إلى جنب مع الرتب.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="7" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">مكون NMA</h2>
<div class="card animate delay-1">
<p class="card-text">
                    عندما تكون التدخلات معقدة (على سبيل المثال، السلوكية + الدوائية)، يقوم مكون <strong>NMA</strong>
                    بتحليل المعالجات متعددة المكونات لتقدير المساهمة الفردية لكل مكون. يستخدم النماذج المضافة: التأثير (أ + ب) = التأثير (أ) + التأثير (ب) + التفاعل.
                  </p>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">شبكة سيبرياني</h3>
<p style="margin-bottom: 0.75rem;">
                    وجد تحليل لانسيت لعام 2018 أن جميع مضادات الاكتئاب الـ 21 كانت أكثر فعالية من العلاج الوهمي. احتل أميتريبتيلين وميرتازابين وفينلافاكسين المرتبة الأولى من حيث الفعالية. احتل أغوميلاتين، وفلوكستين، وإسيتالوبرام المرتبة الأعلى من حيث المقبولية (أقل عدد من المتسربين).
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    لا يوجد دواء واحد "فاز" في جميع النتائج. كشفت الشبكة عن مقايضات غير مرئية للتحليل الزوجي.
                  </p>
</div>
</div>
</div>
 شجرة القرار 
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">شجرة القرار: هل NMA مناسب؟</h2>
<div class="decision-tree animate delay-1">
<div class="decision-tree-header">التحقق من جدوى NMA</div>
<div class="decision-scenario">
                    لديك 15 تجربة معشاة ذات شواهد تقارن 6 ستاتينات مختلفة. بعض الأزواج لديهم أدلة مباشرة، والبعض الآخر لا.
                  </div>
<div class="decision-options">
<div class="decision-option correct">
<div class="decision-label">التحقق من العبور، ثم ملاءمة NMA</div>
<div class="decision-detail">التحقق من أن مجموعات المرضى وتصميمات الدراسة متشابهة بدرجة كافية عبر المقارنات.</div>
</div>
<div class="decision-option">
<div class="decision-label">تجاهل الأدلة غير المباشرة</div>
<div class="decision-detail">يفقد القوة الإحصائية ويترك فجوات في قاعدة الأدلة.</div>
</div>
<div class="decision-option">
<div class="decision-label">تجميع الكل في مقارنة زوجية واحدة</div>
<div class="decision-detail">ينتهك بنية الأدلة. الستاتينات هي أدوية مختلفة.</div>
</div>
</div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 14</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما الافتراض الذي يجب أن يحمله الدليل غير المباشر حتى يكون صالحًا في NMA؟</p>
<div class="quiz-options" id="m14-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m14-q1', 0, 0, ['Correct! Transitivity means effect modifiers are similarly distributed across comparisons, making indirect evidence valid.', 'Homogeneity is about pairwise I², not NMA validity.', 'Similar sample size is not required for NMA.', 'Blinding status matters for bias assessment, not transitivity.'])">
<span>A.</span> العبور - تتم موازنة معدلات التأثير عبر المقارنات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m14-q1', 1, 0, ['Correct! Transitivity means effect modifiers are similarly distributed across comparisons, making indirect evidence valid.', 'Homogeneity is about pairwise I², not NMA validity.', 'Similar sample size is not required for NMA.', 'Blinding status matters for bias assessment, not transitivity.'])">
<span>B.</span> التجانس - يجب أن يكون I² أقل من 25%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m14-q1', 2, 0, ['Correct! Transitivity means effect modifiers are similarly distributed across comparisons, making indirect evidence valid.', 'Homogeneity is about pairwise I², not NMA validity.', 'Similar sample size is not required for NMA.', 'Blinding status matters for bias assessment, not transitivity.'])">
<span>C.</span> يجب أن تحتوي جميع الدراسات على أحجام عينات مماثلة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m14-q1', 3, 0, ['Correct! Transitivity means effect modifiers are similarly distributed across comparisons, making indirect evidence valid.', 'Homogeneity is about pairwise I², not NMA validity.', 'Similar sample size is not required for NMA.', 'Blinding status matters for bias assessment, not transitivity.'])">
<span>D.</span> يجب أن تكون جميع الدراسات مزدوجة التعمية
                    </div>
</div>
<div id="m14-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="11">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 14 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "ترى الشبكة ما لا تستطيع المقارنات الزوجية رؤيته: المشهد الكامل لاختيار العلاج."
                </p>
</div>
</div>
<div class="slide black" data-index="12">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 15: الفرد</p>
</div>
</div>
 ================ الوحدة 15: الفرد (EBCTCG - التحليل التلوي IPD) ============================================================================================================== 
<div class="module-slides" data-module="15">
<div class="slide dark active" data-index="0">
<p class="refrain animate">ما الذي كان مخفيا على مرأى من الجميع؟</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 15: الفرد</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 15: الفرد</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح لماذا يمكن للبيانات المجمعة أن تحجب التفاعلات بين العلاج والمتغيرات</li>
<li>التمييز بين المرحلة الواحدة ونماذج IPD ذات المرحلتين</li>
<li>التعرف على التحيز البيئي في التحليل التلوي الكلي</li>
<li>فهم التحديات العملية لجمع IPD</li>
<li>تفسير مخططات التفاعل بين العلاج والمتغير</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">لعقود من الزمن، كانت تجارب سرطان الثدي</p>
<p class="title gold animate delay-1 text-center">الملخصات المنشورة. ليس المرضى.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                قامت المجموعة التعاونية لتجارب سرطان الثدي المبكر (EBCTCG) بجمع سجلات فردية من أكثر من 100.000 امرأة عبر مئات التجارب. أظهرت تحليلات IPD الخاصة بهم أن فوائد عقار تاموكسيفين تعتمد بشكل كبير على حالة مستقبلات هرمون الاستروجين، وهو أمر غير مرئي في البيانات الإجمالية.
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">ما أخفته الملخصات</h2>
<p class="direct-address animate delay-1">أبلغت كل تجربة منشورة عن عقار تاموكسيفين عن نتيجة إجمالية. ومن خلال مئات الدراسات، بدا أن عقار تاموكسيفين يقدم فائدة متواضعة. لكن "الفائدة المتواضعة" كانت عبارة عن متوسط يخفي حقيقة عميقة.</p>
<div class="investigation-box animate delay-2">
<h4>انقسام المجموعة الفرعية المخفية</h4>
<div class="stats-grid" style="margin-top: 1rem;">
<div class="stat-box" style="border-right: 4px solid #22c55e;">
<div class="stat-value" style="color: #22c55e;">RR 0.59</div>
<div class="stat-label">مجموعة فرعية إيجابية ER: انخفاض بنسبة 41% في التكرار</div>
</div>
<div class="stat-box" style="border-right: 4px solid #ef4444;">
<div class="stat-value" style="color: #ef4444;">RR 0.97</div>
<div class="stat-label">المجموعة الفرعية سلبية ER: لا فائدة على الإطلاق</div>
</div>
</div>
<p style="margin-top: 1rem; font-style: italic;">كان التأثير الإجمالي المجمع – أي الخلط بين المرضى المستجيبين وغير المستجيبين – مجرد خيال إحصائي. متوسط "متواضع" يبالغ في تقدير الفائدة لمجموعة واحدة ويشير إلى فائدة ضمنية حيث لا توجد فائدة للمجموعة الأخرى.</p>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">بيانات المرضى المجمعة مقابل بيانات المرضى الفردية</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box">
<div class="stat-value">AD</div>
<div class="stat-label">الإجمالي: التأثير المنشور + CI فقط</div>
</div>
<div class="stat-box">
<div class="stat-value">IPD</div>
<div class="stat-label">الفرد: السجلات الأولية على مستوى المريض</div>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text">
                    يسمح IPD بما يلي: (1) تعريفات نتائج متسقة، (2) تحليل المجموعات الفرعية حسب خصائص المريض، (3) النمذجة من وقت لآخر، (4) التحقق من التحيز البيئي. إنه <strong>المعيار الذهبي</strong>
                    لاستكشاف تعديل تأثير العلاج.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="5" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">مرحلة واحدة مقابل مرحلتين IPD</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>مرحلتين</h4>
<p>قم بتحليل كل دراسة على حدة، ثم اجمع بين التقديرات (مثل MA القياسي). بسيطة ولكنها تفقد المعلومات.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>مرحلة واحدة</h4>
<p>تناسب نموذج واحد مختلط التأثيرات لجميع بيانات المريض في وقت واحد. أكثر قوة للتفاعلات والأحداث النادرة.</p>
</div>
</div>
<div class="card animate delay-3" style="margin-top: 1rem;">
<p class="card-text">
<strong>Key:</strong> كلاهما يجب أن يأخذ في الاعتبار تجميع الدراسة. لا تقم أبدًا بتجميع IPD كما لو كان من تجربة واحدة ضخمة، فهذا يؤدي إلى الإرباك (مفارقة سيمبسون).
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="6" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">التحيز البيئي</h2>
<div class="card animate delay-1">
<p class="card-text">
                    قد يُظهر الانحدار التلوي باستخدام متوسط العمر على مستوى الدراسة أن المرضى الأكبر سنًا يستفيدون أكثر. ولكن قد يكون هذا <strong>تحيزًا بيئيًا</strong>- الارتباط على مستوى الدراسة لا يعكس الحقيقة على مستوى المريض. يمكن لـ IPD فقط أن ينفصل <em>داخل الدراسة</em> from <em>بين تأثيرات الدراسة</em> .
                  </p>
</div>
</div>
</div>
<div class="slide dark" data-index="7">
<div class="content" style="max-width: 700px;">
<h2 class="title cream animate text-center">عندما يكذب الكل بشأن أجزائه</h2>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2" style="font-size: 1.05rem; text-align: center; max-width: 650px; margin-top: 1rem;">
                  مفارقة سيمبسون: الاتجاه الذي يظهر في البيانات المجمعة ينعكس عندما يتم تجميع البيانات بواسطة متغير مربك.
                </p>
<div class="investigation-box animate delay-3" style="margin-top: 1.5rem;">
<h4>المفارقة في الممارسة</h4>
<p style="margin-top: 0.75rem;">وجد تحليل تجريبي ضخم أن العلاج X مفيد <em>بشكل عام</em>. لكن <strong>داخل كل دراسة</strong>، كان ضارًا. كيف؟ خلقت الاختلافات في المخاطر الأساسية بين الدراسات وهمًا، إذ حدث أن السكان الأكثر مرضًا يتلقون المزيد من العلاج، مما يؤدي إلى تضخيم الفائدة الإجمالية.</p>
<p style="margin-top: 0.75rem;">كيتس (2002، <em>BMJ</em>) أظهر أن التجميع عبر الدراسات دون مراعاة التجميع يمكن أن يعكس الاتجاه الواضح للتأثير.</p>
<p style="margin-top: 0.75rem; font-weight: 600; color: var(--gold);">ولهذا السبب تتضمن نماذج IPD ذات المرحلة الواحدة الدراسة كمتغير تجميعي - لمنع الخلط بين الدراسات من التنكر كتأثير علاجي.</p>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">تراث EBCTCG</h3>
<p style="margin-bottom: 0.75rem;">
                    حددت التحليلات الوصفية لـ IPD الخاصة بـ EBCTCG علاج سرطان الثدي لمدة 40 عامًا. أظهر تحليلهم لعام 2005 للتاموكسيفين مقابل عدم العلاج فائدة واضحة في الأورام إيجابية الإستروجين (RR 0.59) ولكن لا فائدة في الأورام السلبية ER (RR 0.97).
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    وبدون وجود IPD، لكان التأثير الإجمالي الإجمالي قد تم تجميعه عبر كلا المجموعتين، مما أدى إلى إضعاف الفائدة وربما حرمان المرضى الذين لديهم ER إيجابي من حجم مكاسبهم.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">شجرة القرار: متى يستحق علاج IPD المتابعة؟</h2>
<div class="decision-tree animate delay-1">
<div class="decision-node" style="background: var(--navy); color: white; padding: 1rem; border-radius: 8px; text-align: center; margin-bottom: 1rem;">
                    هل تشك في حدوث تفاعلات بين العلاج والمتغيرات؟
                  </div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
<div style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #22c55e;">
<strong>Yes →</strong>
<p style="margin-top: 0.5rem; font-size: 0.95rem;">هل يمكنك الحصول على IPD من أكثر من 80% من التجارب؟</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 0.75rem;">
<div style="background: rgba(34,197,94,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: #22c55e;">Yes →</strong> التحليل التلوي لـ IPD بمرحلة واحدة مع مصطلحات التفاعل
                        </div>
<div style="background: rgba(212,175,55,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: var(--gold);">No →</strong> على مرحلتين: طلب IPD المتوفر + الركام للباقي
                        </div>
</div>
</div>
<div style="background: rgba(239,68,68,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #ef4444;">
<strong>No →</strong>
<p style="margin-top: 0.5rem; font-size: 0.95rem;">هل التحيز البيئي مصدر قلق؟</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 0.75rem;">
<div style="background: rgba(212,175,55,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: var(--gold);">Yes →</strong> يفضل IPD حتى بدون التفاعلات
                        </div>
<div style="background: rgba(239,68,68,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: #ef4444;">No →</strong> قد يكون التحليل التلوي للبيانات المجمعة كافيا
                        </div>
</div>
</div>
</div>
<p class="footnote animate delay-2" style="margin-top: 1rem; font-size: 0.85rem; font-style: italic;">قام EBCTCG بجمع البيانات من مئات التجارب على مدار 40 عامًا. تتضمن معظم التحليلات التلوية لـ IPD ما بين 5 إلى 20 تجربة. القرار يعتمد على السؤال وليس الطموح.</p>
</div>
</div>
</div>
<div class="slide light" data-index="10" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">يتكرر النمط</h2>
<p class="direct-address animate delay-1">تذكر الوحدة 3؟ بدا العلاج التعويضي بالهرمونات مفيدًا في الدراسات الرصدية ولكنه ضار في التجارب المعشاة ذات الشواهد. حدث نفس الإخفاء الكلي: أخفت الفائدة الإجمالية ضرر المجموعة الفرعية.</p>
<div class="card animate delay-2">
<p class="card-text">
                    أظهر تحليل IPD لمبادرة صحة المرأة ذلك لاحقًا <strong>التوقيت مهم</strong>- النساء اللاتي بدأن العلاج التعويضي بالهرمونات خلال 10 سنوات من انقطاع الطمث كان لهن نتائج مختلفة عن تلك التي بدأنها في وقت لاحق. وكانت "فرضية التوقيت" غير مرئية في الملخصات المجمعة المنشورة.
                  </p>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; border-right: 4px solid var(--gold);">
<p class="card-text">
<strong>الدرس يتكرر:</strong> يمكن للبيانات المجمعة أن تحجب التفاعلات الحرجة بين العلاج والمتغيرات. سواء كان الأمر يتعلق بحالة الطوارئ في سرطان الثدي أو التوقيت في العلاج التعويضي بالهرمونات، فإن البيانات على المستوى الفردي تكشف ما تخفيه الملخصات.
                  </p>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">الوحدة 15 اختبار</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما هي الميزة الأساسية لـ IPD مقارنة بالتحليل التلوي للبيانات المجمعة؟</p>
<div class="quiz-options" id="m15-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m15-q1', 0, 2, ['More studies doesn\'t help if the data granularity is the same.', 'Cheaper is false\u2014IPD is much more expensive to collect.', 'Correct! IPD allows exploration of patient-level effect modifiers without ecological bias.', 'Faster is false\u2014IPD requires extensive data sharing negotiations.'])">
<span>A.</span> ويتضمن دائما المزيد من الدراسات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m15-q1', 1, 2, ['More studies doesn\'t help if the data granularity is the same.', 'Cheaper is false\u2014IPD is much more expensive to collect.', 'Correct! IPD allows exploration of patient-level effect modifiers without ecological bias.', 'Faster is false\u2014IPD requires extensive data sharing negotiations.'])">
<span>B.</span> إنه أرخص وأسرع
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m15-q1', 2, 2, ['More studies doesn\'t help if the data granularity is the same.', 'Cheaper is false\u2014IPD is much more expensive to collect.', 'Correct! IPD allows exploration of patient-level effect modifiers without ecological bias.', 'Faster is false\u2014IPD requires extensive data sharing negotiations.'])">
<span>C.</span> يمكنه استكشاف التفاعلات بين العلاج والمتغيرات دون تحيز بيئي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m15-q1', 3, 2, ['More studies doesn\'t help if the data granularity is the same.', 'Cheaper is false\u2014IPD is much more expensive to collect.', 'Correct! IPD allows exploration of patient-level effect modifiers without ecological bias.', 'Faster is false\u2014IPD requires extensive data sharing negotiations.'])">
<span>D.</span> إنه يلغي الحاجة إلى نماذج التأثيرات العشوائية
                    </div>
</div>
<div id="m15-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 15 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "وراء كل تقدير مجمع هناك أفراد لا يمكن لمجموع قصصهم أن تحكي."
                </p>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 16: الجرعة</p>
</div>
</div>
 ================ الوحدة 16: الجرعة (الكحول J-curve / Stockwell 2016) ============================================================================================================== 
<div class="module-slides" data-module="16">
<div class="slide dark active" data-index="0">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 16: الجرعة</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 16: الجرعة</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح لماذا تغفل المقارنات الزوجية البسيطة العلاقات بين الجرعة والاستجابة</li>
<li>التمييز بين نماذج الاستجابة للجرعة الخطية والتربيعية والخددية</li>
<li>تفسير الخطوط المكعبة المقيدة بالعقد</li>
<li>تحديد تأثيرات العتبة والمنحنيات على شكل J/U</li>
<li>فهم مقارنة النماذج مع AIC/BIC</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">لعقود من الزمن، شرب معتدل</p>
<p class="title gold animate delay-1 text-center">ظهرت لحماية القلب.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                أظهر "المنحنى على شكل حرف J" أن الأشخاص الذين لا يشربون الخمر لديهم معدل وفيات أعلى بأمراض القلب والأوعية الدموية مقارنة بالذين يشربون الخمر بشكل معتدل. لكن ستوكويل وآخرون. (2016) أظهر أن المنحنى J كان نتيجة لتصنيف خاطئ للشاربين السابقين (الذين توقفوا عن التدخين بسبب المرض) على أنهم "ممتنعون".
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">إجماع علمي بني على الرمال</h2>
<p class="direct-address animate delay-1">بحلول عام 2010، أكدت أكثر من 100 دراسة رصدية وجود منحنى J. علمته الكتب الطبية. واستشهد به أطباء القلب. قامت جماعات الضغط في صناعة النبيذ بتمويل المؤتمرات حول هذا الموضوع.</p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">100+</div>
<div class="stat-label">الدراسات الرصدية التي تؤكد منحنى J</div>
</div>
<div class="stat-box">
<div class="stat-value">15–25%</div>
<div class="stat-label">انخفاض معدل الوفيات القلبية الوعائية لدى الذين يشربون الخمر بشكل معتدل مقابل الممتنعين عن التدخين</div>
</div>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; border-right: 4px solid var(--red);">
<p class="card-text">
                    بدت الأدلة ساحقة. ولكن ماذا لو كانت مجموعة المقارنة - "الممتنعون" - ملوثة؟
                  </p>
</div>
</div>
</div>
<div class="slide dark" data-index="4">
<div class="content" style="max-width: 700px;">
<h2 class="title cream animate text-center">المستسلم المريض</h2>
<p class="title gold animate delay-1 text-center" style="font-size: 1.2rem;">محير مخفي</p>
<div class="gold-line animate delay-2"></div>
<div class="investigation-box animate delay-3" style="margin-top: 1.5rem;">
<h4>المشكلة</h4>
<p style="margin-top: 0.75rem;">غالبًا ما يفعل الأشخاص الذين يتوقفون عن الشرب ذلك <strong>لأنهم مرضى بالفعل</strong>- أمراض الكبد، التفاعلات الدوائية، تشخيص السرطان. تم تصنيف هؤلاء "الشاربين السابقين" على أنهم "ممتنعون" في معظم الدراسات.</p>
<p style="margin-top: 0.75rem;"><strong>التأثير:</strong> ظهرت المجموعة المرجعية (الممتنعون). <em>أقل صحة</em>- ليس لأن الامتناع عن ممارسة الجنس كان ضارًا، ولكن لأن المرضى انضموا إليه.</p>
</div>
<div class="card animate delay-4" style="margin-top: 1rem; background: rgba(212,175,55,0.15); border-right: 4px solid var(--gold);">
<p class="card-text" style="color: var(--cream);">
                    عندما ستوكويل وآخرون. (2016، <em>J مسمار المخدرات الكحول</em>) إزالة الشاربين السابقين وتطبيق تصحيحات جودة الدراسة المناسبة: <strong>اختفى منحنى J</strong>. وكان التأثير الوقائي وهميا.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">التحليل التلوي للجرعة والاستجابة</h2>
<div class="card animate delay-1">
<p class="card-text">
                    يسأل التحليل التلوي القياسي: "هل العلاج X فعال؟" يسأل التحليل التلوي للاستجابة للجرعة: "<strong>عند أي جرعة</strong> هل العلاج X يعمل بشكل أفضل؟" فهو يجسد العلاقة بين مستوى الجرعة والنتيجة عبر دراسات متعددة.
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">خطي</div>
<div class="stat-label">الأبسط: log(RR) = β × جرعة</div>
</div>
<div class="stat-box">
<div class="stat-value">خطي</div>
<div class="stat-label">مرنة: متعددات الحدود متعددة الحدود ذات عقد</div>
</div>
<div class="stat-box">
<div class="stat-value">عقدة</div>
<div class="stat-label">متعددة الحدود: جرعة^p1 + جرعة^p2</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">خطوط مكعبة مقيدة</h2>
<div class="card animate delay-1">
<p class="card-text">
                    مكان RCS <strong>عقدة</strong> عند نقاط الجرعة المحددة مسبقًا وتناسب متعددات الحدود الملساء فيما بينها. عادة 3-5 عقدة في كميات توزيع الجرعة. عقدة خطية وراء الحدود. تقارن اختبارات اللاخطية نموذج الشريحة بنموذج خطي أبسط.
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">AIC</div>
<div class="lesson-content">
<h4>مقارنة النماذج</h4>
<p>مقارنة AIC/BIC الخطية مع ملاءمة الخط. أقل = أفضل. اختبر أيضًا الابتعاد عن الخطية (القيمة p لمصطلحات الشريحة).</p>
</div>
</div>
</div>
</div>
 أداة تفاعلية 
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">تفاعلية: منشئ الجرعة والاستجابة</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  قارن بين الخطية والتربيعية والتناسبات الخطية. شاهد كيف يتغير شكل النموذج مع اختلاف الافتراضات.
                </p>
<div class="animate delay-2" id="doseResponseTool" style="min-height: 300px; background: rgba(30,39,97,0.05); border-radius: 8px; padding: 1rem;">
<div style="display:flex; gap:1rem; margin-bottom:1rem; flex-wrap:wrap;">
<button class="btn" id="doseBtn-linear" onclick="setDoseModel('linear')">خطي</button>
<button class="btn" id="doseBtn-quadratic" onclick="setDoseModel('quadratic')">تربيعية</button>
<button class="btn primary" id="doseBtn-spline" onclick="setDoseModel('spline')">المفتاح (3 عقدة)</button>
</div>
<div id="doseResponsePlotArea" style="width:100%; min-height:240px;"></div>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">تم فضح زيف منحنى J للكحول</h3>
<p style="margin-bottom: 0.75rem;">
                    وجدت إعادة تحليل ستوكويل عام 2016 أنه عندما تم استبعاد شاربي الكحول السابقين بشكل صحيح من المجموعة المرجعية "الممتنعين"، اختفى التأثير الوقائي للشرب المعتدل. كان منحنى J مدفوعًا بالتحيز المرضي.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    كشف التحليل التلوي للاستجابة للجرعة عن الحقيقة: يعتمد شكل المنحنى بشكل حاسم على كيفية تعريف "الجرعة الصفرية". أنشأت الفئة المرجعية الخاطئة فائدة وهمية.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">عندما تكون سياسة شكل المنحنيات</h2>
<p class="direct-address animate delay-1">أثر منحنى J الوهمي على إرشادات الكحول في جميع أنحاء العالم:</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #1a3a5c; color: white;">UK</div>
<div class="lesson-content">
<h4>إرشادات NHS (حتى 2016)</h4>
<p>"الشرب المعتدل قد يحمي القلب" ظهر في التوجيهات الرسمية. بعد تصحيح ستوكويل، قامت المملكة المتحدة بتعديل الحدود إلى 14 وحدة/أسبوع <strong>all</strong> يشربون (21 سابقًا للرجال). لم يتم الإعلان عن أي مبلغ "آمن".</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #3b4d8c; color: white;">US</div>
<div class="lesson-content">
<h4>اللجنة الاستشارية للمبادئ التوجيهية الغذائية</h4>
<p>تم الاستشهاد بدراسات منحنى J حتى عام 2015. وأوصت لجنة عام 2020 بخفض الحدود إلى مشروب واحد يوميًا للرجال، مع الاعتراف بتحيز المجموعة المرجعية.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #2d6a4f; color: white;">AU</div>
<div class="lesson-content">
<h4>المبادئ التوجيهية الأسترالية</h4>
<p>تأخرت حدود الشرب الآمن بسبب أبحاث منحنى J الممولة من الصناعة والتي تروج للاستهلاك المعتدل "الوقائي للقلب"</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">شجرة القرار: هل تحليل الاستجابة للجرعة مناسب؟</h2>
<div class="decision-tree animate delay-1">
<div class="decision-node" style="background: var(--navy); color: white; padding: 1rem; border-radius: 8px; text-align: center; margin-bottom: 1rem;">
                    هل لديك مستويات تعرض ≥3 (وليس فقط المكشوف مقابل غير المكشوف)؟
                  </div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
<div style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #22c55e;">
<strong>Yes →</strong>
<p style="margin-top: 0.5rem; font-size: 0.95rem;">هل العلاقة غير خطية بشكل معقول؟</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 0.75rem;">
<div style="background: rgba(34,197,94,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: #22c55e;">Yes →</strong> الخطوط المكعبة المقيدة (3-5 عقدة).
                        </div>
<div style="background: rgba(212,175,55,0.2); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">
<strong style="color: var(--gold);">No →</strong> قد يكفي الانحدار التلوي الخطي للاستجابة للجرعة
                        </div>
</div>
</div>
<div style="background: rgba(239,68,68,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #ef4444;">
<strong>No →</strong>
<p style="margin-top: 0.5rem; font-size: 0.95rem;">التحليل التلوي القياسي الزوجي (لا يمكن الاستجابة للجرعة بمستويين فقط)</p>
</div>
</div>
<div style="background: rgba(197,48,48,0.15); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-right: 4px solid var(--red);">
<strong style="color: #f87171;">تحذير:</strong> تحقق دائمًا — هل الفئة المرجعية الخاصة بك نظيفة؟ درس منحنى J: مجموعة مرجعية ملوثة تخلق عدم خطية وهمية.
                  </div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 16</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما الذي يجعل الخطوط المكعبة المقيدة مفيدة في التحليل التلوي للجرعة والاستجابة</p>
<div class="quiz-options" id="m16-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m16-q1', 0, 1, ['Splines are not limited to straight lines\u2014that is the linear model.', 'Correct! Splines can model non-linear shapes (J-curves, U-curves, thresholds) while remaining smooth.', 'Fewer studies does not improve with any model choice alone.', 'Splines may increase parameters compared to a linear model.'])">
<span>A.</span> أنها تنتج دائمًا خطًا مستقيمًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m16-q1', 1, 1, ['Splines are not limited to straight lines\u2014that is the linear model.', 'Correct! Splines can model non-linear shapes (J-curves, U-curves, thresholds) while remaining smooth.', 'Fewer studies does not improve with any model choice alone.', 'Splines may increase parameters compared to a linear model.'])">
<span>B.</span> إنهم يلتقطون منحنيات الاستجابة للجرعة غير الخطية بمرونة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m16-q1', 2, 1, ['Splines are not limited to straight lines\u2014that is the linear model.', 'Correct! Splines can model non-linear shapes (J-curves, U-curves, thresholds) while remaining smooth.', 'Fewer studies does not improve with any model choice alone.', 'Splines may increase parameters compared to a linear model.'])">
<span>C.</span> أنها تقلل من عدد الدراسات اللازمة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m16-q1', 3, 1, ['Splines are not limited to straight lines\u2014that is the linear model.', 'Correct! Splines can model non-linear shapes (J-curves, U-curves, thresholds) while remaining smooth.', 'Fewer studies does not improve with any model choice alone.', 'Splines may increase parameters compared to a linear model.'])">
<span>D.</span> ويبسطون النموذج إلى معلمات أقل
                    </div>
</div>
<div id="m16-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">اكتملت الوحدة 16</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "الجرعة هي التي تصنع السم. وشكل المنحنى يكشف ما إذا كان السم حقيقيا."
                </p>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">غياب الدليل ليس دليلاً على الغياب.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 17: الهشاشة</p>
</div>
</div>
 ================ الوحدة 17: الهشاشة (أوسيلتاميفير / جيفرسون 2014) ============================================================================================================== 
<div class="module-slides" data-module="17">
<div class="slide dark active" data-index="0">
<p class="refrain animate">غياب الدليل ليس دليلاً على الغياب.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 17: الهشاشة</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 17: الهشاشة</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>حساب وتفسير مؤشر الهشاشة</li>
<li>استخدم مخططات GOSH لتحديد الدراسات المؤثرة وتأثيرات المجموعة الفرعية</li>
<li>تفسير المخططات القمعية المحسنة</li>
<li>تطبيق نماذج اختيار Copas وPET-PEESE لتحيز النشر</li>
<li>فهم كيف تعزز تحليلات الحساسية استنتاجات التحليل التلوي</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">خزنت الحكومات المليارات</p>
<p class="title gold animate delay-1 text-center">بناء على أدلة لم يتمكنوا من رؤيتها.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                وبعد فيروس H1N1، أنفقت الحكومات المليارات على مخزون الأوسيلتاميفير (تاميفلو). ناضل فريق كوكرين (Jefferson et al. 2014) لسنوات للوصول إلى البيانات غير المنشورة. وعندما فعلوا ذلك أخيرًا، تبخرت الأدلة التي تساعد على منع المضاعفات.
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">مؤشر الهشاشة</h2>
<div class="card animate delay-1">
<p class="card-text">
                    يسأل مؤشر الهشاشة: <strong>"كم عدد المرضى الذين سيحتاجون إلى ذلك" هل تحتاج إلى تغيير النتيجة لقلب نتيجة ذات دلالة إحصائية إلى نتيجة غير مهمة؟"</strong>
                    يقوم بشكل متكرر بإضافة الأحداث (تحويل غير الأحداث إلى أحداث) في المجموعة ذات الأحداث الأقل حتى p &gt; 0.05.
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">FI = 1</div>
<div class="stat-label">هش للغاية. قلب مريض واحد يغير النتيجة.</div>
</div>
<div class="stat-box">
<div class="stat-value">FI &gt; 8</div>
<div class="stat-label">قوي إلى حد معقول. أقل حساسية للنتائج الفردية.</div>
</div>
</div>
</div>
</div>
 أدوات تفاعلية 
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">تفاعلية: حاسبة الهشاشة</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  أدخل جدول 2×2 لحساب مؤشر الهشاشة. شاهد الأحداث تتغير حتى تنقلب الأهمية.
                </p>
<div class="animate delay-2" id="fragilityTool" style="min-height: 200px; background: rgba(30,39,97,0.05); border-radius: 8px; padding: 1rem;">
<div style="display:grid; grid-template-columns: auto 1fr 1fr; gap:0.5rem; max-width:350px; margin-bottom:1rem;">
<div></div>
<div style="font-weight:600; text-align:center;">أحداث</div>
<div style="font-weight:600; text-align:center;">إجمالي N</div>
<div style="font-weight:600;">العلاج</div>
<input id="fi-eventsTx" style="padding:0.3rem; border:1px solid #ccc; border-radius:4px; text-align:center;" type="number" value="15"/>
<input id="fi-nTx" style="padding:0.3rem; border:1px solid #ccc; border-radius:4px; text-align:center;" type="number" value="100"/>
<div style="font-weight:600;">تحكم</div>
<input id="fi-eventsCtrl" style="padding:0.3rem; border:1px solid #ccc; border-radius:4px; text-align:center;" type="number" value="30"/>
<input id="fi-nCtrl" style="padding:0.3rem; border:1px solid #ccc; border-radius:4px; text-align:center;" type="number" value="100"/>
</div>
<button class="btn primary" onclick="calculateFragilityIndex()">حساب مؤشر الهشاشة</button>
<div id="fragilityResult" style="margin-top:1rem; padding:1rem; background:rgba(212,175,55,0.1); border-radius:6px; display:none;"></div>
</div>
</div>
</div>
<div class="slide light" data-index="5" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">مخططات GOSH</h2>
<div class="card animate delay-1">
<p class="card-text">
<strong>نظرة رسومية على عدم تجانس الدراسة</strong> (GOSH) يناسب نماذج التحليل التلوي لجميع مجموعات الدراسات الفرعية الممكنة. ترسم كل نقطة التأثير المجمع مقابل I² لمجموعة فرعية واحدة. تقترح المجموعات مجموعات فرعية متميزة؛ تشير السحب الخارجية إلى دراسة واحدة تقود إلى عدم التجانس.
                  </p>
</div>
<p class="footnote animate delay-2">بالنسبة لدراسات k، هناك 2<sup>k</sup>−1 مجموعات فرعية. بالنسبة إلى k &gt; 15، يتم استخدام أخذ العينات العشوائية.</p>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">مخططات التحويل المحسنة للخطوط الكنتورية</h2>
<div class="card animate delay-1">
<p class="card-text">
                    تُظهر مخططات التحويل القياسية حجم التأثير مقابل الخطأ القياسي. <strong>تحسين الكفاف</strong> تضيف الإصدارات مناطق مظللة لـ p &lt;0.01، وp &lt;0.05، وp &lt;0.10. إذا وقعت الدراسات المفقودة في مناطق غير هامة، فمن المحتمل أن يكون هناك تحيز في النشر. إذا وقعت في مناطق مهمة، فقد تفسر أسباب أخرى (مثل جودة الدراسة) عدم التماثل.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="7" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">اختيار Copas وPET-PEESE</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>نموذج اختيار Copas</h4>
<p>نماذج احتمالية نشر الدراسة كدالة لـ SE وحجم التأثير. يقدر بشكل مشترك التأثير الحقيقي وآلية الاختيار.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>الحيوانات الأليفة بيز</h4>
<p>اختبار تأثير الدقة (PET): تأثيرات التراجع على SE. إذا كان التقاطع = 0، لا يوجد تأثير حقيقي. يستخدم PEESE SE² للحصول على أداء أفضل عند وجود تأثير حقيقي.</p>
</div>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">ملحمة أوسيلتاميفير</h3>
<p style="margin-bottom: 0.75rem;">
                    أظهر التحليل التلوي الأصلي الذي مولته شركة روش (Kaiser 2003) أن الأوسيلتاميفير قلل من مضاعفات الأنفلونزا بنسبة 67%. لكن 8 من 10 تجارب لم يتم نشرها قط. بعد أن حصلت كوكرين على تقارير الدراسة السريرية، انخفضت الفائدة من المضاعفات إلى نسبة غير ملحوظة تبلغ 11%.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    ولم تكن الهشاشة إحصائية فحسب، بل كانت معلوماتية. كانت قاعدة الأدلة نفسها تفتقد معظم البيانات.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">شجرة القرار: تفسير نتائج الهشاشة لديك</h2>
<div class="decision-tree animate delay-1">
<div class="decision-node" style="background: var(--navy); color: white; padding: 1rem; border-radius: 8px; text-align: center; margin-bottom: 1rem;">
                    لقد قمت بحساب مؤشر الهشاشة. ماذا يعني الرقم؟
                  </div>
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.75rem;">
<div style="background: rgba(239,68,68,0.15); padding: 1rem; border-radius: 8px; border-top: 4px solid #ef4444;">
<strong style="color: #f87171; font-size: 1.1rem;">FI ≤ 3</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;"><strong>هشة للغاية.</strong> حفنة من الأحداث المختلفة من شأنها أن تعكس النتيجة. تفسير بحذر شديد.</p>
</div>
<div style="background: rgba(212,175,55,0.15); padding: 1rem; border-radius: 8px; border-top: 4px solid var(--gold);">
<strong style="color: var(--gold); font-size: 1.1rem;">FI 4–8</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;"><strong>هش إلى حد ما.</strong> حساسة للاضطرابات الصغيرة. هل هناك تجارب غير منشورة قد تغير هذا؟</p>
</div>
<div style="background: rgba(34,197,94,0.15); padding: 1rem; border-radius: 8px; border-top: 4px solid #22c55e;">
<strong style="color: #22c55e; font-size: 1.1rem;">FI &gt; 8</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;"><strong>قوي نسبيًا.</strong> ولكن تذكر: الهشاشة ليست سوى بعد واحد. إن تحيز النشر يمكن أن يقوض حتى النتائج القوية.</p>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem; background: rgba(0,0,0,0.05);">
<p class="card-text" style="font-size: 0.9rem;">
                      والش وآخرون. (2014، <em>J Clin Epidemiol</em>) وجدت أنه في 399 تجربة معشاة ذات شواهد منشورة في أفضل المجلات، كان متوسط مؤشر الهشاشة 8 فقط. وكان أكثر من 25% منهم FI ≥ 3. وكانت التجارب التاريخية التي تؤثر على الممارسة السريرية في كثير من الأحيان معلقة بخيط إحصائي.
                    </p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="10" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">ما وراء المؤشر: الهشاشة الهيكلية</h2>
<p class="direct-address animate delay-1">كشفت ملحمة أوسيلتاميفير <strong>ثلاثة أنواع من الهشاشة</strong>- ولا يلتقط مؤشر الهشاشة سوى الحالة الأولى.</p>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #ef4444;">1</div>
<div class="lesson-content">
<h4>الهشاشة الإحصائية (FI)</h4>
<p>كم عدد الأحداث التي تقلب القيمة p؟ وهذا ما يقيسه مؤشر الهشاشة. فهو يحدد مدى الحساسية لنتائج المرضى الفردية.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: var(--gold); color: var(--navy);">2</div>
<div class="lesson-content">
<h4>الهشاشة المعلوماتية</h4>
<p>كم من الأدلة مخفية؟ ثمانية من عشر تجارب روش أوسيلتاميفير لم تُنشر. وكانت قاعدة الأدلة غير مكتملة من الناحية الهيكلية.</p>
</div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number" style="background: #3b82f6;">3</div>
<div class="lesson-content">
<h4>الهشاشة التحليلية</h4>
<p>كم درجة حرية الباحث يمكن أن تغير النتيجة؟ تعريفات مختلفة للنتائج، أو مجموعات التحليل، أو الأساليب الإحصائية.</p>
</div>
</div>
<div class="card animate delay-5" style="margin-top: 1rem; border-right: 4px solid var(--gold);">
<p class="card-text">
<strong>رد الاتصال بالوحدة 10 (الباروكستين):</strong> إعادة التحليل مع تعريفات نتائج مختلفة عكست الاستنتاج تماما. كان ذلك بمثابة هشاشة تحليلية، إذ لم يتم حساب FI أبدًا لأن نقطة النهاية نفسها كانت محل نزاع. ويفحص تقييم المتانة الكامل الأبعاد الثلاثة.
                  </p>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">الاختبار القصير للوحدة 17</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> تشتمل التجربة على 200 مريض لكل ذراع، و12 حدثًا في العلاج، و25 حدثًا تحت السيطرة (قيمة الاحتمال = 0.03). مؤشر الهشاشة هو 3. ماذا يعني هذا؟</p>
<div class="quiz-options" id="m17-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m17-q1', 0, 1, ['Fragility index is about significance, not effect size.', 'Correct! Changing just 3 events would flip p from &lt;0.05 to &gt;0.05. The conclusion is fragile.', 'It means fragile, not robust.', '3 patients are not the minimum for the study\u2014it is the minimum to flip significance.'])">
<span>A.</span> حجم التأثير هو بالضبط 3
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m17-q1', 1, 1, ['Fragility index is about significance, not effect size.', 'Correct! Changing just 3 events would flip p from &lt;0.05 to &gt;0.05. The conclusion is fragile.', 'It means fragile, not robust.', '3 patients are not the minimum for the study\u2014it is the minimum to flip significance.'])">
<span>B.</span> سيؤدي تغيير 3 نتائج للمرضى فقط إلى قلب النتيجة إلى غير مهمة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m17-q1', 2, 1, ['Fragility index is about significance, not effect size.', 'Correct! Changing just 3 events would flip p from &lt;0.05 to &gt;0.05. The conclusion is fragile.', 'It means fragile, not robust.', '3 patients are not the minimum for the study\u2014it is the minimum to flip significance.'])">
<span>C.</span> والنتيجة قوية جدًا مع 3 دراسات تأكيدية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m17-q1', 3, 1, ['Fragility index is about significance, not effect size.', 'Correct! Changing just 3 events would flip p from &lt;0.05 to &gt;0.05. The conclusion is fragile.', 'It means fragile, not robust.', '3 patients are not the minimum for the study\u2014it is the minimum to flip significance.'])">
<span>D.</span> هناك حاجة إلى 3 مرضى على الأقل للدراسة
                    </div>
</div>
<div id="m17-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">اكتملت الوحدة 17</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "الرقم الذي ينجو من كل محاولة لكسره هو الرقم الذي يستحق الثقة."
                </p>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 18: حقوق الملكية</p>
</div>
</div>
 ================ الوحدة 18: حقوق الملكية (استثناءات SPRINT / التقدم الزائد) ============================================================================================================== 
<div class="module-slides" data-module="18">
<div class="slide dark active" data-index="0">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 18: حقوق الملكية</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 18: حقوق الملكية</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>حدد كيفية إنشاء معايير استبعاد التجارب فجوات الأدلة</li>
<li>تطبيق إطار PROGRESS-Plus لتقييم العدالة في الأدلة</li>
<li>استخدم المبادئ التوجيهية لإعداد تقارير PRISMA-Equity</li>
<li>فهم قابلية النقل: عندما تفشل نتائج التجارب في الممارسة</li>
<li>صمم استراتيجيات بحث وتوليف تراعي العدالة</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">أثبت نظام SPRINT أن التحكم الدقيق في ضغط الدم</p>
<p class="title gold animate delay-1 text-center">ينقذ الأرواح. لكن حياة من؟</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                استبعدت تجربة SPRINT التاريخية المرضى الذين يعانون من مرض السكري والسكتة الدماغية السابقة وفشل القلب. أكثر من 75% من مرضى ارتفاع ضغط الدم في الولايات المتحدة لم يكونوا مؤهلين. وكانت الأدلة قوية ولكن قابلية التطبيق كانت ضيقة.
              </p>
</div>
 الشريحة أ: الأغلبية المفقودة 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">المحاكمة التي استبعدت معظم مرضاها</h2>
<div class="card animate delay-1">
<p class="card-text">
                    سجل SPRINT 9361 مريضًا وأثبت أن التحكم المكثف في ضغط الدم (الهدف &lt;120 مم زئبق) قلل من أحداث القلب والأوعية الدموية بنسبة 25٪ (HR 0.75، 95٪ CI 0.64-0.89). لكن معايير الاشتمال تحكي قصة مختلفة.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top: 1rem; background: rgba(197,48,48,0.08); border-right: 3px solid var(--red);">
<p class="card-text"><strong>من تم استبعاده:</strong></p>
<ul style="margin-top: 0.5rem; padding-right: 1.25rem; line-height: 1.8;">
<li><strong>مرض السكري</strong> – 35% من البالغين في الولايات المتحدة يعانون من ارتفاع ضغط الدم</li>
<li><strong>السكتة الدماغية السابقة</strong> — 8% من السكان المصابين بارتفاع ضغط الدم</li>
<li><strong>قصور القلب المصحوب بأعراض</strong> — 6% من البالغين المصابين بارتفاع ضغط الدم</li>
<li><strong>البقاء المتوقع &lt;3 سنوات</strong> - أضعف المرضى</li>
<li><strong>المقيمين في دار التمريض</strong> — مستبعد تمامًا</li>
<li><strong>معدل الترشيح الكبيبي &lt;20 مل/دقيقة</strong> — مرض الكلى المتقدم</li>
</ul>
</div>
<p class="footnote animate delay-3" style="margin-top: 1rem; font-weight: 600;">
                  النتيجة: أكثر من 75% من البالغين الأمريكيين المصابين بارتفاع ضغط الدم لم يكونوا مؤهلين. وكانت الأدلة قوية. ولكن لمن؟
                </p>
</div>
</div>
 الشريحة ب: جغرافية الأدلة 
<div class="slide dark" data-index="4">
<div class="content" style="max-width: 750px;">
<h2 class="title cream animate" style="text-align: center;">من أين تأتي الأدلة</h2>
<div class="gold-line animate delay-1"></div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
<div class="animate delay-2" style="background: rgba(212,175,55,0.1); padding: 1.25rem; border-radius: 8px; border: 1px solid rgba(212,175,55,0.3);">
<p style="font-size: 2rem; font-weight: 700; color: var(--gold);">78%</p>
<p style="font-size: 0.95rem; margin-top: 0.5rem;">من المشاركين في التجارب الكبرى لأمراض القلب والأوعية الدموية جاءوا من بلدان مرتفعة الدخل (2000-2020).</p>
</div>
<div class="animate delay-3" style="background: rgba(212,175,55,0.1); padding: 1.25rem; border-radius: 8px; border: 1px solid rgba(212,175,55,0.3);">
<p style="font-size: 2rem; font-weight: 700; color: var(--gold);">6%</p>
<p style="font-size: 0.95rem; margin-top: 0.5rem;">من أفريقيا جنوب الصحراء الكبرى - حيث تتزايد أمراض القلب والأوعية الدموية بشكل أسرع.</p>
</div>
</div>
<div class="animate delay-4" style="margin-top: 1.5rem; background: rgba(255,255,255,0.05); padding: 1.25rem; border-radius: 8px;">
<p style="font-size: 1rem; line-height: 1.7;">
                    تجارب الحبوب المتعددة: أجريت 4 من 5 تجارب على مجموعات سكانية متوسط مؤشر كتلة الجسم لديهم أقل من 25. The US mean BMI is 30. Drug metabolism, comorbidity patterns, healthcare access, and genetic variation all differ across populations. <strong>لا تضمن الفعالية في مجموعة سكانية معينة الفعالية في مجموعة أخرى.</strong>
</p>
</div>
<p class="footnote animate delay-4" style="margin-top: 1rem; opacity: 0.7; font-size: 0.85rem;">
                  المرجع: التجارب المتعددة الجنسيات وفجوة PROGRESS-Plus
                </p>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">إطار عمل PROGRESS-Plus</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box"><div class="stat-value">P</div><div class="stat-label">مكان الإقامة</div></div>
<div class="stat-box"><div class="stat-value">R</div><div class="stat-label">العرق / العرق</div></div>
<div class="stat-box"><div class="stat-value">O</div><div class="stat-label">المهنة</div></div>
<div class="stat-box"><div class="stat-value">G</div><div class="stat-label">الجنس / الجنس</div></div>
<div class="stat-box"><div class="stat-value">R</div><div class="stat-label">الدين</div></div>
<div class="stat-box"><div class="stat-value">E</div><div class="stat-label">التعليم</div></div>
<div class="stat-box"><div class="stat-value">S</div><div class="stat-label">SES (اجتماعي واقتصادي)</div></div>
<div class="stat-box"><div class="stat-value">S</div><div class="stat-label">رأس المال الاجتماعي</div></div>
</div>
<p class="footnote animate delay-2"><strong>بالإضافة إلى:</strong> العمر والإعاقة والتوجه الجنسي والفئات الضعيفة الأخرى.</p>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">PRISMA-المساواة وقابلية النقل</h2>
<div class="card animate delay-1">
<p class="card-text">
<strong>PRISMA-الأسهم</strong> يوسع برنامج PRISMA ليتطلب الإبلاغ عن كيفية معالجة الإنصاف في المراجعة: الخصائص السكانية، وتحليلات المجموعات الفرعية حسب العيوب، وتقييم قابلية التطبيق على السكان المحرومين.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top:1rem;">
<p class="card-text">
<strong>قابلية النقل</strong>: فعالية التجربة لا تساوي فعالية العالم الحقيقي. توجد طرق لإعادة وزن بيانات التجارب لتتناسب مع التوزيع السكاني المستهدف.
                  </p>
</div>
</div>
</div>
 الشريحة ج: سؤال قابلية النقل 
<div class="slide light" data-index="7" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">من التجربة إلى العالم الحقيقي: قابلية النقل</h2>
<div class="card animate delay-1">
<p class="card-text">
<strong>قابلية النقل</strong> = هل يمكن تطبيق نتائج مجموعة التجربة X على المجموعة السكانية المستهدفة Y؟ هذا ليس سؤالا فلسفيا، بل له أساليب رسمية.
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>الاحتمالية العكسية لترجيح المشاركة (IPPW)</h4>
<p>إعادة وزن المشاركين في التجربة بحيث يشبهون المجموعة السكانية المستهدفة في المتغيرات المشتركة الرئيسية.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>مؤشر قابلية التعميم</h4>
<p>يحدد مدى تشابه العينة التجريبية مع المجموعة السكانية المستهدفة من حيث الخصائص المرصودة.</p>
</div>
</div>
<div class="card animate delay-4" style="margin-top: 1rem; background: rgba(212,175,55,0.08); border-right: 3px solid var(--gold);">
<p class="card-text">
<strong>ستيوارت وآخرون (2015، <em>ستات ميد</em>):</strong> عندما تم إعادة ترجيح نتائج SPRINT لتتناسب مع سكان الولايات المتحدة الذين يعانون من ارتفاع ضغط الدم، تم تخفيف الفائدة المقدرة - HR 0.82 (مقابل 0.75 في التجربة). العلاج لا يزال يعمل. لكن الحجم يتغير عندما يتغير عدد السكان.
                  </p>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">SPRINT والأغلبية المفقودة</h3>
<p style="margin-bottom: 0.75rem;">
                    كانت SPRINT تجربة جيدة التصميم شملت 9361 مريضًا. لقد غيرت نتائجها (HR 0.75 للتحكم المكثف مقابل التحكم القياسي في ضغط الدم) المبادئ التوجيهية في جميع أنحاء العالم. لكن التحليلات اللاحقة أظهرت أن الفائدة كانت أقوى في المجموعة الفرعية الأكثر تشابهًا مع مجموعة التجربة، وكانت غير مؤكدة بالنسبة للمجموعات المستبعدة.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    العدالة في تركيب الأدلة لا تعني مجرد السؤال "هل ينجح؟" ولكن "لمن يعمل؟"
                  </p>
</div>
</div>
</div>
 الشريحة د: شجرة القرار 
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">شجرة القرار: تقييم الأسهم للمراجعة الخاصة بك</h2>
<div class="decision-tree animate delay-1" style="font-size: 0.95rem; line-height: 1.7;">
<div class="card" style="background: var(--navy); color: var(--cream); padding: 1rem; border-radius: 8px;">
<p><strong>الجذر:</strong> هل تأتي أدلة المراجعة الخاصة بك من مجموعات سكانية مماثلة لهدفك؟</p>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
<div style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--green);">
<p><strong>YES</strong> → جيد. لكن تحقق: هل يتم الإبلاغ عن المجموعات الفرعية (العمر، الجنس، العرق، الحالة الاجتماعية والاقتصادية) بشكل منفصل؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1rem; font-size: 0.9rem;">
<li><strong>Yes:</strong> استخدم تأثيرات المجموعة الفرعية للتوصيات الخاصة بالسكان</li>
<li><strong>No:</strong> ضع علامة على أنها قيد - فجوة العدالة في إعداد التقارير</li>
</ul>
</div>
<div style="background: rgba(197,48,48,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--red);">
<p><strong>NO</strong> → هل يكشف تحليل PROGRESS-Plus عن تأثيرات تفاضلية؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1rem; font-size: 0.9rem;">
<li><strong>Yes:</strong> هناك حاجة إلى توصيات خاصة بالسكان. النظر في إعادة وزن قابلية النقل.</li>
<li><strong>No:</strong> تعميم حذر مع بيان الإنصاف الصريح في المناقشة</li>
</ul>
</div>
</div>
</div>
</div>
</div>
 الشريحة E: رد الاتصال بالوحدة 3 
<div class="slide dark" data-index="10" data-tier="mastery">
<span class="tier-badge mastery" style="position:absolute; top:1.5rem; right:1.5rem;">منهجي</span>
<div class="content" style="max-width: 700px;">
<h2 class="title cream animate" style="text-align: center;">رد الاتصال: إعادة النظر في درس العلاج التعويضي بالهرمونات</h2>
<div class="gold-line animate delay-1"></div>
<div class="card animate delay-2" style="background: rgba(212,175,55,0.1); border: 1px solid rgba(212,175,55,0.3); margin-top: 1.5rem;">
<p class="card-text" style="color: var(--cream);">
                    تذكر الوحدة 3؟ وأظهرت قصة HRT ذلك <strong>تحيز المستخدم الصحي</strong> جعل العلاج الضار يبدو نافعا. قد يكون لـ SPRINT مشكلة معاكسة - فتأثير "المتطوع السليم" قد يؤدي إلى ظهور علاج فعال <em>more</em> فعال مما سيكون عليه في العالم الحقيقي.
                  </p>
</div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; margin-top: 1.5rem; font-style: italic; opacity: 0.9;">
                  ينبغي لكل تحليل تلوي أن يسأل: من الذي تم تضمينه؟ من تم استبعاده؟ وهل هذا مهم؟
                </p>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 18</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما الذي يساعد إطار عمل PROGRESS-Plus المراجعين على تقييمه؟</p>
<div class="quiz-options" id="m18-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m18-q1', 0, 1, ['PROGRESS-Plus is about equity, not statistical methods.', 'Correct! PROGRESS-Plus prompts reviewers to consider whether evidence applies across social determinants of health.', 'Risk of bias tools (RoB 2.0) handle internal validity.', 'GRADE handles certainty of evidence.'])">
<span>A.</span> عدم التجانس الإحصائي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m18-q1', 1, 1, ['PROGRESS-Plus is about equity, not statistical methods.', 'Correct! PROGRESS-Plus prompts reviewers to consider whether evidence applies across social determinants of health.', 'Risk of bias tools (RoB 2.0) handle internal validity.', 'GRADE handles certainty of evidence.'])">
<span>B.</span> الإنصاف وقابلية التطبيق بين السكان المحرومين
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m18-q1', 2, 1, ['PROGRESS-Plus is about equity, not statistical methods.', 'Correct! PROGRESS-Plus prompts reviewers to consider whether evidence applies across social determinants of health.', 'Risk of bias tools (RoB 2.0) handle internal validity.', 'GRADE handles certainty of evidence.'])">
<span>C.</span> الصلاحية الداخلية للدراسات المشمولة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m18-q1', 3, 1, ['PROGRESS-Plus is about equity, not statistical methods.', 'Correct! PROGRESS-Plus prompts reviewers to consider whether evidence applies across social determinants of health.', 'Risk of bias tools (RoB 2.0) handle internal validity.', 'GRADE handles certainty of evidence.'])">
<span>D.</span> اليقين العام بالأدلة
                    </div>
</div>
<div id="m18-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">اكتملت الوحدة 18</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "إن الأدلة التي تستبعد الضعفاء لا يمكن أن تدعي أنها تخدمهم."
                </p>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 19: الآلة</p>
</div>
</div>
 =============== الوحدة 19: الآلة (فحص كوكرين لفيروس كورونا) ============================================================================================================== 
<div class="module-slides" data-module="19">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 19: الآلة</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 19: الآلة</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>وصف كيفية استخدام الذكاء الاصطناعي/التعلم الآلي في فحص المراجعة المنهجية</li>
<li>شرح التعلم النشط وسير عمل الإنسان في الحلقة</li>
<li>تقييم التحقق من صحة الأتمتة: الاستدعاء وتوفير أعباء العمل والمخاطر</li>
<li>التعرف على القيود والتحيزات في الفحص الخوارزمي</li>
<li>تطبيق أطر الاستخدام المسؤول للذكاء الاصطناعي في تجميع الأدلة</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">عندما ضرب فيروس كورونا، وصلت أوراق</p>
<p class="title gold animate delay-1 text-center">بشكل أسرع مما يستطيع البشر قراءته.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                بحلول عام 2021، كان هناك أكثر من 300000 ورقة بحثية عن فيروس كورونا. استخدمت شركة Cochrane مصنفات التعلم الآلي لفرز الدراسات من أجل مراجعاتها السريعة، مما أدى إلى تقليل عبء عمل الفحص بنسبة تصل إلى 70% مع الحفاظ على التذكر بنسبة تزيد عن 95%.
              </p>
</div>
 الطوفان 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الطوفان</h2>
<div class="card animate delay-1">
<p>بحلول أبريل 2020، <strong>ظهرت 4000 نسخة أولية من فيروس كورونا كل أسبوع</strong>.</p>
<p style="margin-top: 0.5rem;">تم فهرسة PubMed <strong>500 مقالة جديدة عن فيروس كورونا يوميًا</strong>.</p>
<p style="margin-top: 0.5rem;">وصلت قائمة انتظار فحص كوكرين <strong>10000 عنوان لم تتم مراجعته</strong>.</p>
</div>
<div class="investigation-box animate delay-2" style="margin-top: 1rem;">
<div class="investigation-header"><span class="icon">🔍</span> رياضيات الاستحالة</div>
<div class="investigation-content">
<p>زوج من المراجعين يفحصون ~ 200 عنوان في اليوم.</p>
<p><strong>عند 500 مقالة جديدة في اليوم، كانوا يتأخرون أكثر مع كل ساعة.</strong></p>
<p style="margin-top: 0.5rem; font-style: italic;">كان الاستعراض الحي يموت قبل أن يتمكن من العيش.</p>
</div>
</div>
</div>
</div>
 المحاولات الأولى 
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">المحاولات الأولى</h2>
<p class="direct-address animate delay-1">الفكرة لم تكن جديدة. كوهين وآخرون. (2006، JAMIA) أظهر لأول مرة أن التعلم الآلي يمكن أن يقلل من عبء عمل الفحص بنسبة 50٪ - مع خسارة أقل من 5٪ في الاستدعاء.</p>
<div class="lesson-item animate delay-2">
<div class="lesson-icon">📅</div>
<div class="lesson-text"><strong>2006:</strong> كوهين وآخرون. - مصنفات SVM لمراجعات فئة الأدوية. إثبات المفهوم.</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-icon">📅</div>
<div class="lesson-text"><strong>2016:</strong> RobotReviewer (Marshall et al., JMLR) — التعلم الآلي لمخاطر تقييم التحيز. موثوقية Inter-Rater مماثلة للمراجعين البشريين.</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-icon">📅</div>
<div class="lesson-text"><strong>2021:</strong> ASReview (van de Schoot et al., Nature Machine Intelligence) — التعلم النشط الذي يحاكي تقليل عبء العمل بنسبة 95%.</div>
</div>
<p class="animate delay-3" style="margin-top: 1rem; font-style: italic; color: var(--gold);">لكن المحاكاة ليست حقيقة. سيكون فيروس كورونا أول اختبار حقيقي على نطاق واسع.</p>
</div>
</div>
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">الذكاء الاصطناعي في المراجعات المنهجية</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>تحديد أولويات الفحص</h4>
<p>يصنف التعلم النشط الاستشهادات حسب صلتها بالموضوع. يقوم المراجعون بفحص العناصر ذات الصلة على الأرجح أولاً.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>مساعدة في استخراج البيانات</h4>
<p>يستخرج البرمجة اللغوية العصبية عناصر PICO ونتائجها ونتائجها. Always requires human verification.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>خطر تقييم التحيز</h4>
<p>تتنبأ مصنفات ML بمجالات RoB. تجريبي – يظل الحكم البشري هو المعيار الذهبي.</p>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">التحقق من الأتمتة</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box">
<div class="stat-value">استدعاء</div>
<div class="stat-label">&gt; مطلوب بنسبة 95%. دراسة واحدة مفقودة يمكن أن تغير الاستنتاجات.</div>
</div>
<div class="stat-box">
<div class="stat-value">دبليو إس إس @ 95%</div>
<div class="stat-label">تم حفظ العمل بعد أخذ العينات بنسبة استدعاء تصل إلى 95%.</div>
</div>
<div class="stat-box">
<div class="stat-value">إيقاف</div>
<div class="stat-label">متى يجب التوقف عن الفحص؟ عتبة متتالية غير ذات صلة.</div>
</div>
</div>
<div class="card animate delay-2" style="margin-top:1rem;">
<p class="card-text">
<strong>التوتر الأساسي:</strong> توفر الأتمتة الوقت ولكنها تقدم مصدرًا جديدًا للخطأ. قم دائمًا بالإبلاغ عن الأداة والإصدار وبيانات التدريب ومعايير التوقف.
                  </p>
</div>
</div>
</div>
 أزمة التحقق 
<div class="slide dark" data-index="7">
<div class="content" style="max-width: 700px;">
<div class="investigation-box animate">
<div class="investigation-header"><span class="icon">🔍</span> مفارقة التحقق من الصحة</div>
<div class="investigation-content">
<p>لمعرفة ما إذا كان الجهاز قد فاتته دراسة ذات صلة، <strong>أنت بحاجة إلى إنسان لفحص كل شيء</strong>.</p>
<p style="margin-top: 0.5rem;">ولكن إذا قام البشر بفحص كل شيء، <strong>لماذا استخدام الجهاز ؟</strong></p>
<p style="margin-top: 1rem;">الحل: <strong>التحقق من صحة الرفض المحتمل</strong>.</p>
<ul style="margin-top: 0.5rem;">
<li>فحص عينة عشوائية بنسبة 10% بواسطة كل من الإنسان والآلة</li>
<li>قارن: هل أخطأت الآلة ما وجده الإنسان؟</li>
<li>إذا انخفض معدل الاستدعاء إلى أقل من 95%، فأعد تدريب الفحص البشري ووسعه</li>
</ul>
<p style="margin-top: 1rem; font-style: italic;">ثق، ولكن تحقق. تكتسب الآلة دورها، ولا ترثه.</p>
</div>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">استجابة كوكرين لفيروس كورونا</h3>
<p style="margin-bottom: 0.75rem;">
                    قامت شركة كوكرين ببناء سجل دراسة كوفيد-19 باستخدام مصنفات التعلم الآلي المدربة على ملايين السجلات. حقق النظام حساسية بنسبة 99% مع تقليل الفحص اليدوي من أسابيع إلى أيام.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    لكن الآلة كانت أداة وليست بديلاً. تم التحقق من كل دراسة مشمولة من قبل المراجعين البشريين. الدرس المستفاد: الذكاء الاصطناعي يعزز المراجع، ولا يحل محله.
                  </p>
</div>
</div>
</div>
 الدراسة التي لم يتم العثور عليها تقريبًا 
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">الدراسة التي لم يتم العثور عليها تقريبًا</h2>
<div class="story-box animate delay-1">
<p>في يونيو 2020، نشرت تجربة RECOVERY نتائجها الخاصة بالديكساميثازون:<strong>الأول ثبت أن العلاج يقلل من وفيات فيروس كورونا</strong> (الوفيات لمدة 28 يومًا: 22.9% مقابل 25.7%، RR 0.83).</p>
<p style="margin-top: 0.5rem;">ظهرت النسخة الأولية على medRxiv بعنوان غير قياسي. حدثت مثل هذه السيناريوهات بشكل متكرر أثناء الوباء: فقد صنف مصنفو تعلم الآلة، المدربون على المصطلحات الموجودة، الإطارات غير المألوفة في مرتبة منخفضة.</p>
<p style="margin-top: 0.5rem;">في العديد من المراجعات الحية، قام المراجعون البشريون بمسح العناوين المميزة بالتعرف على أسماء الأدوية الرئيسية وقاموا بتصعيد الدراسات التي قلل المصنفون من أولوياتها.</p>
<p style="margin-top: 1rem; font-weight: 600; color: var(--gold);">وبدون هؤلاء البشر، ربما انتظرت نتائج العلاج التاريخية أسابيع قبل أن تدخل المراجعة الحية.</p>
<p style="margin-top: 0.5rem; font-style: italic;">الآلة تقرأ بشكل أسرع. يقرأ الإنسان بشكل أعمق. ولا يكفي أي منهما وحده.</p>
</div>
</div>
</div>
 شجرة القرار: متى يجب عليك استخدام الذكاء الاصطناعي؟ 
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">شجرة القرار: متى يجب عليك استخدام الذكاء الاصطناعي؟</h2>
<div class="decision-tree animate delay-1">
<div class="decision-node" style="background: var(--navy); color: white; padding: 1rem; border-radius: 8px; text-align: center; margin-bottom: 1rem;">
                    هل ستعرض مراجعتك أكثر من 5000 عنوان؟
                  </div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
<div class="decision-option" style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #22c55e;">
<strong>نعم → فكر في الفحص بمساعدة الذكاء الاصطناعي</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;">تحديد أولويات التعلم النشط. شاشة مزدوجة عشوائية بنسبة 10%. توقف عندما تسفر 3 دفعات متتالية عن 0 دراسات ذات صلة.</p>
<p style="margin-top: 0.5rem; font-size: 0.85rem; font-style: italic;">التقرير: نوع المصنف، بيانات التدريب، الاستدعاء عند الإيقاف، قاعدة الإيقاف.</p>
</div>
<div class="decision-option" style="background: rgba(239,68,68,0.1); padding: 1rem; border-radius: 8px; border-right: 4px solid #ef4444;">
<strong>لا ← الفحص اليدوي ممكن</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;">بالنسبة لـ &lt;5000 عنوان، يظل الفحص البشري المزدوج هو المعيار الذهبي. يضيف الذكاء الاصطناعي التعقيد دون فائدة متناسبة.</p>
</div>
</div>
<div class="decision-node animate delay-2" style="background: rgba(212,175,55,0.15); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-right: 4px solid var(--gold);">
<strong>هل هذه مراجعة حية أم سريعة؟</strong>
<p style="margin-top: 0.5rem; font-size: 0.9rem;">إذا كانت الإجابة بنعم ← الذكاء الاصطناعي ذو قيمة خاصة. إعادة تدريب المصنف المستمر على الأدلة الجديدة. لكن: <strong>لا تدع الجهاز أبدًا يتخذ قرار التضمين النهائي.</strong></p>
</div>
</div>
</div>
</div>
 يتكرر النمط 
<div class="slide light" data-index="11" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">يتكرر النمط</h2>
<p class="direct-address animate delay-1">تذكر الوحدة 6؟ قام بولديرمانز بتلفيق بيانات DECREASE التي وجهت المبادئ التوجيهية لحاصرات بيتا المحيطة بالجراحة لمدة عقد من الزمن.</p>
<div class="card animate delay-2">
<p>يمكن للذكاء الاصطناعي الآن اكتشاف الحالات الشاذة الإحصائية تلقائيًا:</p>
<ul style="margin-top: 0.5rem;">
<li><strong>اختبار GRIM:</strong> هل الوسائل المبلغ عنها متوافقة مع أحجام العينات الصحيحة؟</li>
<li><strong>SPRITE:</strong> هل يمكن إعادة بناء الإحصائيات الموجزة المبلغ عنها من بيانات فردية معقولة؟</li>
<li><strong>Statcheck:</strong> هل تتطابق القيم الاحتمالية المبلغ عنها مع إحصائيات الاختبار؟</li>
</ul>
<p style="margin-top: 1rem;">وجدت هذه الأدوات حالات شاذة في <strong>مئات الأبحاث المنشورة</strong>— أسرع من أي مدقق بشري.</p>
<p style="margin-top: 0.5rem; font-style: italic; color: var(--gold);">لكن الآلة تلوح. قضاة البشر. ويظل قرار التراجع إنسانيًا إلى حد كبير.</p>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="12">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 19</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما هو الحد الأدنى المقبول للفحص بمساعدة الذكاء الاصطناعي في المراجعات المنهجية؟</p>
<div class="quiz-options" id="m19-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m19-q1', 0, 2, ['80% means missing 1 in 5 relevant studies\u2014too many.', '90% still risks missing important studies.', 'Correct! &gt;95% recall is the accepted threshold to minimize the risk of missing relevant studies.', 'While ideal, 100% recall is practically impossible with any automated system.'])">
<span>A.</span> 80%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m19-q1', 1, 2, ['80% means missing 1 in 5 relevant studies\u2014too many.', '90% still risks missing important studies.', 'Correct! &gt;95% recall is the accepted threshold to minimize the risk of missing relevant studies.', 'While ideal, 100% recall is practically impossible with any automated system.'])">
<span>B.</span> 90%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m19-q1', 2, 2, ['80% means missing 1 in 5 relevant studies\u2014too many.', '90% still risks missing important studies.', 'Correct! &gt;95% recall is the accepted threshold to minimize the risk of missing relevant studies.', 'While ideal, 100% recall is practically impossible with any automated system.'])">
<span>C.</span> &gt;95%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m19-q1', 3, 2, ['80% means missing 1 in 5 relevant studies\u2014too many.', '90% still risks missing important studies.', 'Correct! &gt;95% recall is the accepted threshold to minimize the risk of missing relevant studies.', 'While ideal, 100% recall is practically impossible with any automated system.'])">
<span>D.</span> 100%
                    </div>
</div>
<div id="m19-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="13">
<div class="content" style="text-align: center;">
<p class="title gold animate">أكمل الوحدة 19</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "الآلة تقرأ بشكل أسرع. والإنسان يقرأ بشكل أعمق. ومعاً، يقرأان الحقيقة."
                </p>
</div>
</div>
<div class="slide black" data-index="14">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 20: النوعية</p>
</div>
</div>
 ================ الوحدة 20: النوعية (Bohren 2015 - رعاية الأمومة) ============================================================================================================== 
<div class="module-slides" data-module="20">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الأساليب تحمي المرضى من ثقتنا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 20: النوعية</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 20: النوعية</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>اشرح لماذا تتطلب بعض الأسئلة تركيب أدلة نوعية</li>
<li>وصف الإثنوغرافيا الفوقية (نوبليت وهير) والتوليف الموضوعي</li>
<li>تطبيق إطار CERQual لتقييم الثقة في النتائج النوعية</li>
<li>فهم مناهج التوليف ذات الأساليب المختلطة</li>
<li>التعرف على متى تغير الأدلة النوعية الممارسة</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">طرحت منظمة الصحة العالمية سؤالاً</p>
<p class="title gold animate delay-1 text-center">لا يمكن للـ RCT الإجابة.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                لماذا تعاني النساء في جميع أنحاء العالم من عدم الاحترام وسوء المعاملة أثناء الولادة؟ بوهرين وآخرون. (2015) قام بتجميع 65 دراسة نوعية من 34 دولة في إطار من سبعة مجالات لسوء المعاملة.
              </p>
</div>
 الشريحة أ: سؤال يتجاوز التوزيع العشوائي 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">سؤال يتجاوز العشوائية</h2>
<div class="card animate delay-1" style="background: rgba(197,48,48,0.06); border-right: 3px solid var(--red);">
<p class="card-text">
                    في عام 2014، شكلت منظمة الصحة العالمية لجنة لمعالجة الأزمة العالمية: حيث كانت النساء يتعرضن للإيذاء الجسدي، والإهانة اللفظية، وحرمانهن من الرعاية أثناء الولادة. لم يكن هذا حدثًا نادرًا، فقد جاءت التقارير من هناك <strong>34 دولة</strong>.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text">
                    كانوا بحاجة إلى فهم <strong>WHY</strong>. ما الذي يدفع إلى عدم الاحترام وسوء المعاملة في رعاية الأمومة؟
                  </p>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; background: rgba(212,175,55,0.08); border-right: 3px solid var(--gold);">
<p class="card-text">
                    لا يمكن لأي تجربة معشاة ذات شواهد أن تجيب على هذا. لا يمكنك توزيع النساء بشكل عشوائي على الرعاية المسيئة مقابل الرعاية المحترمة. لا يمكنك أعمى القابلات. لا يمكنك قياس "الكرامة" على مقياس ليكرت.
                    <strong>وكان يجب أن تكون الأدلة نوعية.</strong>
</p>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">ميتا الاثنوغرافيا</h2>
<div class="card animate delay-1">
<p class="card-text">
                    تم تطويره بواسطة نوبليت وهير (1988)، الإثنوغرافيا الوصفية <strong>يترجم</strong>
                    المفاهيم عبر الدراسات بدلا من تجميع الأرقام. وينتج أطر تفسيرية جديدة (بنيات من الدرجة الثالثة) من بيانات الدرجة الأولى (اقتباسات المشاركين) والبيانات من الدرجة الثانية (تفسيرات المؤلف).
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">متبادل</div>
<div class="stat-label">الدراسات تؤكد بعضها البعض</div>
</div>
<div class="stat-box">
<div class="stat-value">تفنيدي</div>
<div class="stat-label">الدراسات تتناقض مع بعضها البعض</div>
</div>
<div class="stat-box">
<div class="stat-value">سطر<br/>الوسيطة</div>
<div class="stat-label">الدراسات تبني نظرية جديدة</div>
</div>
</div>
</div>
</div>
 الشريحة ب: مجالات بوهرين السبعة 
<div class="slide dark" data-index="5">
<div class="content" style="max-width: 750px;">
<h2 class="title cream animate" style="text-align: center;">ما وجده بورين: تصنيف سوء المعاملة</h2>
<div class="gold-line animate delay-1"></div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-top: 1.5rem;">
<div class="animate delay-2" style="background: rgba(197,48,48,0.15); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">1. الاعتداء الجسدي</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">الضرب والقرص والصفع أثناء المخاض</p>
</div>
<div class="animate delay-2" style="background: rgba(197,48,48,0.15); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">2. الاعتداء الجنسي</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">اللمس غير اللائق، والإجراءات غير الرضائية</p>
</div>
<div class="animate delay-3" style="background: rgba(197,48,48,0.12); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">3. الإساءة اللفظية</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">الصراخ والتهديدات والتعليقات القضائية</p>
</div>
<div class="animate delay-3" style="background: rgba(197,48,48,0.12); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">4. الوصمة والتمييز</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">على أساس حالة فيروس نقص المناعة البشرية، والانتماء العرقي، والعمر، والفقر</p>
</div>
<div class="animate delay-4" style="background: rgba(197,48,48,0.09); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">5. الفشل في المعايير المهنية</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">الإهمال، وعدم وجود موافقة مستنيرة</p>
</div>
<div class="animate delay-4" style="background: rgba(197,48,48,0.09); padding: 0.75rem 1rem; border-radius: 6px;">
<strong style="color: var(--gold);">6. علاقة سيئة</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">ضعف التواصل والاستخفاف</p>
</div>
</div>
<div class="animate delay-4" style="background: rgba(197,48,48,0.06); padding: 0.75rem 1rem; border-radius: 6px; margin-top: 0.75rem; text-align: center;">
<strong style="color: var(--gold);">7. ظروف النظام الصحي</strong>
<p style="font-size: 0.9rem; margin-top: 0.25rem;">الاكتظاظ، ونقص الموظفين، ونقص الإمدادات</p>
</div>
<p class="animate delay-4" style="font-size: 1rem; text-align: center; margin-top: 1.25rem; font-style: italic; opacity: 0.9;">
                  65 دراسة. 34 دولة. تتكرر نفس الأنماط عبر اللغات والثقافات والأنظمة. لم تكن هذه حكاية. وقد تم توليف هذا الأدلة.
                </p>
</div>
</div>
<div class="slide light" data-index="6" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">CERQual: الثقة في الأدلة النوعية</h2>
<div class="card animate delay-1">
<p class="card-text">
                    يقوم CERQual بتقييم الثقة في نتائج المراجعة النوعية عبر أربعة مكونات:
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">1</div>
<div class="lesson-content"><h4>القيود المنهجية</h4><p>جودة الدراسات المساهمة.</p></div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">2</div>
<div class="lesson-content"><h4>التماسك</h4><p>مدى دعم البيانات لهذه النتائج.</p></div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">3</div>
<div class="lesson-content"><h4>الكفاية</h4><p>ثراء البيانات (وليس فقط عدد الدراسات).</p></div>
</div>
<div class="lesson-item animate delay-4">
<div class="lesson-number">4</div>
<div class="lesson-content"><h4>الصلة</h4><p>قابلية التطبيق على سياق سؤال المراجعة.</p></div>
</div>
</div>
</div>
 الشريحة ج: من الدليل إلى العمل 
<div class="slide light" data-index="7">
<div class="content">
<h2 class="title navy animate">عندما تكون الأدلة النوعية ممارسة التغييرات</h2>
<div class="card animate delay-1">
<p class="card-text">
                    أفاد تجميع بورين بتوصيات منظمة الصحة العالمية <strong>لعام 2018 بشأن الرعاية أثناء الولادة لتجربة ولادة إيجابية</strong>. تغييرات محددة ترتكز على الأدلة النوعية:
                  </p>
</div>
<div class="stats-grid animate delay-2" style="margin-top: 1rem;">
<div class="stat-box" style="text-align: right; padding: 1rem;">
<div class="stat-value" style="font-size: 1.2rem;">تفصيل. 15</div>
<div class="stat-label">الرفقة أثناء المخاض</div>
</div>
<div class="stat-box" style="text-align: right; padding: 1rem;">
<div class="stat-value" style="font-size: 1.2rem;">تفصيل. 1</div>
<div class="stat-label">رعاية الأمومة المحترمة</div>
</div>
<div class="stat-box" style="text-align: right; padding: 1rem;">
<div class="stat-value" style="font-size: 1.2rem;">تفصيل. 3</div>
<div class="stat-label">التواصل الفعال</div>
</div>
<div class="stat-box" style="text-align: right; padding: 1rem;">
<div class="stat-value" style="font-size: 1.2rem;">تفصيل. 12</div>
<div class="stat-label">الدعم العاطفي</div>
</div>
</div>
<p class="footnote animate delay-3" style="margin-top: 1rem; font-weight: 600;">
                  وهذه التوصيات - المبنية على أدلة نوعية - توجه الآن رعاية الأمومة في 194 دولة عضو في منظمة الصحة العالمية. لا يمكن لأي قطعة أرض في الغابة أن تنتجها. لا يمكن لأي إحصائية أن تكشف عنهم.
                </p>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="8">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">إطار بوهرين لسوء المعاملة</h3>
<p style="margin-bottom: 0.75rem;">
                    حدد التوليف النوعي لعام 2015 سبعة مجالات: الاعتداء الجسدي، والاعتداء الجنسي، والإساءة اللفظية، والوصم والتمييز، وعدم تلبية المعايير المهنية، وسوء العلاقات، وظروف النظام الصحي. استرشد هذا الإطار بتوصيات منظمة الصحة العالمية بشأن الرعاية أثناء الولادة (2018).
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    لا يمكن لأي قيمة p أن تعبر عن تجربة الصفع أثناء المخاض. أعطى التركيب النوعي صوتًا لما لا تستطيع الأرقام تقديمه.
                  </p>
</div>
</div>
</div>
 الشريحة د: شجرة القرار 
<div class="slide light" data-index="9">
<div class="content">
<h2 class="title navy animate">شجرة القرار: متى يكون التوليف النوعي مناسبًا؟</h2>
<div class="decision-tree animate delay-1" style="font-size: 0.95rem; line-height: 1.7;">
<div class="card" style="background: var(--navy); color: var(--cream); padding: 1rem; border-radius: 8px;">
<p><strong>الجذر:</strong> هل سؤال بحثك يتعلق بالتجارب أو التصورات أو العوائق أو الميسرات؟</p>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
<div style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--green);">
<p><strong>YES</strong> → هل سؤالك حول كيف أو لماذا، وليس فقط ما إذا كان؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1rem; font-size: 0.9rem;">
<li><strong>Yes:</strong> تركيب الأدلة النوعية (الإثنوغرافيا التلوية، التوليف الموضوعي، أو توليف الإطار)</li>
<li><strong>No:</strong> فكر في الأساليب المختلطة: كمية لـ التأثير + النوعي للآلية</li>
</ul>
</div>
<div style="background: rgba(212,175,55,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--gold);">
<p><strong>NO</strong> → هل سؤالك حول الفعالية/الفعالية؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1rem; font-size: 0.9rem;">
<li><strong>Yes:</strong> التحليل التلوي الكمي</li>
<li><strong>But:</strong> استكمل المراجعة النوعية لعوائق التنفيذ (تقييم CERQual)</li>
</ul>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem; background: rgba(212,175,55,0.08); border-right: 3px solid var(--gold);">
<p class="card-text" style="font-style: italic;">
<strong>الرؤية الأساسية:</strong> تجيب أقوى المراجعات المنهجية على كلا الأمرين: هل تعمل؟ (كمي) ولماذا ينجح أو يفشل؟ (نوعي)
                    </p>
</div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 20</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما الذي يميز الإثنوغرافيا التلوية عن التحليل التلوي الكمي؟</p>
<div class="quiz-options" id="m20-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m20-q1', 0, 1, ['Meta-ethnography can include many more studies when needed.', 'Correct! Meta-ethnography translates conceptual themes across studies rather than pooling numerical effect sizes.', 'Both methods require systematic search strategies.', 'Both are systematic approaches, but they synthesize different types of data.'])">
<span>A.</span> يتضمن 3-5 دراسات فقط
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m20-q1', 1, 1, ['Meta-ethnography can include many more studies when needed.', 'Correct! Meta-ethnography translates conceptual themes across studies rather than pooling numerical effect sizes.', 'Both methods require systematic search strategies.', 'Both are systematic approaches, but they synthesize different types of data.'])">
<span>B.</span> يترجم المفاهيم عبر الدراسات بدلاً من تجميع الأرقام
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m20-q1', 2, 1, ['Meta-ethnography can include many more studies when needed.', 'Correct! Meta-ethnography translates conceptual themes across studies rather than pooling numerical effect sizes.', 'Both methods require systematic search strategies.', 'Both are systematic approaches, but they synthesize different types of data.'])">
<span>C.</span> لا يتطلب بحثًا منهجيًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m20-q1', 3, 1, ['Meta-ethnography can include many more studies when needed.', 'Correct! Meta-ethnography translates conceptual themes across studies rather than pooling numerical effect sizes.', 'Both methods require systematic search strategies.', 'Both are systematic approaches, but they synthesize different types of data.'])">
<span>D.</span> إنه أقل صرامة من التوليف الكمي
                    </div>
</div>
<div id="m20-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="11">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 20 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "ليس كل ما يهم يمكن إحصاؤه. ليس كل ما يتم إحصاؤه مهم."
                </p>
</div>
</div>
<div class="slide black" data-index="12">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 21: متعدد المتغيرات</p>
</div>
</div>
 ====================================================== الوحدة 21: النتائج المترابطة / RVE ========= 
<div class="module-slides" data-module="21">
<div class="slide dark active" data-index="0">
<p class="refrain animate">التباين رسالة وليس ضجيج.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 21: متعدد المتغيرات</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 21: متعدد المتغيرات</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>التعرف على الحالات التي تكون فيها النتائج مترابطة في الدراسة</li>
<li>شرح نماذج التأثيرات العشوائية متعددة المتغيرات</li>
<li>تطبيق تقدير التباين القوي (RVE) لأحجام التأثير التابعة</li>
<li>فهم النماذج ثلاثية المستويات للنماذج المتداخلة البيانات</li>
<li>اختر من بين الأساليب متعددة المتغيرات بناءً على بنية البيانات</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">تقرير تجارب القلب والأوعية الدموية</p>
<p class="title gold animate delay-1 text-center">الوفيات، MI، والسكتة الدماغية، وأكثر من ذلك.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                ترتبط هذه النتائج داخل المرضى. لا يمكن للمريض الذي يموت أن يكون لديه نقطة نهاية MI. يعالج التحليل التلوي القياسي كل نتيجة بشكل مستقل - متجاهلاً الاعتماد وأدلة العد المزدوج المحتملة.
              </p>
</div>
 الشريحة أ: كذبة الملاءمة 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">أسئلة الافتراض لا أحد</h2>
<div class="card animate delay-1">
<p class="card-text">
                    افتح أي كتاب دراسي قياسي للتحليل التلوي. تفترض النماذج أن كل دراسة تساهم في
                    <strong>حجم تأثير مستقل واحد</strong>. لكن الواقع مختلف.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top: 1rem; background: rgba(197,48,48,0.06); border-right: 3px solid var(--red);">
<p class="card-text">
                    تشير تجربة واحدة للقلب والأوعية الدموية إلى الوفيات، واحتشاء عضلة القلب، والسكتة الدماغية، وإعادة تكوين الأوعية الدموية. تشير دراسة واحدة للعلاج النفسي إلى حدوث الاكتئاب والقلق ونوعية الحياة عند 3 و6 و12 شهرًا.
                  </p>
</div>
<div class="stats-grid animate delay-3" style="margin-top: 1rem;">
<div class="stat-box">
<div class="stat-value">30 تجربة</div>
<div class="stat-label">× 4 نتائج</div>
</div>
<div class="stat-box">
<div class="stat-value">= 120</div>
<div class="stat-label">أحجام التأثير</div>
</div>
</div>
<div class="card animate delay-4" style="margin-top: 1rem;">
<p class="card-text">
                    معظم المحللين إما: <strong>(a)</strong> يتعاملون مع جميع الـ 120 على أنها مستقلة (تضخيم الدقة بعامل √4)، أو <strong>(b)</strong> اختر نتيجة واحدة وتجاهل الباقي.
                    <strong>كلا النهجين خاطئان.</strong>
</p>
</div>
</div>
</div>
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">مشكلة التبعية</h2>
<div class="card animate delay-1">
<p class="card-text">
                    في التحليل التلوي القياسي الزوجي، تساهم كل دراسة بحجم تأثير <em>one</em> . لكن العديد من الدراسات تشير إلى نتائج أو مجموعات فرعية أو نقاط زمنية أو أذرع متعددة، مما يؤدي إلى إنشاء
                    <strong>متكل</strong> أحجام التأثير. يؤدي تجاهل هذا إلى تضخيم الدقة وتشويه الاستدلال.
                  </p>
</div>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">RVE</div>
<div class="stat-label">تقدير قوي للتباين. مقدر الساندويتش يتعامل مع الارتباط غير المعروف.</div>
</div>
<div class="stat-box">
<div class="stat-value">3-المستوى</div>
<div class="stat-label">دراسة ← تم تصميم نموذج تداخل النتائج بشكل صريح.</div>
</div>
</div>
</div>
</div>
<div class="slide light" data-index="5" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">تقدير التباين القوي</h2>
<div class="card animate delay-1">
<p class="card-text">
                    يستخدم RVE (Hedges, Tipton &amp; Johnson, 2010) <strong>نوع ساندويتش</strong> مقدِّر يوفر أخطاء قياسية صالحة بغض النظر عن الارتباط الحقيقي بين التأثيرات التابعة. لا حاجة لمعرفة أو تقدير الارتباط داخل الدراسة. الأفضل من أجل ≥20 دراسة.
                  </p>
</div>
<div class="card animate delay-2" style="margin-top:1rem;">
<p class="card-text">
<strong>تصحيح العينة الصغيرة:</strong> طور Tipton &amp; Pustejovsky (2015) تصحيحات عينة صغيرة (CR2) لـ RVE، باستخدام درجات الحرية Satterthwaite عندما يكون عدد المجموعات صغيرًا.
                  </p>
</div>
</div>
</div>
 الشريحة B: الحقيقة الرياضية 
<div class="slide dark" data-index="6" data-tier="methods">
<span class="tier-badge methods" style="position:absolute; top:1.5rem; right:1.5rem;">الباحث</span>
<div class="content" style="max-width: 700px;">
<h2 class="title cream animate" style="text-align: center;">ما تأثير الاعتماد على فترات ثقتك</h2>
<div class="gold-line animate delay-1"></div>
<div class="animate delay-2" style="margin-top: 1.5rem; background: rgba(212,175,55,0.1); padding: 1.5rem; border-radius: 8px; border: 1px solid rgba(212,175,55,0.3);">
<p style="font-size: 1rem; margin-bottom: 0.75rem;">
                    إذا كانت 4 نتائج من نفس الدراسة لها ارتباط داخل الدراسة ρ = 0.5:
                  </p>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
<div style="background: rgba(197,48,48,0.2); padding: 1rem; border-radius: 6px; text-align: center;">
<p style="font-size: 0.85rem; opacity: 0.8;">التعامل كمستقل</p>
<p style="font-size: 1.5rem; font-weight: 700; color: var(--red); margin-top: 0.25rem;">عرض CI = X</p>
</div>
<div style="background: rgba(34,197,94,0.2); padding: 1rem; border-radius: 6px; text-align: center;">
<p style="font-size: 0.85rem; opacity: 0.8;">محاسبة التبعية</p>
<p style="font-size: 1.5rem; font-weight: 700; color: var(--green); margin-top: 0.25rem;">عرض CI = 1.58X</p>
</div>
</div>
<p style="font-size: 1rem; margin-top: 1rem; text-align: center;">
                    يجب أن يكون فاصل الثقة الخاص بك <strong>أوسع بنسبة 58%</strong>. كل تحليل تلوي تجاهل هذا نشر نتائج دقيقة بشكل خاطئ.
                  </p>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; background: rgba(212,175,55,0.08); border: 1px solid rgba(212,175,55,0.2);">
<p class="card-text" style="color: var(--cream);">
<strong>RVE</strong> (Hedges, Tipton &amp; Johnson, 2010): يستخدم مقدر التباين "الساندويتش" الذي ينتج أخطاء معيارية صحيحة <em>بدون</em> تحتاج إلى معرفة الارتباط الدقيق داخل الدراسة.
                  </p>
</div>
</div>
</div>
 الشريحة ج: المستويات الثلاثة (موسعة) 
<div class="slide light" data-index="7" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">نماذج ثلاثية المستويات: جعل الهيكل واضحًا</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number">1</div>
<div class="lesson-content">
<h4>المستوى 1: تباين أخذ العينات</h4>
<p>خطأ في القياس ضمن كل تقدير لحجم التأثير.</p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">2</div>
<div class="lesson-content">
<h4>المستوى 2: التباين داخل الدراسة</h4>
<p>تختلف النتائج والنقاط الزمنية ضمن دراسة واحدة.</p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number">3</div>
<div class="lesson-content">
<h4>المستوى 3: التباين بين الدراسة</h4>
<p>تختلف الدراسات عن بعضها البعض في المجموعات السكانية والإعدادات والأساليب.</p>
</div>
</div>
<div class="card animate delay-4" style="margin-top: 1rem; background: rgba(212,175,55,0.08); border-right: 3px solid var(--gold);">
<p class="card-text">
<strong>مثال:</strong> في التحليل التلوي للعلاج النفسي للاكتئاب (k=50 دراسة، 180 تأثير). الأحجام)، <strong>35%</strong> كان من التباين ضمن الدراسة (نتائج مختلفة) و <strong>65%</strong> كان بين الدراسة (علاجات مختلفة، والسكان). يكشف هذا التحليل عن مقدار عدم التجانس <em>داخل</em> vs <em>بين</em> دراسات.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="8" data-tier="mastery">
<span class="tier-badge mastery">منهجي</span>
<div class="content">
<h2 class="title navy animate">نماذج ثلاثية المستويات: الإطار الرسمي</h2>
<div class="card animate delay-1">
<p class="card-text">
                    عندما تكون التأثيرات متداخلة (على سبيل المثال، نتائج متعددة داخل الدراسات، أو دراسات داخل مجموعات البحث)، <strong>نموذج ثلاثي المستويات</strong> يقسم التباين إلى: (1) تباين العينات (المستوى 1)، (2) التباين داخل الدراسة (المستوى 2)، و (3) التباين بين الدراسة (المستوى 3). يحافظ هذا على الاستدلال الصحيح أثناء استعارة القوة عبر المستويات.
                  </p>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="9">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">تحدي القلب والأوعية الدموية</h3>
<p style="margin-bottom: 0.75rem;">
                    قد يتضمن التحليل التلوي للستاتينات 30 تجربة، تشير كل منها إلى الوفيات، والاحتشاء الدماغي، والسكتة الدماغية، وإعادة تكوين الأوعية الدموية. هذا هو 120 حجم تأثير من 30 مجموعة. إن التعامل معها على أنها 120 تقديرًا مستقلاً يؤدي إلى تضخيم الدقة بعامل يتعلق بالارتباط داخل الدراسة.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    تتعامل نماذج RVE أو النماذج متعددة المتغيرات مع هذا بشكل صحيح - مما ينتج فترات ثقة أوسع وصادقة.
                  </p>
</div>
</div>
</div>
 الشريحة د: شجرة القرار 
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">شجرة القرار: ما هي الطريقة المتبعة لأحجام التأثير التابعة؟</h2>
<div class="decision-tree animate delay-1" style="font-size: 0.95rem; line-height: 1.7;">
<div class="card" style="background: var(--navy); color: var(--cream); padding: 1rem; border-radius: 8px;">
<p><strong>الجذر:</strong> هل التحليل التلوي الخاص بك له تأثيرات متعددة لكل دراسة؟</p>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
<div style="background: rgba(34,197,94,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--green);">
<p><strong>YES</strong> → هل تعرف (أو تستطيع تقدير) الارتباطات داخل الدراسة؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1rem; font-size: 0.9rem;">
<li><strong>Yes:</strong> نموذج التأثيرات العشوائية متعدد المتغيرات (الأكثر كفاءة)</li>
<li><strong>No:</strong> RVE مع تصحيح العينات الصغيرة (قوي للارتباطات غير المعروفة)</li>
</ul>
</div>
<div style="background: rgba(212,175,55,0.1); padding: 1rem; border-radius: 8px; border-right: 3px solid var(--gold);">
<p><strong>NO</strong> → نموذج التأثيرات العشوائية أحادي المتغير القياسي</p>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text"><strong>السؤال الفرعي:</strong> هل تأثيراتك المتعددة ناتجة عن نتائج أو نقاط زمنية أو مجموعات فرعية مختلفة؟</p>
<ul style="margin-top: 0.5rem; padding-right: 1.25rem; line-height: 1.8; font-size: 0.9rem;">
<li><strong>نتائج مختلفة</strong> → نموذج ثلاثي المستويات أو RVE مع التجميع</li>
<li><strong>نقاط زمنية مختلفة</strong> → شبكة من النقاط الزمنية ذات الارتباط الزمني</li>
<li><strong>مجموعات فرعية مختلفة</strong> → فكر فيما إذا كانت المجموعات الفرعية ذات معنى أو يجب حساب متوسطها</li>
</ul>
</div>
</div>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="11">
<div class="content">
<h2 class="title navy animate">اختبار الوحدة 21</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما هي المشكلة التي يحلها تقدير التباين القوي (RVE)؟</p>
<div class="quiz-options" id="m21-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m21-q1', 0, 1, ['Publication bias is addressed by funnel plots and selection models.', 'Correct! RVE provides valid standard errors when multiple effect sizes from the same study are correlated.', 'Heterogeneity is quantified by I² and tau².', 'Small study effects use regression-based methods.'])">
<span>A.</span> تحيز النشر
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m21-q1', 1, 1, ['Publication bias is addressed by funnel plots and selection models.', 'Correct! RVE provides valid standard errors when multiple effect sizes from the same study are correlated.', 'Heterogeneity is quantified by I² and tau².', 'Small study effects use regression-based methods.'])">
<span>B.</span> التبعية بين أحجام التأثير المتعددة من نفس الدراسة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m21-q1', 2, 1, ['Publication bias is addressed by funnel plots and selection models.', 'Correct! RVE provides valid standard errors when multiple effect sizes from the same study are correlated.', 'Heterogeneity is quantified by I² and tau².', 'Small study effects use regression-based methods.'])">
<span>C.</span> عدم التجانس بين الدراسات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m21-q1', 3, 1, ['Publication bias is addressed by funnel plots and selection models.', 'Correct! RVE provides valid standard errors when multiple effect sizes from the same study are correlated.', 'Heterogeneity is quantified by I² and tau².', 'Small study effects use regression-based methods.'])">
<span>D.</span> تأثيرات الدراسات الصغيرة
                    </div>
</div>
<div id="m21-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="12">
<div class="content" style="text-align: center;">
<p class="title gold animate">اكتملت الوحدة 21</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "عندما تكون النتائج متشابكة، فإن التظاهر بأنها مستقلة هو كذبة مصلحة."
                </p>
</div>
</div>
<div class="slide black" data-index="13">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 22: الإثبات</p>
</div>
</div>
 ================ الوحدة 22: الإثبات (خطأ رينهارت-روجوف في Excel) ============================================================================================================== 
<div class="module-slides" data-module="22">
<div class="slide dark active" data-index="0">
<p class="refrain animate">الرقم بدون مصدر ليس رقمًا.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 22: الإثبات</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 22: الإثبات</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>فهم كيفية انتشار الأخطاء الحسابية من خلال السياسة</li>
<li>تعريف قابلية التكرار والتمييز عن قابلية التكرار</li>
<li>تطبيق تجزئة الأدلة والأرقام الحاملة للإثبات</li>
<li>استخدم قوائم التحقق من التكرار للتحليل التلوي</li>
<li>التعرف على دور التسجيل المسبق والبيانات المفتوحة</li>
</ul>
</div>
</div>
</div>
<div class="slide dark" data-index="2">
<p class="title cream animate text-center">فتح طالب دراسات عليا جدول بيانات</p>
<p class="title gold animate delay-1 text-center">ووجدت أن عصر التقشف بني على خطأ.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                في عام 2010، ادعى راينهارت وروجوف أن البلدان التي تزيد فيها نسبة الدين إلى الناتج المحلي الإجمالي عن 90% كان نموها سلبيا. وقد أثر هذا على سياسات التقشف في جميع أنحاء أوروبا. في عام 2013، اكتشف توماس هيرندون خطأً في برنامج Excel أدى إلى استبعاد 5 دول من المتوسط. وكانت النتيجة المصححة: نمو إيجابي متواضع، وليس الانهيار.
              </p>
</div>
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الاستنساخ مقابل قابلية النسخ المتماثل</h2>
<div class="stats-grid animate delay-1">
<div class="stat-box">
<div class="stat-value">قابلة للتكرار</div>
<div class="stat-label">نفس البيانات + نفس الرمز = نفس النتيجة</div>
</div>
<div class="stat-box">
<div class="stat-value">قابلة للتكرار</div>
<div class="stat-label">بيانات جديدة + نفس الأساليب = نتيجة متسقة</div>
</div>
</div>
<div class="card animate delay-2" style="margin-top: 1rem;">
<p class="card-text">
                    قابلية التكرار هي <strong>المعيار الأدنى</strong>. إذا لم يتمكن الآخرون من إعادة إنتاج تقديرك المجمع من بياناتك المبلغ عنها، فلا يمكن التحقق من التحليل. يجب أن تتشارك التحليلات التلوية: البيانات المستخرجة، ونصوص التحليل، وإصدارات البرامج، والبذور العشوائية.
                  </p>
</div>
</div>
</div>
<div class="slide light" data-index="4" data-tier="methods">
<span class="tier-badge methods">الباحث</span>
<div class="content">
<h2 class="title navy animate">الأرقام الحاملة للإثبات</h2>
<div class="card animate delay-1">
<p class="card-text">
                    يجب أن يحمل كل رقم في التحليل التلوي <strong>المصدر</strong>: من أين جاء، وكيف تم تحويله، وما هو الكود الذي أنتجه.
                    <strong>تجزئة الأدلة</strong> بصمة مشفرة للمدخلات، لذا فإن أي تغيير (عرضي أو غير مقصود) متعمد) يمكن اكتشافه.
                  </p>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number">SHA</div>
<div class="lesson-content">
<h4>تجزئة الإدخال</h4>
<p>تجزئة SHA-256 للبيانات المستخرجة. إذا تغيرت خلية واحدة، يتغير التجزئة. سلسلة المصدر: البيانات → الكود → النتيجة → التجزئة.</p>
</div>
</div>
</div>
</div>
 أداة تفاعلية 
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">تفاعلية: قائمة التحقق من التكرار</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  تحقق من كل عنصر لتقييم إمكانية تكرار نتائج التحليل التلوي. كيف تقيم تقييمك؟
                </p>
<div class="animate delay-2" id="reproducibilityTool" style="background: rgba(30,39,97,0.05); border-radius: 8px; padding: 1rem;">
<div id="reproChecklist"></div>
<div id="reproScore" style="margin-top:1rem; padding:0.75rem; background:rgba(212,175,55,0.1); border-radius:6px;"></div>
</div>
</div>
</div>
 مربع القصة 
<div class="slide dark" data-index="6">
<div class="content" style="max-width: 700px;">
<div class="story-box animate">
<h3 style="color: var(--gold); margin-bottom: 1rem;">خطأ Excel الذي غير الاقتصادات</h3>
<p style="margin-bottom: 0.75rem;">
                    وقد تم الاستشهاد بكتاب راينهارت روجوف "النمو في زمن الديون" في شهاداته أمام الكونجرس، وتقارير المفوضية الأوروبية، والموجزات السياسية لصندوق النقد الدولي. كان خطأ Excel (تم استبعاد الصفوف 30-34 من صيغة المتوسط) يعني أن خمسة بلدان - أستراليا والنمسا وبلجيكا وكندا والدنمارك - كانت مفقودة ببساطة.
                  </p>
<p style="font-style: italic; opacity: 0.9;">
                    ارتفع المتوسط المصحح من -0.1% إلى +2.2%. أثرت سياسات التقشف على الملايين. إن قابلية التكرار ليست سعيًا للكمال الأكاديمي، بل هي ضمانة ضد الكوارث.
                  </p>
</div>
</div>
</div>
 رد اتصال 
<div class="slide dark" data-index="7">
<div class="content" style="text-align: center;">
<p class="animate" style="font-size: 1.1rem; opacity: 0.7;">تذكر الوحدة 5؟</p>
<p class="title gold animate delay-1">انخفاض من خلال عدسة التكاثر</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="max-width: 600px; font-size: 1.05rem;">
                  تم سحب تجارب DECREASE التي أجراها دون بولدرمانز للحصول على بيانات ملفقة. لو كانت هناك أرقام تحمل إثباتًا - مدخلات مجزأة، وسلاسل مصدر، وحسابات تم التحقق منها - لكان من الممكن اكتشاف التلفيق <em>قبل</em> دخلت الأدلة التحليلات التلوية وتغيير المبادئ التوجيهية الجراحية.
                </p>
</div>
</div>
<!-- Quiz -->
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">الوحدة 22 اختبار</h2>
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q1.</strong> ما هو خطأ راينهارت-روجوف؟</p>
<div class="quiz-options" id="m22-q1">
<div class="quiz-option" onclick="checkQuizAnswer('m22-q1', 0, 1, ['The sample size was the full dataset of countries.', 'Correct! An Excel formula excluded 5 countries from the average, making high-debt growth appear negative when it was actually positive.', 'The analysis used the correct time period.', 'Wrong statistical test was not the primary issue\u2014the data entry error was.'])">
<span>A.</span> لقد استخدموا عينة صغيرة جدًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m22-q1', 1, 1, ['The sample size was the full dataset of countries.', 'Correct! An Excel formula excluded 5 countries from the average, making high-debt growth appear negative when it was actually positive.', 'The analysis used the correct time period.', 'Wrong statistical test was not the primary issue\u2014the data entry error was.'])">
<span>B.</span> استبعدت صيغة Excel 5 دول، مما أدى إلى عكس النتيجة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m22-q1', 2, 1, ['The sample size was the full dataset of countries.', 'Correct! An Excel formula excluded 5 countries from the average, making high-debt growth appear negative when it was actually positive.', 'The analysis used the correct time period.', 'Wrong statistical test was not the primary issue\u2014the data entry error was.'])">
<span>C.</span> لقد درسوا الفترة الزمنية الخاطئة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('m22-q1', 3, 1, ['The sample size was the full dataset of countries.', 'Correct! An Excel formula excluded 5 countries from the average, making high-debt growth appear negative when it was actually positive.', 'The analysis used the correct time period.', 'Wrong statistical test was not the primary issue\u2014the data entry error was.'])">
<span>D.</span> لقد استخدموا الاختبار الإحصائي الخاطئ
                    </div>
</div>
<div id="m22-q1-feedback" style="display: none;"></div>
</div>
</div>
</div>
 إغلاق 
<div class="slide dark" data-index="9">
<div class="content" style="text-align: center;">
<p class="title gold animate">الوحدة 22 كاملة</p>
<div class="gold-line animate delay-1"></div>
<p class="animate delay-2 serif" style="font-size: 1.3rem; font-style: italic; max-width: 600px;">
                  "الرقم بدون مصدر ليس رقمًا. والتحليل بدون إمكانية التكرار ليس دليلاً."
                </p>
</div>
</div>
<div class="slide black" data-index="10">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 23: أول سباق سريع لك</p>
</div>
</div>
 الوحدة 23: Capstone - أول سباق سريع لك 
<div class="module-slides" data-module="23">
<div class="slide dark active" data-index="0">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 23: أول سباق سريع لك</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الوحدة 23: أول سباق سريع لك</h2>
<div class="learning-objectives animate delay-1">
<h4>🎯 أهداف التعلم</h4>
<ul>
<li>فهم سير عمل المراجعة المنهجية لمدة 40 يومًا</li>
<li>قم بتخطيط المبادئ السبعة لمراحل الممارسة الحقيقية</li>
<li>التعرف على بوابات تعريف الإنهاء (DoD) كنقاط تفتيش للجودة</li>
<li>نقدر لماذا يمنع الهيكل حالات الفشل التي درستها</li>
<li>خريج جاهز لإجراء (وليس مجرد فهم) التحليل التلوي</li>
</ul>
</div>
</div>
</div>
 اكتملت الرحلة 
<div class="slide dark" data-index="2">
<p class="title cream animate">لقد تعلمت القصص.</p>
<p class="title gold animate delay-1">الآن يجب عليك السير على الطريق.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1.1rem; text-align: center; max-width: 600px;">
                كل عكس الأدلة التي درستها حدث بسبب الفرق <em>knew</em> الطرق ولكن لم يتم <em>يتبع</em> لهم بشكل منهجي.
              </p>
</div>
 إطار عمل META-SPRINT 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">إطار عمل META-SPRINT</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  سير عمل منظم لمدة 40 يومًا مع 5 بوابات طور. كل بوابة عبارة عن نقطة تفتيش لتعريف التنفيذ (DoD) تمنعك من المضي قدمًا حتى يتم ضمان الجودة.
                </p>
<div class="stats-grid animate delay-2">
<div class="stat-box">
<div class="stat-value">40</div>
<div class="stat-label">الأيام حتى الانتهاء</div>
</div>
<div class="stat-box">
<div class="stat-value">5</div>
<div class="stat-label">بوابات مرحلة وزارة الدفاع</div>
</div>
<div class="stat-box">
<div class="stat-value">اليوم 34</div>
<div class="stat-label">تجميد صعب</div>
</div>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; background: rgba(212,175,55,0.1); border: 1px solid var(--gold);">
<p class="card-text" style="font-size: 0.9rem;">
<strong style="color: var(--gold);">لماذا 40 يوما؟</strong> طويلة بما يكفي للدقة، وقصيرة بما يكفي لمنع زحف النطاق. تم دفن إشارات القلب روزيجليتازون لسنوات لأنه لم يكن هناك موعد نهائي يفرض الشفافية.
                  </p>
</div>
</div>
</div>
 البوابات الخمس 
<div class="slide light" data-index="4">
<div class="content">
<h2 class="title navy animate">بوابات المرحلة الخمس</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number" style="background: #7C3AED;">A</div>
<div class="lesson-content">
<h4>DoD-A: قفل البروتوكول (الأيام 1-3)</h4>
<p>تم تعريف PICOS، وتم تعيين قواعد النقطة الزمنية، واختيارات النموذج محددة مسبقًا. <em>لا يوجد هدف متحرك.</em></p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #2563EB;">B</div>
<div class="lesson-content">
<h4>DoD-B: قفل البحث (الأيام 6-10)</h4>
<p>تم البحث في جميع قواعد البيانات، وفحص الأدبيات الرمادية، والتحقق من صحة PRESS. <em>لا توجد دراسات مخفية.</em></p>
</div>
</div>
<div class="lesson-item animate delay-3">
<div class="lesson-number" style="background: #D97706;">C</div>
<div class="lesson-content">
<h4>DoD-C: قفل الاستخراج (الأيام 10-28)</h4>
<p>الاستخراج المزدوج، ربط المصدر، تقييم RoB. <em>لا أرقام ملفقة.</em></p>
</div>
</div>
</div>
</div>
 وتابع غيتس 
<div class="slide light" data-index="5">
<div class="content">
<h2 class="title navy animate">بوابات المرحلة الخمس (تابع)</h2>
<div class="lesson-item animate delay-1">
<div class="lesson-number" style="background: #059669;">D</div>
<div class="lesson-content">
<h4>DoD-D: قفل التحليل (الأيام 21-33)</h4>
<p>تم إنشاء قطع الغابات، وإجراء تحليلات الحساسية، واستكشاف عدم التجانس. <em>لا قطف الكرز.</em></p>
</div>
</div>
<div class="lesson-item animate delay-2">
<div class="lesson-number" style="background: #DC2626;">E</div>
<div class="lesson-content">
<h4>DoD-E: قفل التقديم (الأيام 33-40)</h4>
<p>تصنيف درجة اليقين، كتابة الملخص السريري، وضع اللمسات النهائية على المخطوطة. <em>لا ثقة زائدة.</em></p>
</div>
</div>
<div class="card animate delay-3" style="margin-top: 1rem; background: rgba(220,38,38,0.1); border: 1px solid #DC2626;">
<p class="card-text" style="font-size: 0.9rem;">
<strong style="color: #DC2626;">تجميد اليوم 34:</strong> لا يمكن إجراء دراسات جديدة تمت إضافته بعد اليوم 34. وهذا يمنع "زحف النطاق المسلح" الذي ابتليت به التحليلات الوصفية لجراحة العمود الفقري لـ BMP، حيث استمرت الصناعة في "العثور" على دراسات إيجابية.
                  </p>
</div>
</div>
</div>
 سبعة مبادئ تم تعيينها للممارسة 
<div class="slide light" data-index="6">
<div class="content">
<h2 class="title navy animate">المبادئ السبعة في الممارسة</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  كل مبدأ تعلمته يرتبط ببوابة مرحلة محددة:
                </p>
<div class="animate delay-2" style="display: grid; gap: 0.5rem; font-size: 0.85rem;">
<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem; background: rgba(124,58,237,0.1); border-radius: 6px;">
<span style="color: #7C3AED; font-weight: 700; min-width: 40px;">وزارة الدفاع-أ</span>
<span>"<em>ليست كل إشارة هي الحقيقة</em>" — حدد مسبقًا ما يمكن اعتباره الدليل</span>
</div>
<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem; background: rgba(37,99,235,0.1); border-radius: 6px;">
<span style="color: #2563EB; font-weight: 700; min-width: 40px;">DoD-B</span>
<span>"<em>ما الذي كان مخفيا على مرأى من الجميع؟</em>" - بحث شامل</span>
</div>
<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem; background: rgba(217,119,6,0.1); border-radius: 6px;">
<span style="color: #D97706; font-weight: 700; min-width: 40px;">DoD-C</span>
<span>"<em>الرقم بدون مصدر ليس رقمًا</em>" — ربط كل نقطة بيانات</span>
</div>
<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem; background: rgba(5,150,105,0.1); border-radius: 6px;">
<span style="color: #059669; font-weight: 700; min-width: 40px;">DoD-D</span>
<span>"<em>التجانس هو رسالة وليس ضجيج</em>"- تحقق، لا تتجاهل</span>
</div>
<div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem; background: rgba(220,38,38,0.1); border-radius: 6px;">
<span style="color: #DC2626; font-weight: 700; min-width: 40px;">DoD-E</span>
<span>"<em>فاليقين يجب اكتسابه، وليس افتراضه</em>"- صنف كل شيء</span>
</div>
</div>
</div>
</div>
 ضمان الجودة الخصومة للفريق الأحمر 
<div class="slide dark" data-index="7">
<p class="title cream animate">مبدأ الفريق الأحمر</p>
<p class="title gold animate delay-1">فريقك الخاص يحاول تعطيل عملك.</p>
<div class="gold-line animate delay-2"></div>
<p class="animate delay-3" style="font-size: 1rem; text-align: center; max-width: 650px;">
                في كل يوم، يقضي اثنان من أعضاء الفريق المتناوبين 12 دقيقة في التحقق من جودة البيانات كخصوم. هذه هي الطريقة التي تم بها اكتشاف احتيال بولدت - ليس من خلال المراجعة الودية، ولكن من خلال الفحص المتشكك الذي لاحظ معدلات توظيف مستحيلة.
              </p>
</div>
 بروتوكول الطوارئ CondGO 
<div class="slide light" data-index="8">
<div class="content">
<h2 class="title navy animate">CondGO: عندما تسوء الأمور</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1rem;">
                  ماذا يحدث عندما تكتشف مشكلة حرجة في منتصف السباق؟
                </p>
<div class="card animate delay-2" style="background: rgba(217,119,6,0.1); border: 1px solid #D97706;">
<h4 style="color: #D97706;">CondGO = الذهاب المشروط</h4>
<p class="card-text" style="font-size: 0.9rem;">
                    بروتوكول إنقاذ محدود. لديك بالضبط <strong>72 ساعة</strong> لإصلاح المشكلة باستخدام الإجراءات المسموح بها فقط. إذا لم تتمكن من إصلاح الأمر، فيجب عليك إيقاف المراجعة.
                  </p>
</div>
<div class="card animate delay-3" style="margin-top: 1rem;">
<p class="card-text" style="font-size: 0.85rem; font-style: italic;">
                    📖 <strong>درس أفانديا:</strong> شهدت شركة GSK إشارات القلب والأوعية الدموية في عام 2000 ولكن لم يكن لديها موعد نهائي قسري. لقد "شاهدوا وانتظروا" لمدة 7 سنوات. وتضرر عشرات الآلاف. توجد CondGO لأن عبارة "سنتعامل معها في النهاية" تقتل الأشخاص.
                  </p>
</div>
</div>
</div>
 تخرجك 
<div class="slide dark" data-index="9">
<p class="title cream animate">لقد بدأت هذه الدورة بالقصص.</p>
<p class="title gold animate delay-1">لقد أنهيتها جاهزة للتمرين.</p>
<div class="gold-line animate delay-2"></div>
<div class="animate delay-3" style="text-align: center; max-width: 600px;">
<p style="font-size: 1rem; margin-bottom: 1rem;">
                  يأخذ سير عمل META-SPRINT كل ما تعلمته وينظمه في نظام مدته 40 يومًا يمنع حالات الفشل التي تمت دراستها.
                </p>
<p style="font-size: 0.9rem; opacity: 0.9;">
                  عندما تكون مستعدًا لإجراء مراجعة منهجية حقيقية، افتح تطبيق META-SPRINT. ستوجهك القصص التي تعلمتها هنا، وستظهر كتذكيرات في كل خطوة.
                </p>
</div>
</div>
 القصة: تعاون CTT - عندما تنقذ الطرق الملايين 
<div class="slide dark" data-index="9b">
<div class="story-box animate">
<p class="story-opener">كيف يبدو الأمر عندما يتم اتباع كل مبدأ؟</p>
<div class="real-data-box">
<h4>البيانات الحقيقية</h4>
<p>
                    يعد تعاون القائمين على تجارب علاج الكوليسترول (CTT) هو المعيار الذهبي للتحليل التلوي. لقد حصلوا على <span class="data-highlight">بيانات مريض فردية من أكثر من 170,000 مشارك</span>
                    عبر <span class="data-highlight">26 تجربة ستاتين</span>. البروتوكول المحدد مسبقًا. IPD من جميع التجارب الكبرى. نتائج موحدة. النتيجة: تقليل الستاتينات <span class="data-highlight">الأحداث الوعائية الكبرى بنسبة 21% لكل مليمول/لتر من تقليل LDL</span>
                    (RR 0.79، 95٪ CI 0.77-0.81)، بغض النظر عن المخاطر الأساسية. تم تكرار هذه النتيجة عبر <span class="data-highlight">5 تحليلات تلوية على مدار 15 عامًا</span>، منع ما يقدر بنحو <span class="data-highlight">من الإصابة بالنوبات القلبية والسكتات الدماغية في جميع أنحاء العالم</span>.
                  </p>
</div>
<div class="decision-tree">
<div class="decision-tree-header">المبادئ السبعة المطبقة</div>
<div class="decision-scenario">
                    تُظهر قصة CTT ما يحدث عند اتباع كل مبدأ من هذه الدورة. خذ بعين الاعتبار البديل:
                  </div>
<div class="decision-paths">
<div class="decision-path path-a" role="button" tabindex="0">
<div class="path-label">المسار أ: بدون المبادئ</div>
<div class="path-choice">لا يوجد بروتوكول. البيانات المنشورة فقط. لا روب. لا التحقيق في عدم التجانس. لا الصف.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">التجارب الصغيرة المتضاربة. لا يزال الجدل حول الستاتين مستمرًا. الملايين دون علاج.</div>
<div class="path-outcome">النتيجة: استمرار الوفيات القلبية الوعائية التي يمكن الوقاية منها</div>
</div>
<div class="decision-path path-b" role="button" tabindex="0">
<div class="path-label">المسار ب: طريقة CTT</div>
<div class="path-choice">البروتوكول المسجل مسبقًا. IPD من جميع التجارب. نتائج موحدة. أساليب شفافة. الدرجة درجة عالية من اليقين.</div>
<div class="path-arrow">↓</div>
<div class="path-consequence">إجابة نهائية. تتغير المبادئ التوجيهية العالمية. الستاتينات موصوفة لمن يستفيد.</div>
<div class="path-outcome">النتيجة: إنقاذ ملايين الأرواح من خلال تجميع الأدلة الصارمة</div>
</div>
</div>
</div>
<div class="story-revelation">
<div class="revelation-label">الرؤيا</div>
<div class="revelation-text">
                    كل مبدأ في هذه الدورة موجود لأن غيابه يسبب الضرر. يثبت تعاون CTT أنه عندما تكون الأساليب صارمة، وعندما يكون للبيانات مصدر، وعندما يتم تقييم التحيز واكتساب اليقين - يصبح التحليل التلوي أقوى أداة في الطب. أنت الآن تحمل هذه المبادئ. استخدمها.
                  </div>
</div>
</div>
</div>
 اختبار Capstone 
<div class="slide light" data-index="10">
<div class="content">
<h2 class="title navy animate">اختبار Capstone</h2>
<div class="quiz-container">
<div class="quiz-question" id="q13-1">
<h4>1. ما هو الغرض من "التجميد الشديد" لليوم 34 في META-SPRINT؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q13-1', 0, 1, ['Close but incomplete. The freeze also prevents weaponized scope creep.', 'Correct! The BMP spine surgery scandal showed how late-added studies can manipulate pooled estimates.', 'The freeze is about scope control, not speed.', 'Publication timing is separate from the methodological freeze.'])">أ. لإتاحة الوقت لمراجعة النظراء</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-1', 1, 1, ['Close but incomplete. The freeze also prevents weaponized scope creep.', 'Correct! The BMP spine surgery scandal showed how late-added studies can manipulate pooled estimates.', 'The freeze is about scope control, not speed.', 'Publication timing is separate from the methodological freeze.'])">ب. لمنع الدراسات المضافة متأخراً من التلاعب بالنتائج</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-1', 2, 1, ['Close but incomplete. The freeze also prevents weaponized scope creep.', 'Correct! The BMP spine surgery scandal showed how late-added studies can manipulate pooled estimates.', 'The freeze is about scope control, not speed.', 'Publication timing is separate from the methodological freeze.'])">ج. لتسريع النشر</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-1', 3, 1, ['Close but incomplete. The freeze also prevents weaponized scope creep.', 'Correct! The BMP spine surgery scandal showed how late-added studies can manipulate pooled estimates.', 'The freeze is about scope control, not speed.', 'Publication timing is separate from the methodological freeze.'])">د. للتنسيق مع المواعيد النهائية للمجلة</div>
</div>
<div class="quiz-feedback" id="q13-1-feedback"></div>
</div>
<div class="quiz-question" id="q13-2" style="margin-top: 1.5rem;">
<h4>2. يمنح بروتوكول CondGO الفرق المدة اللازمة لإصلاح المشكلات الحرجة؟</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q13-2', 0, 2, ['Too short for meaningful fixes.', 'Still too short.', 'Correct! 72 hours forces urgent action without allowing indefinite delay (the Avandia failure mode).', 'Too long—problems would fester like they did at GSK.'])">أ. 24 ساعة</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-2', 1, 2, ['Too short for meaningful fixes.', 'Still too short.', 'Correct! 72 hours forces urgent action without allowing indefinite delay (the Avandia failure mode).', 'Too long—problems would fester like they did at GSK.'])">ب. 48 ساعة</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-2', 2, 2, ['Too short for meaningful fixes.', 'Still too short.', 'Correct! 72 hours forces urgent action without allowing indefinite delay (the Avandia failure mode).', 'Too long—problems would fester like they did at GSK.'])">ج. 72 ساعة</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-2', 3, 2, ['Too short for meaningful fixes.', 'Still too short.', 'Correct! 72 hours forces urgent action without allowing indefinite delay (the Avandia failure mode).', 'Too long—problems would fester like they did at GSK.'])">د. أسبوع واحد</div>
</div>
<div class="quiz-feedback" id="q13-2-feedback"></div>
</div>
<div class="quiz-question" id="q13-3" style="margin-top: 1.5rem;">
<h4>3. اكتشف فريق ضمان الجودة الخصوم للفريق الأحمر احتيال يواكيم بولدت من خلال ملاحظة:</h4>
<div class="quiz-options">
<div class="quiz-option" onclick="checkQuizAnswer('q13-3', 0, 0, ['Correct! Adversarial checking found patterns that friendly review missed for years.', 'Statistical tests came later.', 'The results looked consistent—that was part of the deception.', 'There were no whistleblowers initially.'])">أ. معدلات توظيف المرضى المستحيلة</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-3', 1, 0, ['Correct! Adversarial checking found patterns that friendly review missed for years.', 'Statistical tests came later.', 'The results looked consistent—that was part of the deception.', 'There were no whistleblowers initially.'])">ب. الاختراق في الاختبارات الإحصائية</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-3', 2, 0, ['Correct! Adversarial checking found patterns that friendly review missed for years.', 'Statistical tests came later.', 'The results looked consistent—that was part of the deception.', 'There were no whistleblowers initially.'])">ج. أحجام التأثير غير المتسقة</div>
<div class="quiz-option" onclick="checkQuizAnswer('q13-3', 3, 0, ['Correct! Adversarial checking found patterns that friendly review missed for years.', 'Statistical tests came later.', 'The results looked consistent—that was part of the deception.', 'There were no whistleblowers initially.'])">د. شهادة المبلغين عن المخالفات</div>
</div>
<div class="quiz-feedback" id="q13-3-feedback"></div>
</div>
</div>
</div>
</div>
 إغلاق 
<div class="slide black" data-index="11">
<div class="animate" style="text-align: center;">
<p class="refrain">القصص التي تعلمتها ليست تاريخًا.</p>
<p style="font-size: 1.2rem; margin-top: 1rem; color: var(--gold);">إنها تحذيرات تحمي عملك المستقبلي.</p>
<div class="gold-line" style="margin: 1.5rem auto;"></div>
<p style="font-size: 1rem; margin-top: 1.5rem; opacity: 0.9;">
                  عندما تقوم بإجراء التحليل التلوي الأول،<br/>
                  تذكر CAST قبل أن تثق في إشارة،<br/>
                  تذكر Poldermans قبل تخطي المصدر،<br/>
                  تذكر Reboxetine قبل أن تتجاهل مسار التحويل.
                </p>
<p style="font-size: 0.9rem; margin-top: 1.5rem; font-style: italic; opacity: 0.8;">
                  أنت الآن جاهز. الذهاب مع الهيكل. اذهب بالتواضع. اتبع المبادئ السبعة.
                </p>
</div>
</div>
<div class="slide black" data-index="12">
<p class="refrain animate">ليست كل إشارة حقيقة.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الوحدة 24: الاختبار النهائي</p>
</div>
</div>
 الوحدة 24: الاختبار النهائي (التقييم الختامي) 
<div class="module-slides" data-module="24">
<div class="slide dark active" data-index="0">
<p class="refrain animate">يجب اكتساب اليقين وليس افتراضه.</p>
<p class="animate delay-1" style="font-size: 1.25rem; margin-top: 1.5rem;">الاختبار النهائي</p>
</div>
<div class="slide light" data-index="1">
<div class="content">
<h2 class="title navy animate">الاختبار النهائي: الجزء 1 من 2</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1.5rem;">
                  اختبر مدى إتقانك لمبادئ التحليل التلوي. يتناول كل سؤال مفهومًا أساسيًا من الدورة.
                </p>
<!-- Q1: PICO -->
<div class="quiz-box animate delay-2" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q1.</strong> يريد أحد الباحثين دراسة "تأثيرات التمارين الرياضية على الصحة". ما هي المشكلة الأساسية في سؤال البحث هذا؟</p>
<div class="quiz-options" id="final-q1">
<div class="quiz-option" onclick="checkQuizAnswer('final-q1', 0, 2, ['Study design matters, but a poorly framed question can use any design.', 'Study size is about precision, not question framing.', 'Correct! A PICO question must specify Population, Intervention, Comparator, and Outcome. This question lacks all specificity.', 'Ethical approval is procedural, not methodological.'])">
<span>A.</span> إنه يفتقر إلى التوزيع العشوائي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q1', 1, 2, ['Study design matters, but a poorly framed question can use any design.', 'Study size is about precision, not question framing.', 'Correct! A PICO question must specify Population, Intervention, Comparator, and Outcome. This question lacks all specificity.', 'Ethical approval is procedural, not methodological.'])">
<span>B.</span> حجم العينة صغير جدًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q1', 2, 2, ['Study design matters, but a poorly framed question can use any design.', 'Study size is about precision, not question framing.', 'Correct! A PICO question must specify Population, Intervention, Comparator, and Outcome. This question lacks all specificity.', 'Ethical approval is procedural, not methodological.'])">
<span>C.</span> ليس كذلك للإجابة - يفتقر إلى عناصر PICO المحددة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q1', 3, 2, ['Study design matters, but a poorly framed question can use any design.', 'Study size is about precision, not question framing.', 'Correct! A PICO question must specify Population, Intervention, Comparator, and Outcome. This question lacks all specificity.', 'Ethical approval is procedural, not methodological.'])">
<span>D.</span> ويفتقر إلى الموافقة الأخلاقية
                    </div>
</div>
<div id="final-q1-feedback" style="display: none;"></div>
</div>
 السؤال الثاني: تحيز النشر 
<div class="quiz-box animate delay-2" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q2.</strong> يُظهر المخطط القمعي عدم تناسق واضح مع الدراسات المفقودة في المنطقة السفلية اليسرى. ماذا يوحي هذا؟</p>
<div class="quiz-options" id="final-q2">
<div class="quiz-option" onclick="checkQuizAnswer('final-q2', 0, 1, ['Large effects favor different directions, not one region.', 'Correct! The pattern is consistent with small-study effects; publication bias is one plausible explanation.', 'True effects would show symmetry around the pooled estimate.', 'Random error would cause symmetric scatter, not systematic asymmetry.'])">
<span>A.</span> الدراسات الكبيرة لديها تقديرات أكثر دقة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q2', 1, 1, ['Large effects favor different directions, not one region.', 'Correct! The pattern is consistent with small-study effects; publication bias is one plausible explanation.', 'True effects would show symmetry around the pooled estimate.', 'Random error would cause symmetric scatter, not systematic asymmetry.'])">
<span>B.</span> من المحتمل أن تكون الدراسات السلبية الصغيرة غير منشورة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q2', 2, 1, ['Large effects favor different directions, not one region.', 'Correct! The pattern is consistent with small-study effects; publication bias is one plausible explanation.', 'True effects would show symmetry around the pooled estimate.', 'Random error would cause symmetric scatter, not systematic asymmetry.'])">
<span>C.</span> التأثير الحقيقي أقوى من المقدر
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q2', 3, 1, ['Large effects favor different directions, not one region.', 'Correct! The pattern is consistent with small-study effects; publication bias is one plausible explanation.', 'True effects would show symmetry around the pooled estimate.', 'Random error would cause symmetric scatter, not systematic asymmetry.'])">
<span>D.</span> خطأ في أخذ العينات العشوائية
                    </div>
</div>
<div id="final-q2-feedback" style="display: none;"></div>
</div>
 Q3: عدم التجانس 
<div class="quiz-box animate delay-2" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q3.</strong> يشير التحليل التلوي إلى I² = 85% وτ² = 0.42. ما هو التفسير الأكثر ملاءمة؟</p>
<div class="quiz-options" id="final-q3">
<div class="quiz-option" onclick="checkQuizAnswer('final-q3', 0, 2, ['85% chance would be a probability, not a proportion of variance.', 'Effect magnitude is shown by the pooled estimate, not I².', 'Correct! High I² means most variability is true heterogeneity. Explore sources before pooling.', 'Clinical relevance depends on the outcome, not I².'])">
<span>A.</span> هناك فرصة بنسبة 85% للتأثير الحقيقي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q3', 1, 2, ['85% chance would be a probability, not a proportion of variance.', 'Effect magnitude is shown by the pooled estimate, not I².', 'Correct! High I² means most variability is true heterogeneity. Explore sources before pooling.', 'Clinical relevance depends on the outcome, not I².'])">
<span>B.</span> حجم التأثير كبير جدًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q3', 2, 2, ['85% chance would be a probability, not a proportion of variance.', 'Effect magnitude is shown by the pooled estimate, not I².', 'Correct! High I² means most variability is true heterogeneity. Explore sources before pooling.', 'Clinical relevance depends on the outcome, not I².'])">
<span>C.</span> يوجد تباين كبير بين الدراسة؛ التحقيق في المصادر
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q3', 3, 2, ['85% chance would be a probability, not a proportion of variance.', 'Effect magnitude is shown by the pooled estimate, not I².', 'Correct! High I² means most variability is true heterogeneity. Explore sources before pooling.', 'Clinical relevance depends on the outcome, not I².'])">
<span>D.</span> النتائج مهمة سريريًا
                    </div>
</div>
<div id="final-q3-feedback" style="display: none;"></div>
</div>
 Q4: الصف 
<div class="quiz-box animate delay-2" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q4.</strong> في GRADE، ما هو اليقين المبدئي لمجموعة من الأدلة من التجارب المعشاة ذات الشواهد؟</p>
<div class="quiz-options" id="final-q4">
<div class="quiz-option" onclick="checkQuizAnswer('final-q4', 0, 0, ['Correct! RCTs start at HIGH certainty, then may be downgraded for risk of bias, inconsistency, indirectness, imprecision, or publication bias.', 'Moderate is not a starting point—it results from downgrading.', 'Low is the starting point for observational studies.', 'Very low requires multiple downgrades.'])">
<span>A.</span> High
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q4', 1, 0, ['Correct! RCTs start at HIGH certainty, then may be downgraded for risk of bias, inconsistency, indirectness, imprecision, or publication bias.', 'Moderate is not a starting point—it results from downgrading.', 'Low is the starting point for observational studies.', 'Very low requires multiple downgrades.'])">
<span>B.</span> معتدل
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q4', 2, 0, ['Correct! RCTs start at HIGH certainty, then may be downgraded for risk of bias, inconsistency, indirectness, imprecision, or publication bias.', 'Moderate is not a starting point—it results from downgrading.', 'Low is the starting point for observational studies.', 'Very low requires multiple downgrades.'])">
<span>C.</span> Low
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q4', 3, 0, ['Correct! RCTs start at HIGH certainty, then may be downgraded for risk of bias, inconsistency, indirectness, imprecision, or publication bias.', 'Moderate is not a starting point—it results from downgrading.', 'Low is the starting point for observational studies.', 'Very low requires multiple downgrades.'])">
<span>D.</span> منخفض جدًا
                    </div>
</div>
<div id="final-q4-feedback" style="display: none;"></div>
</div>
 س5: خطر التحيز 
<div class="quiz-box animate delay-2">
<p class="quiz-question"><strong>Q5.</strong> في RoB 2.0، ما المجال الذي يقيم ما إذا كان مقيمو النتائج يعرفون تخصيص العلاج؟</p>
<div class="quiz-options" id="final-q5">
<div class="quiz-option" onclick="checkQuizAnswer('final-q5', 0, 3, ['Randomization is about allocation sequence generation.', 'Deviations assess protocol adherence and contamination.', 'Missing data assesses attrition and exclusions.', 'Correct! Domain 4 (Measurement of the outcome) includes blinding of outcome assessors.'])">
<span>A.</span> D1: عملية التوزيع العشوائي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q5', 1, 3, ['Randomization is about allocation sequence generation.', 'Deviations assess protocol adherence and contamination.', 'Missing data assesses attrition and exclusions.', 'Correct! Domain 4 (Measurement of the outcome) includes blinding of outcome assessors.'])">
<span>B.</span> D2: الانحرافات عن التدخلات المقصودة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q5', 2, 3, ['Randomization is about allocation sequence generation.', 'Deviations assess protocol adherence and contamination.', 'Missing data assesses attrition and exclusions.', 'Correct! Domain 4 (Measurement of the outcome) includes blinding of outcome assessors.'])">
<span>C.</span> D3: نتيجة مفقودة البيانات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q5', 3, 3, ['Randomization is about allocation sequence generation.', 'Deviations assess protocol adherence and contamination.', 'Missing data assesses attrition and exclusions.', 'Correct! Domain 4 (Measurement of the outcome) includes blinding of outcome assessors.'])">
<span>D.</span> D4: قياس النتيجة
                    </div>
</div>
<div id="final-q5-feedback" style="display: none;"></div>
</div>
</div>
</div>
<div class="slide light" data-index="2">
<div class="content">
<h2 class="title navy animate">الاختبار النهائي: الجزء 2 من 2</h2>
 Q6: عكس الأدلة 
<div class="quiz-box animate delay-1" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q6.</strong> أظهرت تجربة CAST أن الأدوية المضادة لاضطراب النظم تزيد معدل الوفيات على الرغم من قمع عدم انتظام ضربات القلب. هذا مثال على:</p>
<div class="quiz-options" id="final-q6">
<div class="quiz-option" onclick="checkQuizAnswer('final-q6', 0, 1, ['Random error would not show consistent harm.', 'Correct! PVC suppression (surrogate) did not predict mortality (patient-important outcome).', 'Confounding involves unmeasured variables, but CAST was randomized.', 'The trial was stopped early for harm, indicating clear causation.'])">
<span>A.</span> خطأ في أخذ العينات العشوائية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q6', 1, 1, ['Random error would not show consistent harm.', 'Correct! PVC suppression (surrogate) did not predict mortality (patient-important outcome).', 'Confounding involves unmeasured variables, but CAST was randomized.', 'The trial was stopped early for harm, indicating clear causation.'])">
<span>B.</span> فشل النتيجة البديلة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q6', 2, 1, ['Random error would not show consistent harm.', 'Correct! PVC suppression (surrogate) did not predict mortality (patient-important outcome).', 'Confounding involves unmeasured variables, but CAST was randomized.', 'The trial was stopped early for harm, indicating clear causation.'])">
<span>C.</span> مربكة بالإشارة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q6', 3, 1, ['Random error would not show consistent harm.', 'Correct! PVC suppression (surrogate) did not predict mortality (patient-important outcome).', 'Confounding involves unmeasured variables, but CAST was randomized.', 'The trial was stopped early for harm, indicating clear causation.'])">
<span>D.</span> السببية العكسية
                    </div>
</div>
<div id="final-q6-feedback" style="display: none;"></div>
</div>
 Q7: التأثيرات الثابتة مقابل التأثيرات العشوائية 
<div class="quiz-box animate delay-1" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q7.</strong> متى يجب تفضيل نموذج التأثيرات العشوائية على التأثير الثابت نموذج؟</p>
<div class="quiz-options" id="final-q7">
<div class="quiz-option" onclick="checkQuizAnswer('final-q7', 0, 2, ['Sample size does not determine model choice.', 'Outcome type is irrelevant to model selection.', 'Correct! Random-effects assumes true effects vary between studies; use when heterogeneity is expected or observed.', 'Publication bias is assessed separately from model choice.'])">
<span>A.</span> عندما تكون أحجام العينات كبيرة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q7', 1, 2, ['Sample size does not determine model choice.', 'Outcome type is irrelevant to model selection.', 'Correct! Random-effects assumes true effects vary between studies; use when heterogeneity is expected or observed.', 'Publication bias is assessed separately from model choice.'])">
<span>B.</span> عندما تكون النتائج ثنائية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q7', 2, 2, ['Sample size does not determine model choice.', 'Outcome type is irrelevant to model selection.', 'Correct! Random-effects assumes true effects vary between studies; use when heterogeneity is expected or observed.', 'Publication bias is assessed separately from model choice.'])">
<span>C.</span> عندما يكون من المتوقع عدم التجانس بين الدراسات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q7', 3, 2, ['Sample size does not determine model choice.', 'Outcome type is irrelevant to model selection.', 'Correct! Random-effects assumes true effects vary between studies; use when heterogeneity is expected or observed.', 'Publication bias is assessed separately from model choice.'])">
<span>D.</span> عند الاشتباه في تحيز النشر
                    </div>
</div>
<div id="final-q7-feedback" style="display: none;"></div>
</div>
<!-- Q8: ICEMAN -->
<div class="quiz-box animate delay-1" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q8.</strong> وفقًا لمعايير ICEMAN، مما يجعل تحليل المجموعة الفرعية أكثر مصداقية؟</p>
<div class="quiz-options" id="final-q8">
<div class="quiz-option" onclick="checkQuizAnswer('final-q8', 0, 0, ['Correct! Pre-specification prevents fishing for significant subgroups. Post-hoc subgroups are hypothesis-generating only.', 'Opposite—small numbers of subgroups are more credible.', 'Opposite—biological rationale strengthens credibility.', 'Consistent effects within subgroups would support pooling.'])">
<span>A.</span> تم تحديد الفرضية مسبقًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q8', 1, 0, ['Correct! Pre-specification prevents fishing for significant subgroups. Post-hoc subgroups are hypothesis-generating only.', 'Opposite—small numbers of subgroups are more credible.', 'Opposite—biological rationale strengthens credibility.', 'Consistent effects within subgroups would support pooling.'])">
<span>B.</span> تم اختبار عدد كبير من المجموعات الفرعية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q8', 2, 0, ['Correct! Pre-specification prevents fishing for significant subgroups. Post-hoc subgroups are hypothesis-generating only.', 'Opposite—small numbers of subgroups are more credible.', 'Opposite—biological rationale strengthens credibility.', 'Consistent effects within subgroups would support pooling.'])">
<span>C.</span> لا يوجد مبرر بيولوجي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q8', 3, 0, ['Correct! Pre-specification prevents fishing for significant subgroups. Post-hoc subgroups are hypothesis-generating only.', 'Opposite—small numbers of subgroups are more credible.', 'Opposite—biological rationale strengthens credibility.', 'Consistent effects within subgroups would support pooling.'])">
<span>D.</span> تأثيرات غير متناسقة عبر التجارب داخل المجموعة الفرعية
                    </div>
</div>
<div id="final-q8-feedback" style="display: none;"></div>
</div>
 س9: التحليل التلوي للشبكة 
<div class="quiz-box animate delay-1" style="margin-bottom: 1.5rem;">
<p class="quiz-question"><strong>Q9.</strong> ما الافتراض الذي يجب التحقق منه في التحليل التلوي للشبكة لضمان المقارنات غير المباشرة الصحيحة؟</p>
<div class="quiz-options" id="final-q9">
<div class="quiz-option" onclick="checkQuizAnswer('final-q9', 0, 2, ['Equal sample sizes are not required.', 'Same outcomes are needed, but transitivity is the key assumption.', 'Correct! Transitivity means treatment comparisons are valid through common comparators—no systematic differences in effect modifiers across comparisons.', 'Blinding is study-level, not network-level.'])">
<span>A.</span> جميع الدراسات لها أحجام عينات متساوية
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q9', 1, 2, ['Equal sample sizes are not required.', 'Same outcomes are needed, but transitivity is the key assumption.', 'Correct! Transitivity means treatment comparisons are valid through common comparators—no systematic differences in effect modifiers across comparisons.', 'Blinding is study-level, not network-level.'])">
<span>B.</span> تقيس جميع الدراسات نفس النتيجة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q9', 2, 2, ['Equal sample sizes are not required.', 'Same outcomes are needed, but transitivity is the key assumption.', 'Correct! Transitivity means treatment comparisons are valid through common comparators—no systematic differences in effect modifiers across comparisons.', 'Blinding is study-level, not network-level.'])">
<span>C.</span> العبور (اتساق معدلات التأثير)
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q9', 3, 2, ['Equal sample sizes are not required.', 'Same outcomes are needed, but transitivity is the key assumption.', 'Correct! Transitivity means treatment comparisons are valid through common comparators—no systematic differences in effect modifiers across comparisons.', 'Blinding is study-level, not network-level.'])">
<span>D.</span> التعمية المزدوجة في جميع التجارب
                    </div>
</div>
<div id="final-q9-feedback" style="display: none;"></div>
</div>
<!-- Q10: TSA -->
<div class="quiz-box animate delay-1">
<p class="quiz-question"><strong>Q10.</strong> في التحليل التسلسلي التجريبي (TSA)، إلى ماذا يشير تجاوز حد عدم الجدوى؟</p>
<div class="quiz-options" id="final-q10">
<div class="quiz-option" onclick="checkQuizAnswer('final-q10', 0, 1, ['Harm boundary indicates increased risk of adverse events.', 'Correct! Crossing futility means even with more data, the effect is unlikely to reach clinical significance.', 'Opposite—crossing benefit boundary indicates sufficient evidence of effect.', 'Power is about required sample size, not boundary crossing.'])">
<span>A.</span> أسباب العلاج ضرر
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q10', 1, 1, ['Harm boundary indicates increased risk of adverse events.', 'Correct! Crossing futility means even with more data, the effect is unlikely to reach clinical significance.', 'Opposite—crossing benefit boundary indicates sufficient evidence of effect.', 'Power is about required sample size, not boundary crossing.'])">
<span>B.</span> من غير المرجح أن تظهر الدراسات الإضافية تأثيرًا ذا معنى
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q10', 2, 1, ['Harm boundary indicates increased risk of adverse events.', 'Correct! Crossing futility means even with more data, the effect is unlikely to reach clinical significance.', 'Opposite—crossing benefit boundary indicates sufficient evidence of effect.', 'Power is about required sample size, not boundary crossing.'])">
<span>C.</span> الدليل قاطع لصالحه
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q10', 3, 1, ['Harm boundary indicates increased risk of adverse events.', 'Correct! Crossing futility means even with more data, the effect is unlikely to reach clinical significance.', 'Opposite—crossing benefit boundary indicates sufficient evidence of effect.', 'Power is about required sample size, not boundary crossing.'])">
<span>D.</span> التحليل التلوي ضعيف
                    </div>
</div>
<div id="final-q10-feedback" style="display: none;"></div>
</div>
<div class="animate delay-2" style="margin-top: 2rem; padding: 1.5rem; background: rgba(212,175,55,0.1); border-radius: 8px; border-right: 4px solid var(--gold);">
<p style="font-weight: 600; color: var(--navy);">الجزء الأول كامل - تابع إلى الجزء 2 (الوحدات المتقدمة)</p>
</div>
</div>
</div>
 الجزء 2: أسئلة الوحدة المتقدمة (Q11-Q25) 
<div class="slide light" data-index="3">
<div class="content">
<h2 class="title navy animate">الاختبار النهائي: الجزء 2 من 2 (متقدم)</h2>
<p class="animate delay-1" style="color: var(--light-text); margin-bottom: 1.5rem;">
                  الأسئلة 11-25 تغطي الوحدات 13-22 (Bayesian، NMA، IPD، الاستجابة للجرعة، الهشاشة، العدالة، الذكاء الاصطناعي، النوعي، متعدد المتغيرات، التكاثر).
                </p>
 Q11: بايزي 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q11.</strong> في التحليل التلوي بايزي، ماذا يحدث عند استخدام سابقة غامضة مع العديد من الدراسات؟</p>
<div class="quiz-options" id="final-q11">
<div class="quiz-option" onclick="checkQuizAnswer('final-q11', 0, 0, ['Correct! With enough data, even a vague prior produces results very similar to frequentist. Data dominates.', 'The prior becomes irrelevant\u2014it does not become the result.', 'More studies narrow the posterior, not widen it.', 'The model still converges; it just resembles frequentist results.'])">
<span>A.</span> يتطابق الجزء الخلفي بشكل وثيق مع النتيجة المتكررة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q11', 1, 0, ['Correct! With enough data, even a vague prior produces results very similar to frequentist. Data dominates.', 'The prior becomes irrelevant\u2014it does not become the result.', 'More studies narrow the posterior, not widen it.', 'The model still converges; it just resembles frequentist results.'])">
<span>B.</span> يهيمن السابق على الجزء الخلفي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q11', 2, 0, ['Correct! With enough data, even a vague prior produces results very similar to frequentist. Data dominates.', 'The prior becomes irrelevant\u2014it does not become the result.', 'More studies narrow the posterior, not widen it.', 'The model still converges; it just resembles frequentist results.'])">
<span>C.</span> يصبح الفاصل الزمني الموثوق به واسعًا بلا حدود
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q11', 3, 0, ['Correct! With enough data, even a vague prior produces results very similar to frequentist. Data dominates.', 'The prior becomes irrelevant\u2014it does not become the result.', 'More studies narrow the posterior, not widen it.', 'The model still converges; it just resembles frequentist results.'])">
<span>D.</span> فشل النموذج للالتقاء
                    </div>
</div>
<div id="final-q11-feedback" style="display: none;"></div>
</div>
<!-- Q12: NMA -->
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q12.</strong> في NMA المضاد للاكتئاب الذي طوره سيبرياني، لماذا لم يتم الإعلان عن دواء واحد "الفائز"؟</p>
<div class="quiz-options" id="final-q12">
<div class="quiz-option" onclick="checkQuizAnswer('final-q12', 0, 1, ['Statistical power was sufficient with 522 trials.', 'Correct! Different drugs ranked best on different outcomes (efficacy vs acceptability). NMA reveals trade-offs.', 'NMA does use both direct and indirect evidence.', 'Rankings were possible\u2014but they showed different drugs for different outcomes.'])">
<span>A.</span> عدد قليل جدًا من الدراسات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q12', 1, 1, ['Statistical power was sufficient with 522 trials.', 'Correct! Different drugs ranked best on different outcomes (efficacy vs acceptability). NMA reveals trade-offs.', 'NMA does use both direct and indirect evidence.', 'Rankings were possible\u2014but they showed different drugs for different outcomes.'])">
<span>B.</span> تم تصنيف الأدوية المختلفة بشكل أفضل على نتائج مختلفة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q12', 2, 1, ['Statistical power was sufficient with 522 trials.', 'Correct! Different drugs ranked best on different outcomes (efficacy vs acceptability). NMA reveals trade-offs.', 'NMA does use both direct and indirect evidence.', 'Rankings were possible\u2014but they showed different drugs for different outcomes.'])">
<span>C.</span> لم يكن هناك دليل غير مباشر متاح
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q12', 3, 1, ['Statistical power was sufficient with 522 trials.', 'Correct! Different drugs ranked best on different outcomes (efficacy vs acceptability). NMA reveals trade-offs.', 'NMA does use both direct and indirect evidence.', 'Rankings were possible\u2014but they showed different drugs for different outcomes.'])">
<span>D.</span> لا يمكن تحديد SUCRA محسوب
                    </div>
</div>
<div id="final-q12-feedback" style="display: none;"></div>
</div>
<!-- Q13: IPD -->
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q13.</strong> لماذا لا يجب عليك أبدًا تجميع IPD كما لو كان من تجربة واحدة ضخمة؟</p>
<div class="quiz-options" id="final-q13">
<div class="quiz-option" onclick="checkQuizAnswer('final-q13', 0, 1, ['IPD is about more granular data, not fewer studies.', 'Correct! Ignoring study clustering can introduce confounding (Simpson\'s paradox). Always account for study as a clustering variable.', 'Time-to-event data can be modelled in IPD meta-analysis.', 'Binary outcomes work fine in IPD models.'])">
<span>A.</span> لدى IPD دائمًا عدد أقل من الدراسات عن المجموع
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q13', 1, 1, ['IPD is about more granular data, not fewer studies.', 'Correct! Ignoring study clustering can introduce confounding (Simpson\'s paradox). Always account for study as a clustering variable.', 'Time-to-event data can be modelled in IPD meta-analysis.', 'Binary outcomes work fine in IPD models.'])">
<span>B.</span> إنه يتجاهل تجميع الدراسات ويقدم ارتباكًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q13', 2, 1, ['IPD is about more granular data, not fewer studies.', 'Correct! Ignoring study clustering can introduce confounding (Simpson\'s paradox). Always account for study as a clustering variable.', 'Time-to-event data can be modelled in IPD meta-analysis.', 'Binary outcomes work fine in IPD models.'])">
<span>C.</span> لا يمكنه التعامل مع بيانات الوقت حتى الحدث
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q13', 3, 1, ['IPD is about more granular data, not fewer studies.', 'Correct! Ignoring study clustering can introduce confounding (Simpson\'s paradox). Always account for study as a clustering variable.', 'Time-to-event data can be modelled in IPD meta-analysis.', 'Binary outcomes work fine in IPD models.'])">
<span>D.</span> لا يمكن تجميع النتائج الثنائية
                    </div>
</div>
<div id="final-q13-feedback" style="display: none;"></div>
</div>
 Q14: الاستجابة للجرعة 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q14.</strong> ما الذي تسبب في اختفاء "منحنى J" للكحول في إعادة تحليل ستوكويل؟</p>
<div class="quiz-options" id="final-q14">
<div class="quiz-option" onclick="checkQuizAnswer('final-q14', 0, 1, ['The studies were the same\u2014only the reference group classification changed.', 'Correct! Former drinkers (who quit due to illness) were misclassified as abstainers, making the reference group appear unhealthier.', 'Larger sample size alone does not change the shape of the curve.', 'Confounders were part of the issue, but the key was the reference group definition.'])">
<span>A.</span> تمت إضافة دراسات جديدة أظهرت عدم وجود فائدة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q14', 1, 1, ['The studies were the same\u2014only the reference group classification changed.', 'Correct! Former drinkers (who quit due to illness) were misclassified as abstainers, making the reference group appear unhealthier.', 'Larger sample size alone does not change the shape of the curve.', 'Confounders were part of the issue, but the key was the reference group definition.'])">
<span>B.</span> تمت إزالة من يشربون الخمر السابقون بشكل صحيح من المجموعة المرجعية الممتنعين
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q14', 2, 1, ['The studies were the same\u2014only the reference group classification changed.', 'Correct! Former drinkers (who quit due to illness) were misclassified as abstainers, making the reference group appear unhealthier.', 'Larger sample size alone does not change the shape of the curve.', 'Confounders were part of the issue, but the key was the reference group definition.'])">
<span>C.</span> تم زيادة حجم العينة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q14', 3, 1, ['The studies were the same\u2014only the reference group classification changed.', 'Correct! Former drinkers (who quit due to illness) were misclassified as abstainers, making the reference group appear unhealthier.', 'Larger sample size alone does not change the shape of the curve.', 'Confounders were part of the issue, but the key was the reference group definition.'])">
<span>D.</span> تعديل أفضل للمربكين
                    </div>
</div>
<div id="final-q14-feedback" style="display: none;"></div>
</div>
 Q15: الهشاشة 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q15.</strong> في ملحمة الأوسيلتاميفير، ما الذي اكتشفه كوكرين عند الوصول إلى الأبحاث السريرية غير المنشورة تقارير الدراسة ؟</p>
<div class="quiz-options" id="final-q15">
<div class="quiz-option" onclick="checkQuizAnswer('final-q15', 0, 2, ['The drug was still effective for reducing symptom duration.', 'The original analysis already showed large effects.', 'Correct! The claimed 67% reduction in complications fell to a non-significant 11% when unpublished data was included.', 'Side effects were a separate finding.'])">
<span>A.</span> كان الدواء غير فعال تمامًا
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q15', 1, 2, ['The drug was still effective for reducing symptom duration.', 'The original analysis already showed large effects.', 'Correct! The claimed 67% reduction in complications fell to a non-significant 11% when unpublished data was included.', 'Side effects were a separate finding.'])">
<span>B.</span> كان التأثير أكبر مما كان يُعتقد في الأصل
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q15', 2, 2, ['The drug was still effective for reducing symptom duration.', 'The original analysis already showed large effects.', 'Correct! The claimed 67% reduction in complications fell to a non-significant 11% when unpublished data was included.', 'Side effects were a separate finding.'])">
<span>C.</span> اختفت فائدة المضاعفات إلى حد كبير
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q15', 3, 2, ['The drug was still effective for reducing symptom duration.', 'The original analysis already showed large effects.', 'Correct! The claimed 67% reduction in complications fell to a non-significant 11% when unpublished data was included.', 'Side effects were a separate finding.'])">
<span>D.</span> كانت الآثار الجانبية أكثر شيوعًا مما تم الإبلاغ عنه
                    </div>
</div>
<div id="final-q15-feedback" style="display: none;"></div>
</div>
 Q16: الإنصاف 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q16.</strong> ما هي النسبة المئوية لمرضى ارتفاع ضغط الدم في الولايات المتحدة الذين لم يكونوا مؤهلين لتجربة SPRINT؟</p>
<div class="quiz-options" id="final-q16">
<div class="quiz-option" onclick="checkQuizAnswer('final-q16', 0, 2, ['Only 25% excluded would still leave most patients represented.', 'Half excluded is an underestimate.', 'Correct! Over 75% of US hypertensive patients had exclusion criteria (diabetes, prior stroke, heart failure).', '100% would mean no one qualified\u2014the trial did enroll 9,361 patients.'])">
<span>A.</span> حوالي 25%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q16', 1, 2, ['Only 25% excluded would still leave most patients represented.', 'Half excluded is an underestimate.', 'Correct! Over 75% of US hypertensive patients had exclusion criteria (diabetes, prior stroke, heart failure).', '100% would mean no one qualified\u2014the trial did enroll 9,361 patients.'])">
<span>B.</span> حوالي 50%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q16', 2, 2, ['Only 25% excluded would still leave most patients represented.', 'Half excluded is an underestimate.', 'Correct! Over 75% of US hypertensive patients had exclusion criteria (diabetes, prior stroke, heart failure).', '100% would mean no one qualified\u2014the trial did enroll 9,361 patients.'])">
<span>C.</span> أكثر من 75%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q16', 3, 2, ['Only 25% excluded would still leave most patients represented.', 'Half excluded is an underestimate.', 'Correct! Over 75% of US hypertensive patients had exclusion criteria (diabetes, prior stroke, heart failure).', '100% would mean no one qualified\u2014the trial did enroll 9,361 patients.'])">
<span>D.</span> ما يقرب من 100%
                    </div>
</div>
<div id="final-q16-feedback" style="display: none;"></div>
</div>
<!-- Q17: AI -->
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q17.</strong> لماذا يُعتبر الذكاء الاصطناعي "مُعززًا" وليس "بديلًا" في المراجعات المنهجية؟</p>
<div class="quiz-options" id="final-q17">
<div class="quiz-option" onclick="checkQuizAnswer('final-q17', 0, 2, ['AI is faster than humans at screening, not slower.', 'AI achieves high recall but requires human verification for inclusion decisions.', 'Correct! AI achieves high recall but cannot make contextual judgments about relevance, quality, and applicability that humans can.', 'Cost is not the primary reason\u2014accuracy and judgment are.'])">
<span>A.</span> الذكاء الاصطناعي أبطأ من المراجعين البشريين
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q17', 1, 2, ['AI is faster than humans at screening, not slower.', 'AI achieves high recall but requires human verification for inclusion decisions.', 'Correct! AI achieves high recall but cannot make contextual judgments about relevance, quality, and applicability that humans can.', 'Cost is not the primary reason\u2014accuracy and judgment are.'])">
<span>B.</span> يتمتع الذكاء الاصطناعي باستدعاء مثالي
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q17', 2, 2, ['AI is faster than humans at screening, not slower.', 'AI achieves high recall but requires human verification for inclusion decisions.', 'Correct! AI achieves high recall but cannot make contextual judgments about relevance, quality, and applicability that humans can.', 'Cost is not the primary reason\u2014accuracy and judgment are.'])">
<span>C.</span> يقوم الذكاء الاصطناعي بالفحص بسرعة ولكنه لا يستطيع إصدار أحكام سياقية على المستوى البشري
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q17', 3, 2, ['AI is faster than humans at screening, not slower.', 'AI achieves high recall but requires human verification for inclusion decisions.', 'Correct! AI achieves high recall but cannot make contextual judgments about relevance, quality, and applicability that humans can.', 'Cost is not the primary reason\u2014accuracy and judgment are.'])">
<span>D.</span> الذكاء الاصطناعي مكلف للغاية بالنسبة لمعظم المراجعات
                    </div>
</div>
<div id="final-q17-feedback" style="display: none;"></div>
</div>
 Q18: النوعي 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q18.</strong> ما الذي يقيمه عنصر "الملاءمة" في CERQual؟</p>
<div class="quiz-options" id="final-q18">
<div class="quiz-option" onclick="checkQuizAnswer('final-q18', 0, 1, ['Number of studies is part of it, but adequacy is about richness of data, not just count.', 'Correct! Adequacy assesses the richness and quantity of data supporting the review finding, not just how many studies.', 'Consistency is assessed under the coherence component.', 'Generalizability is closer to the relevance component.'])">
<span>A.</span> عدد الدراسات فقط
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q18', 1, 1, ['Number of studies is part of it, but adequacy is about richness of data, not just count.', 'Correct! Adequacy assesses the richness and quantity of data supporting the review finding, not just how many studies.', 'Consistency is assessed under the coherence component.', 'Generalizability is closer to the relevance component.'])">
<span>B.</span> ثراء وكمية البيانات التي تدعم النتيجة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q18', 2, 1, ['Number of studies is part of it, but adequacy is about richness of data, not just count.', 'Correct! Adequacy assesses the richness and quantity of data supporting the review finding, not just how many studies.', 'Consistency is assessed under the coherence component.', 'Generalizability is closer to the relevance component.'])">
<span>C.</span> اتساق النتائج عبر الدراسات
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q18', 3, 1, ['Number of studies is part of it, but adequacy is about richness of data, not just count.', 'Correct! Adequacy assesses the richness and quantity of data supporting the review finding, not just how many studies.', 'Consistency is assessed under the coherence component.', 'Generalizability is closer to the relevance component.'])">
<span>D.</span> إمكانية التعميم على مجموعات سكانية أخرى
                    </div>
</div>
<div id="final-q18-feedback" style="display: none;"></div>
</div>
 Q19: متعدد المتغيرات 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q19.</strong> يتضمن التحليل التلوي 30 تجربة ستاتين، تشير كل منها إلى 4 نتائج مترابطة (120 حجم تأثير). ما هو النهج الصحيح؟</p>
<div class="quiz-options" id="final-q19">
<div class="quiz-option" onclick="checkQuizAnswer('final-q19', 0, 1, ['Treating 120 dependent effects as independent inflates precision.', 'Correct! RVE with small-sample correction handles dependent effect sizes without knowing the true within-study correlation.', 'Picking one outcome wastes data and may not answer the key question.', 'Averaging within studies loses information about outcome-specific effects.'])">
<span>A.</span> تعامل مع جميع الـ 120 كأحجام تأثير مستقلة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q19', 1, 1, ['Treating 120 dependent effects as independent inflates precision.', 'Correct! RVE with small-sample correction handles dependent effect sizes without knowing the true within-study correlation.', 'Picking one outcome wastes data and may not answer the key question.', 'Averaging within studies loses information about outcome-specific effects.'])">
<span>B.</span> استخدم RVE مع تصحيح عينة صغيرة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q19', 2, 1, ['Treating 120 dependent effects as independent inflates precision.', 'Correct! RVE with small-sample correction handles dependent effect sizes without knowing the true within-study correlation.', 'Picking one outcome wastes data and may not answer the key question.', 'Averaging within studies loses information about outcome-specific effects.'])">
<span>C.</span> اختر نتيجة واحدة فقط لكل دراسة
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q19', 3, 1, ['Treating 120 dependent effects as independent inflates precision.', 'Correct! RVE with small-sample correction handles dependent effect sizes without knowing the true within-study correlation.', 'Picking one outcome wastes data and may not answer the key question.', 'Averaging within studies loses information about outcome-specific effects.'])">
<span>D.</span> متوسط النتائج الأربع داخل كل دراسة
                    </div>
</div>
<div id="final-q19-feedback" style="display: none;"></div>
</div>
 Q20: التكاثر 
<div class="quiz-box animate delay-2" style="margin-bottom: 1rem;">
<p class="quiz-question"><strong>Q20.</strong> في خطأ راينهارت-روجوف، ما هو متوسط معدل النمو المصحح لـ البلدان ذات الديون المرتفعة؟</p>
<div class="quiz-options" id="final-q20">
<div class="quiz-option" onclick="checkQuizAnswer('final-q20', 0, 1, ['That was the INCORRECT value from the erroneous spreadsheet.', 'Correct! After including the 5 missing countries, average growth went from -0.1% to +2.2%.', '0% would mean no growth at all.', '5% would be unusually high for high-debt countries.'])">
<span>A.</span> −0.1% (نفس ما تم المطالبة به)
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q20', 1, 1, ['That was the INCORRECT value from the erroneous spreadsheet.', 'Correct! After including the 5 missing countries, average growth went from -0.1% to +2.2%.', '0% would mean no growth at all.', '5% would be unusually high for high-debt countries.'])">
<span>B.</span> +2.2%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q20', 2, 1, ['That was the INCORRECT value from the erroneous spreadsheet.', 'Correct! After including the 5 missing countries, average growth went from -0.1% to +2.2%.', '0% would mean no growth at all.', '5% would be unusually high for high-debt countries.'])">
<span>C.</span> 0%
                    </div>
<div class="quiz-option" onclick="checkQuizAnswer('final-q20', 3, 1, ['That was the INCORRECT value from the erroneous spreadsheet.', 'Correct! After including the 5 missing countries, average growth went from -0.1% to +2.2%.', '0% would mean no growth at all.', '5% would be unusually high for high-debt countries.'])">
<span>D.</span> +5%
                    </div>
</div>
<div id="final-q20-feedback" style="display: none;"></div>
</div>
<div class="animate delay-2" style="margin-top: 2rem; padding: 1.5rem; background: rgba(212,175,55,0.1); border-radius: 8px; border-right: 4px solid var(--gold);">
<p style="font-weight: 600; color: var(--navy);">درجة النجاح: 15/20 عبر كلا الجزأين</p>
<p style="margin-top: 0.5rem; color: var(--light-text);">
                    راجع أي أسئلة لم يتم الرد عليها من خلال العودة إلى الوحدة ذات الصلة. كل سؤال يختبر مفهومًا أساسيًا.
                  </p>
</div>
</div>
</div>
<div class="slide black" data-index="4">
<div class="animate" style="text-align: center;">
<p class="refrain">ليست كل إشارة حقيقة.</p>
<p style="font-size: 1.1rem; margin-top: 1rem;">الأساليب تحمي المرضى من ثقتنا.</p>
<div class="gold-line" style="margin: 1.5rem auto;"></div>
<p style="font-size: 1.5rem; color: var(--gold); margin-top: 1.5rem;">
                  تهانينا
                </p>
<p style="font-size: 1.1rem; margin-top: 1rem;">
                  لقد أكملت عكس الأدلة: دورة التحليل التلوي.
                </p>
<p style="font-size: 1rem; margin-top: 1rem; opacity: 0.9;">
                  أتمنى أن يسترشد تركيبك بالحقيقة، وتجميعك بالحكمة،<br/>
                  واستنتاجاتك بالتواضع.
                </p>
<div style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.8;">
<p style="margin-bottom: 0.5rem;"><strong>السبعة المبادئ:</strong></p>
<p>"ليست كل إشارة هي الحقيقة."</p>
<p>"أساليب تحمي المرضى من ثقتنا."</p>
<p>"ما الذي كان مخفيا على مرأى من الجميع؟"</p>
<p>"الرقم بدون مصدر ليس رقمًا."</p>
<p>"التباين هو رسالة، وليس ضجيجا."</p>
<p>"غياب الدليل ليس دليلاً على الغياب"</p>
<p>"اليقين يجب أن يُكتسب، لا أن يُفترض."</p>
</div>
<p style="font-size: 0.9rem; margin-top: 2rem; font-style: italic; opacity: 0.7;">
                  "اهدنا إلى الصراط المستقيم..."
                </p>
</div>
</div>
</div>
 التنقل بين الشرائح - الحد الأدنى من الأسهم العائمة 
<nav class="slide-nav" id="slideNav">
<button class="nav-btn" id="prevBtn" onclick="prevSlide()" title="Previous (←)">←</button>
<div class="nav-center">
<div class="progress" id="progress"></div>
<span class="slide-counter" id="counter">1 / 10</span>
</div>
<button class="nav-btn" id="nextBtn" onclick="nextSlide()" title="Next (→)">→</button>
</nav>
</div>
 لوحة الأدوات 
<aside class="tools-panel" id="toolsPanel">
<div class="tools-header">
<h3>الأدوات التفاعلية</h3>
<button class="btn" onclick="toggleToolsPanel()" style="padding: 0.25rem 0.5rem;">×</button>
</div>
<div class="tools-content">
 لوحة بيانات القصة الحية 
<div class="story-data-panel" id="storyDataPanel">
<h4><span style="font-size: 1.1rem;">📊</span> بيانات القصة الحية</h4>
<div id="storyDataContent">
<div class="no-story-data">
                  انتقل إلى الوحدة لرؤية بيانات قصة الأدلة الخاصة بها مع التفاعل قبل/بعد المقارنة.
                </div>
</div>
</div>
 حاسبة حجم التأثير 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                حاسبة حجم التأثير <span>▼</span>
</div>
<div class="tool-section-body">
<div class="form-group">
<label>نوع التأثير</label>
<select id="effectType">
<option value="OR">نسبة الأرجحية (OR)</option>
<option value="RR">نسبة المخاطرة (RR)</option>
<option value="RD">فرق المخاطر (RD)</option>
<option value="SMD">فرق المتوسط الموحد</option>
<option value="MD">فرق المتوسط</option>
</select>
</div>
<div id="binaryInputs">
<div class="form-group">
<label>المعالجة: الأحداث / الإجمالي</label>
<div style="display: flex; gap: 0.5rem;">
<input id="eventsTx" placeholder="Events" style="flex:1" type="number"/>
<input id="nTx" placeholder="Total" style="flex:1" type="number"/>
</div>
</div>
<div class="form-group">
<label>التحكم: الأحداث / الإجمالي</label>
<div style="display: flex; gap: 0.5rem;">
<input id="eventsCtrl" placeholder="Events" style="flex:1" type="number"/>
<input id="nCtrl" placeholder="Total" style="flex:1" type="number"/>
</div>
</div>
</div>
<button class="btn-small primary" onclick="calculateEffectSize()">احسب</button>
<div class="results-display" id="effectResults" style="display: none;"></div>
</div>
</div>
 حاسبة التحليل التلوي 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                حاسبة التحليل التلوي <span>▼</span>
</div>
<div class="tool-section-body">
<div class="form-group">
<label>أدخل الدراسات (التأثير، CI منخفض، CI مرتفع)</label>
<table class="study-table" id="studyTable">
<thead>
<tr>
<th>دراسة</th>
<th>التأثير</th>
<th>CI Lo</th>
<th>CI Hi</th>
<th></th>
</tr>
</thead>
<tbody id="studyTableBody">
<tr>
<td><input type="text" value="Study 1"/></td>
<td><input step="0.01" type="number" value="1.25"/></td>
<td><input step="0.01" type="number" value="0.95"/></td>
<td><input step="0.01" type="number" value="1.64"/></td>
<td><button class="btn-small" onclick="removeStudyRow(this)">×</button></td>
</tr>
<tr>
<td><input type="text" value="Study 2"/></td>
<td><input step="0.01" type="number" value="1.42"/></td>
<td><input step="0.01" type="number" value="1.10"/></td>
<td><input step="0.01" type="number" value="1.83"/></td>
<td><button class="btn-small" onclick="removeStudyRow(this)">×</button></td>
</tr>
<tr>
<td><input type="text" value="Study 3"/></td>
<td><input step="0.01" type="number" value="0.98"/></td>
<td><input step="0.01" type="number" value="0.72"/></td>
<td><input step="0.01" type="number" value="1.33"/></td>
<td><button class="btn-small" onclick="removeStudyRow(this)">×</button></td>
</tr>
</tbody>
</table>
<button class="btn-small" onclick="addStudyRow()">+ إضافة دراسة</button>
</div>
<div class="form-group">
<label>مقدر Tau²</label>
<select id="tau2Method">
<option value="DL">DerSimonian-Laird (DL)</option>
<option value="REML">REML</option>
<option value="PM">Paule-Mandel (PM)</option>
<option value="SJ">Sidik-Jonkman (SJ)</option>
<option value="HE">التحوطات (HE)</option>
<option value="EB">بايز التجريبية (EB)</option>
<option value="ML">أقصى احتمال (ML)</option>
<option value="HS">Hunter-Schmidt (HS)</option>
</select>
</div>
<div class="form-group">
<label>
<input checked="" id="useHKSJ" type="checkbox"/> استخدم تعديل HKSJ
                  </label>
</div>
<button class="btn-small primary" onclick="runMetaAnalysis()">تشغيل التحليل</button>
<div class="results-display" id="maResults" style="display: none;"></div>
<div class="forest-plot-container" id="forestPlotContainer" style="display: none;"></div>
</div>
</div>
<!-- PICO Builder -->
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                PICO Builder <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<div class="form-group">
<label>سكان</label>
<input id="picoP" placeholder="على سبيل المثال، البالغين المصابين بداء السكري من النوع 2" type="text"/>
</div>
<div class="form-group">
<label>تدخل</label>
<input id="picoI" placeholder="e.g., SGLT2 inhibitors" type="text"/>
</div>
<div class="form-group">
<label>المقارنة</label>
<input id="picoC" placeholder="e.g., Placebo or standard care" type="text"/>
</div>
<div class="form-group">
<label>حصيلة</label>
<input id="picoO" placeholder="e.g., All-cause mortality" type="text"/>
</div>
<button class="btn-small primary" onclick="generatePICO()">إنشاء سؤال</button>
<div id="picoOutput" style="margin-top: 1rem; padding: 0.75rem; background: #f7fafc; border-radius: 4px; display: none;"></div>
</div>
</div>
 تقييم تحيز النشر 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                انحياز النشر <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<p style="font-size: 0.75rem; color: var(--light-text); margin-bottom: 0.75rem;">
                  يستخدم البيانات من حاسبة التحليل التلوي أعلاه
                </p>
<button class="btn-small primary" onclick="runPublicationBias()">تقييم تحيز النشر</button>
<div id="pubBiasResults" style="display: none; margin-top: 1rem;">
<div class="results-display" id="eggerResults"></div>
<div class="forest-plot-container" id="funnelPlotContainer" style="margin-top: 0.5rem;"></div>
</div>
</div>
</div>
 خطر التحيز 2.0 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                خطر التحيز 2.0 <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<div class="form-group">
<label>اسم الدراسة</label>
<input id="robStudyName" placeholder="e.g., Smith 2020" type="text"/>
</div>
<div class="rob-domains">
<div class="rob-domain">
<label>D1: التوزيع العشوائي</label>
<select id="robD1" onchange="updateRoBOverall()">
<option value="">حدد...</option>
<option value="low">مخاطر منخفضة</option>
<option value="some">بعض المخاوف</option>
<option value="high">خطر مرتفع</option>
</select>
</div>
<div class="rob-domain">
<label>D2: الانحرافات عن التدخل</label>
<select id="robD2" onchange="updateRoBOverall()">
<option value="">حدد...</option>
<option value="low">مخاطر منخفضة</option>
<option value="some">بعض المخاوف</option>
<option value="high">خطر مرتفع</option>
</select>
</div>
<div class="rob-domain">
<label>D3: نتيجة مفقودة البيانات</label>
<select id="robD3" onchange="updateRoBOverall()">
<option value="">حدد...</option>
<option value="low">مخاطر منخفضة</option>
<option value="some">بعض المخاوف</option>
<option value="high">خطر مرتفع</option>
</select>
</div>
<div class="rob-domain">
<label>D4: قياس النتائج</label>
<select id="robD4" onchange="updateRoBOverall()">
<option value="">حدد...</option>
<option value="low">مخاطر منخفضة</option>
<option value="some">بعض المخاوف</option>
<option value="high">خطر مرتفع</option>
</select>
</div>
<div class="rob-domain">
<label>D5: اختيار النتائج المبلغ عنها</label>
<select id="robD5" onchange="updateRoBOverall()">
<option value="">حدد...</option>
<option value="low">مخاطر منخفضة</option>
<option value="some">بعض المخاوف</option>
<option value="high">خطر مرتفع</option>
</select>
</div>
</div>
<div id="robOverall" style="margin-top: 1rem; padding: 0.75rem; border-radius: 6px; text-align: center; font-weight: 600;"></div>
<div id="robTrafficLight" style="margin-top: 0.5rem;"></div>
</div>
</div>
 تقييم الدرجة 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                درجة اليقين <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<div class="form-group">
<label>بداية اليقين</label>
<select id="gradeStart">
<option value="4">عالية (RCTs)</option>
<option value="2">منخفضة (رصدية)</option>
</select>
</div>
<p style="font-size: 0.7rem; font-weight: 600; color: var(--navy); margin: 0.75rem 0 0.25rem;">عوامل خفض المستوى:</p>
<div class="grade-factors">
<div class="form-group" style="margin-bottom: 0.5rem;">
<label style="display: flex; align-items: center; gap: 0.5rem;">
<select id="gradeRoB" style="width: 100px;">
<option value="0">None</option>
<option value="-1">جدي (-1)</option>
<option value="-2">خطيرة جدًا (-2)</option>
</select>
                      خطر التحيز
                    </label>
</div>
<div class="form-group" style="margin-bottom: 0.5rem;">
<label style="display: flex; align-items: center; gap: 0.5rem;">
<select id="gradeInconsistency" style="width: 100px;">
<option value="0">None</option>
<option value="-1">جدي (-1)</option>
<option value="-2">خطيرة جدًا (-2)</option>
</select>
                      التناقض
                    </label>
</div>
<div class="form-group" style="margin-bottom: 0.5rem;">
<label style="display: flex; align-items: center; gap: 0.5rem;">
<select id="gradeIndirectness" style="width: 100px;">
<option value="0">None</option>
<option value="-1">جدي (-1)</option>
<option value="-2">خطيرة جدًا (-2)</option>
</select>
                      عدم المباشرة
                    </label>
</div>
<div class="form-group" style="margin-bottom: 0.5rem;">
<label style="display: flex; align-items: center; gap: 0.5rem;">
<select id="gradeImprecision" style="width: 100px;">
<option value="0">None</option>
<option value="-1">جدي (-1)</option>
<option value="-2">خطيرة جدًا (-2)</option>
</select>
                      عدم الدقة
                    </label>
</div>
<div class="form-group" style="margin-bottom: 0.5rem;">
<label style="display: flex; align-items: center; gap: 0.5rem;">
<select id="gradePubBias" style="width: 100px;">
<option value="0">None</option>
<option value="-1">جدي (-1)</option>
<option value="-2">خطيرة جدًا (-2)</option>
</select>
                      انحياز النشر
                    </label>
</div>
</div>
<button class="btn-small primary" onclick="calculateGRADE()" style="margin-top: 0.5rem;">احسب اليقين</button>
<div id="gradeResult" style="margin-top: 1rem;"></div>
</div>
</div>
 I² التفسير 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                دليل عدم التجانس <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<div class="form-group">
<label>أدخل قيمة I² (%)</label>
<input id="i2Input" max="100" min="0" placeholder="e.g., 75" type="number"/>
</div>
<button class="btn-small primary" onclick="interpretI2()">التفسير</button>
<div id="i2Interpretation" style="margin-top: 1rem;"></div>
<div style="margin-top: 1rem; padding: 0.75rem; background: #f7fafc; border-radius: 6px; font-size: 0.75rem;">
<p style="font-weight: 600; margin-bottom: 0.5rem;">إرشادات كوكرين:</p>
<p>0-40%: قد لا يكون مهمًا</p>
<p>30-60%: عدم تجانس معتدل</p>
<p>50-90%: عدم تجانس كبير</p>
<p>75-100%: عدم تجانس كبير</p>
<p style="margin-top: 0.5rem; font-style: italic; color: var(--light-text);">
                    "التباين هو رسالة، وليس ضجيجا."
                  </p>
</div>
</div>
</div>
 حاسبة NNT/NNH 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                حاسبة NNT/NNH <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<p style="font-size: 0.75rem; color: var(--light-text); margin-bottom: 0.75rem;">
                  تحويل أحجام التأثير إلى أرقام مطلوب للعلاج/الضرر
                </p>
<div class="form-group">
<label>خطر خط الأساس (معدل حدث التحكم)</label>
<input id="nntCER" max="1" min="0" placeholder="e.g., 0.15 for 15%" step="0.01" type="number"/>
</div>
<div class="form-group">
<label>مقياس التأثير</label>
<select id="nntEffectType">
<option value="RR">نسبة المخاطرة (RR)</option>
<option value="OR">نسبة الأرجحية (OR)</option>
<option value="RD">فرق المخاطر (RD)</option>
</select>
</div>
<div class="form-group">
<label>حجم التأثير</label>
<input id="nntEffect" placeholder="e.g., 0.75" step="0.01" type="number"/>
</div>
<div class="form-group">
<label>95% CI أقل</label>
<input id="nntCILo" placeholder="e.g., 0.60" step="0.01" type="number"/>
</div>
<div class="form-group">
<label>95% CI العلوي</label>
<input id="nntCIHi" placeholder="e.g., 0.95" step="0.01" type="number"/>
</div>
<button class="btn-small primary" onclick="calculateNNT()">احسب NNT/NNH</button>
<div class="results-display" id="nntResults" style="display: none;"></div>
</div>
</div>
 حساسية الإجازة لمرة واحدة 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                تحليل الإجازة لمرة واحدة <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<p style="font-size: 0.75rem; color: var(--light-text); margin-bottom: 0.75rem;">
                  اختبار تأثير كل دراسة على النتيجة المجمعة. يستخدم البيانات من حاسبة التحليل التلوي.
                </p>
<button class="btn-small primary" onclick="runLeaveOneOut()">تشغيل تحليل الحساسية</button>
<div id="looResults" style="display: none; margin-top: 1rem;">
<div class="results-display" id="looSummary"></div>
<div class="forest-plot-container" id="looPlotContainer" style="margin-top: 0.5rem;"></div>
</div>
</div>
</div>
 تقليم وملء 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                تقليم وملء <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<p style="font-size: 0.75rem; color: var(--light-text); margin-bottom: 0.75rem;">
                  يحسب الدراسات المفقودة لتصحيح عدم تناسق المخطط القمعي. يستخدم البيانات من حاسبة التحليل التلوي.
                </p>
<div class="form-group">
<label>المقدر</label>
<select id="trimFillEstimator">
<option value="L0">L0 (خطي)</option>
<option selected="" value="R0">R0 (على أساس الرتبة)</option>
</select>
</div>
<div class="form-group">
<label>Side</label>
<select id="trimFillSide">
<option value="right">اليمين (قمع إيجابي)</option>
<option selected="" value="left">اليسار (منع السلبية)</option>
</select>
</div>
<button class="btn-small primary" onclick="runTrimAndFill()">تشغيل القطع والتعبئة</button>
<div id="trimFillResults" style="display: none; margin-top: 1rem;">
<div class="results-display" id="trimFillSummary"></div>
<div class="forest-plot-container" id="trimFillPlotContainer" style="margin-top: 0.5rem;"></div>
</div>
</div>
</div>
 المراجع الرئيسية 
<div class="tool-section">
<div class="tool-section-header" onclick="toggleSection(this)">
                المراجع الرئيسية <span>▼</span>
</div>
<div class="tool-section-body" style="display: none;">
<p style="font-size: 0.7rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--navy);">حالات عكس الأدلة:</p>
<ul style="font-size: 0.7rem; color: var(--light-text); margin-right: 1rem; line-height: 1.6;">
<li><strong>CAST:</strong> إخت DS وآخرون. NEJM 1991;324:781-788</li>
<li><strong>HRT/WHI:</strong> روسو جي وآخرون. JAMA 2002;288:321-333</li>
<li><strong>روزيجليتازون:</strong> Nissen SE, Wolski K. NEJM 200;356:2457-2471</li>
<li><strong>فيوكس:</strong> Bombardier C et al. NEJM 2000;343:1520-1528</li>
<li><strong>تقليل الاحتيال:</strong> تحقيقات Erasmus MC 2012</li>
<li><strong>بارت:</strong> فيرغسون DA وآخرون. NEJM 2008;358:2319-2331</li>
<li><strong>إيزيس-4:</strong> المجموعة التعاونية لـداعش-4. لانسيت 1995;345:669-685</li>
<li><strong>ACCORD:</strong> مجموعة دراسة ACCORD. نيم 200؛358:2545-2559</li>
<li><strong>Reboxetine:</strong> إيدنج د وآخرون. BMJ 2010;341:c4737</li>
</ul>
<p style="font-size: 0.7rem; font-weight: 600; margin: 0.75rem 0 0.5rem; color: var(--navy);">مراجع الأساليب:</p>
<ul style="font-size: 0.7rem; color: var(--light-text); margin-right: 1rem; line-height: 1.6;">
<li><strong>الصف:</strong> Guyatt GH et al. بمج 2008;336:924-926</li>
<li><strong>RoB 2.0:</strong> ستيرن جاك وآخرون. بمج 2019;366:l4898</li>
<li><strong>ROBINS-I:</strong> ستيرن جا وآخرون. بمج 2016;355:i4919</li>
<li><strong>ICEMAN:</strong> شاندلماير إس وآخرون. CMAJ 2020;192:E901-E906</li>
<li><strong>HKSJ:</strong> Hartung J, Knapp G. Stat Med 2001;20:3875-3889</li>
<li><strong>بريسما:</strong> صفحة MJ et al. BMJ 2021;372:n71</li>
<li><strong>TSA:</strong> Wetterslev J et al. بي إم سي ميد ريس ميثودول 200؛8:39</li>
</ul>
</div>
</div>
</div>
</aside>
</div>
</main>
</div>
<script>
    // ============================================================
    // CONSTANTS
    // ============================================================
    const Z_95 = 1.96;
    const Z_95_CI_DIVISOR = 2 * Z_95;

    // ============================================================
    // LIVE STORY DATA SYSTEM
    // ============================================================

    const storyData = {
      1: { // CAST
        title: 'تجربة CAST: مضادات اضطراب النظم',
        subtitle: 'هل الأدوية التي تثبط PVCs تنقذ الأرواح؟',
        before: {
          label: 'قبل CAST (1989)',
          studies: [
            { name: 'Obs Study 1', effect: 0.45, lo: 0.28, hi: 0.72, n: 450 },
            { name: 'Obs Study 2', effect: 0.52, lo: 0.35, hi: 0.77, n: 380 },
            { name: 'Obs Study 3', effect: 0.38, lo: 0.22, hi: 0.65, n: 290 },
            { name: 'Surrogate', effect: 0.42, lo: 0.31, hi: 0.57, n: 1200 },
          ],
          pooled: { effect: 0.44, lo: 0.35, hi: 0.55 },
          metrics: { or: '0.44', nnt: '12', conclusion: 'Benefit' },
          insight: 'تشير بيانات المراقبة + المعقولية البيولوجية إلى أن مضادات اضطراب النظم تنقذ الأرواح عن طريق قمع PVCs.'
        },
        after: {
          label: 'بعد CAST (1991)',
          studies: [
            { name: 'CAST-Encainide', effect: 2.38, lo: 1.59, hi: 3.57, n: 730 },
            { name: 'CAST-Flecainide', effect: 2.64, lo: 1.60, hi: 4.36, n: 641 },
          ],
          pooled: { effect: 2.50, lo: 1.80, hi: 3.47 },
          metrics: { or: '2.50', nnh: '17', conclusion: 'Harm' },
          insight: '<strong>عكس الأدلة:</strong> أدت مضادات اضطراب النظم إلى زيادة معدل الوفيات بنسبة 150%. ما يقدر بنحو 50000+ حالة وفاة سنويا سببتها هذه الأدوية.'
        }
      },
      2: { // HRT
        title: 'العلاج التعويضي بالهرمونات وأمراض القلب',
        subtitle: 'هل استبدال الهرمونات يحمي القلب؟',
        before: {
          label: 'قبل WHI (2002)',
          studies: [
            { name: "Nurses' Health", effect: 0.50, lo: 0.40, hi: 0.63, n: 48470 },
            { name: 'Framingham', effect: 0.55, lo: 0.35, hi: 0.86, n: 1234 },
            { name: 'Meta 1998', effect: 0.65, lo: 0.52, hi: 0.81, n: 22000 },
          ],
          pooled: { effect: 0.56, lo: 0.47, hi: 0.67 },
          metrics: { rr: '0.56', nnt: '32', conclusion: 'Benefit' },
          insight: 'أظهرت أكثر من 30 دراسة رصدية انخفاضًا بنسبة 44% تقريبًا في أمراض القلب التاجية. تمت التوصية باستخدام العلاج التعويضي بالهرمونات للوقاية من أمراض القلب.'
        },
        after: {
          label: 'بعد WHI (2002)',
          studies: [
            { name: 'WHI E+P', effect: 1.29, lo: 1.02, hi: 1.63, n: 16608 },
            { name: 'WHI E-only', effect: 0.91, lo: 0.75, hi: 1.12, n: 10739 },
          ],
          pooled: { effect: 1.13, lo: 0.95, hi: 1.34 },
          metrics: { rr: '1.13', nnh: '∞', conclusion: 'لا فائدة / ضرر' },
          insight: '<strong>عكس الأدلة:</strong> أوضح تحيز المستخدم السليم نتائج المراقبة. كانت النساء اللاتي تناولن العلاج التعويضي بالهرمونات أكثر صحة في الأساس.'
        }
      },
      3: { // Rosiglitazone
        title: 'Rosiglitazone (Avandia)',
        subtitle: 'ما الذي تم إخفاؤه في التجارب غير المنشورة؟',
        before: {
          label: 'منشورة فقط',
          studies: [
            { name: 'ADOPT', effect: 1.08, lo: 0.75, hi: 1.56, n: 4360 },
            { name: 'DREAM', effect: 1.20, lo: 0.83, hi: 1.74, n: 5269 },
            { name: 'Published pool', effect: 1.14, lo: 0.90, hi: 1.45, n: 15000 },
          ],
          pooled: { effect: 1.14, lo: 0.92, hi: 1.41 },
          metrics: { or: '1.14', pvalue: '0.23', conclusion: 'NS' },
          insight: 'أظهرت التجارب المنشورة اتجاهًا غير مهم. تم طمأنة إدارة الغذاء والدواء والأطباء.'
        },
        after: {
          label: 'جميع البيانات (Nissen 2007)',
          studies: [
            { name: 'ADOPT', effect: 1.25, lo: 0.78, hi: 2.01, n: 4360 },
            { name: 'DREAM', effect: 1.36, lo: 0.68, hi: 2.71, n: 5269 },
            { name: '42 unpublished', effect: 1.45, lo: 1.10, hi: 1.91, n: 22000 },
          ],
          pooled: { effect: 1.43, lo: 1.03, hi: 1.98 },
          metrics: { or: '1.43', pvalue: '0.03', conclusion: 'HARM' },
          insight: '<strong>عكس الأدلة:</strong> كشفت التجارب غير المنشورة عن زيادة خطر الإصابة بالاحتشاء الدماغي بنسبة 43%. ~ 83000 نوبة قلبية زائدة تقدر.'
        }
      },
      6: { // Aprotinin
        title: 'Aprotinin (Trasylol)',
        subtitle: 'هل أخطأت الدراسات الرصدية الضرر؟',
        before: {
          label: 'Observational Studies',
          studies: [
            { name: 'Mangano 2006', effect: 0.80, lo: 0.64, hi: 1.00, n: 4374 },
            { name: 'Karkouti 2006', effect: 0.85, lo: 0.68, hi: 1.06, n: 10870 },
            { name: 'Obs Meta', effect: 0.82, lo: 0.70, hi: 0.96, n: 30000 },
          ],
          pooled: { effect: 0.82, lo: 0.71, hi: 0.95 },
          metrics: { rr: '0.82', nnt: '50', conclusion: 'Benefit' },
          insight: 'اقترحت الدراسات الرصدية انخفاض معدل الوفيات بنسبة 18%. تم استخدام الأبروتينين على نطاق واسع في جراحة القلب.'
        },
        after: {
          label: 'تجربة بارت (RCT)',
          studies: [
            { name: 'BART', effect: 1.53, lo: 1.10, hi: 2.15, n: 2331 },
          ],
          pooled: { effect: 1.53, lo: 1.10, hi: 2.15 },
          metrics: { rr: '1.53', nnh: '53', conclusion: 'HARM' },
          insight: '<strong>عكس الأدلة:</strong> أظهرت التجارب المعشاة ذات الشواهد زيادة في معدل الوفيات بنسبة 53%. الخلط من حيث الإشارة: المرضى الأكثر مرضًا حصلوا على الدواء.'
        }
      },
      7: { // Magnesium
        title: 'IV المغنيسيوم في MI',
        subtitle: 'المحاكمات الصغيرة مقابل المحاكمات الكبرى',
        before: {
          label: 'التجارب الصغيرة ميتا (1991)',
          studies: [
            { name: 'Morton 1984', effect: 0.10, lo: 0.01, hi: 0.87, n: 40 },
            { name: 'Rasmussen 1986', effect: 0.35, lo: 0.13, hi: 0.94, n: 273 },
            { name: 'Shechter 1990', effect: 0.27, lo: 0.08, hi: 0.95, n: 103 },
            { name: 'LIMIT-2', effect: 0.74, lo: 0.57, hi: 0.97, n: 2316 },
          ],
          pooled: { effect: 0.44, lo: 0.27, hi: 0.71 },
          metrics: { or: '0.44', nnt: '25', conclusion: 'Benefit' },
          insight: 'أظهر التحليل التلوي لـ 7 تجارب صغيرة انخفاض معدل الوفيات بنسبة 56%. بدا المغنيسيوم وكأنه معجزة.'
        },
        after: {
          label: 'مع داعش-4 (1995)',
          studies: [
            { name: 'Small trials', effect: 0.44, lo: 0.27, hi: 0.71, n: 2774 },
            { name: 'ISIS-4', effect: 1.06, lo: 0.99, hi: 1.13, n: 58050 },
          ],
          pooled: { effect: 1.02, lo: 0.95, hi: 1.09 },
          metrics: { or: '1.02', nnt: '∞', conclusion: 'لا يوجد تأثير' },
          insight: '<strong>عكس الأدلة:</strong> لم يجد إيزيس-4 (58,050 مريضًا) أي فائدة. من المحتمل أن تكون تأثيرات الدراسات الصغيرة وتحيز النشر قد ساهمت في التحليل التلوي الإيجابي السابق.'
        }
      },
      9: { // Reboxetine
        title: 'Reboxetine',
        subtitle: 'ما مقدار البيانات التي تم إخفاؤها؟',
        before: {
          label: 'منشورة فقط',
          studies: [
            { name: 'Pub Trial 1', effect: 0.62, lo: 0.35, hi: 1.10, n: 254 },
            { name: 'Pub Trial 2', effect: 0.48, lo: 0.22, hi: 1.05, n: 187 },
            { name: 'Pub Trial 3', effect: 0.55, lo: 0.28, hi: 1.08, n: 203 },
          ],
          pooled: { effect: 0.56, lo: 0.39, hi: 0.80 },
          metrics: { smd: '0.56', pvalue: '<0.001', conclusion: 'Benefit' },
          insight: 'أظهرت التجارب المنشورة فائدة كبيرة مقارنة بالعلاج الوهمي. تمت الموافقة على الريبوكسيتين وتسويقه.'
        },
        after: {
          label: 'جميع البيانات (EMA 2010)',
          studies: [
            { name: 'Published (26%)', effect: 0.56, lo: 0.39, hi: 0.80, n: 644 },
            { name: 'Unpublished (74%)', effect: 0.98, lo: 0.81, hi: 1.19, n: 1802 },
          ],
          pooled: { effect: 0.85, lo: 0.72, hi: 1.00 },
          metrics: { smd: '0.10', pvalue: '0.43', conclusion: 'لا يوجد تأثير' },
          insight: '<strong>نقض الأدلة:</strong> لم يتم نشر 74% من بيانات المرضى! كان التأثير الحقيقي فارغًا في الأساس. ولم يكن الدواء أفضل من العلاج الوهمي.'
        }
      },
      4: { // Vioxx
        title: 'Vioxx (Rofecoxib)',
        subtitle: 'ما الذي تم الإبلاغ عنه بشكل انتقائي؟',
        before: {
          label: 'VIGOR Published (2000)',
          studies: [
            { name: 'VIGOR (GI)', effect: 0.46, lo: 0.33, hi: 0.64, n: 8076 },
          ],
          pooled: { effect: 0.46, lo: 0.33, hi: 0.64 },
          metrics: { rr: '0.46', nnt: '41', conclusion: 'فائدة جي آي' },
          insight: 'تم نشر VIGOR مع التركيز على تقليل مضاعفات الجهاز الهضمي بنسبة 54%. تم التقليل من أهمية أحداث القلب والأوعية الدموية.'
        },
        after: {
          label: 'كشف بيانات السيرة الذاتية الكاملة',
          studies: [
            { name: 'VIGOR (CV)', effect: 4.25, lo: 1.39, hi: 17.37, n: 8076 },
            { name: 'APPROVe', effect: 1.92, lo: 1.19, hi: 3.11, n: 2586 },
          ],
          pooled: { effect: 2.24, lo: 1.24, hi: 4.02 },
          metrics: { rr: '2.24', nnh: '73', conclusion: 'ضرر السيرة الذاتية' },
          insight: '<strong>عكس الدليل:</strong> أظهرت البيانات الكاملة زيادة في خطر الإصابة باحتشاء عضلة القلب بمقدار 4 أضعاف. ~ 88.000 نوبة قلبية زائدة. تم سحبه عام 2004.'
        }
      },
      5: { // DECREASE
        title: 'تقليل المحاكمات (الاحتيال)',
        subtitle: 'ماذا يحدث عندما يتم تلفيق البيانات؟',
        before: {
          label: 'قبل أن ينكشف الاحتيال',
          studies: [
            { name: 'DECREASE-I', effect: 0.09, lo: 0.02, hi: 0.37, n: 112 },
            { name: 'DECREASE-IV', effect: 0.65, lo: 0.24, hi: 1.74, n: 1066 },
            { name: 'محاكمات أخرى', effect: 0.78, lo: 0.58, hi: 1.05, n: 3500 },
          ],
          pooled: { effect: 0.56, lo: 0.35, hi: 0.89 },
          metrics: { or: '0.56', nnt: '15', conclusion: 'Benefit' },
          insight: 'وأظهر التحليل التلوي بما في ذلك انخفاض معدل الوفيات بنسبة 44٪. تم تكليف حاصرات بيتا في المبادئ التوجيهية.'
        },
        after: {
          label: 'باستثناء البيانات الاحتيالية',
          studies: [
            { name: 'POISE', effect: 1.33, lo: 1.03, hi: 1.74, n: 8351 },
            { name: 'DIPOM', effect: 1.11, lo: 0.66, hi: 1.87, n: 921 },
            { name: 'MaVS', effect: 0.92, lo: 0.46, hi: 1.84, n: 496 },
          ],
          pooled: { effect: 1.27, lo: 1.01, hi: 1.60 },
          metrics: { or: '1.27', nnh: '67', conclusion: 'HARM' },
          insight: '<strong>عكس الأدلة:</strong> بدون بيانات الانخفاض الملفقة، أدت حاصرات بيتا إلى زيادة معدل الوفيات بنسبة 27%. ~ 10.000 حالة وفاة زائدة في أوروبا بسبب المبادئ التوجيهية المعيبة.'
        }
      },
      8: { // ACCORD
        title: 'ACCORD Trial',
        subtitle: 'عندما يخفي المتوسط الحقيقة',
        before: {
          label: 'قبل أكورد (2008)',
          studies: [
            { name: 'DCCT (Type 1)', effect: 0.42, lo: 0.23, hi: 0.75, n: 1441 },
            { name: 'UKPDS', effect: 0.84, lo: 0.71, hi: 0.99, n: 3867 },
            { name: 'Obs studies', effect: 0.70, lo: 0.60, hi: 0.82, n: 50000 },
          ],
          pooled: { effect: 0.72, lo: 0.62, hi: 0.84 },
          metrics: { hr: '0.72', nnt: '20', conclusion: 'Benefit' },
          insight: 'أظهرت التجارب السابقة أن التحكم المكثف في الجلوكوز يقلل من مضاعفات الأوعية الدموية الدقيقة. فائدة مفترضة للأوعية الدموية الكبيرة أيضًا.'
        },
        after: {
          label: 'ACCORD Results',
          studies: [
            { name: 'ACCORD', effect: 1.22, lo: 1.01, hi: 1.46, n: 10251 },
            { name: 'ADVANCE', effect: 0.93, lo: 0.83, hi: 1.06, n: 11140 },
            { name: 'VADT', effect: 1.07, lo: 0.81, hi: 1.42, n: 1791 },
          ],
          pooled: { effect: 1.04, lo: 0.91, hi: 1.19 },
          metrics: { hr: '1.22*', nnh: '95', conclusion: 'ضرر في اتفاق' },
          insight: '<strong>عكس الأدلة:</strong> توقف عقار أكورد مبكرًا - أدت المراقبة المكثفة إلى زيادة معدل الوفيات بنسبة 22%. كان عدم التجانس مهمًا: فالضرر يتركز في المرضى الأكبر سناً المصابين بأمراض القلب والأوعية الدموية.'
        }
      },
      10: { // Surfactant
        title: 'الفاعل بالسطح المبكر في الخدج',
        subtitle: 'عندما يتغير سياق الممارسة',
        before: {
          label: 'Early Trials (1990s)',
          studies: [
            { name: 'Kendig 1991', effect: 0.55, lo: 0.35, hi: 0.86, n: 479 },
            { name: 'OSECT 1992', effect: 0.61, lo: 0.41, hi: 0.91, n: 338 },
            { name: 'Egberts 1993', effect: 0.58, lo: 0.37, hi: 0.91, n: 324 },
          ],
          pooled: { effect: 0.58, lo: 0.45, hi: 0.75 },
          metrics: { rr: '0.58', nnt: '9', conclusion: 'Benefit' },
          insight: 'أظهر الفاعل بالسطح المبكر (الوقائي) انخفاض معدل الوفيات/اضطراب الشخصية الحدية بنسبة 42% مقارنةً بالفاعل بالسطح الإنقاذي. أصبح المعيار.'
        },
        after: {
          label: 'التجارب الحديثة مع CPAP',
          studies: [
            { name: 'COIN 2008', effect: 1.05, lo: 0.78, hi: 1.41, n: 610 },
            { name: 'SUPPORT 2010', effect: 0.91, lo: 0.68, hi: 1.21, n: 1316 },
            { name: 'VON 2011', effect: 0.94, lo: 0.71, hi: 1.25, n: 648 },
          ],
          pooled: { effect: 0.96, lo: 0.82, hi: 1.13 },
          metrics: { rr: '0.96', nnt: '∞', conclusion: 'لا فائدة' },
          insight: '<strong>تطور الأدلة:</strong> غيرت أجهزة CPAP الحديثة السياق. لم يعد الفاعل بالسطح المبكر متفوقًا على CPAP + الفاعل بالسطح الانتقائي. ويجب أن تتطور الممارسات بالأدلة.'
        }
      },
      11: { // HCQ COVID
        title: 'COVID-19 Hydroxychloroquine',
        subtitle: 'الوعد المبكر مقابل الأدلة الصارمة',
        before: {
          label: 'الدراسات المبكرة (مارس-مايو 2020)',
          studies: [
            { name: 'Gautret', effect: 0.15, lo: 0.03, hi: 0.75, n: 36 },
            { name: 'Chen J', effect: 0.65, lo: 0.25, hi: 1.69, n: 62 },
            { name: 'Million', effect: 0.22, lo: 0.11, hi: 0.44, n: 1061 },
          ],
          pooled: { effect: 0.28, lo: 0.15, hi: 0.52 },
          metrics: { or: '0.28', pvalue: '<0.001', conclusion: 'Benefit' },
          insight: 'اقترحت الدراسات الصغيرة/الرصدية المبكرة فائدة هائلة. تبع ذلك تفويضات الطوارئ.'
        },
        after: {
          label: 'التجارب المعشاة ذات الشواهد (التعافي، منظمة الصحة العالمية)',
          studies: [
            { name: 'RECOVERY', effect: 1.09, lo: 0.97, hi: 1.23, n: 4716 },
            { name: 'تضامن منظمة الصحة العالمية', effect: 1.19, lo: 0.89, hi: 1.59, n: 954 },
            { name: 'RCT Meta', effect: 1.11, lo: 1.00, hi: 1.22, n: 8000 },
          ],
          pooled: { effect: 1.11, lo: 1.00, hi: 1.22 },
          metrics: { or: '1.11', pvalue: '0.05', conclusion: 'لا فائدة / ضرر' },
          insight: '<strong>عكس الأدلة:</strong> لم تظهر التجارب المعشاة ذات الشواهد الكبيرة أي فائدة أو ضرر محتمل. تم إلغاء التفويضات. المحاكمات الصارمة تستغرق وقتا ولكنها تعطي الحقيقة.'
        }
      }
    };

    let currentStoryView = 'before';
    let storyPlotType = 'forest';
    let storyPredictions = {}; // Track predictions per module
    let showingPrediction = false;

    function setStoryPlotType(type) {
      storyPlotType = type;
      const story = storyData[currentModule];
      if (story) renderStoryContent(story);
    }

    function hasPredicted(moduleId) {
      return storyPredictions[moduleId] !== undefined;
    }

    function makePrediction(moduleId, prediction) {
      const story = storyData[moduleId];
      if (!story) return;

      // Determine the actual answer
      const afterEffect = story.after.pooled.effect;
      let actual;
      if (afterEffect < 0.9) actual = 'benefit';
      else if (afterEffect > 1.1) actual = 'harm';
      else actual = 'neutral';

      // Store prediction and result
      storyPredictions[moduleId] = {
        prediction: prediction,
        actual: actual,
        correct: prediction === actual
      };

      // Update progress
      saveProgress();

      // Now show the actual results
      showingPrediction = false;
      renderStoryContent(story);
    }

    function updateStoryPanel(moduleId) {
      const panel = document.getElementById('storyDataPanel');
      const content = document.getElementById('storyDataContent');
      const story = storyData[moduleId];

      panel.classList.add('updating');
      setTimeout(() => panel.classList.remove('updating'), 500);

      if (!story) {
        content.innerHTML = `
          <div class="no-story-data">
            <p style="font-size: 1.2rem; margin-bottom: 0.5rem;">📚</p>
            <p>Module ${moduleId}: ${modules[moduleId]?.title || 'Unknown'}</p>
            <p style="margin-top: 0.5rem; opacity: 0.7;">This module focuses on methods rather than a specific evidence reversal story.</p>
          </div>
        `;
        return;
      }

      currentStoryView = 'before';
      renderStoryContent(story);
    }

    function renderStoryContent(story) {
      const content = document.getElementById('storyDataContent');
      const moduleId = currentModule;
      const data = currentStoryView === 'before' ? story.before : story.after;
      const predicted = hasPredicted(moduleId);
      const predictionResult = storyPredictions[moduleId];

      // If viewing "After" and haven'لم يتم توقعه بعد، قم بإظهار واجهة التنبؤ إذا كان (currentStoryView ==='after' && !predicted && showingPrediction) {
        content.innerHTML = `
          <div style="margin-bottom: 0.75rem;">
            <div style="font-size: 1rem; font-weight: 600; color: white;">${story.title}</div>
            <div style="font-size: 0.75rem; color: rgba(255,255,255,0.7);">${story.subtitle}</div>
          </div>

          <div class="story-toggle">
            <button class="" onclick="toggleStoryView('before')">
              ${story.before.label}
            </button>
            <button class="active" onclick="toggleStoryView('after')">
              ${story.after.label}
            </button>
          </div>

          <div class="predict-first-panel">
            <div class="predict-icon">🤔</div>
            <h4>Predict First!</h4>
            <p>Based on ${story.before.label}, the evidence suggested <strong>${story.before.metrics.conclusion.toLowerCase()}</strong>.</p>
            <p style="margin-top: 0.5rem;">What do you think the rigorous evidence showed?</p>

            <div class="predict-buttons">
              <button class="predict-btn benefit" onclick="makePrediction(${moduleId}, 'benefit')"> <span class="predict-icon-small">✓</span> يساعد العلاج </button> <button class="predict-btn Neutral" onclick="makePrediction(${moduleId},'neutral')"> <span class="predict-icon-small">—</span> لا يوجد تأثير </button> <button class="predict-btn ضرر" onclick="makePrediction(${moduleId},'harm')">
                <span class="predict-icon-small">✗</span>
                Treatment Harms
              </button>
            </div>

            <p style="font-size: 0.7rem; opacity: 0.6; margin-top: 0.75rem;">Making a prediction improves learning retention by 40%</p>
          </div>
        `;
        return;
      }

      // Prediction feedback (shown after predicting)
      let predictionFeedback = ''; إذا (currentStoryView ==='after' && predicted) {
        const wasCorrect = predictionResult.correct;
        predictionFeedback = `
          <div class="prediction-feedback ${wasCorrect ? 'correct' : 'incorrect'}">
            <span class="feedback-icon">${wasCorrect ? '✓' : '✗'}</span>
            <span>${wasCorrect ? 'Correct! You predicted this evidence reversal.' : 'Not quite - this is why we need rigorous evidence!'}</span>
          </div>
        `;
      }

      content.innerHTML = `
        <div style="margin-bottom: 0.75rem;">
          <div style="font-size: 1rem; font-weight: 600; color: white;">${story.title}</div>
          <div style="font-size: 0.75rem; color: rgba(255,255,255,0.7);">${story.subtitle}</div>
        </div>

        <div class="story-toggle">
          <button class="${currentStoryView === 'before' ? 'active' : ''}" onclick="toggleStoryView('before')">
            ${story.before.label}
          </button>
          <button class="${currentStoryView === 'after' ? 'active' : ''}" onclick="toggleStoryView('after')">
            ${story.after.label}
          </button>
        </div>

        ${predictionFeedback}

        <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
          <button class="btn-small ${storyPlotType === 'forest' ? 'primary' : ''}" onclick="setStoryPlotType('forest')" style="flex:1; font-size: 0.7rem;">Forest Plot</button>
          <button class="btn-small ${storyPlotType === 'funnel' ? 'primary' : ''}" onclick="setStoryPlotType('funnel')" style="flex:1; font-size: 0.7rem;">Funnel Plot</button>
        </div>

        <div class="story-viz" id="storyForestPlot"></div>

        <div class="story-metrics">
          <div class="story-metric ${getMetricHighlight(data.metrics.conclusion)}">
            <div class="value">${Object.values(data.metrics)[0]}</div>
            <div class="label">${Object.keys(data.metrics)[0].toUpperCase()}</div>
          </div>
          <div class="story-metric ${getMetricHighlight(data.metrics.conclusion)}">
            <div class="value">${data.metrics.conclusion}</div>
            <div class="label">Conclusion</div>
          </div>
        </div>

        <div class="story-insight">${data.insight}</div>

        <button class="btn-small primary" style="width: 100%; margin-top: 0.75rem;" onclick="loadStoryIntoCalculator()">
          Load Data into Calculator →
        </button>
      `;

      // Draw the appropriate plot
      if (storyPlotType === 'funnel') { drawStoryFunnelPlot(data.studies, data.pooled,currentStoryView ==='after'); } else { drawStoryForestPlot(data.studies, data.pooled,currentStoryView ==='after'); } } الدالة getMetricHighlight(conclusion) { if (conclusion.includes('Harm') || conclusion === 'HARM') return 'highlight-bad'; إذا (الاستنتاج. يشمل ('Benefit')) return 'highlight-good';
      return '';
    }

    function toggleStoryView(view) {
      const moduleId = currentModule;
      const story = storyData[moduleId];
      if (!story) return;

      currentStoryView = view;

      // If switching to "after" and haven't predicted yet, show prediction interface
      if (view === 'after' && !hasPredicted(moduleId)) {
        showingPrediction = true;
      } else {
        showingPrediction = false;
      }

      renderStoryContent(story);
    }

    function drawStoryForestPlot(studies, pooled, isAfter) {
      const container = document.getElementById('storyForestPlot');
      if (!container) return;

      const width = 320;
      const height = studies.length * 32 + 60;
      const margin = { left: 100, right: 30, top: 15, bottom: 30 };
      const plotWidth = width - margin.left - margin.right;

      // Find data range
      const allEffects = [...studies.map(s => [s.lo, s.hi]).flat(), pooled.lo, pooled.hi];
      let minE = Math.min(...allEffects, 0.1);
      let maxE = Math.max(...allEffects, 3);

      // Log scale
      const logMin = Math.log(Math.max(0.05, minE * 0.8));
      const logMax = Math.log(maxE * 1.2);
      const xScale = (v) => margin.left + ((Math.log(v) - logMin) / (logMax - logMin)) * plotWidth;

      let svg = `<svg viewBox="0 0 ${width} ${height}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا الرقيق؛" role="img" aria-label="قطعة أرض توضح أحجام التأثير لدراسات ${studies.length}.">`;

      // Add pattern definitions for color-blind accessibility
      svg += `<defs>
        <pattern id="harmPattern" patternUnits="userSpaceOnUse" width="4" height="4">
          <path d="M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2" stroke="#ef4444" stroke-width="1"/>
        </pattern>
        <pattern id="benefitPattern" patternUnits="userSpaceOnUse" width="4" height="4">
          <circle cx="2" cy="2" r="1" fill="#22c55e"/>
        </pattern>
      </defs>`;

      // Grid lines
      [0.1, 0.25, 0.5, 1, 2, 4].forEach(tick => {
        if (tick >= minE * 0.8 && tick <= maxE * 1.2) {
          const x = xScale(tick);
          svg += `<line x1="${x}" y1="${margin.top}" x2="${x}" y2="${الارتفاع - هامش.أسفل}" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;
          svg += `<text x="${x}" y="${الارتفاع - هامش.أسفل + 12}" text-anchor="middle" font-size="8" fill="rgba(255,255,255,0.5)">${tick}</text>`;
        }
      });

      // Null line at 1
      const nullX = xScale(1);
      svg += `<line x1="${nullX}" y1="${margin.top}" x2="${nullX}" y2="${الارتفاع - هامش.أسفل}" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>`;

      // Studies - COLOR-BLIND SAFE: use different shapes + colors
      studies.forEach((study, i) => {
        const y = margin.top + 15 + i * 32;
        const x = xScale(Math.max(0.05, Math.min(10, study.effect)));
        const xLo = xScale(Math.max(0.05, study.lo));
        const xHi = xScale(Math.min(10, study.hi));

        // Color-blind safe: green (#22c55e) for benefit, red (#ef4444) for harm, gray for neutral
        const isBenefit = study.effect < 1;
        const isHarm = study.effect > 1.1;
        const color = isBenefit ? '#22c55e' : (isHarm ? '#ef4444' : '#94a3b8');

        // Study name
        svg += `<text x="${margin.left - 5}" y="${y + 4}" text-anchor="end" font-size="9" fill="white">${study.name}</text>`;

        // CI line - use dashed for harm, solid for benefit (color-blind safe)
        const dashArray = isHarm ? 'stroke-dasharray="3,2"' : '';
        svg += `<line x1="${xLo}" y1="${y}" x2="${xHi}" y2="${y}" stroke="${color}" stroke-width="2" ${dashArray}/>`;

        // Effect marker - SHAPES differ: square for benefit, circle for harm, diamond for neutral
        const size = Math.min(10, Math.max(5, study.n ? Math.sqrt(study.n) / 10 : 6));
        if (isBenefit) {
          // Square with fill for benefit
          svg += `<rect x="${x - size/2}" y="${y - size/2}" width="${size}" height="${size}" fill="${color}" rx="1"/>`;
        } else if (isHarm) {
          // Circle for harm
          svg += `<circle cx="${x}" cy="${y}" r="${size/2}" fill="${color}"/>`;
        } else {
          // Diamond for neutral
          svg += `<polygon points="${x},${y-size/2} ${x+size/2},${y} ${x},${y+size/2} ${x-size/2},${y}" fill="${color}"/>`;
        }
      });

      // Pooled diamond
      const poolY = height - margin.bottom - 10;
      const poolX = xScale(Math.max(0.05, Math.min(10, pooled.effect)));
      const poolXLo = xScale(Math.max(0.05, pooled.lo));
      const poolXHi = xScale(Math.min(10, pooled.hi));
      const isPooledHarm = pooled.effect > 1;
      const diamondColor = isAfter ? (isPooledHarm ? '#ef4444' : '#22c55e') : '#D4AF37';

      svg += `<polygon points="${poolXLo},${poolY} ${poolX},${poolY - 6} ${poolXHi},${poolY} ${poolX},${poolY + 6}" fill="${diamondColor}" stroke="white" stroke-width="1"/>`;
      svg += `<text x="${margin.left - 5}" y="${poolY + 3}" text-anchor="end" font-size="9" font-weight="bold" fill="${diamondColor}">Pooled</text>`;

      // Labels with symbols for color-blind users
      svg += `<text x="${xScale(0.3)}" y="${height - 3}" text-anchor="middle" font-size="7" fill="rgba(255,255,255,0.6)">■ Favors Treatment</text>`;
      svg += `<text x="${xScale(2.5)}" y="${height - 3}" text-anchor="middle" font-size="7" fill="rgba(255,255,255,0.6)">● Favors Control</text>`;

      svg += '</svg>';
      container.innerHTML = svg;
    }

    function drawStoryFunnelPlot(studies, pooled, isAfter) {
      const container = document.getElementById('storyForestPlot');
      if (!container) return;

      const width = 320;
      const height = 200;
      const margin = { left: 40, right: 20, top: 20, bottom: 35 };
      const plotWidth = width - margin.left - margin.right;
      const plotHeight = height - margin.top - margin.bottom;

      // Calculate SE from CI
      const studiesWithSE = studies.map(s => ({
        ...s,
        se: (Math.log(s.hi) - Math.log(s.lo)) / 3.92
      }));

      const maxSE = Math.max(...studiesWithSE.map(s => s.se)) * 1.2;
      const logPooled = Math.log(pooled.effect);

      // Scale functions
      const logEffects = studiesWithSE.map(s => Math.log(s.effect));
      const minLog = Math.min(...logEffects, logPooled) - 0.5;
      const maxLog = Math.max(...logEffects, logPooled) + 0.5;

      const xScale = (logE) => margin.left + ((logE - minLog) / (maxLog - minLog)) * plotWidth;
      const yScale = (se) => margin.top + (se / maxSE) * plotHeight;

      let svg = `<svg viewBox="0 0 ${width} ${height}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا الرقيق؛">`;

      // Funnel shape
      const funnelLeft = xScale(logPooled - 1.96 * maxSE);
      const funnelRight = xScale(logPooled + 1.96 * maxSE);
      const funnelTop = xScale(logPooled);

      svg += `<polygon points="${funnelTop},${margin.top} ${funnelLeft},${margin.top +plotHeight} ${funnelRight},${margin.top +plotHeight}"
               fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.3)" stroke-dasharray="3"/>`;

      // Vertical line at pooled effect
      svg += `<line x1="${xScale(logPooled)}" y1="${margin.top}" x2="${xScale(logPooled)}" y2="${margin.top +plotHeight}"
               stroke="${isAfter ? '#ef4444' : '#D4AF37'}" stroke-width="2"/>`;

      // Null line at log(1) = 0
      const nullX = xScale(0);
      if (nullX > margin.left && nullX < width - margin.right) {
        svg += `<line x1="${nullX}" y1="${margin.top}" x2="${nullX}" y2="${margin.top +plotHeight}"
                 stroke="rgba(255,255,255,0.4)" stroke-width="1" stroke-dasharray="4"/>`;
      }

      // Study points
      studiesWithSE.forEach(study => {
        const x = xScale(Math.log(study.effect));
        const y = yScale(study.se);
        const color = study.effect < 1 ? '#22c55e' : '#ef4444';

        svg += `<circle cx="${x}" cy="${y}" r="6" fill="${color}" stroke="white" stroke-width="1"/>`;
      });

      // X-axis label
      svg += `<text x="${width/2}" y="${height - 5}" text-anchor="middle" font-size="8" fill="rgba(255,255,255,0.6)">Effect Size (log scale)</text>`;

      // Y-axis label
      svg += `<text x="12" y="${height/2}" text-anchor="middle" font-size="8" fill="rgba(255,255,255,0.6)" transform="rotate(-90, 12, ${height/2})">Standard Error</text>`;

      // Show asymmetry indicator if appropriate
      if (isAfter) {
        svg += `<text x="${width - 10}" y="${margin.top + 15}" text-anchor="end" font-size="8" fill="#ef4444">⚠ Asymmetry</text>`;
      }

      svg += '</svg>';
      container.innerHTML = svg;
    }

    // ============================================================
    // INTERACTIVE TOOLS FOR NEW MODULES (13-22)
    // ============================================================

    // --- Tool 1: Bayesian Posterior Visualizer (Module 13) ---
    function updateBayesianPosterior() {
      const strengthVal = parseInt(document.getElementById('priorStrengthSlider').value);
      const meanVal = parseInt(document.getElementById('priorMeanSlider').value) / 100;
      const priorSD = Math.max(0.1, 10 - strengthVal * 0.098);
      const labels = ['Vague', 'Vague', 'Weak', 'Weak', 'Moderate', 'Moderate', 'Informative', 'Informative', 'Strong', 'Strong', 'Very Strong'];
      document.getElementById('priorStrengthLabel').textContent = labels[Math.min(10, Math.floor(strengthVal / 10))];
      document.getElementById('priorMeanLabel').textContent = meanVal.toFixed(2);

      // Data likelihood: centered at observed log-OR = -0.47 (STAMPEDE HR 0.63), SE = 0.10
      const dataM = -0.47, dataSE = 0.10;
      const dataPrec = 1 / (dataSE * dataSE);
      const priorPrec = 1 / (priorSD * priorSD);
      const postPrec = dataPrec + priorPrec;
      const postM = (dataM * dataPrec + meanVal * priorPrec) / postPrec;
      const postSD = Math.sqrt(1 / postPrec);

      const w = 500, h = 220, pad = 40;
      const xMin = -2, xMax = 2, steps = 200;
      function gauss(x, m, s) { return Math.exp(-0.5 * ((x - m) / s) ** 2) / (s * Math.sqrt(2 * Math.PI)); }
      function pathData(m, s, color) {
        let pts = [];
        for (let i = 0; i <= steps; i++) {
          const x = xMin + (xMax - xMin) * i / steps;
          const px = pad + (x - xMin) / (xMax - xMin) * (w - 2 * pad);
          const py = h - pad - gauss(x, m, s) / gauss(m, m, s) * (h - 2 * pad);
          pts.push(`${i === 0 ? 'M' : 'L'}${px.toFixed(1)},${py.toFixed(1)}`);
        }
        return `<path d="${pts.join(' ')}" fill="none" stroke="${color}" stroke-width="2.5"/>`;
      }

      let svg = `<svg viewBox="0 0 ${w} ${h}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا رقيق؛">`;
      svg += `<line x1="${pad}" y1="${h-pad}" x2="${w-pad}" y2="${h-pad}" stroke="#ccc"/>`;
      // Zero line
      const zx = pad + (0 - xMin) / (xMax - xMin) * (w - 2 * pad);
      svg += `<line x1="${zx}" y1="${pad}" x2="${zx}" y2="${h-pad}" stroke="#aaa" stroke-dasharray="4"/>`;
      svg += `<text x="${zx}" y="${h-pad+15}" text-anchor="middle" font-size="10" fill="#666">0</text>`;
      // Labels
      svg += `<text x="${pad}" y="${h-pad+15}" text-anchor="middle" font-size="10" fill="#666">${xMin}</text>`;
      svg += `<text x="${w-pad}" y="${h-pad+15}" text-anchor="middle" font-size="10" fill="#666">${xMax}</text>`;
      svg += `<text x="${w/2}" y="${h-5}" text-anchor="middle" font-size="11" fill="#666">log-OR</text>`;
      // Curves
      svg += pathData(meanVal, priorSD, '#3b82f6');
      svg += pathData(dataM, dataSE, '#22c55e');
      svg += pathData(postM, postSD, '#D4AF37');
      // Legend
      svg += `<circle cx="${pad+10}" cy="15" r="5" fill="#3b82f6"/><text x="${pad+20}" y="19" font-size="10" fill="#333">Prior</text>`;
      svg += `<circle cx="${pad+70}" cy="15" r="5" fill="#22c55e"/><text x="${pad+80}" y="19" font-size="10" fill="#333">Likelihood</text>`;
      svg += `<circle cx="${pad+160}" cy="15" r="5" fill="#D4AF37"/><text x="${pad+170}" y="19" font-size="10" fill="#333">Posterior</text>`;
      // Posterior summary
      svg += `<text x="${w-pad}" y="35" text-anchor="end" font-size="10" fill="#333">Posterior: ${postM.toFixed(2)} [${(postM-1.96*postSD).toFixed(2)}, ${(postM+1.96*postSD).toFixed(2)}]</text>`;
      svg += '</svg>';
      document.getElementById('bayesianPlotArea').innerHTML = svg;
    }

    // --- Tool 2: NMA Network Graph (Module 14) ---
    function drawNMANetwork() {
      const area = document.getElementById('nmaNetworkArea');
      if (!area) return;
      // Simplified antidepressant network (12 key drugs)
      const drugs = [
        { name: 'Placebo', x: 250, y: 160 },
        { name: 'Fluoxetine', x: 120, y: 60 }, { name: 'Sertraline', x: 180, y: 40 },
        { name: 'Paroxetine', x: 310, y: 40 }, { name: 'Citalopram', x: 380, y: 60 },
        { name: 'Escitalopram', x: 420, y: 130 }, { name: 'Venlafaxine', x: 400, y: 220 },
        { name: 'Duloxetine', x: 330, y: 270 }, { name: 'Mirtazapine', x: 220, y: 280 },
        { name: 'Amitriptyline', x: 130, y: 260 }, { name: 'Bupropion', x: 70, y: 200 },
        { name: 'Agomelatine', x: 80, y: 130 }
      ];
      // Edges: [from, to, nStudies]
      const edges = [
        [0,1,35],[0,2,15],[0,3,22],[0,4,12],[0,5,18],[0,6,20],[0,7,10],[0,8,14],[0,9,8],
        [1,2,5],[1,3,8],[1,6,12],[1,8,4],[2,3,3],[2,6,6],[3,6,7],[4,5,6],
        [5,6,8],[6,7,5],[6,8,6],[8,9,3],[1,10,4],[0,10,7],[0,11,9],[5,11,3]
      ];
      const w = 500, h = 320;
      let svg = `<svg viewBox="0 0 ${w} ${h}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا رقيق؛">`;
      // Edges
      edges.forEach(([a, b, n]) => {
        const d1 = drugs[a], d2 = drugs[b];
        const thick = Math.max(1, Math.min(6, n / 5));
        svg += `<line x1="${d1.x}" y1="${d1.y}" x2="${d2.x}" y2="${d2.y}" stroke="rgba(212,175,55,0.4)" stroke-width="${thick}"/>`;
      });
      // Nodes
      drugs.forEach((d, i) => {
        const r = i === 0 ? 18 : 12;
        const fill = i === 0 ? '#1E2761' : '#D4AF37';
        svg += `<circle cx="${d.x}" cy="${d.y}" r="${r}" fill="${fill}" stroke="white" stroke-width="1.5"/>`;
        svg += `<text x="${d.x}" y="${d.y + r + 12}" text-anchor="middle" font-size="8" fill="#333" font-weight="600">${d.name}</text>`;
      });
      svg += '</svg>';
      area.innerHTML = svg;
    }

    // --- Tool 3: GOSH Plot Generator (Module 17) ---
    // xoshiro128** PRNG for deterministic sampling
    function xoshiro128ss(seed) {
      let s = [seed, seed ^ 0x9E3779B9, seed ^ 0x6A09E667, seed ^ 0xBB67AE85];
      function rotl(x, k) { return ((x << k) | (x >>> (32 - k))) >>> 0; }
      function next() {
        const result = (rotl((s[1] * 5) >>> 0, 7) * 9) >>> 0;
        const t = (s[1] << 9) >>> 0;
        s[2] ^= s[0]; s[3] ^= s[1]; s[1] ^= s[2]; s[0] ^= s[3];
        s[2] ^= t; s[3] = rotl(s[3], 11);
        return result / 4294967296;
      }
      return next;
    }

    function generateGOSHPlot() {
      const area = document.getElementById('goshPlotArea');
      if (!area) return;
      // Example 8-study data (log-OR and SE)
      const studies = [
        { y: -0.5, se: 0.2 }, { y: -0.3, se: 0.15 }, { y: -0.1, se: 0.25 },
        { y: -0.4, se: 0.18 }, { y: 0.6, se: 0.3 }, { y: -0.35, se: 0.12 },
        { y: -0.2, se: 0.22 }, { y: -0.45, se: 0.16 }
      ];
      const k = studies.length;
      const rng = xoshiro128ss(42);
      const nSubsets = Math.min(2000, Math.pow(2, k) - 1);
      const points = [];

      for (let s = 0; s < nSubsets; s++) {
        // Random subset (at least 2 studies)
        let mask;
        do {
          mask = Math.floor(rng() * (Math.pow(2, k) - 1)) + 1;
        } while (mask.toString(2).split('').filter(c => c === '1').length < 2);

        const sub = studies.filter((_, i) => mask & (1 << i));
        // Fixed-effect pooled estimate + I²
        const wSum = sub.reduce((a, s) => a + 1 / (s.se * s.se), 0);
        const pooled = sub.reduce((a, s) => a + s.y / (s.se * s.se), 0) / wSum;
        const Q = sub.reduce((a, s) => a + (s.y - pooled) ** 2 / (s.se * s.se), 0);
        const df = sub.length - 1;
        const I2 = Math.max(0, (Q - df) / Q * 100);
        points.push({ effect: pooled, I2 });
      }

      const w = 500, h = 280, pad = 50;
      const xMin = -1.2, xMax = 1.2, yMin = 0, yMax = 100;
      let svg = `<svg viewBox="0 0 ${w} ${h}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا رقيق؛">`;
      // Axes
      svg += `<line x1="${pad}" y1="${h-pad}" x2="${w-pad}" y2="${h-pad}" stroke="#999"/>`;
      svg += `<line x1="${pad}" y1="${pad}" x2="${pad}" y2="${h-pad}" stroke="#999"/>`;
      svg += `<text x="${w/2}" y="${h-5}" text-anchor="middle" font-size="11" fill="#666">Pooled Effect (log-OR)</text>`;
      svg += `<text x="12" y="${h/2}" text-anchor="middle" font-size="11" fill="#666" transform="rotate(-90,12,${h/2})">I² (%)</text>`;
      // Points
      points.forEach(p => {
        const px = pad + (p.effect - xMin) / (xMax - xMin) * (w - 2 * pad);
        const py = h - pad - (p.I2 - yMin) / (yMax - yMin) * (h - 2 * pad);
        svg += `<circle cx="${px.toFixed(1)}" cy="${py.toFixed(1)}" r="2" fill="rgba(212,175,55,0.4)"/>`;
      });
      // Tick labels
      [-1, -0.5, 0, 0.5, 1].forEach(v => {
        const x = pad + (v - xMin) / (xMax - xMin) * (w - 2 * pad);
        svg += `<text x="${x}" y="${h-pad+15}" text-anchor="middle" font-size="9" fill="#999">${v}</text>`;
      });
      [0, 25, 50, 75, 100].forEach(v => {
        const y = h - pad - v / 100 * (h - 2 * pad);
        svg += `<text x="${pad-5}" y="${y+3}" text-anchor="end" font-size="9" fill="#999">${v}</text>`;
      });
      svg += '</svg>';
      area.innerHTML = svg;
    }

    // --- Tool 4: Contour-Enhanced Funnel Plot (Module 17) ---
    function generateContourFunnel() {
      const area = document.getElementById('contourFunnelArea');
      if (!area) return;
      // Reuse magnesium-like data
      const studies = [
        {y: -0.5, se: 0.20}, {y: -0.3, se: 0.15}, {y: -0.1, se: 0.25},
        {y: -0.4, se: 0.18}, {y: 0.6, se: 0.30}, {y: -0.35, se: 0.12},
        {y: -0.2, se: 0.22}, {y: -0.45, se: 0.16}, {y: -0.15, se: 0.28},
        {y: -0.55, se: 0.10}
      ];
      const w = 460, h = 300, pad = 50;
      const pooled = -0.28;
      const maxSE = 0.35;
      const xMin = -1.5, xMax = 1.0;
      function px(v) { return pad + (v - xMin) / (xMax - xMin) * (w - 2 * pad); }
      function py(se) { return pad + se / maxSE * (h - 2 * pad); }

      let svg = `<svg viewBox="0 0 ${w} ${h}" style="العرض: 100%؛ الارتفاع: تلقائي؛ عائلة الخط: بلا رقيق؛">`;
      // Contour regions (p-value regions)
      // Draw widest region first (p<0.10) so narrower regions layer on top
      const zVals = [1.645, 1.96, 2.576]; // p<0.10, p<0.05, p<0.01
      const colors = ['rgba(212,175,55,0.15)', 'rgba(59,130,246,0.15)', 'rgba(34,197,94,0.15)'];
      const labels = ['p<0.10', 'p<0.05', 'p<0.01'];
      for (let z = 0; z < zVals.length; z++) {
        // Left contour: effect = -z*SE (significant negative)
        let pts = `${px(0)},${py(0)}`;
        for (let se = 0; se <= maxSE; se += 0.01) {
          pts += ` ${px(-zVals[z] * se)},${py(se)}`;
        }
        pts += ` ${px(xMin)},${py(maxSE)} ${px(xMin)},${py(0)}`;
        svg += `<polygon points="${pts}" fill="${colors[z]}"/>`;
        // Right contour
        pts = `${px(0)},${py(0)}`;
        for (let se = 0; se <= maxSE; se += 0.01) {
          pts += ` ${px(zVals[z] * se)},${py(se)}`;
        }
        pts += ` ${px(xMax)},${py(maxSE)} ${px(xMax)},${py(0)}`;
        svg += `<polygon points="${pts}" fill="${colors[z]}"/>`;
      }
      // Pooled line
      svg += `<line x1="${px(pooled)}" y1="${py(0)}" x2="${px(pooled)}" y2="${py(maxSE)}" stroke="#D4AF37" stroke-width="2"/>`;
      // Null line
      svg += `<line x1="${px(0)}" y1="${py(0)}" x2="${px(0)}" y2="${py(maxSE)}" stroke="#999" stroke-dasharray="4"/>`;
      // Studies
      studies.forEach(s => {
        svg += `<circle cx="${px(s.y)}" cy="${py(s.se)}" r="5" fill="#1E2761" stroke="white" stroke-width="1"/>`;
      });
      // Legend
      svg += `<text x="${w-pad}" y="15" text-anchor="end" font-size="9" fill="#22c55e">p&lt;0.01</text>`;
      svg += `<text x="${w-pad}" y="28" text-anchor="end" font-size="9" fill="#3b82f6">p&lt;0.05</text>`;
      svg += `<text x="${w-pad}" y="41" text-anchor="end" font-size="9" fill="#D4AF37">p&lt;0.10</text>`;
      // Axes
      svg += `<line x1="${pad}" y1="${py(0)}" x2="${w-pad}" y2="${py(0)}" stroke="#999"/>`;
      svg += `<line x1="${pad}" y1="${py(0)}" x2="${pad}" y2="${py(maxSE)}" stroke="#999"/>`;
      svg += `<text x="${w/2}" y="${h-5}" text-anchor="middle" font-size="11" fill="#666">Effect Size</text>`;
      svg += `<text x="12" y="${h/2}" text-anchor="middle" font-size="11" fill="#666" transform="rotate(-90,12,${h/2})">Std Error</text>`;
      svg += '</svg>';
      area.innerHTML = svg;
    }

    // --- Tool 5: Fragility Index Calculator (Module 17) ---
    function calculateFragilityIndex() {
      let eTx = parseInt(document.getElementById('fi-eventsTx').value) || 0;
      let nTx = parseInt(document.getElementById('fi-nTx').value) || 0;
      let eCtrl = parseInt(document.getElementById('fi-eventsCtrl').value) || 0;
      let nCtrl = parseInt(document.getElementById('fi-nCtrl').value) || 0;
      if (nTx <= 0 || nCtrl <= 0 || eTx < 0 || eCtrl < 0) {
        document.getElementById('fragilityResult').innerHTML = '<p style="color:#C53030;">Please enter valid positive numbers.</p>';
        document.getElementById('fragilityResult').style.display = 'block';
        return;
      }
      // Fisher's exact test approximation using chi-squared
      function pValue(a, b, c, d) {
        const n = a + b + c + d;
        const e = (a * d - b * c);
        const chi2 = n * e * e / ((a + b) * (c + d) * (a + c) * (b + d));
        // Approximate p from chi2 with 1 df using normal
        const z = Math.sqrt(chi2);
        return 2 * (1 - normalCDF(z));
      }
      function normalCDF(x) {
        const t = 1 / (1 + 0.2316419 * Math.abs(x));
        const d = 0.3989422804 * Math.exp(-x * x / 2);
        const p = d * t * (0.3193815 + t * (-0.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))));
        return x > 0 ? 1 - p : p;
      }
      let fi = 0;
      let a = eTx, b = nTx - eTx, c = eCtrl, d = nCtrl - eCtrl;
      let p = pValue(a, b, c, d);
      if (p >= 0.05) {
        document.getElementById('fragilityResult').innerHTML = '<p>Result is already non-significant (p = ' + p.toFixed(4) + '). Fragility index = 0.</p>';
        document.getElementById('fragilityResult').style.display = 'block';
        return;
      }
      // Iteratively add events to treatment arm (convert non-events to events)
      while (p < 0.05 && fi < 500 && a < nTx) {
        a++;
        b = nTx - a;
        p = pValue(a, b, c, d);
        fi++;
      }
      const res = document.getElementById('fragilityResult');
      res.innerHTML = `
        <p style="font-weight:600; font-size:1.2rem; color:var(--navy);">Fragility Index = ${fi}</p>
        <p style="margin-top:0.5rem;">Changing <strong>${fi}</strong> event${fi !== 1 ? 's' : ''} flips p from significant to ${p.toFixed(4)}.</p>
        <p style="margin-top:0.5rem; color:${fi <= 3 ? '#C53030' : fi <= 8 ? '#D4AF37' : '#22c55e'}; font-weight:600;">
          ${fi <= 3 ? 'Very fragile result' : fi <= 8 ? 'Moderately fragile' : 'Reasonably robust'}
        </p>
      `;
      res.style.display = 'block';
    }

    // --- Tool 6: Dose-Response Curve Builder (Module 16) ---
    let currentDoseModel = 'spline'; وظيفة setDoseModel(model) {currentDoseModel = model; ['linear', 'quadratic', 'spline'].forEach(m => {
        const btn = document.getElementById('doseBtn-' + m);
        if (btn) { btn.classList.toggle('primary', m === model); }
      });
      drawDoseResponse();
    }
    function drawDoseResponse() {
      const area = document.getElementById('doseResponsePlotArea');
      if (!area) return;
      // Simulated dose-response data (drinks/week vs log-RR)
      const data = [
        {dose: 0, rr: 0, lo: 0, hi: 0},
        {dose: 3, rr: -0.05, lo: -0.15, hi: 0.05},
        {dose: 7, rr: 0.02, lo: -0.08, hi: 0.12},
        {dose: 14, rr: 0.15, lo: 0.03, hi: 0.27},
        {dose: 21, rr: 0.35, lo: 0.18, hi: 0.52},
        {dose: 28, rr: 0.55, lo: 0.30, hi: 0.80}
      ];
      const w = 480, h = 240, pad = 50;
      const maxDose = 30, yMin = -0.3, yMax = 0.9;
      function px(d) { return pad + d / maxDose * (w - 2 * pad); }
      function py(v) { return h - pad - (v - yMin) / (yMax - yMin) * (h - 2 * pad); }

      let svg = `<svg viewBox="0 0 ${w} ${h}" style="width:100%;height:auto;font-family:sans-serif;">`;
      // Reference line at 0
      svg += `<line x1="${pad}" y1="${py(0)}" x2="${w-pad}" y2="${py(0)}" stroke="#aaa" stroke-dasharray="4"/>`;
      // CI shading
      let ciPath = `M${px(data[0].dose)},${py(data[0].hi)}`;
      data.forEach(d => { ciPath += ` L${px(d.dose)},${py(d.hi)}`; });
      for (let i = data.length - 1; i >= 0; i--) { ciPath += ` L${px(data[i].dose)},${py(data[i].lo)}`; }
      ciPath += 'Z';
      svg += `<path d="${ciPath}" fill="rgba(212,175,55,0.15)"/>`;

      // Model curve
      let curvePts = [];
      for (let d = 0; d <= maxDose; d += 0.5) {
        let val;
        if (currentDoseModel === 'linear') { فال = 0.019 * د؛ } else if (currentDoseModel ==='quadratic') { فال = -0.005 * د + 0.0009 * د * د؛ } else { // spline // محاكاة تأثير منحنى J if (d <= 5) val = -0.01 * d; وإلا إذا (د <= 15) فال = -0.05 + 0.02 * (د - 5)؛ قيمة أخرى = 0.15 + 0.025 * (د - 15)؛ } المنحنىPts.push(`${px(d).toFixed(1)},${py(val).toFixed(1)}`); } svg += `<polyline point="${curvePts.join(' ')}" fill="none" stroke="#D4AF37" stroke-width="2.5"/>`;

      // Data points
      data.forEach(d => {
        svg += `<circle cx="${px(d.dose)}" cy="${py(d.rr)}" r="5" fill="#1E2761" stroke="white" stroke-width="1"/>`;
        svg += `<line x1="${px(d.dose)}" y1="${py(d.lo)}" x2="${px(d.dose)}" y2="${py(d.hi)}" stroke="#1E2761" stroke-width="1"/>`;
      });
      // Axes + labels
      svg += `<line x1="${pad}" y1="${h-pad}" x2="${w-pad}" y2="${h-pad}" stroke="#999"/>`;
      svg += `<line x1="${pad}" y1="${pad}" x2="${pad}" y2="${h-pad}" stroke="#999"/>`;
      svg += `<text x="${w/2}" y="${h-5}" text-anchor="middle" font-size="11" fill="#666">Dose (drinks/week)</text>`;
      svg += `<text x="12" y="${h/2}" text-anchor="middle" font-size="11" fill="#666" transform="rotate(-90,12,${h/2})">log-RR</text>`;
      svg += `<text x="${w-pad}" y="20" text-anchor="end" font-size="11" fill="#D4AF37" font-weight="600">${currentDoseModel.charAt(0).toUpperCase() + currentDoseModel.slice(1)} model</text>`;
      svg += '</svg>';
      area.innerHTML = svg;
    }

    // --- Tool 7: CERQual Assessment Tool (Module 20) ---
    function initCERQualTool() {
      const container = document.getElementById('cerqualTool');
      if (!container) return;
      const components = [
        { id: 'meth', label: 'Methodological Limitations', desc: 'Extent of problems with design/conduct of contributing studies' },
        { id: 'cohe', label: 'Coherence', desc: 'How clearly and consistently the data supports the finding' },
        { id: 'adeq', label: 'Adequacy', desc: 'Degree of richness and quantity of data supporting the finding' },
        { id: 'relv', label: 'Relevance', desc: 'Extent to which the contributing studies apply to the review context' }
      ];
      const levels = ['No concerns', 'Minor concerns', 'Moderate concerns', 'Serious concerns'];
      let html = '';
      components.forEach(c => {
        html += `<div style="margin-bottom:0.75rem; padding:0.75rem; background:white; border-radius:6px; border:1px solid #e2e8f0;">
          <div style="font-weight:600; margin-bottom:0.25rem;">${c.label}</div>
          <div style="font-size:0.8rem; color:#718096; margin-bottom:0.5rem;">${c.desc}</div>
          <select id="cerqual-${c.id}" onchange="updateCERQual()" style="width:100%; padding:0.3rem; border:1px solid #ccc; border-radius:4px;">
            ${levels.map((l, i) => `<option value="${i}">${l}</option>`).join('')} </select> </div>`; }); أتش تي أم أل +='<div id="cerqualResult" style="margin-top:0.75rem; padding:0.75rem; background:rgba(212,175,55,0.1); border-radius:6px;"></div>';
      container.innerHTML = html;
      updateCERQual();
    }
    function updateCERQual() {
      const ids = ['meth', 'cohe', 'adeq', 'relv'];
      const total = ids.reduce((s, id) => s + parseInt(document.getElementById('cerqual-' + id)?.value || 0), 0);
      const levels = ['High', 'Moderate', 'Low', 'Very Low'];
      const colors = ['#22c55e', '#D4AF37', '#f59e0b', '#C53030'];
      const idx = Math.min(3, Math.floor(total / 2));
      const res = document.getElementById('cerqualResult');
      if (res) res.innerHTML = `<p style="font-weight:600; color:${colors[idx]}; font-size:1.1rem;">Overall Confidence: ${levels[idx]}</p>
        <p style="font-size:0.85rem; margin-top:0.25rem;">Total concern score: ${total}/12</p>`;
    }

    // --- Tool 8: Reproducibility Checklist (Module 22) ---
    function initReproChecklist() {
      const container = document.getElementById('reproChecklist');
      if (!container) return;
      const items = [
        'Search strategy fully reported and reproducible',
        'Extracted data table available (supplementary or repository)',
        'Analysis code/script shared (R, Python, or equivalent)',
        'Software version and packages documented',
        'Random seed specified for stochastic analyses',
        'Sensitivity analyses pre-specified in protocol',
        'PRISMA checklist completed and submitted',
        'Data available in machine-readable format (CSV/JSON)'
      ];
      container.innerHTML = items.map((item, i) =>
        `<label style="display:flex; align-items:center; gap:0.5rem; padding:0.5rem 0; border-bottom:1px solid #e2e8f0; cursor:pointer;">
          <input type="checkbox" id="repro-${i}" onchange="updateReproScore()" style="width:18px;height:18px;accent-color:#D4AF37;">
          <span style="font-size:0.9rem;">${item}</span>
        </label>`
      ).join('');
      updateReproScore();
    }
    function updateReproScore() {
      const total = 8;
      let checked = 0;
      for (let i = 0; i < total; i++) {
        if (document.getElementById('repro-' + i)?.checked) checked++;
      }
      const pct = Math.round(checked / total * 100);
      const color = pct >= 75 ? '#22c55e' : pct >= 50 ? '#D4AF37' : '#C53030';
      const label = pct >= 75 ? 'Good' : pct >= 50 ? 'Fair' : 'Poor';
      const res = document.getElementById('reproScore');
      if (res) {
        res.innerHTML = `
          <div style="background:#e2e8f0; border-radius:4px; height:12px; margin-bottom:0.5rem;">
            <div style="background:${color}; height:100%; border-radius:4px; width:${pct}%; transition:width 0.3s;"></div>
          </div>
          <p style="font-weight:600; color:${color};">${label} Reproducibility (${checked}/${total} = ${pct}%)</p>
        `;
      }
    }

    // Initialize tools when modules are first visited
    function initAdvancedTools() {
      // Run once on first visit to these modules
      if (document.getElementById('bayesianPlotArea') && !document.getElementById('bayesianPlotArea').innerHTML) {
        updateBayesianPosterior();
      }
      if (document.getElementById('nmaNetworkArea') && !document.getElementById('nmaNetworkArea').innerHTML) {
        drawNMANetwork();
      }
      if (document.getElementById('doseResponsePlotArea') && !document.getElementById('doseResponsePlotArea').innerHTML) {
        drawDoseResponse();
      }
      if (document.getElementById('reproChecklist') && !document.getElementById('reproChecklist').innerHTML) {
        initReproChecklist();
      }
    }

    // Hook into goToModule to init tools
    const _origGoToModuleForTools = typeof goToModule === 'function' ? goToModule : null;

    function openToolsWithStory() {
      // Open tools panel
      const panel = document.getElementById('toolsPanel');
      panel.classList.add('open');

      // Scroll to story data section
      const storyPanel = document.getElementById('storyDataPanel'); إذا (storyPanel) { StoryPanel.scrollIntoView({ السلوك:'smooth', block: 'start' });
        storyPanel.classList.add('updating');
        setTimeout(() => storyPanel.classList.remove('updating'), 500);
      }

      // Hide the indicator button since they found it
      document.getElementById('storyIndicatorBtn').classList.remove('pulse');
    }

    function loadStoryIntoCalculator() {
      const story = storyData[currentModule];
      if (!story) {
        alert('No story data available for this module.');
        return;
      }

      const data = currentStoryView === 'before' ? story.before : story.after;
      const tbody = document.getElementById('studyTableBody'); // مسح الصفوف الموجودة tbody.innerHTML ='';

      // Add story studies
      data.studies.forEach(study => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><input type="text" value="${study.name}"></td>
          <td><input type="number" step="0.01" value="${study.effect.toFixed(2)}"></td>
          <td><input type="number" step="0.01" value="${study.lo.toFixed(2)}"></td>
          <td><input type="number" step="0.01" value="${study.hi.toFixed(2)}"></td>
          <td><button class="btn-small" onclick="removeStudyRow(this)">×</button></td>
        `;
        tbody.appendChild(row);
      });

      // Auto-run the analysis
      runMetaAnalysis();

      // Show notification
      const panel = document.getElementById('storyDataPanel');
      panel.classList.add('updating');
      setTimeout(() => panel.classList.remove('updating'), 500);
    }

    // ============================================================
    // STATISTICAL FUNCTIONS
    // ============================================================

    function normalCDF(x) {
      const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741;
      const a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
      const sign = x < 0 ? -1 : 1;
      x = Math.abs(x) / Math.sqrt(2);
      const t = 1 / (1 + p * x);
      const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
      return 0.5 * (1 + sign * y);
    }

    function tCDF(t, df) {
      if (df <= 0) return 0.5;
      const x = df / (df + t * t);
      const half = 0.5 * incompleteBeta(x, df / 2, 0.5);
      return t >= 0 ? 1 - half : half;
    }

    function incompleteBeta(x, a, b) {
      if (x === 0) return 0;
      if (x === 1) return 1;
      const bt = Math.exp(
        logGamma(a + b) - logGamma(a) - logGamma(b) +
        a * Math.log(x) + b * Math.log(1 - x)
      );
      if (x < (a + 1) / (a + b + 2)) {
        return bt * betaCF(x, a, b) / a;
      }
      return 1 - bt * betaCF(1 - x, b, a) / b;
    }

    function betaCF(x, a, b) {
      const maxIter = 200, eps = 1e-10;
      const qab = a + b, qap = a + 1, qam = a - 1;
      let c = 1, d = 1 - qab * x / qap;
      if (Math.abs(d) < 1e-30) d = 1e-30;
      d = 1 / d;
      let h = d;
      for (let m = 1; m <= maxIter; m++) {
        const m2 = 2 * m;
        let aa = m * (b - m) * x / ((qam + m2) * (a + m2));
        d = 1 + aa * d;
        if (Math.abs(d) < 1e-30) d = 1e-30;
        c = 1 + aa / c;
        if (Math.abs(c) < 1e-30) c = 1e-30;
        d = 1 / d;
        h *= d * c;
        aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
        d = 1 + aa * d;
        if (Math.abs(d) < 1e-30) d = 1e-30;
        c = 1 + aa / c;
        if (Math.abs(c) < 1e-30) c = 1e-30;
        d = 1 / d;
        const del = d * c;
        h *= del;
        if (Math.abs(del - 1) < eps) break;
      }
      return h;
    }

    function logGamma(x) {
      const c = [76.18009172947146, -86.50532032941677, 24.01409824083091,
        -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5];
      let y = x, tmp = x + 5.5;
      tmp -= (x + 0.5) * Math.log(tmp);
      let ser = 1.000000000190015;
      for (let j = 0; j < 6; j++) ser += c[j] / ++y;
      return -tmp + Math.log(2.5066282746310005 * ser / x);
    }

    function tQuantile(p, df) {
      if (p <= 0) return -Infinity;
      if (p >= 1) return Infinity;
      if (df <= 0) return NaN;
      let lo = -10, hi = 10;
      for (let i = 0; i < 100; i++) {
        const mid = (lo + hi) / 2;
        if (tCDF(mid, df) < p) lo = mid;
        else hi = mid;
      }
      return (lo + hi) / 2;
    }

    function normalQuantile(p) {
      if (p <= 0) return -Infinity;
      if (p >= 1) return Infinity;
      let lo = -10, hi = 10;
      for (let i = 0; i < 100; i++) {
        const mid = (lo + hi) / 2;
        if (normalCDF(mid) < p) lo = mid;
        else hi = mid;
      }
      return (lo + hi) / 2;
    }

    function chiSquareCDF(x, df) {
      if (x <= 0) return 0;
      return regularizedGammaP(df / 2, x / 2);
    }

    function regularizedGammaP(a, x) {
      if (x < 0 || a <= 0) return NaN;
      if (x === 0) return 0;
      if (x < a + 1) {
        let sum = 1 / a, term = sum;
        for (let n = 1; n < 100; n++) {
          term *= x / (a + n);
          sum += term;
          if (Math.abs(term) < 1e-10) break;
        }
        return sum * Math.exp(-x + a * Math.log(x) - logGamma(a));
      } else {
        let b = x + 1 - a, c = 1 / 1e-30, d = 1 / b, h = d;
        for (let i = 1; i < 100; i++) {
          const an = -i * (i - a);
          b += 2;
          d = an * d + b;
          if (Math.abs(d) < 1e-30) d = 1e-30;
          c = b + an / c;
          if (Math.abs(c) < 1e-30) c = 1e-30;
          d = 1 / d;
          const del = d * c;
          h *= del;
          if (Math.abs(del - 1) < 1e-10) break;
        }
        return 1 - Math.exp(-x + a * Math.log(x) - logGamma(a)) * h;
      }
    }

    function chiSquareQuantile(p, df) {
      if (p <= 0) return 0;
      if (p >= 1) return Infinity;
      let lo = 0, hi = df * 5 + 50;
      for (let i = 0; i < 100; i++) {
        const mid = (lo + hi) / 2;
        if (chiSquareCDF(mid, df) < p) lo = mid;
        else hi = mid;
      }
      return (lo + hi) / 2;
    }

    // ============================================================
    // TAU² ESTIMATORS
    // ============================================================

    function calculateTau2DL(effects, ses) {
      const k = effects.length;
      if (k < 2) return 0;
      const variances = ses.map(se => se * se);
      const weights = variances.map(v => 1 / v);
      const totalWeight = weights.reduce((a, b) => a + b, 0);
      const meanEffect = effects.reduce((sum, e, i) => sum + e * weights[i], 0) / totalWeight;
      const q = effects.reduce((sum, e, i) => sum + weights[i] * (e - meanEffect) ** 2, 0);
      const c = totalWeight - weights.reduce((sum, w) => sum + w * w, 0) / totalWeight;
      return c > 0 ? Math.max(0, (q - (k - 1)) / c) : 0;
    }

    function calculateTau2REML(effects, ses, maxIter = 100, tol = 1e-6) {
      const k = effects.length;
      if (k < 2) return 0;
      const variances = ses.map(se => se * se);
      let tau2 = calculateTau2DL(effects, ses);
      for (let iter = 0; iter < maxIter; iter++) {
        const w = variances.map(v => 1 / (v + tau2));
        const sumW = w.reduce((a, b) => a + b, 0);
        const sumW2 = w.reduce((sum, wi) => sum + wi * wi, 0);
        const mu = effects.reduce((sum, e, i) => sum + e * w[i], 0) / sumW;
        const score = -0.5 * sumW + 0.5 * sumW2 / sumW + 0.5 * effects.reduce((sum, e, i) => sum + w[i] * w[i] * (e - mu) ** 2, 0);
        const info = 0.5 * (sumW2 - w.reduce((sum, wi) => sum + wi * wi * wi, 0) * 2 / sumW + sumW2 * sumW2 / (sumW * sumW));
        const delta = info > 0 ? score / info : 0;
        const newTau2 = Math.max(0, tau2 + delta);
        if (Math.abs(newTau2 - tau2) < tol) return newTau2;
        tau2 = newTau2;
      }
      return tau2;
    }

    function calculateTau2PM(effects, ses) {
      const n = effects.length;
      const variances = ses.map(se => se * se);
      let tau2 = 0.1;
      for (let iter = 0; iter < 100; iter++) {
        const weights = variances.map(v => 1 / (v + tau2));
        const sumW = weights.reduce((a, b) => a + b, 0);
        const meanEffect = effects.reduce((sum, e, i) => sum + e * weights[i], 0) / sumW;
        const Q = effects.reduce((sum, e, i) => sum + weights[i] * (e - meanEffect) ** 2, 0);
        if (Math.abs(Q - (n - 1)) < 0.0001) break;
        const dQ = -effects.reduce((sum, e, i) => sum + weights[i] * weights[i] * (e - meanEffect) ** 2, 0);
        tau2 = Math.max(0, tau2 - (Q - (n - 1)) / dQ);
      }
      return tau2;
    }

    function calculateTau2SJ(effects, ses) {
      const n = effects.length;
      const variances = ses.map(se => se * se);
      const meanEffect = effects.reduce((a, b) => a + b, 0) / n;
      let tau2 = effects.reduce((sum, e) => sum + (e - meanEffect) ** 2, 0) / (n - 1);
      const weights = variances.map(v => 1 / (v + tau2));
      const sumW = weights.reduce((a, b) => a + b, 0);
      const pooled = effects.reduce((sum, e, i) => sum + e * weights[i], 0) / sumW;
      tau2 = effects.reduce((sum, e, i) => sum + (e - pooled) ** 2 / (variances[i] + tau2), 0) / (n - 1);
      return Math.max(0, tau2);
    }

    function calculateTau2HE(effects, ses) {
      const n = effects.length;
      const variances = ses.map(se => se * se);
      const meanEffect = effects.reduce((a, b) => a + b, 0) / n;
      const S2 = effects.reduce((sum, e) => sum + (e - meanEffect) ** 2, 0) / (n - 1);
      const avgVar = variances.reduce((a, b) => a + b, 0) / n;
      return Math.max(0, S2 - avgVar);
    }

    function calculateTau2EB(effects, ses) {
      const n = effects.length;
      const variances = ses.map(se => se * se);
      let tau2 = calculateTau2DL(effects, ses);
      for (let iter = 0; iter < 20; iter++) {
        const weights = variances.map(v => 1 / (v + tau2));
        const sumW = weights.reduce((a, b) => a + b, 0);
        const mean = effects.reduce((sum, e, i) => sum + e * weights[i], 0) / sumW;
        const Q = effects.reduce((sum, e, i) => sum + weights[i] * (e - mean) ** 2, 0);
        const C = sumW - weights.reduce((sum, w) => sum + w * w, 0) / sumW;
        const newTau2 = Math.max(0, (Q - (n - 1)) / C);
        if (Math.abs(newTau2 - tau2) < 1e-8) break;
        tau2 = newTau2;
      }
      return tau2;
    }

    function calculateTau2ML(effects, ses, maxIter = 100, tol = 1e-6) {
      const k = effects.length;
      if (k < 2) return 0;
      const variances = ses.map(se => se * se);
      let tau2 = calculateTau2DL(effects, ses);
      for (let iter = 0; iter < maxIter; iter++) {
        const w = variances.map(v => 1 / (v + tau2));
        const sumW = w.reduce((a, b) => a + b, 0);
        const mu = effects.reduce((sum, e, i) => sum + e * w[i], 0) / sumW;
        const score = 0.5 * effects.reduce((sum, e, i) => sum + w[i] * w[i] * (e - mu) ** 2, 0) -
                      0.5 * w.reduce((sum, wi) => sum + wi, 0);
        const sumW2 = w.reduce((sum, wi) => sum + wi * wi, 0);
        const info = 0.5 * sumW2;
        const delta = info > 0 ? score / info : 0;
        const newTau2 = Math.max(0, tau2 + delta);
        if (Math.abs(newTau2 - tau2) < tol) return newTau2;
        tau2 = newTau2;
      }
      return tau2;
    }

    function calculateTau2HS(effects, ses) {
      const k = effects.length;
      if (k < 2) return 0;
      const variances = ses.map(se => se * se);
      const meanEffect = effects.reduce((a, b) => a + b, 0) / k;
      const totalVariance = effects.reduce((sum, e) => sum + (e - meanEffect) ** 2, 0) / k;
      const avgSamplingVar = variances.reduce((a, b) => a + b, 0) / k;
      return Math.max(0, totalVariance - avgSamplingVar);
    }

    // ============================================================
    // MAIN META-ANALYSIS
    // ============================================================

    function calculateMetaAnalysis(studies, options = {}) {
      const settings = { tau2Estimator: 'DL', useHKSJ: true, confidenceLevel: 0.95, ...options };
      const k = studies.length;
      if (k === 0) return { error: 'No studies provided' };

      const isRatio = studies[0].isRatioMeasure !== false;
      const transformedEffects = studies.map(s => isRatio ? Math.log(s.effect) : s.effect);
      const ses = studies.map(s => {
        if (isRatio) return (Math.log(s.ciHi) - Math.log(s.ciLo)) / Z_95_CI_DIVISOR;
        return (s.ciHi - s.ciLo) / Z_95_CI_DIVISOR;
      });

      const fixedWeights = ses.map(se => 1 / (se * se));
      const totalFixedWeight = fixedWeights.reduce((a, b) => a + b, 0);
      const fixedEffect = transformedEffects.reduce((sum, e, i) => sum + e * fixedWeights[i], 0) / totalFixedWeight;
      const q = transformedEffects.reduce((sum, e, i) => sum + fixedWeights[i] * Math.pow(e - fixedEffect, 2), 0);
      const df = k - 1;
      const qPValue = df > 0 ? 1 - chiSquareCDF(q, df) : 1;
      const i2 = q > df ? Math.max(0, ((q - df) / q) * 100) : 0;
      const h2 = df > 0 ? q / df : 1;

      let tau2, tau2Method;
      const estimator = settings.tau2Estimator || 'DL'; التبديل (المقدر) {الحالة'REML': tau2 = calculateTau2REML(transformedEffects, ses); tau2Method = 'REML'; break;
        case 'PM': tau2 = calculateTau2PM(transformedEffects, ses); tau2Method = 'PM'; break;
        case 'SJ': tau2 = calculateTau2SJ(transformedEffects, ses); tau2Method = 'SJ'; break;
        case 'HE': tau2 = calculateTau2HE(transformedEffects, ses); tau2Method = 'HE'; break;
        case 'EB': tau2 = calculateTau2EB(transformedEffects, ses); tau2Method = 'EB'; break;
        case 'ML': tau2 = calculateTau2ML(transformedEffects, ses); tau2Method = 'ML'; break;
        case 'HS': tau2 = calculateTau2HS(transformedEffects, ses); tau2Method = 'HS'; استراحة؛ الافتراضي: tau2 = CalculateTau2DL(transformedEffects, ses); طريقة tau2 ='DL';
      }

      const randomWeights = ses.map(se => 1 / (se * se + tau2));
      const totalRandomWeight = randomWeights.reduce((a, b) => a + b, 0);
      const normalizedWeights = randomWeights.map(w => w / totalRandomWeight);
      const randomEffect = transformedEffects.reduce((sum, e, i) => sum + e * randomWeights[i], 0) / totalRandomWeight;
      let randomSE = Math.sqrt(1 / totalRandomWeight);

      let useHKSJ = settings.useHKSJ && k >= 2;
      let hksjAdjustment = null;
      if (useHKSJ) {
        const qStar = transformedEffects.reduce((sum, e, i) => sum + randomWeights[i] * Math.pow(e - randomEffect, 2), 0);
        const hksjMultiplier = df > 0 ? qStar / df : 1;
        hksjAdjustment = { multiplier: hksjMultiplier, adjustedSE: randomSE * Math.sqrt(Math.max(1, hksjMultiplier)) };
      }

      let pooledCiLo, pooledCiHi, pValue, testMethod;
      if (useHKSJ && hksjAdjustment) {
        const tCrit = tQuantile(1 - (1 - settings.confidenceLevel) / 2, df);
        const effectSE = hksjAdjustment.adjustedSE;
        pooledCiLo = isRatio ? Math.exp(randomEffect - tCrit * effectSE) : randomEffect - tCrit * effectSE;
        pooledCiHi = isRatio ? Math.exp(randomEffect + tCrit * effectSE) : randomEffect + tCrit * effectSE;
        const tStat = randomEffect / effectSE;
        pValue = 2 * (1 - tCDF(Math.abs(tStat), df));
        testMethod = 'HKSJ (t-distribution)';
      } else {
        const zCrit = normalQuantile(1 - (1 - settings.confidenceLevel) / 2);
        pooledCiLo = isRatio ? Math.exp(randomEffect - zCrit * randomSE) : randomEffect - zCrit * randomSE;
        pooledCiHi = isRatio ? Math.exp(randomEffect + zCrit * randomSE) : randomEffect + zCrit * randomSE;
        const z = randomEffect / randomSE;
        pValue = 2 * (1 - normalCDF(Math.abs(z)));
        testMethod = 'Wald (z-distribution)';
      }

      const pooledEffect = isRatio ? Math.exp(randomEffect) : randomEffect;

      const predictionInterval = tau2 > 0 && k >= 3 ? {
        lo: isRatio ? Math.exp(randomEffect - tQuantile(0.975, k - 2) * Math.sqrt(randomSE * randomSE + tau2)) : randomEffect - tQuantile(0.975, k - 2) * Math.sqrt(randomSE * randomSE + tau2),
        hi: isRatio ? Math.exp(randomEffect + tQuantile(0.975, k - 2) * Math.sqrt(randomSE * randomSE + tau2)) : randomEffect + tQuantile(0.975, k - 2) * Math.sqrt(randomSE * randomSE + tau2)
      } : null;

      return {
        pooledEffect, pooledCiLo, pooledCiHi, pValue,
        i2, h2, q, qPValue, tau2, tau2Method,
        k, weights: normalizedWeights, isRatio,
        testMethod, hksjAdjustment, predictionInterval,
        transformedEffects, ses, confidenceLevel: settings.confidenceLevel,
        fixedEffect: isRatio ? Math.exp(fixedEffect) : fixedEffect,
        fixedSE: Math.sqrt(1 / totalFixedWeight)
      };
    }

    // ============================================================
    // FOREST PLOT
    // ============================================================

    function generateForestPlotHTML(studies, meta) {
      const allEffects = [...studies.map(s => s.effect), meta.pooledEffect];
      const allLo = [...studies.map(s => s.ciLo), meta.pooledCiLo];
      const allHi = [...studies.map(s => s.ciHi), meta.pooledCiHi];

      const minEffect = Math.min(...allLo, 0.5);
      const maxEffect = Math.max(...allHi, 2.0);
      const range = maxEffect - minEffect;

      const scale = (val) => ((val - minEffect) / range) * 350 + 50;
      const height = (studies.length + 2) * 28 + 40;

      return `
        <svg viewBox="0 0 550 ${height}" style="width: 100%; height: ${height}px; font-family: 'Source Sans Pro', sans-serif;">
          <line x1="${scale(1)}" y1="15" x2="${scale(1)}" y2="${height - 25}" stroke="#ddd" stroke-width="1.5" stroke-dasharray="4" />
          <line x1="50" y1="${height - 25}" x2="400" y2="${height - 25}" stroke="#333" />
          <text x="${scale(0.5)}" y="${height - 8}" font-size="9" text-anchor="middle" fill="#666">0.5</text>
          <text x="${scale(1)}" y="${height - 8}" font-size="9" text-anchor="middle" fill="#666">1.0</text>
          <text x="${scale(1.5)}" y="${height - 8}" font-size="9" text-anchor="middle" fill="#666">1.5</text>
          <text x="${scale(2)}" y="${height - 8}" font-size="9" text-anchor="middle" fill="#666">2.0</text>
          ${studies.map((s, i) => {
            const y = 25 + i * 28;
            const size = Math.max(4, Math.sqrt(meta.weights[i]) * 12);
            return `
              <text x="5" y="${y + 4}" font-size="9" fill="#333">${_escHtml(s.label || 'Study ' + (i+1))}</text>
              <line x1="${scale(s.ciLo)}" y1="${y}" x2="${scale(s.ciHi)}" y2="${y}" stroke="#1E2761" stroke-width="1.5" />
              <rect x="${scale(s.effect) - size/2}" y="${y - size/2}" width="${size}" height="${size}" fill="#1E2761" />
              <text x="420" y="${y + 4}" font-size="8" fill="#333">${s.effect.toFixed(2)} [${s.ciLo.toFixed(2)}, ${s.ciHi.toFixed(2)}]</text>
            `;
          }).join('')}
          <polygon points="
            ${scale(meta.pooledEffect)},${25 + studies.length * 28 - 7}
            ${scale(meta.pooledCiLo)},${25 + studies.length * 28}
            ${scale(meta.pooledEffect)},${25 + studies.length * 28 + 7}
            ${scale(meta.pooledCiHi)},${25 + studies.length * 28}
          " fill="#D4AF37" />
          <text x="5" y="${25 + studies.length * 28 + 4}" font-size="9" font-weight="bold" fill="#333">Pooled</text>
          <text x="420" y="${25 + studies.length * 28 + 4}" font-size="8" font-weight="bold" fill="#333">${meta.pooledEffect.toFixed(2)} [${meta.pooledCiLo.toFixed(2)}, ${meta.pooledCiHi.toFixed(2)}]</text>
          <text x="${scale(0.7)}" y="${height - 2}" font-size="8" fill="#22c55e">Favors Treatment</text>
          <text x="${scale(1.3)}" y="${height - 2}" font-size="8" fill="#C53030">Favors Control</text>
        </svg>
      `;
    }

    // ============================================================
    // MODULE NAVIGATION
    // ============================================================

    const modules = [
      { id: 0, title: 'The Opening', subtitle: 'Why meta-analysis exists'، الشرائح: 12 }، {المعرف: 1، العنوان:'The Question', subtitle: 'CAST: PICO framework'، الشرائح: 20 }، {المعرف: 2، العنوان:'The Protocol', subtitle: 'HRT: Pre-specification'، الشرائح: 14 }، { المعرف: 3، العنوان:'The Search', subtitle: 'Rosiglitazone: Grey literature'، الشرائح: 17 }، {المعرف: 4، العنوان:'The Screening', subtitle: 'Vioxx: PRISMA'، الشرائح: 18 }، { المعرف: 5، العنوان:'The Extraction', subtitle: 'DECREASE: Provenance'، الشرائح: 18 }، { المعرف: 6، العنوان:'The Bias', subtitle: 'Aprotinin: RoB 2.0 + ROBINS-I'، الشرائح: 13 }، { المعرف: 7، العنوان:'The Synthesis', subtitle: 'Magnesium: Forest plots'، الشرائح: 19 }، { المعرف: 8، العنوان:'The Heterogeneity', subtitle: 'ACCORD: I², ICEMAN & Meta-regression'، الشرائح: 19 }، { المعرف: 9، العنوان:'The Hidden Studies', subtitle: 'Reboxetine: Funnel plots'، الشرائح: 17 }، { المعرف: 10، العنوان:'The Certainty', subtitle: 'Surfactant: GRADE'، الشرائح: 18 }، { المعرف: 11، العنوان:'The Living Review', subtitle: 'COVID-19: TSA'، الشرائح: 16 }، { المعرف: 12، العنوان:'Advanced Methods', subtitle: 'NMA, DTA, Dose-response'، الشرائح: 16 }، { المعرف: 13، العنوان:'The Bayesian Turn', subtitle: 'STAMPEDE: Priors & posteriors'، الشرائح: 16 }، { المعرف: 14، العنوان:'The Network', subtitle: 'Cipriani 2018: NMA & SUCRA'، الشرائح: 16 }، { المعرف: 15، العنوان:'The Individual', subtitle: 'EBCTCG: IPD meta-analysis'، الشرائح: 14 }، { المعرف: 16، العنوان:'The Dose', subtitle: 'Alcohol J-curve: Dose-response'، الشرائح: 14 }، { المعرف: 17، العنوان:'The Fragility', subtitle: 'Oseltamivir: Robustness'، الشرائح: 14 }، { المعرف: 18، العنوان:'The Equity', subtitle: 'SPRINT: PROGRESS-Plus'، الشرائح: 14 }، { المعرف: 19، العنوان:'The Machine', subtitle: 'Cochrane COVID: AI screening'، الشرائح: 15 }، { المعرف: 20، العنوان:'The Qualitative', subtitle: 'Bohren 2015: Meta-ethnography'، الشرائح: 13 }، { المعرف: 21، العنوان:'The Multivariate', subtitle: 'Correlated outcomes: RVE'، الشرائح: 14 }، { المعرف: 22، العنوان:'The Proof', subtitle: 'Reinhart-Rogoff: Reproducibility'، الشرائح: 16 }، { المعرف: 23، العنوان:'Capstone', subtitle: 'Your First Meta-Sprint'، الشرائح: 14 }، { المعرف: 24، العنوان:'Final Exam', subtitle: 'Summative assessment', slides: 5 }
    ];

    let currentModule = 0;
    let currentSlide = 0;
    let currentTier = 'foundation'; // foundation | researcher | methodologist

    function setTier(tier) {
      currentTier = tier;
      document.body.classList.remove('tier-foundation', 'tier-researcher', 'tier-methodologist'); إذا (الطبقة !=='foundation') document.body.classList.add('tier-' + tier);
      document.querySelectorAll('.tier-btn').forEach(btn => {
        const isCurrent = btn.dataset.tier === tier;
        btn.classList.toggle('active'، الحالي)؛ btn.setAttribute('aria-checked', isCurrent); }); // إعادة حساب عدد الشرائح للوحدة الحالية (الشرائح المخفية في الطبقة لا تحتوي على't count)
      updateSlideNavForTier();
      try { localStorage.setItem('synthesis_course_tier', tier); } catch(e) {}
    }

    function updateSlideNavForTier() {
      // After tier change, if current slide is now hidden, jump to nearest visible slide
      const container = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      if (!container) return;
      const allSlides = container.querySelectorAll('.slide');
      const activeSlide = allSlides[currentSlide];
      if (activeSlide && getComputedStyle(activeSlide).display === 'none') {
        // Find previous visible slide
        for (let i = currentSlide - 1; i >= 0; i--) {
          if (getComputedStyle(allSlides[i]).display !== 'none') {
            goToSlide(i);
            return;
          }
        }
        goToSlide(0);
      }
      updateCounter();
    }

    function getVisibleSlideCount() {
      const container = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      if (!container) return 0;
      let count = 0;
      container.querySelectorAll('.slide').forEach(s => {
        if (getComputedStyle(s).display !== 'none') count++;
      });
      return count;
    }

    function initModuleList() {
      const list = document.getElementById('moduleList');
      list.innerHTML = modules.map(m => `
        <div class="عنصر الوحدة ${m.id === currentModule ? 'active' : ''}" data-module="${m.id}" onclick="goToModule(${m.id})">
          <div class="module-number">${m.id}</div>
          <div class="module-info">
            <div class="module-title">${m.title}</div>
            <div class="module-subtitle">${m.subtitle}</div>
          </div>
        </div>
      `).join('');
    }

    function goToModule(moduleId) {
      // Hide current module
      document.querySelectorAll('.module-slides').forEach(m => m.classList.remove('active'));
      document.querySelectorAll('.module-item').forEach(m => m.classList.remove('active'));

      // Show new module
      currentModule = moduleId;
      currentSlide = 0;
      const moduleEl = document.querySelector(`.module-slides[data-module="${moduleId}"]`);
      if (moduleEl) {
        moduleEl.classList.add('active');
        updateSlideDisplay(moduleEl);
      }
      document.querySelector(`.module-item[data-module="${moduleId}"]`).classList.add('active');

      // Update header
      document.getElementById('currentModuleNum').textContent = moduleId;
      document.getElementById('currentModuleName').textContent = modules[moduleId].title;

      // Update live story data panel
      updateStoryPanel(moduleId);

      // Initialize advanced interactive tools (modules 13-22)
      setTimeout(initAdvancedTools, 100);

      // Show/hide story indicator button
      const storyBtn = document.getElementById('storyIndicatorBtn');
      if (storyData[moduleId]) {
        storyBtn.classList.add('visible');
      } else {
        storyBtn.classList.remove('visible');
      }

      updateProgress();
    }

    function updateSlideDisplay(moduleEl) {
      const slides = moduleEl.querySelectorAll('.slide');
      slides.forEach((s, i) => s.classList.toggle('active', i === currentSlide));

      // Build visible-only progress dots (skip tier-hidden slides)
      const progress = document.getElementById('progress');
      let dots = '';
      let visibleIndex = 0;
      let currentVisibleIndex = 0;
      let visibleTotal = 0;
      for (let i = 0; i < slides.length; i++) {
        if (getComputedStyle(slides[i]).display === 'none') continue;
        if (i === currentSlide) currentVisibleIndex = visibleIndex;
        dots += `<div class="progress-dot ${i ===currentSlide ? 'active' : ''}" onclick="goToSlide(${i})" role="button" tabindex="0" aria-label="اذهب إلى الشريحة ${visibleIndex + 1}"></div>`;
        visibleIndex++;
        visibleTotal++;
      }
      progress.innerHTML = dots;

      // Update counter with visible-only count
      document.getElementById('counter').textContent = `${currentVisibleIndex + 1} / ${visibleTotal}`;

      // Update buttons — check if there's a visible next/prev
      const hasVisiblePrev = (() => { for (let i = currentSlide - 1; i >= 0; i--) { if (getComputedStyle(slides[i]).display !== 'none') return true; } return false; })();
      const hasVisibleNext = (() => { for (let i = currentSlide + 1; i < slides.length; i++) { if (getComputedStyle(slides[i]).display !== 'none') return true; } return false; })();
      document.getElementById('prevBtn').disabled = !hasVisiblePrev;
      document.getElementById('nextBtn').disabled = !hasVisibleNext;

      // Announce slide change to screen readers
      const announcer = document.getElementById('slideAnnouncer');
      if (announcer) {
        announcer.textContent = `Slide ${currentVisibleIndex + 1} of ${visibleTotal}`;
      }
    }

    function updateCounter() {
      const moduleEl = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      if (moduleEl) updateSlideDisplay(moduleEl);
    }

    function goToSlide(index) {
      const moduleEl = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      const slides = moduleEl.querySelectorAll('.slide');
      if (index >= 0 && index < slides.length) {
        currentSlide = index;
        updateSlideDisplay(moduleEl);
      }
    }

    function nextSlide() {
      const moduleEl = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      const slides = moduleEl.querySelectorAll('.slide');
      // Skip tier-hidden slides
      for (let i = currentSlide + 1; i < slides.length; i++) {
        if (getComputedStyle(slides[i]).display !== 'none') {
          currentSlide = i;
          updateSlideDisplay(moduleEl);
          return;
        }
      }
    }

    function prevSlide() {
      const moduleEl = document.querySelector(`.module-slides[data-module="${currentModule}"]`);
      const slides = moduleEl.querySelectorAll('.slide');
      for (let i = currentSlide - 1; i >= 0; i--) {
        if (getComputedStyle(slides[i]).display !== 'none') {
          currentSlide = i;
          updateSlideDisplay(moduleEl);
          return;
        }
      }
    }

    function nextModule() {
      if (currentModule < modules.length - 1) {
        goToModule(currentModule + 1);
      }
    }

    function updateProgress() {
      const percent = Math.round((currentModule / (modules.length - 1)) * 100);
      document.getElementById('progressPercent').textContent = percent + '%';
    }

    // ============================================================
    // TOOLS PANEL
    // ============================================================

    function toggleToolsPanel() {
      const panel = document.getElementById('toolsPanel');
      const contentBody = document.querySelector('.content-body');
      panel.classList.toggle('visible');
      contentBody.classList.toggle('tools-open');
    }

    function toggleSection(header) {
      const body = header.nextElementSibling;
      body.style.display = body.style.display === 'none' ? 'block' : 'none';
      header.querySelector('span').textContent = body.style.display === 'none' ? '▼' : '▲';
    }

    // ============================================================
    // EFFECT SIZE CALCULATOR
    // ============================================================

    function calculateEffectSize() {
      const type = document.getElementById('effectType').value;
      const eventsTx = parseFloat(document.getElementById('eventsTx').value);
      const nTx = parseFloat(document.getElementById('nTx').value);
      const eventsCtrl = parseFloat(document.getElementById('eventsCtrl').value);
      const nCtrl = parseFloat(document.getElementById('nCtrl').value); if (isNaN(eventsTx) || isNaN(nTx) || isNaN(eventsCtrl) || isNaN(nCtrl)) { تنبيه('Please enter all values');
        return;
      }

      let effect, se, ciLo, ciHi;
      const cc = 0.5; // continuity correction

      if (type === 'OR') {
        const a = eventsTx + cc, b = nTx - eventsTx + cc;
        const c = eventsCtrl + cc, d = nCtrl - eventsCtrl + cc;
        const or = (a * d) / (b * c);
        se = Math.sqrt(1/a + 1/b + 1/c + 1/d);
        effect = or;
        ciLo = Math.exp(Math.log(or) - 1.96 * se);
        ciHi = Math.exp(Math.log(or) + 1.96 * se);
      } else if (type === 'RR') {
        const p1 = (eventsTx + cc) / (nTx + 2*cc);
        const p2 = (eventsCtrl + cc) / (nCtrl + 2*cc);
        const rr = p1 / p2;
        se = Math.sqrt((1 - p1) / (eventsTx + cc) + (1 - p2) / (eventsCtrl + cc));
        effect = rr;
        ciLo = Math.exp(Math.log(rr) - 1.96 * se);
        ciHi = Math.exp(Math.log(rr) + 1.96 * se);
      } else if (type === 'RD') {
        const p1 = eventsTx / nTx, p2 = eventsCtrl / nCtrl;
        effect = p1 - p2;
        se = Math.sqrt(p1 * (1 - p1) / nTx + p2 * (1 - p2) / nCtrl);
        ciLo = effect - 1.96 * se;
        ciHi = effect + 1.96 * se;
      }

      const resultsDiv = document.getElementById('effectResults');
      resultsDiv.style.display = 'block'; resultsDiv.innerHTML = ` <div class="result-row"><span class="label">التأثير (${type}):</span><span class="value">${effect.toFixed(3)}</span></div> <div class="result-row"><span class="label">فاصل ثقة 95%:</span><span class="value">[${ciLo.toFixed(3)}, ${ciHi.toFixed(3)}]</span></div> <div class="result-row"><span class="label">SE${type ==='RD' ? '' : ' (log)'}:</span><span class="value">${se.toFixed(4)}</span></div>
      `;
    }

    // ============================================================
    // META-ANALYSIS CALCULATOR UI
    // ============================================================

    function addStudyRow() {
      const tbody = document.getElementById('studyTableBody');
      const rowCount = tbody.rows.length + 1;
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="text" value="Study ${rowCount}"></td>
        <td><input type="number" step="0.01" value="1.00"></td>
        <td><input type="number" step="0.01" value="0.80"></td>
        <td><input type="number" step="0.01" value="1.25"></td>
        <td><button class="btn-small" onclick="removeStudyRow(this)">×</button></td>
      `;
      tbody.appendChild(row);
    }

    function removeStudyRow(btn) {
      const row = btn.closest('tr');
      row.remove();
    }

    function runMetaAnalysis() {
      const rows = document.getElementById('studyTableBody').rows;
      const studies = [];

      for (const row of rows) {
        const inputs = row.querySelectorAll('input');
        const label = inputs[0].value;
        const effect = parseFloat(inputs[1].value);
        const ciLo = parseFloat(inputs[2].value);
        const ciHi = parseFloat(inputs[3].value);

        if (!isNaN(effect) && !isNaN(ciLo) && !isNaN(ciHi)) {
          studies.push({ label, effect, ciLo, ciHi, isRatioMeasure: true });
        }
      }

      if (studies.length < 2) {
        alert('Need at least 2 studies');
        return;
      }

      const tau2Method = document.getElementById('tau2Method').value;
      const useHKSJ = document.getElementById('useHKSJ').checked;

      const result = calculateMetaAnalysis(studies, { tau2Estimator: tau2Method, useHKSJ });

      // Save for publication bias tools
      lastMetaStudies = studies;
      lastMetaResult = result;

      if (result.error) {
        alert(result.error);
        return;
      }

      // Display results
      const resultsDiv = document.getElementById('maResults');
      resultsDiv.style.display = 'block'; resultsDiv.innerHTML = ` <div class="result-row"><span class="label">التأثير المجمع:</span><span class="value">${result.pooledEffect.toFixed(3)}</span></div> <div class="result-row"><span class="label">95% CI:</span><span class="value">[${result.pooledCiLo.toFixed(3)}, ${result.pooledCiHi.toFixed(3)}]</span></div> <div class="result-row"><span class="label">قيمة p:</span><span class="value">${result.pValue < 0.001 ?'< 0.001': result.pValue.toFixed(4)}</span></div> <div class="result-row"><span class="label">I²:</span><span class="value">${result.i2.toFixed(1)}%</span></div> <div class="result-row"><span class="label">τ² (${result.tau2Method}):</span><span class="value">${result.tau2.toFixed(4)}</span></div> <div class="result-row"><span class="label">س (قيمة p):</span><span class="value">${result.q.toFixed(2)} (${result.qPValue.toFixed(4)})</span></div> <div class="result-row"><span class="label">طريقة الاختبار:</span><span class="value">${result.testMethod}</span></div> ${result.predictionInterval ? `<div class="result-row"><span class="label">95% PI:</span><span class="value">[${result.predictionInterval.lo.toFixed(3)}, ${result.predictionInterval.hi.toFixed(3)}]</span></div>` :''}
      `;

      // Generate forest plot
      const plotContainer = document.getElementById('forestPlotContainer');
      plotContainer.style.display = 'block';
      plotContainer.innerHTML = generateForestPlotHTML(studies, result);
    }

    // ============================================================
    // PICO BUILDER
    // ============================================================

    function _escHtml(s) {
      const d = document.createElement('div');
      d.textContent = s;
      return d.innerHTML;
    }

    function generatePICO() {
      const p = _escHtml(document.getElementById('picoP').value);
      const i = _escHtml(document.getElementById('picoI').value);
      const c = _escHtml(document.getElementById('picoC').value);
      const o = _escHtml(document.getElementById('picoO').value); if (!p || !i || !o) { تنبيه('Please fill Population, Intervention, and Outcome');
        return;
      }

      const question = `In ${p}, does ${i} compared to ${c || 'standard care'} improve ${o}?`;

      const output = document.getElementById('picoOutput'); الإخراج.style.display ='block';
      output.innerHTML = `
        <strong>Research Question:</strong><br>
        <em>${question}</em>
      `;
    }

    // ============================================================
    // KEYBOARD NAVIGATION — see enhanced handler below (near toggleKeyboardHelp)
    // ============================================================

    // ============================================================
    // PUBLICATION BIAS
    // ============================================================

    let lastMetaStudies = null;
    let lastMetaResult = null;

    // runMetaAnalysis now saves lastMetaStudies/lastMetaResult directly (merged from override)

    function calculateEggersTest(effects, ses) {
      const n = effects.length;
      if (n < 3) return { intercept: NaN, pValue: NaN, significant: false };
      const precision = ses.map(se => 1 / se);
      const standardizedEffects = effects.map((e, i) => e / ses[i]);
      const meanX = precision.reduce((a, b) => a + b, 0) / n;
      const meanY = standardizedEffects.reduce((a, b) => a + b, 0) / n;
      let ssXY = 0, ssXX = 0;
      for (let i = 0; i < n; i++) {
        ssXY += (precision[i] - meanX) * (standardizedEffects[i] - meanY);
        ssXX += (precision[i] - meanX) ** 2;
      }
      const slope = ssXX > 0 ? ssXY / ssXX : 0;
      const intercept = meanY - slope * meanX;
      let ssResid = 0;
      for (let i = 0; i < n; i++) {
        const predicted = intercept + slope * precision[i];
        ssResid += (standardizedEffects[i] - predicted) ** 2;
      }
      const residSE = Math.sqrt(ssResid / (n - 2));
      const interceptSE = residSE * Math.sqrt(1/n + meanX * meanX / ssXX);
      const tStat = intercept / interceptSE;
      const pValue = 2 * (1 - tCDF(Math.abs(tStat), n - 2));
      return { intercept, slope, tStat, pValue, significant: pValue < 0.1 };
    }

    function calculateBeggsTest(effects, ses) {
      const n = effects.length;
      if (n < 3) return { tau: NaN, pValue: NaN };
      const indices = effects.map((_, i) => i);
      const variances = ses.map(se => se * se);
      indices.sort((a, b) => variances[a] - variances[b]);
      const sortedEffects = indices.map(i => effects[i]);
      let concordant = 0, discordant = 0;
      for (let i = 0; i < n - 1; i++) {
        for (let j = i + 1; j < n; j++) {
          if (sortedEffects[j] > sortedEffects[i]) concordant++;
          else if (sortedEffects[j] < sortedEffects[i]) discordant++;
        }
      }
      const tau = (concordant - discordant) / (n * (n - 1) / 2);
      const se = Math.sqrt((2 * (2 * n + 5)) / (9 * n * (n - 1)));
      const z = tau / se;
      const pValue = 2 * (1 - normalCDF(Math.abs(z)));
      return { tau, z, pValue, significant: pValue < 0.1 };
    }

    function generateFunnelPlotHTML(effects, ses, pooledEffect) {
      const minEffect = Math.min(...effects) - 0.5;
      const maxEffect = Math.max(...effects) + 0.5;
      const maxSE = Math.max(...ses);
      const range = maxEffect - minEffect;

      const scaleX = (val) => ((val - minEffect) / range) * 300 + 25;
      const scaleY = (se) => (se / maxSE) * 180 + 20;

      const pooledX = scaleX(pooledEffect);

      return `
        <svg viewBox="0 0 350 220" style="width: 100%; height: 220px; font-family: 'Source Sans Pro', sans-serif;">
          <!-- Funnel shape -->
          <polygon points="${pooledX},20 ${scaleX(pooledEffect - 1.96 * maxSE)},200 ${scaleX(pooledEffect + 1.96 * maxSE)},200"
                   fill="rgba(30,39,97,0.1)" stroke="none"/>

          <!-- Axes -->
          <line x1="25" y1="200" x2="325" y2="200" stroke="#333" />
          <line x1="25" y1="20" x2="25" y2="200" stroke="#333" />

          <!-- Pooled effect line -->
          <line x1="${pooledX}" y1="20" x2="${pooledX}" y2="200" stroke="#D4AF37" stroke-width="2" stroke-dasharray="4" />

          <!-- Points -->
          ${effects.map((e, i) => `
            <circle cx="${scaleX(e)}" cy="${scaleY(ses[i])}" r="5" fill="#1E2761" stroke="white" stroke-width="1"/>
          `).join('')}

          <!-- Labels -->
          <text x="175" y="218" font-size="10" text-anchor="middle" fill="#666">Effect Size (log scale)</text>
          <text x="12" y="110" font-size="10" text-anchor="middle" fill="#666" transform="rotate(-90, 12, 110)">Standard Error</text>
          <text x="${pooledX}" y="15" font-size="8" text-anchor="middle" fill="#D4AF37">Pooled</text>
        </svg>
      `;
    }

    function runPublicationBias() {
      if (!lastMetaResult || !lastMetaStudies || lastMetaStudies.length < 3) {
        alert('Run meta-analysis first with at least 3 studies');
        return;
      }

      const effects = lastMetaResult.transformedEffects;
      const ses = lastMetaResult.ses;

      const egger = calculateEggersTest(effects, ses);
      const begg = calculateBeggsTest(effects, ses);

      document.getElementById('pubBiasResults').style.display = 'block';
      document.getElementById('eggerResults').innerHTML = ` <div class="result-row"><span class="label">قيمة Egger's intercept:</span><span class="value">${egger.intercept.toFixed(3)}</span></div>
        <div class="result-row"><span class="label">Egger's p-value:</span><span class="value ${egger.significant ? 'red' : ''}">${egger.pValue.toFixed(4)} ${egger.significant؟'(Significant)' : ''</span></div> <div class="result-row"><span class="label">قيمة Begg's tau:</span><span class="value">${begg.tau.toFixed(3)}</span></div>
        <div class="result-row"><span class="label">Begg's:</span><span class="value ${begg.significant ?'red' : ''}">${begg.pValue.toFixed(4)} ${begg.significant ? '(Significant)' : ''</span></div> <div class="result-row"><span class="label">التفسير:</span><span class="value">${egger.significant || كبير.'Possible small-study effects (publication bias is one explanation)' : 'No strong statistical evidence of asymmetry'}</span></div>
      `;

      const pooledLog = Math.log(lastMetaResult.pooledEffect);
      document.getElementById('funnelPlotContainer').innerHTML = generateFunnelPlotHTML(effects, ses, pooledLog);
    }

    // ============================================================
    // RISK OF BIAS 2.0
    // ============================================================

    function updateRoBOverall() {
      const domains = ['robD1', 'robD2', 'robD3', 'robD4', 'robD5'];
      const values = domains.map(id => document.getElementById(id).value);

      if (values.some(v => !v)) {
        document.getElementById('robOverall').innerHTML = '<span style="اللون: var(--light-text);">Complete all domains</span>';
        document.getElementById('robTrafficLight').innerHTML = '';
        return;
      }

      let overall;
      if (values.includes('high')) {
        overall = 'high'; } وإلا إذا (values.includes('some')) {
        overall = 'some';
      } else {
        overall = 'low';
      }

      const colors = { low: '#22c55e'، بعض:'#f59e0b', high: '#C53030' };
      const labels = { low: 'Low Risk of Bias'، بعض:'Some Concerns', high: 'High Risk of Bias' };

      document.getElementById('robOverall').innerHTML = `
        <span style="color: ${colors[overall]};">${labels[overall]}</span>
      `;
      document.getElementById('robOverall').style.background = عموما ==='low' ? 'rgba(34,197,94,0.1)' :
                                                                overall === 'some' ? 'rgba(245,158,11,0.1)' : 'rgba(197,48,48,0.1)';

      // Traffic light
      document.getElementById('robTrafficLight').innerHTML = `
        <div style="display: flex; gap: 0.25rem; justify-content: center; margin-top: 0.5rem;">
          ${domains.map((id, i) => {
            const val = values[i];
            return `<div style="width: 20px; height: 20px; border-radius: 50%; background: ${colors[val]};" title="D${i+1}: ${val}"></div>`;
          }).join('')}
        </div>
      `;
    }

    // ============================================================
    // GRADE ASSESSMENT
    // ============================================================

    function calculateGRADE() {
      const start = parseInt(document.getElementById('gradeStart').value);
      const rob = parseInt(document.getElementById('gradeRoB').value);
      const inconsistency = parseInt(document.getElementById('gradeInconsistency').value);
      const indirectness = parseInt(document.getElementById('gradeIndirectness').value);
      const imprecision = parseInt(document.getElementById('gradeImprecision').value);
      const pubBias = parseInt(document.getElementById('gradePubBias').value);

      const total = start + rob + inconsistency + indirectness + imprecision + pubBias;
      const finalScore = Math.max(1, Math.min(4, total));

      const levels = {
        4: { label: 'HIGH', color: '#22c55e', symbol: '⊕⊕⊕⊕', desc: 'Very confident the true effect is close to the estimate' },
        3: { label: 'MODERATE', color: '#3b82f6', symbol: '⊕⊕⊕○', desc: 'Moderately confident; true effect likely close to estimate' },
        2: { label: 'LOW', color: '#f59e0b', symbol: '⊕⊕○○', desc: 'Limited confidence; true effect may be substantially different' },
        1: { label: 'VERY LOW', color: '#C53030', symbol: '⊕○○○', desc: 'Very little confidence in the effect estimate' }
      };

      const level = levels[finalScore];

      document.getElementById('gradeResult').innerHTML = `
        <div style="text-align: center; padding: 1rem; background: rgba(${finalScore === 4 ? '34,197,94' : finalScore === 3 ? '59,130,246' : finalScore === 2 ? '245,158,11' : '197,48,48'},0.1); border-radius: 8px;">
          <div style="font-size: 1.5rem; letter-spacing: 0.2rem; color: ${level.color};">${level.symbol}</div>
          <div style="font-size: 1.1rem; font-weight: 700; color: ${level.color}; margin: 0.5rem 0;">${level.label}</div>
          <div style="font-size: 0.75rem; color: var(--light-text);">${level.desc}</div>
        </div>
        <div style="margin-top: 0.75rem; font-size: 0.75rem; color: var(--light-text);">
          Starting: ${start === 4 ? 'High (RCTs)' : 'Low (Observational)'}<br>
          Downgrades: ${Math.abs(rob + inconsistency + indirectness + imprecision + pubBias)} levels
        </div>
      `;
    }

    // ============================================================
    // HETEROGENEITY INTERPRETATION
    // ============================================================

    function interpretI2() {
      const i2 = parseFloat(document.getElementById('i2Input').قيمة)؛ إذا (isNaN(i2) || i2 < 0 || i2 > 100) { تنبيه ('Enter a valid I² value between 0 and 100');
        return;
      }

      let interpretation, color, recommendation;

      if (i2 <= 25) {
        interpretation = 'Low heterogeneity';
        color = '#22c55e';
        recommendation = 'Fixed-effect model may be appropriate. Results are consistent across studies.'; } else if (i2 <= 50) { تفسير ='Moderate heterogeneity';
        color = '#3b82f6';
        recommendation = 'Consider random-effects model. Investigate potential sources of variation.'; } وإلا إذا (i2 <= 75) { تفسير ='Substantial heterogeneity';
        color = '#f59e0b';
        recommendation = 'Use random-effects model. Subgroup analysis or meta-regression recommended. Consider whether pooling is appropriate.';
      } else {
        interpretation = 'Considerable heterogeneity';
        color = '#C53030';
        recommendation = 'Pooling may be inappropriate. Focus on understanding sources of heterogeneity before synthesizing. Report prediction interval.';
      }

      document.getElementById('i2Interpretation').innerHTML = `
        <div style="padding: 0.75rem; background: rgba(${i2 <= 25 ? '34,197,94' : i2 <= 50 ? '59,130,246' : i2 <= 75 ? '245,158,11' : '197,48,48'},0.1); border-radius: 6px; border-right: 3px solid ${color};">
          <div style="font-weight: 700; color: ${color}; margin-bottom: 0.25rem;">I² = ${i2}%: ${interpretation}</div>
          <div style="font-size: 0.8rem; color: var(--text);">${recommendation}</div>
        </div>
      `;
    }

    // ============================================================
    // NNT/NNH CALCULATOR
    // ============================================================

    function calculateNNT() {
      const cer = parseFloat(document.getElementById('nntCER').value);
      const effectType = document.getElementById('nntEffectType').value;
      const effect = parseFloat(document.getElementById('nntEffect').value);
      const ciLo = parseFloat(document.getElementById('nntCILo').value);
      const ciHi = parseFloat(document.getElementById('nntCIHi').قيمة)؛ إذا (isNaN(cer) || isNaN(effect) || cer <= 0 || cer >= 1) { تنبيه('Enter valid baseline risk (0 < CER < 1) and effect size');
        return;
      }

      let arr, arrLo, arrHi; // Absolute Risk Reduction

      if (effectType === 'RD') { arr = -effect; // RD مطلق بالفعل arrLo = -ciHi; arrHi = -ciLo; } وإلا إذا (effectType ==='RR') {
        const eer = cer * effect;
        const eerLo = cer * ciLo;
        const eerHi = cer * ciHi;
        arr = cer - eer;
        arrLo = cer - eerHi;
        arrHi = cer - eerLo;
      } else { // OR
        const eer = (cer * effect) / (1 - cer + cer * effect);
        const eerLo = (cer * ciLo) / (1 - cer + cer * ciLo);
        const eerHi = (cer * ciHi) / (1 - cer + cer * ciHi);
        arr = cer - eer;
        arrLo = cer - eerHi;
        arrHi = cer - eerLo;
      }

      const nnt = arr !== 0 ? 1 / arr : Infinity;
      const nntLo = arrHi !== 0 ? 1 / arrHi : Infinity;
      const nntHi = arrLo !== 0 ? 1 / arrLo : Infinity;
      const ciCrossesNull = arrLo * arrHi < 0;

      const isBenefit = arr > 0;
      const label = isBenefit ? 'NNT (Benefit)' : 'NNH (Harm)';
      const color = isBenefit ? 'var(--green)' : 'var(--red)';

      let nntCiText;
      if (ciCrossesNull) {
        // Altman (1998) convention: NNTB X to ∞ to NNTH Y
        const nntB = arrHi > 0 ? Math.abs(1 / arrHi).toFixed(1) : Math.abs(1 / arrLo).toFixed(1);
        const nntH = arrLo < 0 ? Math.abs(1 / arrLo).toFixed(1) : Math.abs(1 / arrHi).toFixed(1);
        nntCiText = `NNTB ${nntB} to \u221E to NNTH ${nntH}`;
      } else {
        nntCiText = `[${Math.abs(nntLo).toFixed(1)}, ${Math.abs(nntHi).toFixed(1)}]`;
      }

      const resultsDiv = document.getElementById('nntResults');
      resultsDiv.style.display = 'block'; resultsDiv.innerHTML = ` <div class="result-row"><span class="label">المخاطر الأساسية (CER):</span><span class="value">${(cer * 100).toFixed(1)}%</span></div> <div class="result-row"><span class="label">التخفيض المطلق للمخاطر:</span><span class="value">${(arr * 100).toFixed(2)}%</span></div> <div class="result-row"><span class="label" style="color: ${color};font-weight: 700;">${label}:</span><span class="value" style="color: ${color};font-weight: 700;">${Math.abs(nnt).toFixed(1)}</span></div> <div class="result-row"><span class="label">95% CI:</span><span class="value">${nntCiText}</span></div> ${ciCrossesNull ?'<div style="margin-top: 0.5rem; padding: 0.4rem; background: rgba(234,179,8,0.15); border-radius: 4px; font-size: 0.7rem; color: var(--text);">CI crosses the null \u2014 effect may be beneficial or harmful</div>' : ''}
        <div style="margin-top: 0.75rem; padding: 0.5rem; background: rgba(${isBenefit ? '34,197,94' : '197,48,48'},0.1); border-radius: 4px; font-size: 0.75rem;">
          ${isBenefit
            ? `Treat <strong>${Math.ceil(Math.abs(nnt))}</strong> patients to prevent 1 event`
            : `Treat <strong>${Math.ceil(Math.abs(nnt))}</strong> patients before causing 1 harm`}
        </div>
      `;
    }

    // ============================================================
    // LEAVE-ONE-OUT SENSITIVITY ANALYSIS
    // ============================================================

    function runLeaveOneOut() {
      if (!lastMetaStudies || lastMetaStudies.length < 3) {
        alert('Run meta-analysis first with at least 3 studies');
        return;
      }

      const tau2Method = document.getElementById('tau2Method').value;
      const useHKSJ = document.getElementById('useHKSJ').checked;
      const results = [];

      // Run meta-analysis leaving out each study
      for (let i = 0; i < lastMetaStudies.length; i++) {
        const subset = lastMetaStudies.filter((_, idx) => idx !== i);
        const ma = calculateMetaAnalysis(subset, { tau2Estimator: tau2Method, useHKSJ });
        results.push({
          omitted: lastMetaStudies[i].label,
          effect: ma.pooledEffect,
          ciLo: ma.pooledCiLo,
          ciHi: ma.pooledCiHi,
          i2: ma.i2,
          pValue: ma.pValue
        });
      }

      // Find most influential study
      const originalEffect = lastMetaResult.pooledEffect;
      let maxChange = 0;
      let mostInfluential = '';
      results.forEach(r => {
        const change = (lastMetaResult.isRatio !== false && r.effect > 0 && originalEffect > 0)
          ? Math.abs(Math.log(r.effect) - Math.log(originalEffect))
          : Math.abs(r.effect - originalEffect);
        if (change > maxChange) {
          maxChange = change;
          mostInfluential = r.omitted;
        }
      });

      // Check if any exclusion changes significance
      const originalSig = lastMetaResult.pValue < 0.05;
      const sensitivityIssue = results.some(r => (r.pValue < 0.05) !== originalSig);

      document.getElementById('looResults').style.display = 'block';
      document.getElementById('looSummary'.innerHTML = ` <div class="result-row"><span class="label">التأثير المجمع الأصلي:</span><span class="value">${originalEffect.toFixed(3)}</span></div> <div class="result-row"><span class="label">الدراسة الأكثر تأثيرًا:</span><span class="value">${_escHtml(mostInfluential)</span></div> <div class="result-row"><span class="label">مخاوف تتعلق بالحساسية:</span><span class="value ${sensitivityIssue ?'red' : ''}">${sensitivityIssue ? 'Yes - significance changes' : 'No - results robust'}</span></div>
        <div style="margin-top: 0.5rem; font-size: 0.7rem; color: var(--light-text);">
          ${results.map(r => `Omit ${_escHtml(r.omitted)}: ${r.effect.toFixed(3)} [${r.ciLo.toFixed(3)}, ${r.ciHi.toFixed(3)}] I²=${r.i2.toFixed(0)}%`).join('<br>')}
        </div>
      `;

      // Generate LOO forest plot
      document.getElementById('looPlotContainer').innerHTML = generateLOOPlotHTML(results, lastMetaResult);
    }

    function generateLOOPlotHTML(looResults, originalMeta) {
      const allEffects = [...looResults.map(r => r.effect), originalMeta.pooledEffect];
      const allLo = [...looResults.map(r => r.ciLo), originalMeta.pooledCiLo];
      const allHi = [...looResults.map(r => r.ciHi), originalMeta.pooledCiHi];

      const minEffect = Math.min(...allLo, 0.5);
      const maxEffect = Math.max(...allHi, 2.0);
      const range = maxEffect - minEffect;

      const scale = (val) => ((val - minEffect) / range) * 280 + 80;
      const height = (looResults.length + 2) * 22 + 30;

      return `
        <svg viewBox="0 0 500 ${height}" style="width: 100%; height: ${height}px; font-family: 'Source Sans Pro', sans-serif;">
          <line x1="${scale(1)}" y1="10" x2="${scale(1)}" y2="${height - 20}" stroke="#ddd" stroke-width="1" stroke-dasharray="3" />
          <text x="40" y="15" font-size="8" fill="#666" font-weight="600">Omitting:</text>
          ${looResults.map((r, i) => {
            const y = 25 + i * 22;
            return `
              <text x="5" y="${y + 3}" font-size="8" fill="#333">${_escHtml(r.omitted)}</text>
              <line x1="${scale(r.ciLo)}" y1="${y}" x2="${scale(r.ciHi)}" y2="${y}" stroke="#1E2761" stroke-width="1" />
              <circle cx="${scale(r.effect)}" cy="${y}" r="4" fill="#1E2761" />
              <text x="380" y="${y + 3}" font-size="7" fill="#333">${r.effect.toFixed(2)} [${r.ciLo.toFixed(2)}, ${r.ciHi.toFixed(2)}]</text>
            `;
          }).join('')}
          <line x1="${scale(originalMeta.pooledCiLo)}" y1="${height - 25}" x2="${scale(originalMeta.pooledCiHi)}" y2="${height - 25}" stroke="#D4AF37" stroke-width="2" />
          <polygon points="${scale(originalMeta.pooledEffect)},${height - 30} ${scale(originalMeta.pooledEffect) - 5},${height - 25} ${scale(originalMeta.pooledEffect)},${height - 20} ${scale(originalMeta.pooledEffect) + 5},${height - 25}" fill="#D4AF37" />
          <text x="5" y="${height - 22}" font-size="8" font-weight="bold" fill="#D4AF37">All studies</text>
          <text x="380" y="${height - 22}" font-size="7" font-weight="bold" fill="#333">${originalMeta.pooledEffect.toFixed(2)} [${originalMeta.pooledCiLo.toFixed(2)}, ${originalMeta.pooledCiHi.toFixed(2)}]</text>
        </svg>
      `;
    }

    // ============================================================
    // TRIM-AND-FILL
    // ============================================================

    function runTrimAndFill() {
      if (!lastMetaResult || !lastMetaStudies || lastMetaStudies.length < 3) {
        alert('Run meta-analysis first with at least 3 studies');
        return;
      }

      const estimator = document.getElementById('trimFillEstimator').value;
      const side = document.getElementById('trimFillSide').value;

      const effects = [...lastMetaResult.transformedEffects];
      const ses = [...lastMetaResult.ses];
      const k = effects.length;

      // Get initial pooled estimate
      const weights = ses.map(se => 1 / (se * se));
      const sumW = weights.reduce((a, b) => a + b, 0);
      let theta = effects.reduce((sum, e, i) => sum + e * weights[i], 0) / sumW;

      // Calculate ranks of |yi - theta| for each study
      const deviations = effects.map((e, i) => ({
        idx: i,
        dev: e - theta,
        absDev: Math.abs(e - theta),
        se: ses[i]
      }));

      // Sort by absolute deviation
      deviations.sort((a, b) => a.absDev - b.absDev);
      const ranks = deviations.map((d, i) => ({ ...d, rank: i + 1 }));

      // Count studies on the specified side
      let n0;
      if (estimator === 'L0') {
        // Linear estimator
        const T = ranks.reduce((sum, r) => {
          const onSide = (side === 'right' && r.dev > 0) || (side === 'left' && r.dev < 0);
          return sum + (onSide ? r.rank : 0);
        }, 0);
        n0 = Math.max(0, Math.round((4 * T - k * (k + 1)) / (2 * k - 1)));
      } else {
        // R0 rank-based estimator
        const gamma = ranks.reduce((sum, r) => {
          const onSide = (side === 'right' && r.dev > 0) || (side === 'left' && r.dev < 0);
          return sum + (onSide ? 1 : 0);
        }, 0);
        n0 = Math.max(0, Math.round((4 * gamma - k + 1) / 3));
      }

      const nFilled = Math.round(n0);

      // Impute missing studies by reflecting the most extreme ones
      const sortedBySide = [...ranks].sort((a, b) => {
        if (side === 'right') return b.dev - a.dev;
        return a.dev - b.dev;
      });

      const imputedEffects = [...effects];
      const imputedSEs = [...ses];
      const imputedLabels = lastMetaStudies.map(s => s.label);

      for (let i = 0; i < nFilled && i < sortedBySide.length; i++) {
        const study = sortedBySide[i];
        const mirroredEffect = 2 * theta - study.dev - theta; // = -study.dev relative to theta
        imputedEffects.push(2 * theta - effects[study.idx]);
        imputedSEs.push(ses[study.idx]);
        imputedLabels.push(`[Imputed ${i + 1}]`);
      }

      // Recalculate pooled effect with imputed studies
      const newWeights = imputedSEs.map(se => 1 / (se * se));
      const newSumW = newWeights.reduce((a, b) => a + b, 0);
      const adjustedTheta = imputedEffects.reduce((sum, e, i) => sum + e * newWeights[i], 0) / newSumW;
      const adjustedSE = Math.sqrt(1 / newSumW);

      const isRatio = lastMetaResult.isRatio;
      const tfZCrit = normalQuantile(1 - (1 - (lastMetaResult.confidenceLevel || 0.95)) / 2);
      const adjustedEffect = isRatio ? Math.exp(adjustedTheta) : adjustedTheta;
      const adjustedCILo = isRatio ? Math.exp(adjustedTheta - tfZCrit * adjustedSE) : adjustedTheta - tfZCrit * adjustedSE;
      const adjustedCIHi = isRatio ? Math.exp(adjustedTheta + tfZCrit * adjustedSE) : adjustedTheta + tfZCrit * adjustedSE;

      const originalEffect = lastMetaResult.pooledEffect;
      const changePercent = ((adjustedEffect - originalEffect) / originalEffect * 100).toFixed(1);

      document.getElementById('trimFillResults').style.display = 'block';
      document.getElementById('trimFillSummary'.innerHTML = ` <div class="result-row"><span class="label">الدراسات المحتسبة:</span><span class="value">${nFilled</span></div> <div class="result-row"><span class="label">التأثير الأصلي:</span><span class="value">${originalEffect.toFixed(3)}</span></div> <div class="result-row"><span class="label">التأثير المعدل:</span><span class="value ${nFilled > 0 ?'red' : ''}">${adjustedEffect.toFixed(3)}</span></div>
        <div class="result-row"><span class="label">Adjusted ${Math.round((lastMetaResult.confidenceLevel || 0.95) * 100)}% CI:</span><span class="value">[${adjustedCILo.toFixed(3)}, ${adjustedCIHi.toFixed(3)}]</span></div>
        <div class="result-row"><span class="label">Change:</span><span class="value">${changePercent}%</span></div>
        ${nFilled > 0 ? `
          <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(197,48,48,0.1); border-radius: 4px; font-size: 0.75rem;">
            <strong>Caution:</strong> ${nFilled} potentially missing studies imputed.
            Treat this as sensitivity analysis, not correction; assumptions may not hold under severe asymmetry.
          </div>
        ` : `
          <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(34,197,94,0.1); border-radius: 4px; font-size: 0.75rem;">
            No missing studies detected on the ${side} side.
          </div>
        `}
      `;

      // Generate filled funnel plot
      document.getElementById('trimFillPlotContainer').innerHTML = generateFilledFunnelHTML(
        lastMetaResult.transformedEffects,
        lastMetaResult.ses,
        imputedEffects.slice(k),
        imputedSEs.slice(k),
        adjustedTheta,
        Math.log(originalEffect)
      );
    }

    function generateFilledFunnelHTML(origEffects, origSEs, impEffects, impSEs, adjustedTheta, originalTheta) {
      const allEffects = [...origEffects, ...impEffects];
      const allSEs = [...origSEs, ...impSEs];

      const minEffect = Math.min(...allEffects) - 0.5;
      const maxEffect = Math.max(...allEffects) + 0.5;
      const maxSE = Math.max(...allSEs);
      const range = maxEffect - minEffect;

      const scaleX = (val) => ((val - minEffect) / range) * 280 + 35;
      const scaleY = (se) => (se / maxSE) * 160 + 20;

      return `
        <svg viewBox="0 0 350 200" style="width: 100%; height: 200px; font-family: 'Source Sans Pro', sans-serif;">
          <!-- Original funnel -->
          <polygon points="${scaleX(originalTheta)},20 ${scaleX(originalTheta - 1.96 * maxSE)},180 ${scaleX(originalTheta + 1.96 * maxSE)},180"
                   fill="rgba(30,39,97,0.05)" stroke="rgba(30,39,97,0.3)" stroke-dasharray="3"/>
          <!-- Adjusted funnel -->
          <polygon points="${scaleX(adjustedTheta)},20 ${scaleX(adjustedTheta - 1.96 * maxSE)},180 ${scaleX(adjustedTheta + 1.96 * maxSE)},180"
                   fill="rgba(212,175,55,0.1)" stroke="#D4AF37"/>

          <!-- Original effect line -->
          <line x1="${scaleX(originalTheta)}" y1="20" x2="${scaleX(originalTheta)}" y2="180" stroke="#1E2761" stroke-width="1" stroke-dasharray="4" />
          <!-- Adjusted effect line -->
          <line x1="${scaleX(adjustedTheta)}" y1="20" x2="${scaleX(adjustedTheta)}" y2="180" stroke="#D4AF37" stroke-width="2" />

          <!-- Original studies -->
          ${origEffects.map((e, i) => `
            <circle cx="${scaleX(e)}" cy="${scaleY(origSEs[i])}" r="5" fill="#1E2761" stroke="white" stroke-width="1"/>
          `).join('')}

          <!-- Imputed studies -->
          ${impEffects.map((e, i) => `
            <circle cx="${scaleX(e)}" cy="${scaleY(impSEs[i])}" r="5" fill="none" stroke="#C53030" stroke-width="2" stroke-dasharray="2"/>
          `).join('')}

          <!-- Legend -->
          <circle cx="280" cy="15" r="4" fill="#1E2761"/>
          <text x="290" y="18" font-size="7" fill="#666">Original</text>
          <circle cx="280" cy="28" r="4" fill="none" stroke="#C53030" stroke-width="2" stroke-dasharray="2"/>
          <text x="290" y="31" font-size="7" fill="#666">Imputed</text>

          <text x="175" y="198" font-size="9" text-anchor="middle" fill="#666">Effect Size (log scale)</text>
        </svg>
      `;
    }

    // ============================================================
    // GAMIFICATION & PROGRESS SYSTEM
    // ============================================================

    const STORAGE_KEY = 'evidence_reversal_course_progress';

    // Seven Principles for tracking
    const sevenPrinciples = [
      "Not every signal is truth.",
      "Methods protect patients from our confidence.",
      "What was hidden in plain sight?",
      "The number without provenance is not a number.",
      "Heterogeneity is a message, not noise.",
      "Absence of evidence is not evidence of absence.",
      "Certainty must be earned, not assumed."
    ];

    // Badge definitions
    const badges = [
      { id: 'first_module', icon: '🎯', name: 'First Steps', desc: 'Complete your first module' },
      { id: 'predictor', icon: '🔮', name: 'Predictor', desc: 'Make your first prediction' },
      { id: 'correct_prediction', icon: '✨', name: 'Sharp Mind', desc: 'Predict correctly' },
      { id: 'five_modules', icon: '📚', name: 'Scholar', desc: 'Complete 5 modules' },
      { id: 'all_predictions', icon: '🎱', name: 'Oracle', desc: 'Make all predictions' },
      { id: 'streak_3', icon: '🔥', name: 'On Fire', desc: '3-day streak' },
      { id: 'quiz_master', icon: '🏆', name: 'Quiz Master', desc: 'Complete 5 quizzes' },
      { id: 'ready_practice', icon: '🚀', name: 'Ready for Practice', desc: 'Complete the Capstone module' },
      { id: 'completionist', icon: '👑', name: 'Completionist', desc: 'Finish all modules' }
    ];

    // Level definitions
    const levels = [
      { name: 'Novice', minPoints: 0 },
      { name: 'Apprentice', minPoints: 200 },
      { name: 'Practitioner', minPoints: 500 },
      { name: 'Expert', minPoints: 1000 },
      { name: 'Master', minPoints: 2000 }
    ];

    // Gamification state
    let gameState = {
      points: 0,
      earnedBadges: [],
      streak: 0,
      lastVisitDate: null,
      principlesMastered: [],
      quizzesCompleted: 0
    };

    function getLevel(points) {
      for (let i = levels.length - 1; i >= 0; i--) {
        if (points >= levels[i].minPoints) return { level: i + 1, name: levels[i].name };
      }
      return { level: 1, name: 'Novice' };
    }

    function awardPoints(amount, reason) {
      gameState.points += amount;
      updateSidebarPoints();
      saveProgress();
    }

    function earnBadge(badgeId) {
      if (!gameState.earnedBadges.includes(badgeId)) {
        gameState.earnedBadges.push(badgeId);
        saveProgress();
      }
    }

    function checkBadges() {
      const completedModules = document.querySelectorAll('.module-item.completed').length;
      const predictionCount = Object.keys(storyPredictions).length;
      const correctPredictions = Object.values(storyPredictions).filter(p => p.correct).length;

      if (completedModules >= 1) earnBadge('first_module'); إذا (CompletedModules >= 5) EarBadge('five_modules'); إذا (CompletedModules >= 23) كسبشارة('ready_practice'); إذا (CompletedModules >= 15) EarBadge('completionist'); إذا (predictionCount >= 1) كسبشارة('predictor'); إذا (التنبؤات الصحيحة >= 1) كسبشارة('correct_prediction'); إذا (predictionCount >= 11) كسبشارة('all_predictions'); إذا (gameState.streak >= 3) كسبشارة ('streak_3'); إذا (gameState.quizzesCompleted >= 5) كسبشارة('quiz_master');
    }

    function updateStreak() {
      const today = new Date().toDateString();
      if (gameState.lastVisitDate) {
        const lastVisit = new Date(gameState.lastVisitDate).toDateString();
        const yesterday = new Date(Date.now() - 86400000).toDateString();
        if (lastVisit === today) { /* Same day */ }
        else if (lastVisit === yesterday) { gameState.streak++; awardPoints(10, 'Daily streak'); }
        else { gameState.streak = 1; }
      } else { gameState.streak = 1; }
      gameState.lastVisitDate = new Date().toISOString();
    }

    function saveProgress() {
      const completedModules = [];
      document.querySelectorAll('.module-item.completed').forEach(el => {
        completedModules.push(parseInt(el.dataset.module));
      });

      const progress = {
        currentModule, currentSlide, completedModules,
        lastVisit: new Date().toISOString(),
        gameState: gameState,
        predictions: storyPredictions,
        spacedRepetition: spacedRepetitionState,
        scenarioState: scenarioState,
        calibrationState: calibrationState
      };

      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
        updateSidebarPoints();
      } catch (e) { console.log('Could not save progress'); }
    }

    function loadProgress() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const progress = JSON.parse(saved);
          // Migrate old module IDs: 13→23, 14→24 (one-time)
          if (!progress._migrated25) {
            const remap = {13: 23, 14: 24};
            progress.completedModules = progress.completedModules.map(id => remap[id] || id);
            if (remap[progress.currentModule]) progress.currentModule = remap[progress.currentModule];
            progress._migrated25 = true;
            try { localStorage.setItem(STORAGE_KEY, JSON.stringify(progress)); } catch(e) {}
          }
          progress.completedModules.forEach(moduleId => {
            const el = document.querySelector(`.module-item[data-module="${moduleId}"]`);
            if (el) el.classList.add('completed');
          });
          if (progress.gameState) gameState = progress.gameState;
          if (progress.predictions) Object.assign(storyPredictions, progress.predictions);
          if (progress.spacedRepetition) {
            spacedRepetitionState = progress.spacedRepetition;
          }
          if (progress.scenarioState) {
            scenarioState = progress.scenarioState;
          }
          if (progress.calibrationState) {
            calibrationState = progress.calibrationState;
          }
          updateStreak();
          updateSidebarPoints();
          if (progress.currentModule !== undefined) {
            return { module: progress.currentModule, slide: progress.currentSlide || 0 };
          }
        }
      } catch (e) { console.log('Could not load progress'); }
      return null;
    }

    function resetProgress() {
      if (confirm('Reset all progress including points and badges?')) {
        try {
          localStorage.removeItem(STORAGE_KEY);
          document.querySelectorAll('.module-item.completed').forEach(el => el.classList.remove('completed')); gameState = { النقاط: 0، الشارات المكتسبة: []، الخط: 0، تاريخ الزيارة الأخير: null، المبادئ Mastered: []، الاختبارات المكتملة: 0 }; تنبؤات القصة = {}; spacedRepetitionState = { المبادئ: {}، lastDailyReview: null، dailyReviewsCompleted: 0 }؛ سيناريو الحالة = { مكتمل: {}، الدرجات: {} }؛ calibrationState = {توقعات: []، إجمالي التنبؤات: 0، calibrationScore: null }; updateSidebarPoints(); updateReviewButtonStatus(); goToModule(0); يُحذًِر('Progress reset successfully.'); } Catch (e) { console.log('Could not reset progress'); }
      }
    }

    function markModuleComplete(moduleId) {
      const el = document.querySelector(`.module-item[data-module="${moduleId}"]`);
      if (el && !el.classList.contains('completed')) {
        el.classList.add('completed');
        awardPoints(100, 'Module completed');
        checkBadges();
      }
      saveProgress();
    }

    function updateSidebarPoints() {
      const el = document.getElementById('sidebarPoints');
      if (el) el.textContent = gameState.points + ' pts';
    }

    // ============================================================
    // PROGRESS DASHBOARD
    // ============================================================

    function openDashboard() {
      updateDashboardDisplay();
      document.getElementById('progressDashboard').classList.add('open');
    }

    function closeDashboard() {
      document.getElementById('progressDashboard').classList.remove('open');
    }

    function updateDashboardDisplay() {
      const levelInfo = getLevel(gameState.points);
      document.getElementById('levelBadge').textContent = `Level ${levelInfo.level}: ${levelInfo.name}`;
      document.getElementById('totalPoints').textContent = gameState.points;

      const completedModules = document.querySelectorAll('.module-item.completed').length;
      document.getElementById('modulesCompleted').textContent = `${completedModules}/${modules.length}`;

      const predictionCount = Object.keys(storyPredictions).length;
      const correctPredictions = Object.values(storyPredictions).filter(p => p.correct).length;
      document.getElementById('predictionsCorrect').textContent = `${correctPredictions}/${predictionCount}`;
      document.getElementById('quizzesCompleted').textContent = gameState.quizzesCompleted;

      const principlesHtml = sevenPrinciples.map((p, i) => {
        const mastered = gameState.principlesMastered.includes(i);
        return `<div class="principle-item">
          <div class="principle-num ${mastered ? 'mastered' : ''}">${i + 1}</div>
          <div class="principle-text">"${p}"</div>
          <span>${mastered ? '✓' : ''}</span>
        </div>`;
      }).join('');
      document.getElementById('principlesList').innerHTML = principlesHtml;

      const badgesHtml = badges.map(b => {
        const earned = gameState.earnedBadges.includes(b.id);
        return `<div class="badge ${earned ? 'earned' : ''}" title="${b.name}: ${b.desc}"> ${b.icon<div class="badge-tooltip">${b.name}</div> </div>`; }).join('');
      document.getElementById('badgesGrid').innerHTML = badgesHtml;

      document.getElementById('streakCount').textContent = `${gameState.streak} day${gameState.streak !== 1 ? 's' : ''}`;
      document.getElementById('streakFlame').textContent = gameState.streak >= 3 ? '🔥' : '💨';
    }

    // ============================================================
    // SPACED REPETITION ENGINE
    // ============================================================

    // Questions for each principle (used in daily review)
    const principleQuestions = [
      { // Principle 1: "Not every signal is truth."
        principle: 0,
        question: "When a drug shows benefits in observational studies, what should you remember?",
        options: [
          "The benefit is probably real and should guide treatment",
          "Not every signal is truth - RCTs are needed to confirm",
          "Observational studies are always biased and useless",
          "We should immediately conduct a meta-analysis"
        ],
        correct: 1,
        explanation: "Observational signals can be confounded. CAST showed that antiarrhythmics, which appeared beneficial, actually tripled mortality in RCTs."
      },
      { // Principle 2: "Methods protect patients from our confidence."
        principle: 1,
        question: "Why do we pre-register protocols before conducting a meta-analysis?",
        options: [
          "To impress journal editors",
          "Methods protect patients from our confidence",
          "It's required by law in most countries",
          "To speed up the publication process"]، الصحيح: 1، الشرح: مبدأ"Pre-registration prevents us from unconsciously biasing results toward what we expect. HRT observational studies were affected by healthy user bias."
      },
      { // Principle 3: "What was hidden in plain sight?": 2، السؤال:"When evaluating publication bias, what question should guide your thinking?",
        options: [
          "Are the authors reputable?",
          "Is the journal high impact?",
          "What was hidden in plain sight?",
          "How many studies were included?"]، الصحيح: 2، الشرح: تم دفن المخاطر القلبية لـ"Rosiglitazone'في بيانات إدارة الغذاء والدواء غير المنشورة. ابحث دائمًا خارج الأدبيات المنشورة للحصول على الصورة الكاملة." }, { // المبدأ 4: "الرقم بدون مصدر ليس رقمًا." المبدأ: 3، السؤال: "ما الذي يجعل حجم التأثير جديرًا بالثقة في التحليل التلوي؟"، الخيارات: [ "أهميته الإحصائية (ع <0.05)"، "المصدر الواضح - معرفة مصدره بالضبط"، "النشر في مجلة عالية التأثير"، "الاتفاق مع المعقولية البيولوجية"]، صحيح: 1، الشرح: "أظهرت تجارب DECREASE بيانات ملفقة. بدون مصدر يمكن التحقق منه (بيانات أولية، مسار تدقيق)، لا يمكن الوثوق بالأرقام." }, { // المبدأ 5: "عدم التجانس هو رسالة، وليس ضجيج." المبدأ: 4، سؤال: "عندما ترى عدم تجانس عالٍ (I² = 80٪) في التحليل التلوي، ما الذي يجب أن تفكر فيه؟"، الخيارات: [ "لقد فشل التحليل التلوي ويجب التخلي عنه"، "استخدم نموذج التأثيرات العشوائية وتجاهله"، "التباين رسالة". - التحقيق في مصادره"، "متوسط النتائج على أي حال، ذلك المبدأ's what meta-analysis does"]، الصحيح: 2، الشرح: تم دفن المخاطر القلبية لـ"ACCORD showed that intensive glucose control had different effects in different patient subgroups. High I² signals important effect modification."
      },
      { // Principle 6: "Absence of evidence is not evidence of absence.": 5، السؤال:"A meta-analysis of 3 small trials shows no significant effect (p = 0.15). What does this mean?",
        options: [
          "The treatment definitely doesn'لا يعمل"، "غياب الدليل ليس دليلاً على الغياب"، "نحتاج بالضبط إلى 5 تجارب أخرى للتأكد"، "العلاج ضار"]، صحيح: 1، الشرح: "قد تفتقر الدراسات الصغيرة إلى القدرة على اكتشاف التأثيرات الحقيقية. أظهرت التجارب المبكرة للفاعل بالسطح في البداية'no effect' due to small samples, but larger studies proved benefit."
      },
      { // Principle 7: "Certainty must be earned, not assumed."
        principle: 6,
        question: "What does the GRADE framework help us assess?",
        options: [
          "Whether a treatment is cost-effective",
          "How certain we can be in the evidence",
          "Whether authors have conflicts of interest",
          "The optimal sample size for future trials"
        ],
        correct: 1,
        explanation: "GRADE reminds us that certainty must be earned through high-quality evidence, not assumed from statistical significance alone."
      }
    ];

    // Extended question bank for variety
    const extendedQuestions = [
      { principle: 0, question: "The CAST trial showed antiarrhythmics increased mortality by:", options: ["50%", "100%", "200-300%", "400%"], correct: 2, explanation: "Encainide, flecainide, and moricizine roughly tripled mortality compared to placebo." },
      { principle: 1, question: "HRT appeared beneficial in observational studies due to:", options: ["Confounding by indication", "Healthy user bias", "Publication bias", "Data fabrication"], correct: 1, explanation: "Women who chose HRT were healthier at baseline (healthy user bias), creating an apparent benefit." },
      { principle: 2, question: "What percentage of negative trials often go unpublished?", options: ["10-20%", "30-40%", "40-50%", "60-80%"], correct: 2, explanation: "Studies estimate 40-50% of trials with negative results remain unpublished, distorting the evidence base." },
      { principle: 3, question: "The DECREASE trials fraud was detected through:", options: ["Peer review", "Statistical impossibilities", "Journal retraction", "Patient complaints"], correct: 1, explanation: "Patterns in the data were statistically impossible - too perfect, revealing fabrication." },
      { principle: 4, question: "What I² value suggests substantial heterogeneity?", options: [">25%", ">50%", ">75%", ">90%"], correct: 1, explanation: "I² > 50% suggests substantial heterogeneity; > 75% is considerable. Always investigate sources." },
      { principle: 5, question: "A funnel plot shows asymmetry. This suggests:", options: ["Perfect methodology", "Large sample sizes", "Possible small-study effects (publication bias is one explanation)", "High certainty"], correct: 2, explanation: "Funnel plot asymmetry can indicate small-study effects; publication bias is one explanation, but not the only one." },
      { principle: 6, question: "In GRADE, what can LOWER certainty in RCT evidence?", options: ["Large effect size", "Risk of bias", "Dose-response gradient", "Biological plausibility"], correct: 1, explanation: "Risk of bias, imprecision, inconsistency, indirectness, and publication bias can lower certainty from 'high' to lower levels." }
    ];

    // SM-2 inspired spaced repetition state
    let spacedRepetitionState = {
      principles: {}, // { 0: { lastReview: Date, interval: days, easeFactor: 2.5, repetitions: 0, nextReview: Date } }
      lastDailyReview: null,
      dailyReviewsCompleted: 0
    };

    // Initialize spaced repetition for all principles
    function initSpacedRepetition() {
      for (let i = 0; i < 7; i++) {
        if (!spacedRepetitionState.principles[i]) {
          spacedRepetitionState.principles[i] = {
            lastReview: null,
            interval: 1,
            easeFactor: 2.5,
            repetitions: 0,
            nextReview: new Date().toISOString()
          };
        }
      }
    }

    // SM-2 algorithm: update interval based on performance
    function updateSpacedRepetition(principleIndex, quality) {
      // quality: 0-5 (0-2 = fail, 3-5 = pass)
      const p = spacedRepetitionState.principles[principleIndex];
      if (!p) return;

      if (quality >= 3) {
        // Correct answer
        if (p.repetitions === 0) {
          p.interval = 1;
        } else if (p.repetitions === 1) {
          p.interval = 6;
        } else {
          p.interval = Math.round(p.interval * p.easeFactor);
        }
        p.repetitions++;
        p.easeFactor = Math.max(1.3, p.easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02)));

        // Mark as mastered after 3 successful reviews
        if (p.repetitions >= 3 && !gameState.principlesMastered.includes(principleIndex)) {
          gameState.principlesMastered.push(principleIndex);
          awardPoints(50, 'Principle mastered');
          earnBadge('principle_master');
        }
      } else {
        // Incorrect answer - reset
        p.repetitions = 0;
        p.interval = 1;
      }

      p.lastReview = new Date().toISOString();
      p.nextReview = new Date(Date.now() + p.interval * 24 * 60 * 60 * 1000).toISOString();
      saveProgress();
    }

    // Get principles due for review (sorted by urgency)
    function getPrinciplesDueForReview() {
      const now = new Date();
      const due = [];

      for (let i = 0; i < 7; i++) {
        const p = spacedRepetitionState.principles[i];
        if (!p) continue;

        const nextReview = p.nextReview ? new Date(p.nextReview) : new Date(0);
        if (nextReview <= now) {
          due.push({
            index: i,
            overdueDays: Math.floor((now - nextReview) / (24 * 60 * 60 * 1000)),
            repetitions: p.repetitions
          });
        }
      }

      // Sort: most overdue first, then least practiced
      due.sort((a, b) => {
        if (b.overdueDays !== a.overdueDays) return b.overdueDays - a.overdueDays;
        return a.repetitions - b.repetitions;
      });

      return due;
    }

    // ============================================================
    // DAILY REVIEW SYSTEM
    // ============================================================

    let reviewState = {
      active: false,
      questions: [],
      currentIndex: 0,
      answers: [],
      timerInterval: null,
      timeRemaining: 120 // 2 minutes in seconds
    };

    function shouldShowDailyReview() {
      if (!spacedRepetitionState.lastDailyReview) return true;

      const lastReview = new Date(spacedRepetitionState.lastDailyReview);
      const today = new Date();

      // Check if it's a new day
      return lastReview.toDateString() !== today.toDateString();
    }

    function openDailyReview() {
      initSpacedRepetition();

      // Get principles due for review
      const duePrinciples = getPrinciplesDueForReview();

      // Select up to 5 questions (mix of due principles and random for variety)
      let selectedQuestions = [];

      // First, add questions for due principles
      duePrinciples.slice(0, 3).forEach(dp => {
        const available = [principleQuestions[dp.index], ...extendedQuestions.filter(q => q.principle === dp.index)];
        const randomQ = available[Math.floor(Math.random() * available.length)];
        if (randomQ && !selectedQuestions.find(q => q.question === randomQ.question)) {
          selectedQuestions.push({ ...randomQ });
        }
      });

      // Fill remaining with random questions
      const allQuestions = [...principleQuestions, ...extendedQuestions];
      while (selectedQuestions.length < 5) {
        const randomQ = allQuestions[Math.floor(Math.random() * allQuestions.length)];
        if (!selectedQuestions.find(q => q.question === randomQ.question)) {
          selectedQuestions.push({ ...randomQ });
        }
      }

      // Shuffle
      selectedQuestions.sort(() => Math.random() - 0.5);

      // Initialize review state
      reviewState = {
        active: true,
        questions: selectedQuestions.slice(0, 5),
        currentIndex: 0,
        answers: [],
        timerInterval: null,
        timeRemaining: 120
      };

      // Show modal
      document.getElementById('dailyReviewModal').classList.add('open');

      // Render progress dots
      renderReviewProgress();

      // Render first question
      renderReviewQuestion();

      // Start timer
      startReviewTimer();
    }

    function closeDailyReview() {
      reviewState.active = false;
      if (reviewState.timerInterval) {
        clearInterval(reviewState.timerInterval);
      }
      document.getElementById('dailyReviewModal').classList.remove('open');
    }

    function skipDailyReview() {
      spacedRepetitionState.lastDailyReview = new Date().toISOString();
      saveProgress();
      closeDailyReview();
      updateReviewButtonStatus();
    }

    function startReviewTimer() {
      const timerEl = document.getElementById('reviewTimer');

      reviewState.timerInterval = setInterval(() => {
        reviewState.timeRemaining--;

        const mins = Math.floor(reviewState.timeRemaining / 60);
        const secs = reviewState.timeRemaining % 60;
        timerEl.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

        if (reviewState.timeRemaining <= 0) {
          clearInterval(reviewState.timerInterval);
          finishDailyReview();
        }
      }, 1000);
    }

    function renderReviewProgress() {
      const container = document.getElementById('reviewProgress');
      container.innerHTML = reviewState.questions.map((_, i) => {
        let cls = 'progress-dot';
        if (i < reviewState.currentIndex) cls += ' completed';
        if (i === reviewState.currentIndex) cls += ' current';
        return `<div class="${cls}"></div>`;
      }).join('');
    }

    function renderReviewQuestion() {
      if (reviewState.currentIndex >= reviewState.questions.length) {
        finishDailyReview();
        return;
      }

      const q = reviewState.questions[reviewState.currentIndex];
      const container = document.getElementById('reviewCardContainer');

      container.innerHTML = `
        <div class="review-card">
          <div class="review-principle-num">${q.principle + 1}</div>
          <div class="review-principle-text">"${sevenPrinciples[q.principle]}"</div>
          <div class="review-question">${q.question}</div>
          <div class="review-options">
            ${q.options.map((opt, i) => `
              <button class="review-option" onclick="selectReviewAnswer(${i})">${opt}</button>
            `).join('')}
          </div>
          <div id="reviewFeedback"></div>
        </div>
      `;

      document.getElementById('reviewNextBtn').disabled = true;
    }

    function selectReviewAnswer(answerIndex) {
      const q = reviewState.questions[reviewState.currentIndex];
      const isCorrect = answerIndex === q.correct;

      // Store answer
      reviewState.answers.push({
        principle: q.principle,
        correct: isCorrect,
        selected: answerIndex
      });

      // Update spaced repetition
      updateSpacedRepetition(q.principle, isCorrect ? 4 : 1);

      // Award points
      if (isCorrect) {
        awardPoints(15, 'المراجعة اليومية صحيحة');
      }

      // Visual feedback
      const options = document.querySelectorAll('.review-option');
      options.forEach((opt, i) => {
        opt.disabled = true;
        opt.style.cursor = 'default';
        if (i === q.correct) {
          opt.classList.add('correct');
        }
        if (i === answerIndex && !isCorrect) {
          opt.classList.add('incorrect');
        }
        if (i === answerIndex) {
          opt.classList.add('selected');
        }
      });

      // Show feedback
      const feedbackEl = document.getElementById('reviewFeedback');
      feedbackEl.innerHTML = `
        <div class="تعليقات المراجعة ${isCorrect ? 'صحيح' : 'غير صحيح'}">
          ${isCorrect ? '✓ صحيح!' : '✗ ليس تمامًا.'} ${q.explanation}
        </div>
      `;

      // Enable next button
      document.getElementById('reviewNextBtn').disabled = false;
    }

    function nextReviewQuestion() {
      reviewState.currentIndex++;
      renderReviewProgress();
      renderReviewQuestion();
    }

    function finishDailyReview() {
      if (reviewState.timerInterval) {
        clearInterval(reviewState.timerInterval);
      }

      const correctCount = reviewState.answers.filter(a => a.correct).length;
      const totalCount = reviewState.answers.length;
      const score = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;

      // Update state
      spacedRepetitionState.lastDailyReview = new Date().toISOString();
      spacedRepetitionState.dailyReviewsCompleted++;
      gameState.quizzesCompleted++;
      saveProgress();
      checkBadges();

      // Award bonus for perfect score
      if (correctCount === totalCount && totalCount > 0) {
        awardPoints(25, 'مثالية يوميًا مراجعة');
        earnBadge('perfect_review');
      }

      // Show summary
      const container = document.getElementById('reviewCardContainer');
      container.innerHTML = `
        <div class="review-summary">
          <div class="summary-score">${score}%</div>
          <div class="summary-text">Daily Review Complete!</div>

          <div class="summary-breakdown">
            <div class="summary-stat">
              <div class="summary-stat-value correct-val">${correctCount}</div>
              <div class="summary-stat-label">Correct</div>
            </div>
            <div class="summary-stat">
              <div class="summary-stat-value incorrect-val">${totalCount - correctCount}</div>
              <div class="summary-stat-label">To Review</div>
            </div>
          </div>

          ${gameState.streak >= 2 ? `
            <div class="review-streak-bonus">
              <span class="flame">🔥</span>
              <span class="text">${gameState.streak} day learning streak!</span>
            </div>
          ` : ''}
        </div>
      `;

      // Update actions
      document.getElementById('reviewActions').innerHTML = `
        <button class="المراجعة - btn التالي" onclick="closeDailyReview()">Continue Learning</button>
      `;

      updateReviewButtonStatus();
    }

    function updateReviewButtonStatus() {
      const btn = document.getElementById('dailyReviewBtn');
      const status = document.getElementById('reviewStatus');

      if (!btn || !status) return;

      if (shouldShowDailyReview()) {
        btn.classList.add('pending');
        status.textContent = 'Due!';
      } else {
        btn.classList.remove('pending');
        status.textContent = '✓ Done';
      }
    }

    // Add badge for spaced repetition mastery
    if (!badges.find(b => b.id === 'principle_master')) {
      badges.push({ id: 'principle_master', icon: '🎓', name: 'Principle Master', desc: 'إتقان مبدأ من خلال التكرار المتباعد' });
    }
    if (!badges.find(b => b.id === 'perfect_review')) {
      badges.push({ id: 'perfect_review', icon: '💯', name: 'مراجعة مثالية', desc: 'احصل على 100% من المراجعة اليومية' });
    }
    if (!badges.find(b => b.id === 'daily_dedication')) {
      badges.push({ id: 'daily_dedication', icon: '📅', name: 'Daily Dedication', desc: 'أكمل 7 مراجعات يومية' });
    }
    if (!badges.find(b => b.id === 'scenario_solver')) {
      badges.push({ id: 'scenario_solver', icon: '🧩', name: 'Scenario Solver', desc: 'أكمل 5 سيناريوهات متفرعة' });
    }
    if (!badges.find(b => b.id === 'well_calibrated')) {
      badges.push({ id: 'well_calibrated', icon: '🎯', name: 'Well Calibrated', desc: 'تحقيق دقة معايرة تزيد عن 80%' });
    }

    // ============================================================
    // BRANCHING SCENARIOS SYSTEM
    // ============================================================

    // Scenarios based on Evidence Reversal stories - decisions with consequences
    const branchingScenarios = [
      {
        id: 'cast_scenario',
        module: 1,
        title: 'قرار عدم انتظام ضربات القلب',
        situation: "أنت في لجنة كتيبات المستشفى عام 1988. يقدم طبيب القلب بيانات تظهر أن الإنكاينيد يثبط الـ PVCs بنسبة 80% في مرضى ما بعد احتشاء عضلة القلب. إنه يريد إضافتها إلى كتيب الوصفات للاستخدام الروتيني.",
        question: "بماذا توصي؟",
        choices: [
          { id: 'a', text: "الموافقة عليه - يعد قمع PVC بديلاً معتمدًا للوفيات", consequence: 'bad', result: "أظهرت تجربة CAST (1989) أن هذه الأدوية تؤدي إلى معدل وفيات ثلاثي على الرغم من تثبيط PVCs. مات أكثر من 50.000 مريض بسبب الأدوية التي \"نجحت\" على الأم البديلة." },
          { id: 'b', text: "طلب أدلة التجارب المعشاة ذات الشواهد على النتائج الصعبة (الموت، السكتة القلبية) قبل الموافقة", consequence: 'good', result: "صحيح! نقاط النهاية البديلة يمكن أن تكون مضللة. لم يتم إثبات العلاقة بين قمع PVC والبقاء على قيد الحياة أبدًا - وتبين أنها عكس ما كان متوقعًا." },
          { id: 'c', text: "الموافقة على المرضى ذوي المخاطر المنخفضة فقط", consequence: 'bad', result: "ما زال خطأ. وبدون بيانات الوفيات، لا يمكنك معرفة المرضى الذين قد يتعرضون للأذى. أظهر CAST ضررًا عبر المجموعات الفرعية." }
        ],
        correct: 'b',
        principle: 0,
        lesson: "ليست كل إشارة هي الحقيقة. يجب التحقق من صحة البدائل مقابل النتائج الصعبة قبل اتخاذ قرارات العلاج."
      },
      {
        id: 'hrt_scenario',
        module: 2,
        title: 'توصية العلاج التعويضي بالهرمونات',
        situation: "إنه عام 1998. امرأة في مرحلة ما بعد انقطاع الطمث تسأل عن العلاج بالهرمونات البديلة. لديك أكثر من 30 دراسة رصدية تظهر انخفاضًا بنسبة 40-50% في أمراض القلب. لا توجد تجارب معشاة ذات شواهد كبيرة حتى الآن.",
        question: "ماذا تقول لها؟",
        choices: [
          { id: 'a', text: "أوصي بشدة باستخدام العلاج التعويضي بالهرمونات - الأدلة الرصدية ساحقة", consequence: 'bad', result: "أظهرت تجربة WHI (2002) زيادة في أمراض القلب باستخدام العلاج التعويضي بالهرمونات (HR 1.29). تم الخلط بين فائدة المراقبة بسبب تحيز المستخدم الصحي - كانت النساء اللاتي اخترن العلاج التعويضي بالهرمونات أكثر صحة في الأساس." },
          { id: 'b', text: "اشرح عدم اليقين - قد تكون بيانات المراقبة مشوشة، انتظر نتائج التجارب المعشاة ذات الشواهد", consequence: 'good', result: "صحيح! لقد أبلغت بشكل مناسب عدم اليقين. أثبتت WHI أن إشارة المراقبة كانت مضللة بسبب الخلط." },
          { id: 'c', text: "يوصى باستخدام العلاج التعويضي بالهرمونات ولكن فقط للنساء اللاتي لديهن عوامل خطر", consequence: 'bad', result: "لا تزال هناك مشكلة. إن استهداف النساء \"الشديدات الخطورة\" لا يحل الإرباك - بل قد يؤدي إلى تركيز الضرر." }
        ],
        correct: 'b',
        principle: 1,
        lesson: "الأساليب تحمي المرضى من ثقتنا. الارتباطات القائمة على الملاحظة ليست دليلاً سببيًا."
      },
      {
        id: 'rosi_scenario',
        module: 3,
        title: 'التجارب المخفية',
        situation: "أنت تجري تحليلًا تلويًا لعقار روزيجليتازون لمرض السكري في عام 2006. لقد وجدت 12 تجربة منشورة. ذكر أحد الزملاء أن إدارة الغذاء والدواء قد يكون لديها بيانات غير منشورة.",
        question: "ماذا تفعل؟",
        choices: [
          { id: 'a', text: "تابع التجارب المنشورة فقط - من الصعب جدًا الحصول على البيانات غير المنشورة", consequence: 'bad', result: "وجد التحليل التلوي الذي أجرته نيسن عام 2007 تجارب شركة جلاكسو سميث كلاين غير المنشورة. أدى تضمينها إلى الكشف عن زيادة بنسبة 43% في خطر MI (أو 1.43) وهو ما لم يكن مرئيًا في البيانات المنشورة وحدها." },
          { id: 'b', text: "قم بتقديم طلبات قانون حرية المعلومات، ابحث في ClinicalTrials.gov، اتصل بالشركة المصنعة", consequence: 'good', result: "صحيح! البحث في الأدب الرمادي أمر ضروري. تم إخفاء إشارة القلب روزيجليتازون في التقارير التنظيمية غير المنشورة لسنوات." },
          { id: 'c', text: "أضف تحليل الحساسية بافتراض وجود تجارب غير منشورة", consequence: 'neutral', result: "أفضل من لا شيء، ولكنه ليس كافيًا. لا يمكنك أن تصمم ما لم تحاول العثور عليه. مطلوب بحث نشط." }
        ],
        correct: 'b',
        principle: 2,
        lesson: "ما الذي كان مخفيًا على مرأى من الجميع؟ البحث الشامل وراء الأدبيات المنشورة مطلوب منهجيا."
      },
      {
        id: 'decrease_scenario',
        module: 5,
        title: 'النمط المشبوه',
        situation: "أنت تقوم بالتحقق من البيانات المستخرجة لإجراء تحليل تلوي. تُظهر تجارب أحد الباحثين البارزين تأثيرات متسقة بشكل ملحوظ (I² = 0%) بينما تظهر تجارب أخرى عدم تجانس عالٍ. معدلات أحداثه متوازنة بشكل غير عادي.",
        question: "ماذا تفعل؟",
        choices: [
          { id: 'a', text: "اقبل البيانات - عدم التجانس المنخفض أمر جيد، وهو باحث محترم", consequence: 'bad', result: "تبين فيما بعد أن تجارب DECREASE التي أجراها دون بولدرمانز ملفقة. كان الاتساق \"المثالي\" علامة حمراء - فالبيانات الحقيقية أكثر فوضوية. لقد أثر احتياله على المبادئ التوجيهية لسنوات." },
          { id: 'b', text: "اطلب المستندات المصدرية وتحقق من الأرقام مقابل المنشورات الأصلية", consequence: 'good', result: "صحيح! كشف التحقق من المصدر عن عملية الاحتيال. عندما تتبع المحققون أرقامه حتى المصدر، لم يكن هناك مرضى. ربما تضرر 800 ألف شخص من المبادئ التوجيهية المبنية على افتراءاته." },
          { id: 'c', text: "قم بإجراء تحليل الحساسية باستثناء دراساته", consequence: 'neutral', result: "مفيد ولكنه غير كافٍ. يجب عليك التحقق أولاً - في حالة الاشتباه في الاحتيال، يجب تبرير الاستبعاد بالأدلة، وليس بالاشتباه." }
        ],
        correct: 'b',
        principle: 3,
        lesson: "الرقم بدون أصل ليس رقمًا. تحتاج كل نقطة بيانات إلى التحقق من مصدرها."
      },
      {
        id: 'heterogeneity_scenario',
        module: 8,
        title: 'معضلة I²',
        situation: "يُظهر التحليل التلوي للتحكم المكثف في الجلوكوز أن معدل ضربات القلب المجمع يبلغ 0.91 (95% CI 0.84-0.99) لأحداث القلب والأوعية الدموية، ولكن I² = 78%. تظهر تجربة ACCORD ضررًا (HR 1.22) بينما تظهر تجارب أخرى فائدة.",
        question: "كيف يمكنك الإبلاغ عن هذا؟",
        choices: [
          { id: 'a', text: "الإبلاغ عن التقدير المجمع - إنه ذو دلالة إحصائية ويفضل المعالجة", consequence: 'bad', result: "خطير! ويعني عدم التجانس العالي أن التقدير المجمع لا يمثل الواقع. أظهر أكورد أن التحكم المكثف أدى إلى زيادة معدل الوفيات لدى بعض المرضى. إن الإبلاغ عن المتوسط فقط يخفي تأثيرات المجموعة الفرعية التي تهدد الحياة." },
          { id: 'b', text: "التحقيق في مصادر عدم التجانس، والإبلاغ عن اختلافات المجموعات الفرعية بشكل بارز", consequence: 'good', result: "صحيح! وجدت ACCORD أن التحكم المكثف أضر بالمرضى الذين يعانون من مرض السكري لمدة طويلة وأمراض القلب والأوعية الدموية. الفائدة \"المتوسطة\" تخفي الضرر المميت في مجموعات فرعية محددة." },
          { id: 'c', text: "استخدام التأثيرات العشوائية والإبلاغ عن فترات ثقة أوسع", consequence: 'neutral', result: "صحيح من الناحية الفنية ولكنه يخطئ الهدف. التأثيرات العشوائية تفسر عدم التجانس إحصائيًا ولكنها لا تفسره سريريًا. تحتاج إشارة الضرر لـ ACCORD إلى التحقيق، وليس إلى التجانس الإحصائي." }
        ],
        correct: 'b',
        principle: 4,
        lesson: "التباين عبارة عن رسالة، وليس ضوضاء. يتطلب ارتفاع I² التحقيق، وليس فقط التعديل الإحصائي."
      },
      {
        id: 'orbita_scenario',
        module: 4,
        title: 'سؤال الجراحة الوهمية',
        situation: "إنه عام 2015. أنت تصمم تجربة PCI للذبحة الصدرية المستقرة. وتظهر التجارب السابقة غير المعماة تحسنا في الأعراض. يقترح أحد الإحصائيين استخدام إجراء زائف (القسطرة بدون دعامات) كعنصر تحكم.",
        question: "ما هو ردك؟",
        choices: [
          { id: 'a', text: "ارفض التحكم الزائف - من غير الأخلاقي القيام بإجراء غزوي دون فائدة", consequence: 'bad', result: "استخدمت تجربة ORBITA (2017) التحكم الزائف ولم تجد أي اختلاف في وقت التمرين (16.6 ثانية، 95% CI -8.9 إلى 42.0). بدون الخدعة، لكان من الممكن الخلط بين تأثير الدواء الوهمي لـ PCI وتأثير العلاج." },
          { id: 'b', text: "ادعم التحكم الزائف - بدون التعمية، لا يمكننا التمييز بين العلاج الوهمي وتأثير العلاج", consequence: 'good', result: "صحيح! لقد أحدث أوربيتا ثورة في أمراض القلب من خلال إظهار أن الكثير من فوائد PCI في الذبحة الصدرية المستقرة كان تأثير الدواء الوهمي. كانت السيطرة الزائفة ضرورية للكشف عن هذا." },
          { id: 'c', text: "استخدم نقاط النهاية الموضوعية مثل احتشاء عضلة القلب أو الموت بدلاً من الأعراض", consequence: 'neutral', result: "هذه مهمة ولكن الشجاعة لم تظهر بالفعل أي فائدة للوفيات. كان السؤال هو ما إذا كان تحسن الأعراض حقيقيًا - ولا يمكن الإجابة على ذلك إلا عن طريق التحكم الزائف." }
        ],
        correct: 'b',
        principle: 1,
        lesson: "الطرق تحمي المرضى من ثقتنا. تكشف الضوابط الصورية ما لا تستطيع التجارب غير المعماة كشفه."
      },
      {
        id: 'prowess_scenario',
        module: 6,
        title: 'التجربة الإيجابية الفردية',
        situation: "إنه عام 2002. أظهرت تجربة PROWESS أن البروتين C المنشط يقلل من الوفيات الناجمة عن تعفن الدم (RR 0.81, ع = 0.005). تسعى الشركة المصنعة للحصول على موافقة إدارة الغذاء والدواء. أنت في اللجنة الاستشارية.",
        question: "بماذا توصي؟",
        choices: [
          { id: 'a', text: "الموافقة على الفور - التجربة كبيرة وذات دلالة إحصائية", consequence: 'bad', result: "لم تجد PROWESS-SHOCK (2012) أي فائدة (RR 1.09, 95% CI) 0.92-1.28) وأضرار النزيف. تم سحب الدواء بعد 10 سنوات من الاستخدام. التجارب الفردية، مهما كانت مثيرة للإعجاب، تحتاج إلى تكرار." },
          { id: 'b', text: "يتطلب تجربة تأكيدية قبل الحصول على موافقة واسعة النطاق", consequence: 'good', result: "صحيح! النسخ المتماثل أمر ضروري. من المحتمل أن يكون PROWESS نتيجة إيجابية كاذبة أو متأثرًا بقضايا إجراء التجربة. كان من الممكن أن تمنع التجربة التأكيدية سنوات من الاستخدام غير الملائم." },
          { id: 'c', text: "الموافقة على مراقبة ما بعد التسويق", consequence: 'neutral', result: "غير كافية. نادراً ما تولد مراقبة ما بعد التسويق جودة الأدلة اللازمة لإلغاء الموافقات. كانت هناك حاجة إلى تجربة تأكيدية مناسبة." }
        ],
        correct: 'b',
        principle: 5,
        lesson: "لا يعد غياب دليل التكرار دليلاً على الفعالية. التجارب المنفردة لا تتوج العلاجات."
      },
      {
        id: 'egdt_scenario',
        module: 7,
        title: 'النسخ المتماثل التاريخي',
        situation: "أظهرت تجربة Rivers EGDT (2001) انخفاضًا كبيرًا في معدل الوفيات في الإنتان. وبحلول عام 2014، لم تُظهِر ثلاث تجارب كبيرة للتكرار (ProCESS، وARISE، وProMISe) أي فائدة. كيف تفسر هذا؟",
        question: "ما هو استنتاجك؟",
        choices: [
          { id: 'a', text: "كانت ريفرز خاطئة - EGDT لا يعمل", consequence: 'neutral', result: "صحيح جزئيًا ولكنه يفتقد الفروق الدقيقة. لم تكن الأنهار بالضرورة \"خاطئة\" - فقد تغير السياق. كانت الرعاية المعتادة في عام 2014 أفضل بكثير من عام 2001. وقد اختلفت مجموعات المقارنة بشكل كبير." },
          { id: 'b', text: "تحسنت الرعاية المعتادة كثيرًا لدرجة أن ميزة EGDT اختفت", consequence: 'good', result: "صحيح! هذا هو \"الاتجاه العلماني\" - تلقت المجموعة الضابطة في عام 2014 رعاية تتضمن مبادئ EGDT. تم تخفيف تأثير التدخل من خلال الممارسة القياسية المحسنة." },
          { id: 'c', text: "تم إجراء تجارب التكرار في مجموعات سكانية مختلفة", consequence: 'neutral', result: "صحيح ولكنه غير كامل. لا تفسر الاختلافات السكانية (الصلاحية الخارجية) بشكل كامل سبب فشل EGDT في بلدان متعددة. يعد الاتجاه المزمن في جودة الرعاية المعتادة هو العامل الرئيسي." }
        ],
        correct: 'b',
        principle: 5,
        lesson: "السياق مهم. العلاجات التي عملت ضد الرعاية المعتادة التي عفا عليها الزمن قد لا تظهر أي فائدة عندما تتحسن المعايير."
      },
      {
        id: 'grade_scenario',
        module: 10,
        title: 'تقييم اليقين',
        situation: "إنك تقوم بتقييم يقين الأدلة للتحكم المكثف في ضغط الدم. لديك تجارب معشاة ذات شواهد تظهر فائدة (SPRINT)، لكنها استبعدت مرضى السكر واستخدمت ضغط الدم المكتبي الآلي. يشمل مجتمعك مرضى السكر ويستخدمون ضغط الدم اليدوي.",
        question: "كيف تقيم درجة اليقين بالنسبة لسكانك الإرشاديين؟",
        choices: [
          { id: 'a', text: "يقين عالٍ - كان SPRINT عبارة عن تجربة عشوائية معشاة ذات شواهد تم إجراؤها بشكل جيد", consequence: 'bad', result: "خطأ! يتطلب GRADE تصنيفًا لسكانك. لا تنطبق نتائج SPRINT بشكل مباشر على مرضى السكر (باستثناء) أو العيادات التي تستخدم قياس ضغط الدم اليدوي (الذي يقرأ أعلى بحوالي 10 مم زئبق). هذه غير مباشرة." },
          { id: 'b', text: "الرجوع إلى التصنيف السابق لعدم المباشرة - يختلف التعداد والقياسات", consequence: 'good', result: "صحيح! استبعد SPRINT مرضى السكري (أظهر ACCORD ضررًا لدى مرضى السكر!) واستخدم ضغط الدم الآلي (قراءات أقل من اليدوية). إن تطبيق أهداف SPRINT باستخدام ضغط الدم اليدوي قد يؤدي إلى المبالغة في علاج المرضى." },
          { id: 'c', text: "يقين متوسط - بعض عدم اليقين ولكن التجارب المعشاة ذات الشواهد هي المعيار الذهبي", consequence: 'neutral', result: "ليس محددًا بدرجة كافية. أنت بحاجة إلى تحديد سبب تخفيض رتبتك. يتطلب عدم المباشرة في عدد السكان (باستثناء مرضى السكري) والتدخل (طريقة قياس ضغط الدم) اعترافًا صريحًا." }
        ],
        correct: 'b',
        principle: 6,
        lesson: "يجب اكتساب اليقين لسكانك. الأدلة المباشرة تتفوق على الأدلة غير المباشرة، بغض النظر عن تصميم الدراسة."
      },
      {
        id: 'funnel_scenario',
        module: 9,
        title: 'القمع غير المتماثل',
        situation: "يُظهر المخطط القمعي الخاص بك للتدخل الجراحي عدم تناسق ملحوظ - تتجمع الدراسات الصغيرة على الجانب الإيجابي، والدراسات الكبيرة بالقرب من الصفر. اختبار إيجر ع = 0.02.",
        question: "كيف يمكنك المتابعة؟",
        choices: [
          { id: 'a', text: "تطبيق القطع والتعبئة لضبط التقدير المجمع", consequence: 'neutral', result: "القص والتعبئة هو تحليل للحساسية، وليس إصلاحًا. ويفترض أن عدم التماثل هو تحيز محض للنشر، ولكن قد تكون تأثيرات الدراسات الصغيرة أيضًا بسبب اختيار المريض، أو إخلاص التدخل، أو عدم التجانس الحقيقي." },
          { id: 'b', text: "الإبلاغ عن عدم التماثل، واستكشاف الأسباب، وتقديمه مع أو بدون دراسات صغيرة", consequence: 'good', result: "صحيح! عدم تناسق مسار التحويل له أسباب متعددة: تحيز النشر، أو عدم التجانس الحقيقي، أو اختلاف مجموعات المرضى في الدراسات الصغيرة مقابل الدراسات الكبيرة. يعد الإبلاغ الشفاف عن جميع الاحتمالات أمرًا ضروريًا." },
          { id: 'c', text: "استبعد الدراسات الصغيرة لأنها من المحتمل أن تكون متحيزة", consequence: 'bad', result: "يؤدي الاستبعاد التعسفي إلى إنشاء تحيزه الخاص. قد تمثل الدراسات الصغيرة مجموعات سكانية مختلفة حيث يعمل العلاج بشكل أفضل حقًا. التحقيق، وليس الاستبعاد، هو الجواب." }
        ],
        correct: 'b',
        principle: 2,
        lesson: "ما الذي كان مخفيا على مرأى من الجميع؟ يكشف عدم تناسق مسار التحويل عن المشكلات ولكنه لا يحدد السبب. مطلوب التحقيق."
      }
    ];

    // Track scenario completions
    let scenarioState = {
      completed: {},
      confidenceRatings: []
    };

    function renderScenario(scenarioId, containerId) {
      const scenario = branchingScenarios.find(s => s.id === scenarioId);
      if (!scenario) return;

      const container = document.getElementById(containerId);
      if (!container) return;

      const isCompleted = scenarioState.completed[scenarioId];

      container.innerHTML = `
        <div class="scenario-panel" id="scenario-${scenarioId}">
          <div class="scenario-header">
            <span class="scenario-icon">🔀</span>
            <span class="scenario-title">${scenario.title}</span>
          </div>
          <div class="scenario-situation">${scenario.situation}</div>
          <div class="scenario-question">${scenario.question}</div>
          <div class="scenario-choices">
            ${scenario.choices.map(c => `
              <div class="سيناريو اختيار ${isCompleted ? 'تم الرد عليه' : ''} ${isCompleted && c.id ===سيناريو.تصحيح؟ 'صحيح' : ''} ${isCompleted &&سيناريوState.Completed[scenarioId] === c.id && c.id !==سيناريو.correct ? 'غير صحيح' : ''}"
                   onclick="${isCompleted ? '' : `selectScenarioChoice('${scenarioId}', '${c.id}')`}">
                <span class="choice-letter">${c.id.toUpperCase()}</span>
                <span class="choice-text">${c.text}</span>
              </div>
            `).join('')}
          </div>
          <div class="scenario-consequence ${isCompleted ? 'visible' : ''} ${isCompleted ? scenario.choices.find(c => c.id === scenarioState.completed[scenarioId])?.consequence || '' : ''}" id="consequence-${scenarioId}">
            ${isCompleted ? renderConsequence(scenario, scenarioState.completed[scenarioId]) : ''}
          </div>
        </div>
      `;
    }

    function renderConsequence(scenario, choiceId) {
      const choice = scenario.choices.find(c => c.id === choiceId);
      const isCorrect = choiceId === scenario.correct;
      return `
        <div class="consequence-title">
          ${isCorrect ? '✓ Good decision!' : '✗ Problematic decision'}
        </div>
        <div class="consequence-text">${choice.result}</div>
        <div class="consequence-lesson"><strong>Principle ${scenario.principle + 1}:</strong> ${scenario.lesson}</div>
      `;
    }

    function selectScenarioChoice(scenarioId, choiceId) {
      const scenario = branchingScenarios.find(s => s.id === scenarioId);
      if (!scenario || scenarioState.completed[scenarioId]) return;

      scenarioState.completed[scenarioId] = choiceId;

      // Award points
      if (choiceId === scenario.correct) {
        awardPoints(30, 'قرار السيناريو الصحيح');
      } else {
        awardPoints(10, 'Scenario attempted');
      }

      // Check for badge
      const completedCount = Object.keys(scenarioState.completed).length;
      if (completedCount >= 5) {
        earnBadge('scenario_solver');
      }

      saveProgress();

      // Re-render with answer shown
      const container = document.getElementById(`scenario-${scenarioId}`)?.parentElement;
      if (container) {
        renderScenario(scenarioId, container.id);
      }
    }

    // ============================================================
    // CONFIDENCE CALIBRATION SYSTEM
    // ============================================================

    let calibrationState = {
      predictions: [], // { confidence: 0-100, correct: boolean }
      totalPredictions: 0,
      calibrationScore: null
    };

    function addConfidenceToPredict(containerId) {
      const container = document.getElementById(containerId);
      if (!container) return;

      const existingSection = container.querySelector('.confidence-section');
      if (existingSection) return;

      const section = document.createElement('div');
      section.className = 'confidence-section';
      section.innerHTML = `
        <div class="confidence-label">How confident are you in your prediction?</div>
        <div class="confidence-slider-container">
          <input type="range" class="confidence-slider" min="0" max="100" value="50"
                 oninput="updateConfidenceDisplay(this)">
          <span class="confidence-value">50%</span>
        </div>
        <div class="confidence-labels">
          <span>Guessing</span>
          <span>Very sure</span>
        </div>
      `;
      container.appendChild(section);
    }

    function updateConfidenceDisplay(slider) {
      const value = slider.value;
      slider.nextElementSibling.textContent = value + '%';
    }

    function recordConfidence(confidence, wasCorrect) {
      calibrationState.predictions.push({ confidence, correct: wasCorrect });
      calibrationState.totalPredictions++;
      calculateCalibrationScore();
      saveProgress();
    }

    function calculateCalibrationScore() {
      if (calibrationState.predictions.length < 5) {
        calibrationState.calibrationScore = null;
        return;
      }

      // Group predictions by confidence bands
      const bands = { low: [], mid: [], high: [] };
      calibrationState.predictions.forEach(p => {
        if (p.confidence < 40) bands.low.push(p);
        else if (p.confidence < 70) bands.mid.push(p);
        else bands.high.push(p);
      });

      // Calculate accuracy per band
      const bandAccuracy = {};
      Object.keys(bands).forEach(band => {
        if (bands[band].length > 0) {
          const correct = bands[band].filter(p => p.correct).length;
          bandAccuracy[band] = correct / bands[band].length;
        }
      });

      // Perfect calibration: high confidence = high accuracy, low confidence = low accuracy
      // Score: 100 - average absolute deviation from expected
      let totalDeviation = 0;
      let count = 0;

      if (bands.high.length > 0) {
        totalDeviation += Math.abs((bandAccuracy.high || 0) - 0.85) * 100;
        count++;
      }
      if (bands.mid.length > 0) {
        totalDeviation += Math.abs((bandAccuracy.mid || 0) - 0.55) * 100;
        count++;
      }
      if (bands.low.length > 0) {
        totalDeviation += Math.abs((bandAccuracy.low || 0) - 0.25) * 100;
        count++;
      }

      calibrationState.calibrationScore = count > 0 ? Math.max(0, 100 - (totalDeviation / count)) : null;

      // Award badge for good calibration
      if (calibrationState.calibrationScore >= 80) {
        earnBadge('well_calibrated');
      }
    }

    // ============================================================
    // ENHANCED ANALOGY SYSTEM
    // ============================================================

    const conceptAnalogies = {
      'heterogeneity': {
        icon: '🎻',
        title: 'Orchestra Tuning',
        concept: 'I² (Heterogeneity)',
        text: "مثل ضبط الأوركسترا - بعض التباين أمر طبيعي ومتوقع. ولكن إذا كانت آلات الكمان تعزف بمفاتيح مختلفة، فهذا يعني أن هناك خطأ ما. ارتفاع I² يعني أن دراستك لا تلعب نفس النغمة."
      },
      'publication_bias': {
        icon: '🧦',
        title: 'Missing Socks',
        concept: 'Publication Bias',
        text: "مثل الجوارب في الغسيل - أنت تعرف أن الأزواج دخلت، ولكن النتائج الإيجابية فقط هي التي ظهرت. التجارب السلبية المفقودة هي مثل تلك الجوارب المفردة التي اختفت. تكشف مؤامرة القمع غير المتماثلة عن الفجوة."
      },
      'forest_plot': {
        icon: '⚖️',
        title: 'لجنة تحكيم الدراسات',
        concept: 'Forest Plot',
        text: "كل دراسة عبارة عن هيئة محلفين تصدر حكمًا. بعضها أكثر يقينًا (CI ضيق)، والبعض الآخر أقل. الماس هو إجماع هيئة المحلفين - ولكن إذا اختلف المحلفون بشكل كبير (عدم التجانس)، فهل يجب أن تثق في الحكم المتوسط؟"
      },
      'funnel_plot': {
        icon: '🔦',
        title: 'Flashlight Beam',
        concept: 'Funnel Plot',
        text: "يجب أن يضيء المصباح اليدوي بشكل متساوٍ في جميع الاتجاهات. تشبه الحبكة القمعية غير المتماثلة مصباحًا يدويًا به شيء يحجب جانبًا واحدًا - فأنت لا ترى الصورة الكاملة. الدراسات الصغيرة من جانب واحد مفقودة بشكل مثير للريبة."
      },
      'grade': {
        icon: '🪜',
        title: 'سلم الثقة',
        concept: 'GRADE Certainty',
        text: "يجب الحصول على كل درجة، وليس افتراضها. تبدأ من الأعلى (RCT) أو من الأسفل (الرصدي) ولا يمكنك التحرك إلا مع الأدلة. خطر التحيز يدفعك إلى الأسفل؛ التأثيرات الكبيرة يمكن أن تسحبك للأعلى. لا توجد اختصارات."
      },
      'tau_squared': {
        icon: '📻',
        title: 'Background Static',
        concept: 'τ² (Between-study variance)',
        text: "مثل الكهرباء الساكنة في محطة الراديو - ما مقدار الضوضاء الموجودة في الإشارة؟ انخفاض τ² يعني استقبالًا واضحًا (تتفق الدراسات). يعني ارتفاع τ² التداخل من مصادر غير معروفة - مجموعات سكانية أو تدخلات أو نتائج مختلفة."
      },
      'random_effects': {
        icon: '🎼',
        title: 'Different Orchestras',
        concept: 'نموذج التأثيرات العشوائية',
        text: "التأثيرات الثابتة: نفس الأوركسترا تعزف عدة مرات. التأثيرات العشوائية: فرق أوركسترا مختلفة تعزف نفس المقطوعة. يضيف كل منهم تفسيره. نريد متوسط جميع فرق الأوركسترا الممكنة، وليس هذه فقط."
      },
      'prediction_interval': {
        icon: '🎯',
        title: 'أين سيهبط السهم؟',
        concept: 'Prediction Interval',
        text: "يخبرك CI بمكان المتوسط الحقيقي. يخبرك الفاصل الزمني للتنبؤ بالمكان الذي من المحتمل أن تقع فيه الدراسة التالية. إذا تجاوز مؤشر PI الخاص بك خط اللاتأثير، فقد تقلب دراسة جديدة هذه النتيجة."
      },
      'surrogate': {
        icon: '🗺️',
        title: 'الخريطة مقابل الإقليم',
        concept: 'Surrogate Endpoints',
        text: "تمثل الخريطة (بديلة) المنطقة (النتيجة السريرية). لكن الخريطة يمكن أن تكون خاطئة. كان قمع PVC هو الخريطة. كان معدل الوفيات هو الإقليم. أثبتت CAST أن الخريطة أدت إلى الهاوية."
      },
      'confounding': {
        icon: '☂️',
        title: 'Umbrella & Rain',
        concept: 'Confounding',
        text: "تتنبأ مبيعات المظلات بالمطر. لكن شراء المظلات لا يسبب المطر. يؤثر الإرباك (توقعات الطقس) على كليهما. لم يكن مستخدمو العلاج التعويضي بالهرمونات أكثر صحة بسبب العلاج التعويضي بالهرمونات - لقد كانوا نساء أكثر صحة اخترن العلاج التعويضي بالهرمونات."
      }
    };

    function getAnalogy(conceptKey) {
      return conceptAnalogies[conceptKey] || null;
    }

    function renderAnalogy(conceptKey, containerId) {
      const analogy = getAnalogy(conceptKey);
      if (!analogy) return;

      const container = document.getElementById(containerId);
      if (!container) return;

      container.innerHTML = `
        <div class="analogy-card">
          <div class="analogy-header">
            <span class="analogy-icon">${analogy.icon}</span>
            <span class="analogy-title">${analogy.title}</span>
            <span class="analogy-concept">${analogy.concept}</span>
          </div>
          <div class="analogy-text">"${analogy.text}"</div>
        </div>
      `;
    }

    // ============================================================
    // MISCONCEPTION CHALLENGES (from Evidence Reversal 40)
    // ============================================================

    const misconceptions = [
      // Original 10 - Evidence Reversals
      { id: 1, statement: "إذا انخفض عدم انتظام ضربات القلب، يجب أن يرتفع معدل البقاء على قيد الحياة.", truth: false, story: "CAST", explanation: "قام الإنكاينيد/الفليكاينيد بقمع الـPVC لكن معدل الوفيات تضاعف ثلاث مرات. البدائل يمكن أن تخدع." },
      { id: 2, statement: "الوقاية بالملاحظة تساوي الوقاية السببية.", truth: false, story: "WHI/HRT", explanation: "إن تحيز المستخدم السليم جعل العلاج التعويضي بالهرمونات يبدو وقائيًا. وأظهرت التجارب المعشاة ذات الشواهد الضرر." },
      { id: 3, statement: "الجراحة تثبت نفسها دون سيطرة زائفة.", truth: false, story: "Moseley", explanation: "لم تكن جراحة الركبة بالمنظار أفضل من الجراحة الزائفة. تأثير الدواء الوهمي قوي." },
      { id: 4, statement: "إذا كان الشريان مفتوحًا، فيجب أن تتحسن النتائج.", truth: false, story: "COURAGE", explanation: "PCI لـ CAD المستقر لم يقلل من الوفاة/MI مقابل العلاج الطبي وحده." },
      { id: 5, statement: "انخفاض مستوى الجلوكوز يعني دائمًا نتائج أفضل.", truth: false, story: "NICE-SUGAR", explanation: "أدى التحكم المكثف في الجلوكوز إلى زيادة معدل الوفيات بين مرضى وحدة العناية المركزة." },
      { id: 6, statement: "الإشارة المبكرة الإيجابية كافية لاعتمادها.", truth: false, story: "PROWESS-SHOCK", explanation: "بدا البروتين المنشط C واعدًا حتى أظهرت التجربة النهائية عدم وجود فائدة." },
      { id: 7, statement: "إذا كانت الآلية معقولة، فستتبعها النتائج.", truth: false, story: "MAGIC", explanation: "كان للمغنيسيوم نظرية سليمة مضادة لاضطراب النظم، لكن لم يكن هناك فائدة للوفيات في التجارب الكبيرة." },
      { id: 8, statement: "المزيد من القياسات يعني المزيد من البقاء على قيد الحياة.", truth: false, story: "ESCAPE", explanation: "قدمت قثاطير الشريان الرئوي البيانات ولكن لم يحدث تحسن في نتائج فشل القلب." },
      { id: 9, statement: "يحل حماس الجهاز محل الدليل العشوائي.", truth: false, story: "CORAL", explanation: "لم يكن لدعامات الشريان الكلوي أي فائدة على الرغم من الأساس المنطقي الآلي القوي." },
      { id: 10, statement: "المبادئ التوجيهية دليل على قدم المساواة.", truth: false, story: "IABP-SHOCK", explanation: "كانت المضخة البالونية داخل الأبهر من الدرجة الأولى الموصى بها ولكنها لم تظهر أي فائدة في التجارب المعشاة ذات الشواهد." },
      // More Evidence Reversals
      { id: 11, statement: "إن رفع HDL بالأدوية يضمن عددًا أقل من النوبات القلبية.", truth: false, story: "AIM-HIGH", explanation: "رفع النياسين HDL لكنه لم يقلل من أحداث القلب والأوعية الدموية. كان HDL علامة، وليس سببًا قابلاً للتعديل." },
      { id: 12, statement: "إذا نجحت هذه الطريقة في تجربة تاريخية واحدة، فإنها ستنجح في كل مكان.", truth: false, story: "ProCESS/ARISE/ProMISe", explanation: "نجح EGDT الخاص بشركة Rivers في عام 2001 ولكن فشلت ثلاث تجارب للنسخ المتماثل. وقد تحسنت الرعاية المعتادة، مما أدى إلى تخفيف التأثير." },
      { id: 13, statement: "مضادات الأكسدة تمنع الإصابة بالسرطان لدى المدخنين.", truth: false, story: "ATBC/CARET", explanation: "يزيد بيتا كاروتين من سرطان الرئة لدى المدخنين (RR 1.16-1.28). الآلية لا تضمن الاستفادة." },
      { id: 14, statement: "المزيد من الفحص ينقذ دائمًا المزيد من الأرواح.", truth: false, story: "PLCO", explanation: "وجد فحص المستضد البروستاتي النوعي (PSA) المزيد من السرطانات لكنه لم يقلل معدل الوفيات - بل وجد سرطانات لا تقتل أبدًا." },
      { id: 15, statement: "يؤدي تطبيع الهيموجلوبين إلى تحسين نتائج مرضى الكلى.", truth: false, story: "CHOIR/TREAT", explanation: "أدت الأهداف المرتفعة لـ Hb إلى زيادة السكتة الدماغية والوفاة. أصبح الهدف هو العدو." },
      { id: 16, statement: "الأجهزة الجديدة أكثر أمانًا لأنها جديدة.", truth: false, story: "SAMMPRIS", explanation: "تضاعفت الدعامات داخل الجمجمة ثلاثة أضعاف السكتة الدماغية/الوفاة لمدة 30 يومًا مقابل العلاج الطبي (14.7% مقابل 5.8%)." },
      { id: 17, statement: "إذا انخفض الهوموسيستين، ينخفض خطر الإصابة بأمراض القلب والأوعية الدموية.", truth: false, story: "NORVIT", explanation: "فيتامينات ب خفضت مستوى الهوموسيستين لكنها لم تقلل من الأحداث. مغالطة العلامات الحيوية." },
      { id: 18, statement: "يساعد الأكسجين الروتيني مرضى النوبات القلبية.", truth: false, story: "DETO2X-AMI", explanation: "لم يظهر الأكسجين لدى مرضى احتشاء العضلة القلبية غير المصابين بنقص التأكسج أي فائدة للوفيات. قرن من الممارسة، ولا يوجد دليل." },
      { id: 19, statement: "تعمل التغذية العدوانية المبكرة على تسريع عملية التعافي من وحدة العناية المركزة.", truth: false, story: "EPaNIC", explanation: "أدت التغذية الوريدية المتأخرة إلى خروج أسرع من التغذية المبكرة. التوقيت مهم." },
      { id: 20, statement: "يجب أن تؤدي إزالة الخثرة أثناء PCI إلى تحسين النتائج.", truth: false, story: "TASTE", explanation: "أضاف طموح الخثرة وقتًا إجرائيًا ولكن لا فائدة من الوفيات. منطقي لا يعني ثبت." },
      // Cochrane Methods Misconceptions
      { id: 21, statement: "يعني انخفاض I² أن الدراسات متفقة بدرجة كافية للتجميع.", truth: false, story: "Methods", explanation: "يمكن أن يكون I² منخفضًا مع وجود اختلافات مهمة سريريًا. تكشف فترات التنبؤ عن الانتشار الحقيقي للتأثيرات." },
      { id: 22, statement: "تعني دلالة إحصائية أهمية سريرية.", truth: false, story: "Methods", explanation: "يمكن للتجارب الكبيرة أن تكتشف تأثيرات صغيرة لا معنى لها. حجم التأثير وعرض CI مهمان أكثر من القيم p." },
      { id: 23, statement: "تعد التجارب المعشاة ذات الشواهد دائمًا دليلًا عالي اليقين.", truth: false, story: "GRADE", explanation: "تبدأ التجارب المعشاة ذات الشواهد مرتفعة ولكن يتم تخفيض تصنيفها بسبب التحيز أو عدم الدقة أو عدم المباشرة أو عدم الاتساق أو تحيز النشر." },
      { id: 24, statement: "عدم تناسق مؤامرة القمع يثبت تحيز النشر", truth: false, story: "Methods", explanation: "لعدم التماثل أسباب عديدة: عدم التجانس الحقيقي، وتأثيرات الدراسات الصغيرة، واختلاف المجموعات السكانية. التحقيق مطلوب." },
      { id: 25, statement: "تعمل نماذج التأثيرات العشوائية على إصلاح عدم التجانس.", truth: false, story: "Methods", explanation: "التأثيرات العشوائية تفسر عدم التجانس إحصائيًا ولكنها لا تفسره. لا يزال التحقيق السريري مطلوبا." }
    ];

    function renderMisconceptionChallenge(misconceptionId, containerId) {
      const m = misconceptions.find(x => x.id === misconceptionId);
      if (!m) return;

      const container = document.getElementById(containerId);
      if (!container) return;

      container.innerHTML = `
        <div class="misconception-challenge" id="misconception-${m.id}">
          <div class="misconception-header">
            <span>🤔</span>
            <span>Common Belief Challenge</span>
          </div>
          <div class="misconception-statement">"${m.statement}"</div>
          <div class="misconception-buttons">
            <button class="misconception-btn true-btn" onclick="AnswerMisconception(${m.id}, true)">TRUE</button>
            <button class="misconception-btn false-btn" onclick="AnswerMisconception(${m.id}, false)">FALSE</button>
          </div>
          <div class="misconception-result" id="misconception-result-${m.id}"></div>
        </div>
      `;
    }

    function answerMisconception(id, answer) {
      const m = misconceptions.find(x => x.id === id);
      if (!m) return;

      const isCorrect = answer === m.truth;
      const trueBtn = document.querySelector(`#misconception-${id} .true-btn`);
      const falseBtn = document.querySelector(`#misconception-${id} .false-btn`);
      const resultDiv = document.getElementById(`misconception-result-${id}`);

      // Disable buttons
      trueBtn.disabled = true;
      falseBtn.disabled = true;

      // Show correct/incorrect
      if (m.truth) {
        trueBtn.classList.add('correct');
        if (!answer) falseBtn.classList.add('wrong');
      } else {
        falseBtn.classList.add('correct');
        if (answer) trueBtn.classList.add('wrong');
      }

      // Show result
      resultDiv.className = `misconception-result visible ${isCorrect ? 'correct' : 'incorrect'}`;
      resultDiv.innerHTML = `
        <strong>${isCorrect ? '✓ صحيح!' : '✗ ليس تمامًا.'}</strong>
        This belief is <strong>${m.truth ? 'TRUE' : 'FALSE'}</strong>.
        <br><br>
        <strong>${m.story}:</strong> ${m.explanation}
      `;

      // Award points
      if (isCorrect) {
        awardPoints(20, 'تحدي الفهم الخاطئ صحيح');
      }
      saveProgress();
    }

    // ============================================================
    // PRACTICE PROBLEMS (Addressing Cochrane Gaps)
    // ============================================================

    const practiceProblems = [
      // GRADE Problems
      {
        id: 'grade_1',
        category: 'GRADE',
        title: 'يقين التقييم: تجربة SPRINT',
        scenario: 'أنت بصدد إنشاء دليل إرشادي لارتفاع ضغط الدم. تُظهر تجربة SPRINT (RCT، n=9,361) أن التحكم المكثف في ضغط الدم يقلل من أحداث السيرة الذاتية (HR 0.75، 95% CI 0.64-0.89). ومع ذلك: (1) استبعدت التجربة مرضى السكري، (2) ضغط الدم المكتبي الآلي المستخدم (قراءة أقل بمقدار 10 مم زئبق تقريبًا من القراءة اليدوية)، (3) تضمنت نقطة النهاية المركبة فشل القلب.',
        question: 'ما هو تصنيف درجة اليقين المناسب لسكان عيادتك والذي يتضمن مرضى السكر ويستخدم ضغط الدم اليدوي؟',
        options: [
          { id: 'a', text: 'مرتفع - كان SPRINT عبارة عن تجربة عشوائية عشوائية كبيرة وجيدة التنفيذ', correct: false },
          { id: 'b', text: 'متوسط - خفض مستوى واحد بسبب عدم المباشرة (يختلف عدد السكان)', correct: true },
          { id: 'c', text: 'منخفض - خفض مستويين لعدم المباشرة وعدم الدقة', correct: false },
          { id: 'd', text: 'منخفض جدًا - مخاوف خطيرة متعددة', correct: false }
        ],
        explanation: 'خفض مستوى واحد بسبب عدم المباشرة الخطيرة: (1) السكان يستبعدون مرضى السكر (أظهر ACCORD ضررًا في مرضى السكر مع التحكم المكثف)، (2) طريقة قياس ضغط الدم يختلف (تطبيق أهداف SPRINT باستخدام BP اليدوي قد يكون مبالغًا فيه). كانت جودة التجربة جيدة، لكن النتائج لا تنطبق بشكل مباشر على سكانك.',
        principle: 6
      },
      {
        id: 'grade_2',
        category: 'GRADE',
        title: 'عندما تتفوق المراقبة على التجارب المعشاة ذات الشواهد',
        scenario: 'للحصول على تأثير ضار نادر (التسمم الكبدي بدواء جديد)، لديك: (1) تجارب معشاة ذات شواهد تظهر 0/2000 حدث في العلاج مقابل 0/2000 في السيطرة، (2) قاعدة بيانات كبيرة لليقظة الدوائية تعرض 45 حالة في 500000 مستخدم (9/100000).',
        question: 'ما الذي يوفر يقينًا أعلى لإشارة الأمان هذه؟',
        options: [
          { id: 'a', text: 'التجارب المعشاة ذات الشواهد - إنها المعيار الذهبي', correct: false },
          { id: 'b', text: 'بيانات المراقبة - لديها القدرة على اكتشاف الأحداث النادرة', correct: true },
          { id: 'c', text: 'لا - أنت بحاجة إلى المزيد من بيانات RCT', correct: false },
          { id: 'd', text: 'اجمعها في التحليل التلوي', correct: false }
        ],
        explanation: 'إن التجارب المعشاة ذات الشواهد ضعيفة القوة بالنسبة للأحداث النادرة. مع 2000 مريض، ستحتاج إلى خطر أكبر من 1/500 لاكتشاف حدث واحد. توفر بيانات الرصد، على الرغم من المخاطر المربكة، الدليل الوحيد على وجود إشارة حقيقية. يمكن لـ GRADE تقييم بيانات المراقبة عندما يكون التأثير كبيرًا أو عندما تكون هناك استجابة للجرعة.',
        principle: 5
      },
      // Prediction Interval Problems
      {
        id: 'pi_1',
        category: 'Prediction Intervals',
        title: 'Beyond I-squared',
        scenario: 'يظهر التحليل التلوي لـ 8 تجارب: RR المجمعة = 0.80 (95% CI 0.72-0.89)، I² = 65%، τ² = 0.04. فترة التنبؤ 95% هي 0.55-1.16.',
        question: 'إذا قمت بإجراء تجربة جديدة على مجموعة سكانية مماثلة، ما هو نطاق التأثيرات المعقولة؟',
        options: [
          { id: 'a', text: '0.72-0.89 (فاصل الثقة)', correct: false },
          { id: 'b', text: '0.55-1.16 (فاصل التنبؤ)', correct: true },
          { id: 'c', text: 'حوالي 0.80 (النقطة) تقدير)', correct: false },
          { id: 'd', text: 'لا يمكن التنبؤ من هذه البيانات', correct: false }
        ],
        explanation: 'يُظهر الفاصل الزمني للتنبؤ (0.55-1.16) نطاق التأثيرات الحقيقية في إعدادات مختلفة. يتضمن 1.0، مما يعني أن التجربة الجديدة قد تظهر ضررًا على الرغم من أن التقدير المجمع يظهر فائدة. يخبرك I² بوجود عدم تجانس؛ تخبرك فترات التنبؤ بما يعنيه بالنسبة للمريض/الإعداد التالي.',
        principle: 4
      },
      {
        id: 'pi_2',
        category: 'Prediction Intervals',
        title: 'Clinical Interpretation',
        scenario: 'أنت تقدم المشورة لزميل بشأن تنفيذ التدخل. يظهر التحليل التلوي: RR = 0.70 (95% CI 0.60-0.82)، I² = 45% (معتدل)، فاصل التنبؤ 95% = 0.50-0.98.',
        question: 'ماذا تخبر زميلك؟',
        options: [
          { id: 'a', text: 'دليل قوي على الفائدة - التنفيذ بثقة', correct: false },
          { id: 'b', text: 'من المحتمل أن يكون مفيدًا ولكن قد يختلف حجم التأثير بشكل كبير من خلال تحديد', correct: true },
          { id: 'c', text: 'قدر كبير من عدم التجانس لاستخلاص النتائج', correct: false },
          { id: 'd', text: 'انتظر المزيد من التجارب لتقليل عدم اليقين', correct: false }
        ],
        explanation: 'يظل الفاصل الزمني للتنبؤ (0.50-0.98) أقل من 1.0، مما يشير إلى احتمالية الاستفادة في معظم الإعدادات، على الرغم من اختلاف الحجم (تخفيض بنسبة 30-50%). وهذا أكثر إفادة من مجرد الإبلاغ عن "عدم التجانس المعتدل". من المحتمل أن يساعد العلاج، لكن مقدار العلاج يعتمد على العوامل المحلية.',
        principle: 4
      },
      // Risk of Bias Problems
      {
        id: 'rob_1',
        category: 'خطر التحيز',
        title: 'أعلام حمراء بأثر رجعي',
        scenario: 'مراجعة تجربة التدخل الجراحي: (1) كان المرضى يعرفون تخصيصاتهم، (2) الجراحون بوضوح لا يمكن التعمية، (3) وكانت النتيجة الأولية هي "الألم الذي أبلغ عنه المريض بعد 6 أشهر"، (4) فقد 15% من المتابعة، وهو أمر مماثل بين المجموعات.',
        question: 'ما هو الخطر الرئيسي للقلق بشأن التحيز؟',
        options: [
          { id: 'a', text: 'تحيز الاختيار - ربما تم تخريب التوزيع العشوائي', correct: false },
          { id: 'b', text: 'تحيز الأداء - لم يُعمي الجراحون', correct: false },
          { id: 'c', text: 'تحيز الكشف - عرف المرضى التخصيص وأبلغوا عن نتائج ذاتية', correct: true },
          { id: 'd', text: 'تحيز الاستنزاف - فقد 15% للمتابعة', correct: false }
        ],
        explanation: 'مع إبلاغ المرضى غير المكفوفين عن نتائج موضوعية، يعد تحيز الكشف أمرًا بالغ الأهمية. المرضى الذين يعرفون أنهم خضعوا للجراحة "الحقيقية" غالبًا ما يبلغون عن المزيد من التحسن (تأثير الدواء الوهمي). وهذا هو بالضبط سبب استخدام أوربيتا لعملية جراحية زائفة - لفصل العلاج الوهمي عن تأثير العلاج الحقيقي. أما نسبة الاستنزاف البالغة 15%، المتوازنة بين المجموعات، فهي أقل إثارة للقلق.',
        principle: 1
      },
      {
        id: 'rob_2',
        category: 'خطر التحيز',
        title: 'إشارات التخفيض',
        scenario: 'عند مراجعة التجارب التي أجراها باحث غزير الإنتاج، تلاحظ: (1) معدلات الأحداث متوازنة تمامًا بين المجموعات، (2) I² = 0% عندما يتم تجميع تجاربه بمفرده (لكن 70% عند دمجها مع تجارب أخرى)، (3) التأثيرات أكبر باستمرار من تجارب الباحثين الآخرين، (4) غير قادر على التحقق من بيانات المصدر.',
        question: 'ماذا يجب أن تفعل؟',
        options: [
          { id: 'a', text: 'قم بتضمين التجارب - من المرغوب فيه عدم التجانس المنخفض', correct: false },
          { id: 'b', text: 'قم بإجراء تحليل الحساسية باستثناء تجاربه', correct: false },
          { id: 'c', text: 'اطلب التحقق من بيانات المصدر قبل التضمين', correct: true },
          { id: 'd', text: 'قم بالإبلاغ عن المخاوف ولكن قم بتضمينها على أي حال', correct: false }
        ],
        explanation: 'هذه إشارات تلفيق كلاسيكية (من قضية الاحتيال DECREASE). البيانات "المثالية" هي علامة حمراء - البيانات البيولوجية الحقيقية فوضوية. المسار المقبول الوحيد هو التحقق من بيانات المصدر. لقد أثر احتيال دون بولدرمانز على المبادئ التوجيهية لسنوات؛ ربما تضرر 800 ألف مريض. الأرقام بدون مصدر ليست أرقامًا.',
        principle: 3
      },
      // Publication Bias Problems
      {
        id: 'pb_1',
        category: 'Publication Bias',
        title: 'Asymmetric Funnel',
        scenario: 'يوضح المخطط القمعي الخاص بك: التجارب الكبيرة تتجمع حول RR=1.0، والتجارب الصغيرة تتجمع حول RR=0.6 (كلها على جانب "المنفعة"). اختبار إيجر ع = 0.01.',
        question: 'ما هو التفسير الأرجح؟',
        options: [
          { id: 'a', text: 'تحيز النشر - لم يتم نشر التجارب السلبية الصغيرة', correct: false },
          { id: 'b', text: 'تأثيرات الدراسات الصغيرة - يمكن أن تكون تحيز النشر أو عدم التجانس الحقيقي', correct: true },
          { id: 'c', text: 'وجدت التجارب الصغيرة التأثير الحقيقي؛ تم تخفيف التجارب الكبيرة', correct: false },
          { id: 'd', text: 'تباين عشوائي - من المتوقع عدم التماثل', correct: false }
        ],
        explanation: 'عدم تناسق المسار له أسباب متعددة: (1) تحيز النشر، (2) عدم التجانس الحقيقي (تجارب صغيرة في مجموعات سكانية مختلفة)، (3) اختلافات منهجية (تجارب صغيرة أقل صرامة)، (4) الصدفة. لا يمكنك استنتاج "تحيز النشر" من عدم التماثل وحده. مطلوب التحقيق في السبب.',
        principle: 2
      },
      {
        id: 'pb_2',
        category: 'Publication Bias',
        title: 'التجارب المفقودة',
        scenario: 'أنت تقوم بتحليل تلوي لمضاد للاكتئاب. يعرض موقع ClinicalTrials.gov 12 تجربة مسجلة؛ لقد وجدت 8 منشورات. تم الانتهاء من التجارب الأربع المفقودة منذ أكثر من 3 سنوات.',
        question: 'ماذا تفعل؟',
        options: [
          { id: 'a', text: 'استمر في إجراء التجارب الثمانية المنشورة - هذا هو المعيار الممارسة', correct: false },
          { id: 'b', text: 'اتصل بالرعاة/المؤلفين وقدم طلبات قانون حرية المعلومات للبيانات غير المنشورة', correct: true },
          { id: 'c', text: 'لاحظ القيد في قسم المناقشة', correct: false },
          { id: 'd', text: 'استخدم القطع والتعبئة لضبط التجارب المفقودة', correct: false }
        ],
        explanation: 'وجدت إدارة الغذاء والدواء الأمريكية أن 94% من التجارب المنشورة كانت التجارب المضادة للاكتئاب إيجابية، مقابل 51% من جميع التجارب المقدمة إلى إدارة الغذاء والدواء. يجب أن تحاول الحصول على البيانات المفقودة - وهذا ليس اختياريًا. إن "ملاحظة القيد" دون محاولة إصلاحه هو إهمال منهجي.',
        principle: 2
      }
    ];

    function renderPracticeProblem(problemId, containerId) {
      const problem = practiceProblems.find(p => p.id === problemId);
      if (!problem) return;

      const container = document.getElementById(containerId);
      if (!container) return;

      container.innerHTML = `
        <div class="practice-problem" id="مشكلة-${problem.id}">
          <div class="practice-header">
            <span class="practice-category">${problem.category}</span>
            <span class="practice-title">${problem.title}</span>
          </div>
          <div class="practice-scenario">${problem.scenario}</div>
          <div class="practice-question"><strong>${problem.question}</strong></div>
          <div class="practice-options">
            ${problem.options.map(opt => `
              <button class="practice-option" onclick="AnswerPracticeProblem('${problem.id}', '${opt.id}')">
                <span class="option-letter">${opt.id.toUpperCase()}</span>
                <span class="option-text">${opt.text}</span>
              </button>
            `).join('')}
          </div>
          <div class="practice-feedback" id="ردود الفعل-${problem.id}"></div>
        </div>
      `;
    }

    function answerPracticeProblem(problemId, answerId) {
      const problem = practiceProblems.find(p => p.id === problemId);
      if (!problem) return;

      const selectedOption = problem.options.find(o => o.id === answerId);
      const correctOption = problem.options.find(o => o.correct);
      const isCorrect = selectedOption.correct;

      // Disable all buttons and show correct/incorrect
      const buttons = document.querySelectorAll(`#problem-${problemId} .practice-option`);
      buttons.forEach(btn => {
        btn.disabled = true;
        const letter = btn.querySelector('.option-letter').textContent.toLowerCase();
        if (letter === correctOption.id) {
          btn.classList.add('correct');
        } else if (letter === answerId) {
          btn.classList.add('incorrect');
        }
      });

      // Show feedback
      const feedbackDiv = document.getElementById(`feedback-${problemId}`);
      feedbackDiv.className = `practice-feedback visible ${isCorrect ? 'correct' : 'incorrect'}`;
      feedbackDiv.innerHTML = `
        <strong>${isCorrect ? '✓ صحيح!' : '✗ ليس تمامًا.'}</strong>
        <p>${problem.explanation}</p>
        <p class="principle-link"><em>Principle ${problem.principle + 1}: ${sevenPrinciples[problem.principle]?.text || ''}</em></p>
      `;

      // Award points
      if (isCorrect) {
        awardPoints(25, 'تمرين على المشكلة بشكل صحيح');
      } else {
        awardPoints(5, 'محاولة تمرين على المشكلة');
      }
      saveProgress();
    }

    // ============================================================
    // INVESTIGATION EXERCISES
    // ============================================================

    function revealAnswer(elementId) {
      const el = document.getElementById(elementId);
      if (el) {
        el.classList.add('visible');
        // Scroll into view
        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function generateMiniForest(containerId, studies, pooled, showAfter = false) {
      const container = document.getElementById(containerId);
      if (!container) return;

      const minE = Math.min(...studies.map(s => s.lo), pooled.lo, 0.3);
      const maxE = Math.max(...studies.map(s => s.hi), pooled.hi, 3);
      const range = maxE - minE;
      const scale = (v) => ((v - minE) / range) * 240 + 30;
      const height = (studies.length + 1) * 24 + 30;

      container.innerHTML = `
        <svg viewBox="0 0 320 ${height}" style="width: 100%; height: ${height}px; font-family: sans-serif;">
          <line x1="${scale(1)}" y1="5" x2="${scale(1)}" y2="${height - 15}" stroke="#999" stroke-width="1" stroke-dasharray="3"/>
          ${studies.map((s, i) => {
            const y = 18 + i * 24;
            const color = showAfter && s.excluded ? '#ccc' : '#1E2761';
            return `
              <text x="2" y="${y + 3}" font-size="9" fill="${color}" ${s.excluded ? 'text-decoration="line-through"' : ''}>${s.name}</text>
              <line x1="${scale(s.lo)}" y1="${y}" x2="${scale(s.hi)}" y2="${y}" stroke="${color}" stroke-width="1.5"/>
              <rect x="${scale(s.effect) - 4}" y="${y - 4}" width="8" height="8" fill="${color}"/>
              <text x="280" y="${y + 3}" font-size="8" fill="${color}">${s.effect.toFixed(2)}</text>
            `;
          }).join('')}
          <polygon points="${scale(pooled.effect)},${height - 20} ${scale(pooled.lo)},${height - 13} ${scale(pooled.effect)},${height - 6} ${scale(pooled.hi)},${height - 13}" fill="${showAfter ? '#C53030' : '#D4AF37'}"/>
          <text x="2" y="${height - 10}" font-size="9" font-weight="bold" fill="${showAfter ? '#C53030' : '#1E2761'}">Pooled</text>
          <text x="280" y="${height - 10}" font-size="8" font-weight="bold">${pooled.effect.toFixed(2)}</text>
          <text x="${scale(0.5)}" y="${height}" font-size="7" fill="#666">Favors Tx</text>
          <text x="${scale(2)}" y="${height}" font-size="7" fill="#666">Favors Ctrl</text>
        </svg>
      `;
    }

    // CAST Investigation Data
    const castStudiesPublished = [
      { name: 'Obs Study 1', effect: 0.45, lo: 0.28, hi: 0.72 },
      { name: 'Obs Study 2', effect: 0.52, lo: 0.35, hi: 0.77 },
      { name: 'Obs Study 3', effect: 0.38, lo: 0.22, hi: 0.65 },
    ];
    const castPooledBefore = { effect: 0.45, lo: 0.33, hi: 0.61 };
    const castPooledAfter = { effect: 2.50, lo: 1.60, hi: 4.50 };

    // Rosiglitazone data (real from Nissen 2007)
    const rosiStudies = [
      { name: 'ADOPT', effect: 1.25, lo: 0.78, hi: 2.01 },
      { name: 'DREAM', effect: 1.36, lo: 0.68, hi: 2.71 },
      { name: 'Trial 49653/020', effect: 1.81, lo: 0.59, hi: 5.55 },
      { name: 'Trial 49653/024', effect: 2.67, lo: 0.50, hi: 14.3 },
      { name: 'Trial 49653/093', effect: 1.50, lo: 0.25, hi: 8.98 },
    ];
    const rosiPooled = { effect: 1.43, lo: 1.03, hi: 1.98 };

    // DECREASE data (before/after fraud removal)
    const decreaseStudies = [
      { name: 'DECREASE-I', effect: 0.09, lo: 0.02, hi: 0.37, excluded: true },
      { name: 'DECREASE-IV', effect: 0.65, lo: 0.24, hi: 1.74, excluded: true },
      { name: 'POISE', effect: 1.33, lo: 1.03, hi: 1.74 },
      { name: 'DIPOM', effect: 1.11, lo: 0.66, hi: 1.87 },
      { name: 'MaVS', effect: 0.92, lo: 0.46, hi: 1.84 },
    ];
    const decreasePooledBefore = { effect: 0.56, lo: 0.35, hi: 0.89 };
    const decreasePooledAfter = { effect: 1.27, lo: 1.01, hi: 1.60 };

    // Magnesium ISIS-4 data
    const magnesiumSmallTrials = [
      { name: 'Rasmussen', effect: 0.23, lo: 0.05, hi: 1.01 },
      { name: 'Smith', effect: 0.31, lo: 0.09, hi: 1.10 },
      { name: 'Ceremuzynski', effect: 0.48, lo: 0.17, hi: 1.34 },
      { name: 'Schechter 1', effect: 0.52, lo: 0.20, hi: 1.35 },
      { name: 'Schechter 2', effect: 0.35, lo: 0.13, hi: 0.94 },
    ];
    const magPooledSmall = { effect: 0.44, lo: 0.27, hi: 0.71 };
    const isis4Result = { effect: 1.06, lo: 0.99, hi: 1.13 };

    // Complete magnesium trial data with sample sizes for visualization
    const magnesiumTrialsComplete = [
      { name: 'Morton 1984', n: 40, effect: 0.10, lo: 0.01, hi: 0.87, se: 0.55 },
      { name: 'Rasmussen 1986', n: 273, effect: 0.35, lo: 0.13, hi: 0.94, se: 0.25 },
      { name: 'Smith 1986', n: 400, effect: 0.48, lo: 0.21, hi: 1.09, se: 0.21 },
      { name: 'Abraham 1987', n: 94, effect: 0.87, lo: 0.33, hi: 2.30, se: 0.35 },
      { name: 'Shechter 1990', n: 103, effect: 0.27, lo: 0.08, hi: 0.95, se: 0.42 },
      { name: 'Ceremuzynski 1989', n: 48, effect: 0.22, lo: 0.03, hi: 1.50, se: 0.68 },
      { name: 'LIMIT-2', n: 2316, effect: 0.74, lo: 0.57, hi: 0.97, se: 0.09 },
    ];
    const isis4Complete = { name: 'ISIS-4', n: 58050, effect: 1.06, lo: 0.99, hi: 1.13, se: 0.025 };

    function drawMagnesiumForest(mode) {
      const containerId = mode === 'small' ? 'magnesium-forest-small' : 'magnesium-forest-full';
      const container = document.getElementById(containerId);
      if (!container) return;

      let trials = [...magnesiumTrialsComplete];
      let pooled = { effect: 0.44, lo: 0.27, hi: 0.71, label: 'مجمعة (تجارب صغيرة)' };

      if (mode === 'full') {
        trials.push(isis4Complete);
        pooled = { effect: 1.02, lo: 0.95, hi: 1.09, label: 'مجمعة (الكل) التجارب)' };
      }

      const width = 800;
      const height = trials.length * 35 + 100;
      const margin = { left: 150, right: 50, top: 30, bottom: 50 };
      const plotWidth = width - margin.left - margin.right;

      // Log scale for OR
      const minLog = Math.log(0.05);
      const maxLog = Math.log(3);
      const xScale = (logVal) => margin.left + ((logVal - minLog) / (maxLog - minLog)) * plotWidth;

      let svg = `<svg viewBox="0 0 ${width} ${height}" style="أقصى عرض: 100%؛ الارتفاع: تلقائي؛">`;

      // Title
      svg += `<text x="${width/2}" y="20" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#1a365d">
        Forest Plot: Magnesium in MI${mode === 'full' ? '(مع إيزيس-4)' : '(تجارب صغيرة فقط)'}
      </text>`;

      // Grid lines and axis
      const ticks = [0.1, 0.25, 0.5, 1.0, 2.0];
      ticks.forEach(tick => {
        const x = xScale(Math.log(tick));
        svg += `<line x1="${x}" y1="${margin.top}" x2="${x}" y2="${الارتفاع - هامش.أسفل}" stroke="#e2e8f0" stroke-width="1"/>`;
        svg += `<text x="${x}" y="${height - هامش.bottom + 15}" text-anchor="middle" font-size="11" fill="#64748b">${tick}</text>`;
      });

      // Null line
      const nullX = xScale(0);
      svg += `<line x1="${nullX}" y1="${margin.top}" x2="${nullX}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="2"/>`;

      // Studies
      trials.forEach((trial, i) => {
        const y = margin.top + 20 + i * 35;
        const x = xScale(Math.log(trial.effect));
        const xLo = xScale(Math.log(Math.max(0.05, trial.lo)));
        const xHi = xScale(Math.log(Math.min(3, trial.hi)));

        // Weight based on sample size
        const weight = Math.sqrt(trial.n) / Math.sqrt(isis4Complete.n) * 10;
        const boxSize = Math.max(4, Math.min(12, weight + 4));

        const color = trial.name === 'ISIS-4' ? '#C53030' : (trial.effect < 1 ? '#22c55e' : '#64748b');

        // Label
        svg += `<text x="${margin.left - 10}" y="${y + 4}" text-anchor="end" font-size="11" fill="#1a365d">${trial.name} (n=${trial.n.toLocaleString()})</text>`;

        // CI line
        svg += `<line x1="${xLo}" y1="${y}" x2="${xHi}" y2="${y}" stroke="${color}" stroke-width="2"/>`;

        // Effect point
        svg += `<rect x="${x - boxSize/2}" y="${y - boxSize/2}" width="${boxSize}" height="${boxSize}" fill="${color}"/>`;

        // CI caps
        svg += `<line x1="${xLo}" y1="${y - 4}" x2="${xLo}" y2="${y + 4}" stroke="${color}" stroke-width="1"/>`;
        svg += `<line x1="${xHi}" y1="${y - 4}" x2="${xHi}" y2="${y + 4}" stroke="${color}" stroke-width="1"/>`;
      });

      // Pooled diamond
      const poolY = height - margin.bottom - 20;
      const poolX = xScale(Math.log(pooled.effect));
      const poolXLo = xScale(Math.log(pooled.lo));
      const poolXHi = xScale(Math.log(pooled.hi));
      const diamondColor = pooled.effect < 1 ? '#22c55e' : '#C53030';

      svg += `<polygon points="${poolXLo},${poolY} ${poolX},${poolY - 8} ${poolXHi},${poolY} ${poolX},${poolY + 8}" fill="${diamondColor}" stroke="${diamondColor}"/>`;
      svg += `<text x="${margin.left - 10}" y="${poolY + 4}" text-anchor="end" font-size="11" font-weight="bold" fill="#1a365d">${pooled.label}</text>`;

      // Axis label
      svg += `<text x="${width/2}" y="${height - 5}" text-anchor="middle" font-size="12" fill="#1a365d">Odds Ratio (log scale)</text>`;

      // Favors labels
      svg += `<text x="${xScale(Math.log(0.2))}" y="${الارتفاع - هامش.أسفل + 30}" text-anchor="middle" font-size="10" fill="#22c55e">← Favors Magnesium</text>`;
      svg += `<text x="${xScale(Math.log(2))}" y="${الارتفاع - هامش.أسفل + 30}" text-anchor="middle" font-size="10" fill="#C53030">Favors Placebo →</text>`;

      svg += '</svg>';
      container.innerHTML = svg;
    }

    function drawMagnesiumFunnel(mode) {
      const container = document.getElementById('magnesium-funnel-small');
      if (!container) return;

      const trials = magnesiumTrialsComplete;
      const width = 600;
      const height = 400;
      const margin = { left: 80, right: 40, top: 40, bottom: 60 };
      const plotWidth = width - margin.left - margin.right;
      const plotHeight = height - margin.top - margin.bottom;

      // Pooled effect (log scale)
      const pooledLog = Math.log(0.44);

      // X axis: log(OR)
      const minLogOR = -2.5;
      const maxLogOR = 1;
      const xScale = (logOR) => margin.left + ((logOR - minLogOR) / (maxLogOR - minLogOR)) * plotWidth;

      // Y axis: SE (inverted - high precision at top)
      const maxSE = 0.75;
      const yScale = (se) => margin.top + (se / maxSE) * plotHeight;

      let svg = `<svg viewBox="0 0 ${width} ${height}" style="أقصى عرض: 100%؛ الارتفاع: تلقائي؛">`;

      // Title
      svg += `<text x="${width/2}" y="20" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#1a365d">
        Funnel Plot: Magnesium in MI (small trials)
      </text>`;

      // Funnel shape (95% CI bounds)
      const funnelPoints = [];
      for (let se = 0; se <= maxSE; se += 0.01) {
        const ciWidth = 1.96 * se;
        const xLeft = xScale(pooledLog - ciWidth);
        const xRight = xScale(pooledLog + ciWidth);
        const y = yScale(se);
        funnelPoints.push({ xLeft, xRight, y });
      }

      // Draw funnel
      let leftPath = `M ${xScale(pooledLog)} ${yScale(0)}`;
      let rightPath = `M ${xScale(pooledLog)} ${yScale(0)}`;
      funnelPoints.forEach(p => {
        leftPath += ` L ${p.xLeft} ${p.y}`;
        rightPath += ` L ${p.xRight} ${p.y}`;
      });
      svg += `<path d="${leftPath}" fill="none" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="4"/>`;
      svg += `<path d="${rightPath}" fill="none" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="4"/>`;

      // Vertical line at pooled effect
      svg += `<line x1="${xScale(pooledLog)}" y1="${margin.top}" x2="${xScale(pooledLog)}" y2="${الارتفاع - هامش.أسفل}" stroke="#22c55e" stroke-width="2" stroke-dasharray="4"/>`;

      // Null line at OR = 1
      svg += `<line x1="${xScale(0)}" y1="${margin.top}" x2="${xScale(0)}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="2"/>`;

      // Plot studies
      trials.forEach(trial => {
        const x = xScale(Math.log(trial.effect));
        const y = yScale(trial.se);
        const color = trial.effect < 1 ? '#22c55e' : '#64748b';
        svg += `<circle cx="${x}" cy="${y}" r="6" fill="${color}" stroke="#fff" stroke-width="1"/>`;
        svg += `<text x="${x + 8}" y="${y + 3}" font-size="9" fill="#1a365d">${trial.name}</text>`;
      });

      // Axes
      svg += `<line x1="${margin.left}" y1="${الارتفاع - هامش.أسفل}" x2="${العرض - الهامش. اليمين}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="1"/>`;
      svg += `<line x1="${margin.left}" y1="${margin.top}" x2="${margin.left}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="1"/>`;

      // X axis ticks
      [-2, -1, 0, 0.5].forEach(logOR => {
        const x = xScale(logOR);
        const or = Math.exp(logOR).toFixed(2);
        svg += `<line x1="${x}" y1="${الارتفاع - هامش.أسفل}" x2="${x}" y2="${الارتفاع - هامش.أسفل + 5}" stroke="#1a365d"/>`;
        svg += `<text x="${x}" y="${الارتفاع - هامش.أسفل + 18}" text-anchor="middle" font-size="10" fill="#1a365d">${or}</text>`;
      });

      // Y axis ticks
      [0, 0.25, 0.5, 0.75].forEach(se => {
        const y = yScale(se);
        svg += `<line x1="${margin.left - 5}" y1="${y}" x2="${margin.left}" y2="${y}" stroke="#1a365d"/>`;
        svg += `<text x="${margin.left - 10}" y="${y + 3}" text-anchor="end" font-size="10" fill="#1a365d">${se.toFixed(2)}</text>`;
      });

      // Axis labels
      svg += `<text x="${width/2}" y="${height - 10}" text-anchor="middle" font-size="12" fill="#1a365d">Odds Ratio</text>`;
      svg += `<text x="15" y="${height/2}" text-anchor="middle" transform="rotate(-90, 15, ${height/2})" font-size="12" fill="#1a365d">Standard Error</text>`;

      // Annotations
      svg += `<text x="${xScale(-1.5)}" y="${الارتفاع - هامش.أسفل + 40}" text-anchor="middle" font-size="10" fill="#f59e0b" font-weight="bold">
        ⚠️ Asymmetric: Small trials cluster left
      </text>`;

      svg += '</svg>';
      container.innerHTML = svg;

      // Show interpretation
      document.getElementById('mag-funnel-interpretation').style.display = 'block';
    }

    // Reboxetine funnel plot data (published trials only - showing bias)
    function drawReboxetineFunnel() {
      const container = document.getElementById('reboxetine-funnel');
      if (!container) return;

      // Published trials (all showing benefit - biased)
      const publishedTrials = [
        { name: 'Trial 1', smd: 0.72, se: 0.18 },
        { name: 'Trial 2', smd: 0.58, se: 0.22 },
        { name: 'Trial 3', smd: 0.45, se: 0.20 },
        { name: 'Trial 4', smd: 0.61, se: 0.25 },
        { name: 'Trial 5', smd: 0.52, se: 0.19 },
        { name: 'Trial 6', smd: 0.68, se: 0.28 },
        { name: 'Trial 7', smd: 0.41, se: 0.16 },
      ];

      // Where the missing trials likely were (shown as ghost points)
      const missingTrials = [
        { name: 'Hidden 1', smd: -0.12, se: 0.22 },
        { name: 'Hidden 2', smd: 0.05, se: 0.19 },
        { name: 'Hidden 3', smd: -0.08, se: 0.25 },
        { name: 'Hidden 4', smd: 0.11, se: 0.20 },
        { name: 'Hidden 5', smd: -0.15, se: 0.28 },
      ];

      const width = 600;
      const height = 400;
      const margin = { left: 80, right: 40, top: 40, bottom: 60 };
      const plotWidth = width - margin.left - margin.right;
      const plotHeight = height - margin.top - margin.bottom;

      // Pooled effect (published)
      const pooledSMD = 0.56;

      // X axis: SMD
      const minSMD = -0.5;
      const maxSMD = 1.0;
      const xScale = (smd) => margin.left + ((smd - minSMD) / (maxSMD - minSMD)) * plotWidth;

      // Y axis: SE (inverted)
      const maxSE = 0.35;
      const yScale = (se) => margin.top + (se / maxSE) * plotHeight;

      let svg = `<svg viewBox="0 0 ${width} ${height}" style="أقصى عرض: 100%؛ الارتفاع: تلقائي؛">`;

      // Title
      svg += `<text x="${width/2}" y="20" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#1a365d">
        Funnel Plot: Reboxetine vs Placebo (Published Only)
      </text>`;

      // Funnel shape
      const funnelPoints = [];
      for (let se = 0.01; se <= maxSE; se += 0.01) {
        const ciWidth = 1.96 * se;
        const xLeft = xScale(pooledSMD - ciWidth);
        const xRight = xScale(pooledSMD + ciWidth);
        const y = yScale(se);
        funnelPoints.push({ xLeft, xRight, y });
      }

      let leftPath = `M ${xScale(pooledSMD)} ${yScale(0.01)}`;
      let rightPath = `M ${xScale(pooledSMD)} ${yScale(0.01)}`;
      funnelPoints.forEach(p => {
        leftPath += ` L ${p.xLeft} ${p.y}`;
        rightPath += ` L ${p.xRight} ${p.y}`;
      });
      svg += `<path d="${leftPath}" fill="none" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="4"/>`;
      svg += `<path d="${rightPath}" fill="none" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="4"/>`;

      // Pooled effect line
      svg += `<line x1="${xScale(pooledSMD)}" y1="${margin.top}" x2="${xScale(pooledSMD)}" y2="${الارتفاع - هامش.أسفل}" stroke="#22c55e" stroke-width="2" stroke-dasharray="4"/>`;

      // Null line at SMD = 0
      svg += `<line x1="${xScale(0)}" y1="${margin.top}" x2="${xScale(0)}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="2"/>`;

      // Plot missing trials (ghost points)
      missingTrials.forEach(trial => {
        const x = xScale(trial.smd);
        const y = yScale(trial.se);
        svg += `<circle cx="${x}" cy="${y}" r="8" fill="none" stroke="#C53030" stroke-width="2" stroke-dasharray="3"/>`;
      });

      // Plot published trials
      publishedTrials.forEach(trial => {
        const x = xScale(trial.smd);
        const y = yScale(trial.se);
        svg += `<circle cx="${x}" cy="${y}" r="6" fill="#22c55e" stroke="#fff" stroke-width="1"/>`;
      });

      // Axes
      svg += `<line x1="${margin.left}" y1="${الارتفاع - هامش.أسفل}" x2="${العرض - الهامش. اليمين}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="1"/>`;
      svg += `<line x1="${margin.left}" y1="${margin.top}" x2="${margin.left}" y2="${الارتفاع - هامش.أسفل}" stroke="#1a365d" stroke-width="1"/>`;

      // X axis ticks
      [-0.4, -0.2, 0, 0.2, 0.4, 0.6, 0.8].forEach(smd => {
        const x = xScale(smd);
        svg += `<line x1="${x}" y1="${الارتفاع - هامش.أسفل}" x2="${x}" y2="${الارتفاع - هامش.أسفل + 5}" stroke="#1a365d"/>`;
        svg += `<text x="${x}" y="${الارتفاع - هامش.أسفل + 18}" text-anchor="middle" font-size="10" fill="#1a365d">${smd.toFixed(1)}</text>`;
      });

      // Y axis ticks
      [0.05, 0.15, 0.25, 0.35].forEach(se => {
        const y = yScale(se);
        svg += `<line x1="${margin.left - 5}" y1="${y}" x2="${margin.left}" y2="${y}" stroke="#1a365d"/>`;
        svg += `<text x="${margin.left - 10}" y="${y + 3}" text-anchor="end" font-size="10" fill="#1a365d">${se.toFixed(2)}</text>`;
      });

      // Axis labels
      svg += `<text x="${width/2}" y="${height - 10}" text-anchor="middle" font-size="12" fill="#1a365d">Standardized Mean Difference</text>`;
      svg += `<text x="15" y="${height/2}" text-anchor="middle" transform="rotate(-90, 15, ${height/2})" font-size="12" fill="#1a365d">Standard Error</text>`;

      // Legend
      svg += `<circle cx="${width - 120}" cy="${margin.top + 10}" r="5" fill="#22c55e"/>`;
      svg += `<text x="${width - 110}" y="${margin.top + 14}" font-size="10" fill="#1a365d">Published</text>`;
      svg += `<circle cx="${width - 120}" cy="${margin.top + 28}" r="6" fill="none" stroke="#C53030" stroke-width="2" stroke-dasharray="3"/>`;
      svg += `<text x="${width - 110}" y="${margin.top + 32}" font-size="10" fill="#C53030">Missing?</text>`;

      svg += '</svg>';
      container.innerHTML = svg;
    }

    // ============================================================
    // ACCESSIBILITY & UI HELPERS
    // ============================================================

    function toggleSidebar() {
      const sidebar = document.querySelector('.sidebar');
      const overlay = document.getElementById('sidebarOverlay');
      sidebar.classList.toggle('open');
      overlay.classList.toggle('open');
      var btn = document.querySelector('.sidebar-toggle, .hamburger, .mobile-menu-btn'); if (btn) btn.setAttribute('aria-expanded', btn.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
    }

    function toggleGlossary() {
      const panel = document.getElementById('glossaryPanel');
      panel.classList.toggle('open');
      if (panel.classList.contains('open')) {
        document.getElementById('glossarySearch').focus();
      }
    }

    function filterGlossary() {
      const query = document.getElementById('glossarySearch').value.toLowerCase();
      const terms = document.querySelectorAll('.glossary-term');
      terms.forEach(term => {
        const text = term.textContent.toLowerCase();
        term.style.display = text.includes(query) ? 'block' : 'none';
      });
    }

    function toggleKeyboardHelp() {
      const help = document.getElementById('keyboardHelp');
      help.classList.toggle('open');
    }

    // Enhanced keyboard navigation
    document.addEventListener('keydown', (e) => {
      // Don'قم بتشغيل الاختصارات عند الكتابة في المدخلات إذا (e.target.tagName ==='INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') { إذا (e.key ==='Escape') { e.target.blur(); } يعود؛ } التبديل (e.key) { الحالة'ArrowRight':
        case ' ': if (!e.shiftKey) { e.preventDefault(); nextSlide(); } استراحة؛ قضية'ArrowLeft':
        case 'Backspace': e.preventDefault(); prevSlide(); استراحة؛ قضية'ArrowDown':
        case 'n':
        case 'N': if (currentModule < Modules.length - 1) { e.preventDefault(); goToModule(currentModule + 1); } استراحة؛ قضية'ArrowUp':
        case 'p':
        case 'P': if (currentModule > 0) { e.preventDefault(); goToModule(currentModule - 1); } استراحة؛ قضية't':
        case 'T': e.preventDefault(); toggleToolsPanel(); استراحة؛ قضية'g':
        case 'G': e.preventDefault(); toggleGlossary(); استراحة؛ قضية'?': e.preventDefault(); toggleKeyboardHelp(); استراحة؛ قضية'Escape':
          document.getElementById('glossaryPanel').classList.remove('open');
          document.getElementById('keyboardHelp').classList.remove('open');
          document.querySelector('.sidebar').classList.remove('open');
          document.getElementById('sidebarOverlay').classList.remove('open');
          break;
      }
    });

    // ============================================================
    // QUIZ SYSTEM
    // ============================================================

    function checkQuizAnswer(questionId, selectedIdx, correctIdx, explanations) {
      const options = document.querySelectorAll(`#${questionId} .quiz-option`);
      options.forEach((opt, i) => {
        opt.classList.remove('selected');
        opt.onclick = null; // Disable further clicks
        if (i === correctIdx) {
          opt.classList.add('correct');
        } else if (i === selectedIdx && selectedIdx !== correctIdx) {
          opt.classList.add('incorrect');
        }
      });

      // Show explanation
      const feedbackEl = document.getElementById(`${questionId}-feedback`);
      if (feedbackEl) {
        const isCorrect = selectedIdx === correctIdx;
        feedbackEl.style.display = 'block';
        feedbackEl.innerHTML = `
          <div style="padding: 0.75rem; margin-top: 0.5rem; border-radius: 6px; background: ${isCorrect ? 'rgba(34,197,94,0.1)' : 'rgba(197,48,48,0.1)'}; الحدود اليمنى: 3 بكسل صلب ${isCorrect ?'var(--green)' : 'var(--red)'};">
            <strong>${isCorrect ? 'Correct!' : 'Not quite.'}</strong> ${explanations[correctIdx]}
          </div>
        `;
      }
    }

    // ============================================================
    // INITIALIZE
    // ============================================================

    document.addEventListener('DOMContentLoaded', () => {
      initModuleList();

      // Restore saved tier
      try {
        const savedTier = localStorage.getItem('synthesis_course_tier'); إذا (تم حفظ الطبقة && ['foundation','researcher','methodologist'].includes(savedTier)) {
          setTier(savedTier);
        }
      } catch(e) {}

      // Load saved progress
      const savedProgress = loadProgress();
      if (savedProgress) {
        goToModule(savedProgress.module);
        if (savedProgress.slide > 0) {
          setTimeout(() => goToSlide(savedProgress.slide), 100);
        }
      } else {
        goToModule(0);
      }

      // Initialize spaced repetition
      initSpacedRepetition();
      updateReviewButtonStatus();

      // Check for daily review badge
      if (spacedRepetitionState.dailyReviewsCompleted >= 7) {
        earnBadge('daily_dedication');
      }

      // Show daily review prompt if due (with slight delay for UX)
      if (shouldShowDailyReview()) {
        setTimeout(() => {
          // Only auto-prompt if they've completed at least one module
          const completedModules = document.querySelectorAll('.module-item.completed').length;
          if (completedModules >= 1) {
            openDailyReview();
          }
        }, 2000);
      }

      // Auto-save on navigation
      const originalGoToModule = goToModule;
      goToModule = function(moduleId) {
        // Mark previous module as complete if we're progressing
        if (moduleId > currentModule) {
          markModuleComplete(currentModule);
        }
        originalGoToModule(moduleId);
        saveProgress();
      };

      const originalGoToSlide = goToSlide;
      goToSlide = function(index) {
        originalGoToSlide(index);
        saveProgress();
      };
    });
  </script>
</body>
</html>
