<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>प्रकाशन पूर्वाग्रह जासूस: वह साक्ष्य जिसने कभी प्रकाश नहीं देखा</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&amp;family=Source+Sans+Pro:wght@300;400;600;700&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<script>
if (typeof Plotly === 'undefined') {
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('[id*="plot"], [id*="chart"], .plotly-graph-div, .js-plotly-plot').forEach(function(el) {
      el.innerHTML = '<div style="padding:2rem;text-align:center;background:#2a2a4a;border:1px dashed #D4AF37;border-radius:8px;color:#FAF8F5;margin:1rem 0;"><p style="font-size:1.1rem;margin-bottom:0.5rem;">Interactive chart unavailable offline</p><p style="font-size:0.85rem;opacity:0.7;">Connect to the internet to load interactive Plotly.js visualizations</p></div>';
    });
  });
}
</script>
<style>
    :root {
      --navy: #1E2761;
      --deep-navy: #141B3D;
      --gold: #D4AF37;
      --cream: #FAF8F5;
      --red: #dc2626;
      --green: #16a34a;
      --purple: #7c3aed;
      --amber: #f59e0b;
      --teal: #0d9488;
      --detective-blue: #1e3a5f;
      --evidence-red: #991b1b;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%;
      font-family: 'Source Sans Pro', sans-serif;
      background: var(--deep-navy);
      color: var(--cream);
    }
    .course-container { display: flex; height: 100vh; overflow: hidden; }

    /* Sidebar */
    .sidebar {
      width: 320px;
      background: linear-gradient(180deg, var(--detective-blue) 0%, var(--deep-navy) 100%);
      border-right: 1px solid rgba(212,175,55,0.2);
      display: flex; flex-direction: column; flex-shrink: 0;
    }
    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(212,175,55,0.2);
      background: rgba(0,0,0,0.2);
    }
    .sidebar-header h1 {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.3rem; font-weight: 700; color: var(--gold); margin-bottom: 0.25rem;
    }
    .sidebar-header p { font-size: 0.75rem; color: rgba(255,255,255,0.6); }
    .sidebar-badge {
      display: inline-block; padding: 0.25rem 0.5rem;
      background: linear-gradient(135deg, var(--evidence-red), #b91c1c);
      border-radius: 4px; font-size: 0.65rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.05em; margin-top: 0.5rem;
    }
    .module-list { flex: 1; overflow-y: auto; padding: 1rem 0; }
    .module-item {
      display: flex; align-items: center; gap: 0.75rem;
      padding: 0.65rem 1.25rem; cursor: pointer; transition: all 0.2s;
      border-left: 3px solid transparent;
    }
    .module-item:hover { background: rgba(212,175,55,0.1); }
    .module-item.active { background: rgba(212,175,55,0.15); border-left-color: var(--gold); }
    .module-item.completed .module-number { background: var(--green); color: white; }
    .module-number {
      width: 26px; height: 26px; border-radius: 50%;
      background: rgba(255,255,255,0.1); display: flex;
      align-items: center; justify-content: center;
      font-size: 0.75rem; font-weight: 600; flex-shrink: 0;
    }
    .module-info { flex: 1; min-width: 0; }
    .module-title { font-size: 0.85rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .module-subtitle { font-size: 0.7rem; color: rgba(255,255,255,0.5); }
    .sidebar-footer { padding: 1rem; border-top: 1px solid rgba(212,175,55,0.2); }
    .progress-bar-container { margin-top: 0.75rem; }
    .progress-label { font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 0.25rem; }
    .progress-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, var(--evidence-red), var(--gold)); border-radius: 3px; transition: width 0.3s; }

    /* Main Content */
    .main-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .top-bar {
      display: flex; justify-content: space-between; align-items: center;
      padding: 1rem 2rem; background: rgba(0,0,0,0.3);
      border-bottom: 1px solid rgba(212,175,55,0.15);
    }
    .module-indicator { font-size: 0.9rem; color: rgba(255,255,255,0.7); }
    .slide-counter { font-size: 0.8rem; color: var(--gold); margin-left: 1rem; }
    .top-bar-actions { display: flex; gap: 0.75rem; }
    .top-bar-btn {
      padding: 0.5rem 1rem; background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2); border-radius: 6px;
      color: var(--cream); font-size: 0.85rem; cursor: pointer; transition: all 0.2s;
    }
    .top-bar-btn:hover { background: rgba(255,255,255,0.15); }
    .top-bar-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .slide-container { flex: 1; overflow-y: auto; padding: 2rem; }
    .slide { display: none; max-width: 1000px; margin: 0 auto; }
    .slide.active { display: block; }

    /* Storytelling Styles */
    .rhetoric-question {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.8rem; font-style: italic; color: var(--gold);
      text-align: center; padding: 3rem 2rem; line-height: 1.5;
      border-left: 4px solid var(--evidence-red);
      background: linear-gradient(135deg, rgba(153,27,27,0.1), transparent);
      margin: 1rem 0;
    }
    .case-file {
      background: linear-gradient(135deg, rgba(30,58,95,0.4), rgba(15,15,26,0.6));
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 12px; padding: 2rem; margin: 1.5rem 0;
    }
    .case-file-header {
      display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;
      padding-bottom: 1rem; border-bottom: 1px solid rgba(212,175,55,0.2);
    }
    .case-number {
      background: var(--evidence-red); color: white;
      padding: 0.5rem 1rem; border-radius: 4px;
      font-weight: 700; font-size: 0.8rem; text-transform: uppercase;
    }
    .case-title { font-size: 1.3rem; font-weight: 700; color: var(--gold); }
    .case-source { font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem; }
    .evidence-timeline { margin: 1.5rem 0; }
    .timeline-event {
      display: flex; gap: 1rem; padding: 1rem 0;
      border-left: 2px solid rgba(212,175,55,0.3); margin-left: 1rem; padding-left: 1.5rem;
      position: relative;
    }
    .timeline-event::before {
      content: ''; position: absolute; left: -6px; top: 1.2rem;
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--gold); border: 2px solid var(--deep-navy);
    }
    .timeline-event.buried::before { background: var(--evidence-red); }
    .timeline-event.revealed::before { background: var(--green); }
    .timeline-year {
      font-weight: 700; color: var(--gold); min-width: 80px;
      font-family: 'Cormorant Garamond', serif; font-size: 1.1rem;
    }
    .timeline-text { color: rgba(255,255,255,0.85); line-height: 1.6; }

    .evidence-box {
      background: rgba(153,27,27,0.15); border: 1px solid rgba(153,27,27,0.4);
      border-radius: 8px; padding: 1.5rem; margin: 1rem 0;
    }
    .evidence-box.found {
      background: rgba(22,163,74,0.15); border-color: rgba(22,163,74,0.4);
    }
    .evidence-header {
      display: flex; align-items: center; gap: 0.75rem;
      font-weight: 700; margin-bottom: 1rem; font-size: 1.1rem;
    }
    .evidence-icon { font-size: 1.5rem; }

    .statistic-card {
      background: linear-gradient(135deg, rgba(124,58,237,0.2), rgba(124,58,237,0.05));
      border: 1px solid rgba(124,58,237,0.3);
      border-radius: 12px; padding: 1.5rem; text-align: center; margin: 1rem 0;
    }
    .statistic-value {
      font-size: 3rem; font-weight: 700; color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
    }
    .statistic-label { font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-top: 0.5rem; }
    .statistic-context { font-size: 0.8rem; color: var(--evidence-red); margin-top: 0.5rem; font-weight: 600; }

    /* Tool Panel */
    .tool-panel {
      background: linear-gradient(135deg, rgba(13,148,136,0.1), rgba(13,148,136,0.02));
      border: 1px solid rgba(13,148,136,0.3);
      border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;
    }
    .tool-header {
      display: flex; align-items: center; gap: 0.75rem;
      margin-bottom: 1rem; padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(13,148,136,0.2);
    }
    .tool-icon { font-size: 1.5rem; }
    .tool-title { font-size: 1.1rem; font-weight: 700; color: var(--teal); }
    .tool-description { font-size: 0.85rem; color: rgba(255,255,255,0.6); margin-bottom: 1rem; }
    .tool-controls {
      display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;
      padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;
    }
    .tool-control { display: flex; flex-direction: column; gap: 0.25rem; }
    .tool-control label { font-size: 0.8rem; color: rgba(255,255,255,0.6); }
    .tool-control input, .tool-control select {
      padding: 0.5rem; border-radius: 4px; border: 1px solid rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.1); color: var(--cream); font-size: 0.9rem;
    }
    .plot-area {
      background: rgba(0,0,0,0.3); border-radius: 8px;
      min-height: 400px; margin: 1rem 0;
    }

    /* Decision Tree */
    .decision-tree {
      background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(245,158,11,0.02));
      border: 1px solid rgba(245,158,11,0.3);
      border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;
    }
    .decision-title {
      font-size: 1.2rem; font-weight: 700; color: var(--amber); margin-bottom: 0.5rem;
    }
    .decision-situation {
      font-size: 0.95rem; color: rgba(255,255,255,0.8);
      padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;
      margin-bottom: 1.5rem; line-height: 1.6;
    }
    .decision-node { margin: 1rem 0; }
    .decision-question {
      font-weight: 600; color: var(--cream); margin-bottom: 1rem;
      padding: 1rem; background: rgba(245,158,11,0.1); border-radius: 8px;
    }
    .decision-branches { display: flex; flex-direction: column; gap: 0.5rem; }
    .decision-branch {
      width: 100%; text-align: left; font-family: inherit; font-size: inherit;
      color: var(--cream); padding: 1rem; background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1); border-radius: 8px;
      cursor: pointer; transition: all 0.2s;
    }
    .decision-branch:hover {
      background: rgba(255,255,255,0.1); border-color: var(--gold);
    }
    .decision-branch:focus {
      outline: 3px solid var(--gold); outline-offset: 2px;
    }
    .decision-outcome {
      padding: 1.5rem; border-radius: 8px; margin-top: 1rem;
    }
    .decision-outcome.good {
      background: rgba(22,163,74,0.15); border: 1px solid rgba(22,163,74,0.4);
    }
    .decision-outcome.bad {
      background: rgba(220,38,38,0.15); border: 1px solid rgba(220,38,38,0.4);
    }
    .decision-outcome.neutral {
      background: rgba(245,158,11,0.15); border: 1px solid rgba(245,158,11,0.4);
    }
    .outcome-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.75rem; }
    .outcome-text { line-height: 1.6; margin-bottom: 0.75rem; }
    .outcome-case { font-size: 0.85rem; color: rgba(255,255,255,0.6); font-style: italic; }

    /* Method Box */
    .method-box {
      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px; padding: 1.5rem; margin: 1rem 0;
    }
    .method-box h3 { color: var(--gold); margin-bottom: 0.75rem; }
    .method-box ul { padding-left: 1.5rem; }
    .method-box li { margin: 0.5rem 0; line-height: 1.5; }

    /* Quiz */
    .quiz-container { margin: 1.5rem 0; }
    .quiz-question {
      font-size: 1.1rem; font-weight: 600; margin-bottom: 1.5rem;
      padding: 1rem; background: rgba(124,58,237,0.1); border-radius: 8px;
    }
    .quiz-options { display: flex; flex-direction: column; gap: 0.75rem; }
    .quiz-option {
      padding: 1rem; background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1); border-radius: 8px;
      cursor: pointer; transition: all 0.2s;
    }
    .quiz-option:hover { background: rgba(255,255,255,0.1); }
    .quiz-option.correct { background: rgba(22,163,74,0.2); border-color: var(--green); }
    .quiz-option.incorrect { background: rgba(220,38,38,0.2); border-color: var(--red); }
    .quiz-explanation {
      margin-top: 1rem; padding: 1rem; background: rgba(124,58,237,0.1);
      border-radius: 8px; display: none;
    }
    .quiz-explanation.visible { display: block; }

    /* Slide Title */
    .slide-title {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 2rem; color: var(--gold); margin-bottom: 1.5rem;
      border-bottom: 2px solid rgba(212,175,55,0.3); padding-bottom: 0.75rem;
    }

    /* Principle Display */
    .principle-display {
      text-align: center; padding: 3rem;
      background: linear-gradient(135deg, rgba(212,175,55,0.1), transparent);
      border-radius: 12px; margin: 1rem 0;
    }
    .principle-number {
      font-size: 4rem; font-weight: 700; color: var(--gold); opacity: 0.3;
      font-family: 'Cormorant Garamond', serif;
    }
    .principle-text {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.8rem; font-style: italic; color: var(--cream);
      max-width: 700px; margin: 0 auto; line-height: 1.5;
    }

    /* Cycle Return */
    .cycle-return {
      background: linear-gradient(135deg, rgba(212,175,55,0.1), transparent);
      border-left: 4px solid var(--gold);
      padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 8px 8px 0;
    }
    .cycle-return .principle-recall {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.2rem; font-style: italic; color: var(--gold);
    }

    /* Clinical Guide */
    .clinical-guide {
      background: rgba(13,148,136,0.1); border: 1px solid rgba(13,148,136,0.3);
      border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;
    }
    .clinical-guide h3 { color: var(--teal); margin-bottom: 1rem; }
    .clinical-guide ul { padding-left: 1.5rem; }
    .clinical-guide li { margin: 0.75rem 0; line-height: 1.5; }

    /* Glossary Overlay */
    .glossary-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.9); z-index: 1000;
      display: none; justify-content: center; align-items: center;
    }
    .glossary-overlay.open { display: flex; }
    .glossary-panel {
      background: var(--navy); border: 1px solid rgba(212,175,55,0.3);
      border-radius: 12px; width: 90%; max-width: 600px; max-height: 80vh;
      overflow: hidden; display: flex; flex-direction: column;
    }
    .glossary-header {
      padding: 1rem 1.5rem; border-bottom: 1px solid rgba(212,175,55,0.2);
      display: flex; justify-content: space-between; align-items: center;
    }
    .glossary-close {
      background: none; border: none; color: var(--cream);
      font-size: 1.5rem; cursor: pointer;
    }
    .glossary-search {
      padding: 0.75rem 1rem; margin: 1rem;
      background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px; color: var(--cream); font-size: 1rem; width: calc(100% - 2rem);
    }
    .glossary-content { flex: 1; overflow-y: auto; padding: 1rem; }
    .glossary-term { padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1); }

    /* Contrast Box - Two-path comparison style */
    .contrast-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      margin: 1.5rem 0;
      border-radius: 12px;
      overflow: hidden;
    }
    .contrast-side {
      padding: 1.5rem;
    }
    .contrast-side.dark {
      background: linear-gradient(135deg, rgba(153,27,27,0.3), rgba(153,27,27,0.1));
      border: 1px solid rgba(153,27,27,0.4);
    }
    .contrast-side.light {
      background: linear-gradient(135deg, rgba(22,163,74,0.3), rgba(22,163,74,0.1));
      border: 1px solid rgba(22,163,74,0.4);
    }
    .contrast-header {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    .contrast-side.dark .contrast-header { color: #fca5a5; }
    .contrast-side.light .contrast-header { color: #86efac; }
    .contrast-items { list-style: none; padding: 0; }
    .contrast-items li {
      padding: 0.5rem 0;
      padding-left: 1.5rem;
      position: relative;
      line-height: 1.5;
    }
    .contrast-side.dark .contrast-items li::before {
      content: '✗';
      position: absolute;
      left: 0;
      color: #ef4444;
    }
    .contrast-side.light .contrast-items li::before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #22c55e;
    }
    .contrast-consequence {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      font-style: italic;
    }

    /* Oath/Emphatic Statement */
    .oath-box {
      background: linear-gradient(135deg, rgba(212,175,55,0.15), rgba(212,175,55,0.05));
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 2rem;
      margin: 1.5rem 0;
      text-align: center;
    }
    .oath-header {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      color: var(--gold);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: 1rem;
    }
    .oath-text {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem;
      line-height: 1.8;
      color: var(--cream);
    }
    .oath-text strong {
      color: var(--gold);
    }

    /* Death Toll Counter */
    .death-toll {
      background: linear-gradient(135deg, rgba(153,27,27,0.4), rgba(0,0,0,0.3));
      border: 1px solid rgba(153,27,27,0.6);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      margin: 1rem 0;
    }
    .death-toll-number {
      font-size: 3.5rem;
      font-weight: 700;
      color: #ef4444;
      font-family: 'Cormorant Garamond', serif;
    }
    .death-toll-label {
      font-size: 1rem;
      color: rgba(255,255,255,0.8);
      margin-top: 0.5rem;
    }
    .death-toll-source {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      margin-top: 0.5rem;
      font-style: italic;
    }

    /* Learning Objectives Box */
    .learning-objectives {
      background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(59,130,246,0.05));
      border: 1px solid rgba(59,130,246,0.4);
      border-left: 4px solid #3b82f6;
      border-radius: 0 12px 12px 0;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .learning-objectives-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #60a5fa;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .learning-objectives ul {
      padding-left: 1.5rem;
      margin: 0;
    }
    .learning-objectives li {
      margin: 0.5rem 0;
      line-height: 1.5;
      color: rgba(255,255,255,0.9);
    }

    /* Key Takeaways Box */
    .key-takeaways {
      background: linear-gradient(135deg, rgba(34,197,94,0.15), rgba(34,197,94,0.05));
      border: 1px solid rgba(34,197,94,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .key-takeaways-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #4ade80;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .key-takeaways ul {
      padding-left: 1.5rem;
      margin: 0;
    }
    .key-takeaways li {
      margin: 0.5rem 0;
      line-height: 1.5;
    }

    /* Common Mistakes Warning */
    .common-mistakes {
      background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(239,68,68,0.05));
      border: 1px solid rgba(239,68,68,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .common-mistakes-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #f87171;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .common-mistakes ul {
      padding-left: 1.5rem;
      margin: 0;
    }
    .common-mistakes li {
      margin: 0.5rem 0;
      line-height: 1.5;
    }

    /* Patient Communication Box */
    .patient-communication {
      background: linear-gradient(135deg, rgba(168,85,247,0.15), rgba(168,85,247,0.05));
      border: 1px solid rgba(168,85,247,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .patient-communication-header {
      font-weight: 700;
      color: #c084fc;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .dialogue-box {
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      padding: 1rem;
      margin: 0.75rem 0;
    }
    .dialogue-speaker {
      font-weight: 600;
      color: var(--gold);
      margin-bottom: 0.25rem;
    }
    .dialogue-text {
      font-style: italic;
      line-height: 1.6;
      color: rgba(255,255,255,0.85);
    }

    /* Protagonist Story Box */
    .protagonist-story {
      background: linear-gradient(135deg, rgba(212,175,55,0.1), transparent);
      border: 1px solid rgba(212,175,55,0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .protagonist-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 0.5rem;
    }
    .protagonist-title {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.6);
      margin-bottom: 1rem;
    }
    .protagonist-quote {
      font-style: italic;
      border-left: 3px solid var(--gold);
      padding-left: 1rem;
      margin: 1rem 0;
      color: rgba(255,255,255,0.9);
    }

    /* Legal Disclaimer */
    .legal-disclaimer {
      background: rgba(245,158,11,0.1);
      border: 1px solid rgba(245,158,11,0.3);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
      font-size: 0.85rem;
      color: rgba(255,255,255,0.7);
    }
    .legal-disclaimer strong {
      color: var(--amber);
    }

    /* Printable Checklist */
    .printable-checklist {
      background: rgba(255,255,255,0.05);
      border: 2px dashed rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .printable-checklist-header {
      text-align: center;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .checklist-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .checklist-box {
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255,255,255,0.4);
      border-radius: 3px;
      flex-shrink: 0;
      margin-top: 2px;
    }

    /* Additional Patient Communication Styles */
    .communication-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #c084fc;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .scenario {
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      font-style: italic;
    }
    .script-box {
      background: rgba(168,85,247,0.2);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
    }
    .script-label {
      font-weight: 600;
      color: #c084fc;
      margin-bottom: 0.5rem;
    }
    .script-text {
      font-size: 1.05rem;
      line-height: 1.7;
      color: rgba(255,255,255,0.95);
    }
    .key-points {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(168,85,247,0.3);
    }
    .key-points ul {
      padding-left: 1.5rem;
      margin: 0.5rem 0 0 0;
    }

    /* Additional Protagonist Story Styles */
    .protagonist-header {
      margin-bottom: 1rem;
    }
    .protagonist-role {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.6);
    }
    .protagonist-narrative {
      line-height: 1.7;
      margin-bottom: 1rem;
    }
    .protagonist-impact {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(212,175,55,0.3);
      color: rgba(255,255,255,0.9);
    }

    /* Additional Legal Disclaimer Styles */
    .disclaimer-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #fbbf24;
      margin-bottom: 0.75rem;
    }
    .disclaimer-text {
      line-height: 1.6;
    }
    .disclaimer-resources {
      margin-top: 1rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(245,158,11,0.3);
    }
    .disclaimer-resources ul {
      padding-left: 1.5rem;
      margin: 0.5rem 0 0 0;
    }
    .disclaimer-resources a {
      color: #fbbf24;
    }

    /* Additional Printable Checklist Styles */
    .checklist-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 0.5rem;
      font-size: 1.2rem;
    }
    .print-instruction {
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    .checklist-section {
      margin: 1rem 0;
    }
    .checklist-section h4 {
      color: #60a5fa;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }
    .checklist-section ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .checklist-section li {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.4rem 0;
    }
    .print-btn {
      display: block;
      width: 100%;
      margin-top: 1.5rem;
      padding: 0.75rem;
      background: var(--gold);
      color: #1a1a2e;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
    }
    .print-btn:hover {
      background: #e6c847;
    }

    /* Key Takeaways Action Item */
    .action-item {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(34,197,94,0.2);
      border-radius: 8px;
      border-left: 4px solid #4ade80;
    }

    /* Common Mistakes Header */
    .mistakes-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #f87171;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    /* Practice Case Styles */
    .practice-case {
      background: linear-gradient(135deg, rgba(6,182,212,0.15), rgba(6,182,212,0.05));
      border: 1px solid rgba(6,182,212,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .practice-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #22d3ee;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .case-scenario {
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      line-height: 1.6;
    }
    .sample-data {
      margin: 1rem 0;
    }
    .sample-data h4 {
      color: #22d3ee;
      margin-bottom: 0.5rem;
    }
    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    .data-table th, .data-table td {
      padding: 0.5rem;
      border: 1px solid rgba(6,182,212,0.3);
      text-align: center;
    }
    .data-table th {
      background: rgba(6,182,212,0.2);
      color: #22d3ee;
      font-weight: 600;
    }
    .practice-questions {
      margin-top: 1rem;
    }
    .practice-questions h4 {
      color: #22d3ee;
      margin-bottom: 0.5rem;
    }
    .practice-questions ol {
      padding-left: 1.5rem;
    }
    .practice-questions li {
      margin: 0.5rem 0;
      line-height: 1.5;
    }
    .answers-reveal {
      margin-top: 1rem;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 1rem;
    }
    .answers-reveal summary {
      cursor: pointer;
      color: #22d3ee;
      font-weight: 600;
    }
    .answers-reveal ol {
      padding-left: 1.5rem;
      margin-top: 0.75rem;
    }

    /* Pre-Assessment Styles */
    .pre-assessment {
      background: linear-gradient(135deg, rgba(249,115,22,0.15), rgba(249,115,22,0.05));
      border: 1px solid rgba(249,115,22,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .assessment-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #fb923c;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    /* Redemption Story Styles */
    .redemption-story {
      background: linear-gradient(135deg, rgba(52,211,153,0.15), rgba(52,211,153,0.05));
      border: 1px solid rgba(52,211,153,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .redemption-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      color: #34d399;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .redemption-narrative {
      line-height: 1.7;
      margin-bottom: 1rem;
    }
    .redemption-lesson {
      background: rgba(52,211,153,0.2);
      border-radius: 8px;
      padding: 1rem;
      border-left: 4px solid #34d399;
    }

    /* Real-World Story Styles */
    .story-container {
      background: linear-gradient(135deg, rgba(30,58,95,0.5), rgba(15,15,26,0.7));
      border: 1px solid rgba(212,175,55,0.4);
      border-radius: 16px;
      padding: 2rem;
      margin: 1.5rem 0;
      position: relative;
    }
    .story-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--evidence-red), var(--gold));
      border-radius: 16px 16px 0 0;
    }
    .story-opening {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.6rem;
      font-style: italic;
      color: var(--gold);
      text-align: center;
      padding: 2rem 1.5rem;
      line-height: 1.6;
      border-left: 4px solid var(--evidence-red);
      background: linear-gradient(135deg, rgba(153,27,27,0.15), transparent);
      margin: -2rem -2rem 1.5rem -2rem;
      border-radius: 16px 16px 0 0;
    }
    .stats-box {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      background: rgba(124,58,237,0.15);
      border: 1px solid rgba(124,58,237,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .stats-box-header {
      grid-column: 1 / -1;
      font-weight: 700;
      color: #a78bfa;
      font-size: 1.1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(124,58,237,0.3);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .stat-item {
      text-align: center;
      padding: 1rem;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
    }
    .stat-value {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--gold);
      font-family: 'Cormorant Garamond', serif;
    }
    .stat-label {
      font-size: 0.85rem;
      color: rgba(255,255,255,0.7);
      margin-top: 0.25rem;
    }
    .interactive-decision-tree {
      background: linear-gradient(135deg, rgba(245,158,11,0.12), rgba(245,158,11,0.03));
      border: 1px solid rgba(245,158,11,0.4);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    .decision-scenario {
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      padding: 1.25rem;
      margin-bottom: 1.5rem;
      border-left: 4px solid var(--amber);
    }
    .decision-scenario-title {
      font-weight: 700;
      color: var(--amber);
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }
    .decision-path {
      margin: 1rem 0;
      padding: 1.25rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    .decision-path.path-a {
      background: linear-gradient(135deg, rgba(220,38,38,0.15), rgba(220,38,38,0.05));
      border-color: rgba(220,38,38,0.4);
    }
    .decision-path.path-a:hover {
      background: linear-gradient(135deg, rgba(220,38,38,0.25), rgba(220,38,38,0.1));
      border-color: rgba(220,38,38,0.6);
      transform: translateX(5px);
    }
    .decision-path.path-b {
      background: linear-gradient(135deg, rgba(34,197,94,0.15), rgba(34,197,94,0.05));
      border-color: rgba(34,197,94,0.4);
    }
    .decision-path.path-b:hover {
      background: linear-gradient(135deg, rgba(34,197,94,0.25), rgba(34,197,94,0.1));
      border-color: rgba(34,197,94,0.6);
      transform: translateX(5px);
    }
    .decision-path:focus {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
    }
    .path-header {
      font-weight: 700;
      font-size: 1.05rem;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .path-a .path-header { color: #fca5a5; }
    .path-b .path-header { color: #86efac; }
    .path-arrow {
      display: inline-block;
      margin-left: 0.5rem;
      transition: transform 0.2s;
    }
    .decision-path:hover .path-arrow {
      transform: translateX(5px);
    }
    .path-consequence {
      padding-top: 0.75rem;
      border-top: 1px dashed rgba(255,255,255,0.2);
      margin-top: 0.75rem;
      font-size: 0.95rem;
      line-height: 1.6;
    }
    .revelation-box {
      background: linear-gradient(135deg, rgba(212,175,55,0.2), rgba(212,175,55,0.08));
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      text-align: center;
    }
    .revelation-header {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--gold);
      margin-bottom: 1rem;
    }
    .revelation-text {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.3rem;
      line-height: 1.7;
      color: var(--gold);
      font-style: italic;
    }
    .revelation-detail {
      margin-top: 1rem;
      font-size: 0.95rem;
      color: rgba(255,255,255,0.8);
      font-family: 'Source Sans Pro', sans-serif;
      font-style: normal;
    }
    .story-refrain {
      text-align: center;
      padding: 1.5rem;
      margin: 1.5rem 0;
      background: linear-gradient(90deg, transparent, rgba(212,175,55,0.1), transparent);
      border-top: 1px solid rgba(212,175,55,0.3);
      border-bottom: 1px solid rgba(212,175,55,0.3);
    }
    .story-refrain p {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 1.4rem;
      font-style: italic;
      color: var(--gold);
      margin: 0;
    }
    .story-timeline {
      position: relative;
      padding-left: 2rem;
      margin: 1.5rem 0;
    }
    .story-timeline::before {
      content: '';
      position: absolute;
      left: 8px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(180deg, var(--gold), var(--evidence-red), var(--green));
    }
    .timeline-step {
      position: relative;
      padding: 1rem 0 1rem 1.5rem;
    }
    .timeline-step::before {
      content: '';
      position: absolute;
      left: -1.5rem;
      top: 1.25rem;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--gold);
      border: 2px solid var(--deep-navy);
    }
    .timeline-step.danger::before { background: var(--evidence-red); }
    .timeline-step.success::before { background: var(--green); }
    .step-label {
      font-weight: 700;
      color: var(--gold);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.25rem;
    }
    .step-content {
      line-height: 1.6;
      color: rgba(255,255,255,0.9);
    }

    /* Print styles */
    @media print {
      .course-nav, .progress-bar, .nav-buttons {
        display: none !important;
      }
      .printable-checklist {
        border: 2px solid #333;
        page-break-inside: avoid;
      }
      .checklist-box {
        border: 2px solid #333;
      }
    }

    /* Mobile Responsiveness */
    @media (max-width: 900px) {
      .course-container {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        height: auto;
        max-height: 200px;
        border-right: none;
        border-bottom: 1px solid rgba(212,175,55,0.2);
      }
      .module-list {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        padding: 0.5rem;
        gap: 0.5rem;
      }
      .module-item {
        flex-shrink: 0;
        padding: 0.5rem 0.75rem;
        border-left: none;
        border-bottom: 3px solid transparent;
      }
      .module-item.active {
        border-left: none;
        border-bottom-color: var(--gold);
      }
      .sidebar-footer {
        padding: 0.5rem 1rem;
      }
      .main-content {
        height: calc(100vh - 200px);
      }
      .slide-container {
        padding: 1rem;
      }
      .rhetoric-question {
        font-size: 1.4rem;
        padding: 1.5rem 1rem;
      }
      .principle-text {
        font-size: 1.4rem;
      }
      .tool-controls {
        flex-direction: column;
      }
      .contrast-box {
        flex-direction: column;
      }
    }

    @media (max-width: 600px) {
      .sidebar {
        max-height: 150px;
      }
      .module-info {
        display: none;
      }
      .module-number {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
      }
      .slide-title {
        font-size: 1.5rem;
      }
      .case-file-header {
        flex-direction: column;
        align-items: flex-start;
      }
      .decision-branches {
        gap: 0.5rem;
      }
      .decision-branch {
        padding: 0.75rem;
      }
      .data-table {
        font-size: 0.75rem;
      }
      .data-table th, .data-table td {
        padding: 0.25rem;
      }
    }

    /* Floating Glossary Button */
    .floating-glossary {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--gold);
      color: var(--deep-navy);
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .floating-glossary:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }
    @media (min-width: 901px) {
      .floating-glossary {
        display: none;
      }
    }

    /* Reading Level Indicator */
    .reading-level {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: rgba(124,58,237,0.2);
      border: 1px solid rgba(124,58,237,0.4);
      border-radius: 20px;
      font-size: 0.75rem;
      color: #a78bfa;
      margin-top: 0.5rem;
    }

    /* Module Time Estimate */
    .module-time {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.4);
      margin-top: 0.15rem;
    }

    /* Chart Accessibility Description */
    .chart-description {
      position: absolute;
      left: -9999px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
    .chart-description-visible {
      position: static;
      width: auto;
      height: auto;
      background: rgba(0,0,0,0.3);
      padding: 0.75rem;
      margin-top: 0.5rem;
      border-radius: 8px;
      font-size: 0.85rem;
      color: rgba(255,255,255,0.7);
    }

    /* Animation */
    .animate-in {
      animation: fadeSlideIn 0.4s ease-out;
    }
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ============================================
       ACCESSIBILITY FEATURES
       ============================================ */

    /* Skip to Content Link */
    .skip-link {
      position: absolute;
      top: -100px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--gold);
      color: var(--deep-navy);
      padding: 0.75rem 1.5rem;
      border-radius: 0 0 8px 8px;
      font-weight: 600;
      text-decoration: none;
      z-index: 10000;
      transition: top 0.3s ease;
    }
    .skip-link:focus {
      top: 0;
      outline: 3px solid var(--evidence-red);
      outline-offset: 2px;
    }

    /* Visible Focus States */
    *:focus {
      outline: 2px solid var(--gold);
      outline-offset: 2px;
    }
    *:focus:not(:focus-visible) {
      outline: none;
    }
    *:focus-visible {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
    }
    button:focus-visible,
    .top-bar-btn:focus-visible,
    .module-item:focus-visible {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.3);
    }
    input:focus-visible,
    textarea:focus-visible,
    select:focus-visible {
      outline: 3px solid var(--gold);
      outline-offset: 0;
      border-color: var(--gold);
    }
    a:focus-visible {
      outline: 3px solid var(--gold);
      outline-offset: 2px;
      text-decoration: underline;
    }

    /* ============================================
       DARK/LIGHT MODE TOGGLE
       ============================================ */

    /* Light Mode Variables */
    .light-mode {
      --navy: #e8e8f0;
      --deep-navy: #f5f5fa;
      --gold: #b8860b;
      --cream: #1a1a2e;
      --detective-blue: #d0dbe8;
      --evidence-red: #dc2626;
    }
    .light-mode .course-container {
      background: #f5f5fa;
    }
    .light-mode .sidebar {
      background: linear-gradient(180deg, #e8eef5 0%, #f5f5fa 100%);
      border-right-color: rgba(184, 134, 11, 0.3);
    }
    .light-mode .sidebar-header {
      background: rgba(0, 0, 0, 0.05);
    }
    .light-mode .main-content {
      background: #ffffff;
    }
    .light-mode .top-bar {
      background: rgba(0, 0, 0, 0.05);
      border-bottom-color: rgba(184, 134, 11, 0.2);
    }
    .light-mode .slide-container {
      background: #ffffff;
    }
    .light-mode .case-file {
      background: linear-gradient(135deg, rgba(208, 219, 232, 0.6), rgba(245, 245, 250, 0.8));
      border-color: rgba(184, 134, 11, 0.4);
    }
    .light-mode .evidence-box {
      background: rgba(220, 38, 38, 0.1);
      border-color: rgba(220, 38, 38, 0.3);
    }
    .light-mode .evidence-box.found {
      background: rgba(22, 163, 74, 0.1);
      border-color: rgba(22, 163, 74, 0.3);
    }
    .light-mode .top-bar-btn {
      background: rgba(0, 0, 0, 0.08);
      border-color: rgba(0, 0, 0, 0.15);
      color: #1a1a2e;
    }
    .light-mode .top-bar-btn:hover {
      background: rgba(0, 0, 0, 0.12);
    }
    .light-mode .glossary-overlay .glossary-panel {
      background: #ffffff;
      border-color: rgba(184, 134, 11, 0.3);
    }
    .light-mode .glossary-search {
      background: #f5f5fa;
      border-color: rgba(0, 0, 0, 0.2);
      color: #1a1a2e;
    }

    /* Theme Toggle Button */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--detective-blue);
      border: 2px solid var(--gold);
      color: var(--gold);
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }
    .theme-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    }
    .light-mode .theme-toggle {
      background: #ffffff;
    }

    /* ============================================
       CERTIFICATE OF COMPLETION
       ============================================ */

    .certificate-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    .certificate-overlay.open {
      display: flex;
    }
    .certificate-container {
      background: linear-gradient(135deg, #fdf6e3 0%, #fff8dc 50%, #fdf6e3 100%);
      border: 8px double var(--gold);
      border-radius: 12px;
      padding: 3rem;
      max-width: 700px;
      width: 100%;
      text-align: center;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }
    .certificate-seal {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--gold), #c5a028);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.5);
    }
    .certificate-title {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--detective-blue);
      margin-top: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
    }
    .certificate-subtitle {
      font-size: 1rem;
      color: #666;
      margin-bottom: 1.5rem;
    }
    .certificate-body {
      font-size: 1.1rem;
      color: #333;
      line-height: 1.8;
      margin: 1.5rem 0;
    }
    .certificate-name {
      font-family: 'Cormorant Garamond', Georgia, serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--evidence-red);
      border-bottom: 2px solid var(--gold);
      display: inline-block;
      padding: 0 2rem 0.5rem;
      margin: 1rem 0;
    }
    .certificate-date {
      font-size: 0.9rem;
      color: #666;
      margin-top: 1.5rem;
    }
    .certificate-id {
      font-size: 0.75rem;
      color: #999;
      margin-top: 0.5rem;
      font-family: monospace;
    }
    .certificate-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
    }
    .certificate-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .certificate-btn.primary {
      background: var(--gold);
      color: var(--deep-navy);
      border: none;
    }
    .certificate-btn.secondary {
      background: transparent;
      color: #666;
      border: 2px solid #ccc;
    }
    .certificate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    .certificate-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: #eee;
      color: #666;
      font-size: 1.2rem;
      cursor: pointer;
    }

    /* Certificate Name Input Modal */
    .name-input-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 10001;
      display: none;
      align-items: center;
      justify-content: center;
    }
    .name-input-modal.open {
      display: flex;
    }
    .name-input-box {
      background: var(--deep-navy);
      border: 2px solid var(--gold);
      border-radius: 12px;
      padding: 2rem;
      max-width: 400px;
      width: 90%;
      text-align: center;
    }
    .name-input-box h3 {
      color: var(--gold);
      margin-bottom: 1rem;
    }
    .name-input-box input {
      width: 100%;
      padding: 0.75rem;
      font-size: 1.1rem;
      border: 2px solid rgba(212, 175, 55, 0.3);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--cream);
      margin-bottom: 1rem;
    }
    .name-input-box button {
      padding: 0.75rem 2rem;
      background: var(--gold);
      color: var(--deep-navy);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    .mobile-menu-toggle{display:none;position:fixed;top:12px;left:12px;z-index:1001;background:#1E2761;border:1px solid #D4AF37;color:#D4AF37;width:40px;height:40px;border-radius:8px;font-size:1.2rem;cursor:pointer;align-items:center;justify-content:center;}
    @media(max-width:768px){.mobile-menu-toggle{display:flex;}.sidebar{transform:translateX(-100%);transition:transform 0.3s ease;position:fixed;z-index:1000;height:100vh;}.sidebar.open{transform:translateX(0);}.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:999;}.sidebar-overlay.show{display:block;}}
  </style>
</head>
<body>
<!-- Skip to Content Link (Accessibility) -->
<a class="skip-link" href="#main-content" id="skipLink">Skip to main content</a>
<button aria-expanded="false" aria-label="Toggle navigation menu" class="mobile-menu-toggle" onclick="toggleSidebar()">☰</button>
<div class="sidebar-overlay" onclick="document.querySelector('.sidebar').classList.remove('open');this.classList.remove('show');"></div>
<div class="course-container">
<!-- Sidebar -->
<nav aria-label="पाठ्यक्रम नेविगेशन" class="sidebar">
<div class="sidebar-header">
<a href="index.html" onmouseout="this.style.color='rgba(212,175,55,0.7)'" onmouseover="this.style.color='#D4AF37'" style="display:block;font-size:0.7rem;color:rgba(212,175,55,0.7);text-decoration:none;margin-bottom:0.5rem;">← Course Library</a>
<h1>Publication Bias Detective</h1>
<p>वह साक्ष्य जिसने कभी प्रकाश नहीं देखा</p>
<span class="sidebar-badge">Investigation Unit</span>
</div>
<div class="module-list" id="moduleList"></div>
<div class="sidebar-footer">
<button class="top-bar-btn" onclick="openGlossary()" style="width:100%;margin-bottom:0.5rem;">
          Investigator's Glossary
        </button>
<div class="progress-bar-container">
<div class="progress-label">Case Progress: <span id="progressPercent">0%</span></div>
<div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
</div>
</div>
</nav>
<!-- Main Content -->
<div class="main-content">
<div class="top-bar">
<div>
<span class="module-indicator" id="moduleIndicator">Case File 0</span>
<span class="slide-counter" id="slideCounter">1 / 1</span>
</div>
<div class="top-bar-actions">
<button class="top-bar-btn" id="prevBtn" onclick="prevSlide()">Previous</button>
<button class="top-bar-btn" id="nextBtn" onclick="nextSlide()">Next</button>
</div>
</div>
<div class="slide-container" id="main-content"></div>
</div>
</div>
<!-- Glossary Overlay -->
<div class="glossary-overlay" id="glossaryOverlay">
<div class="glossary-panel">
<div class="glossary-header">
<h3 style="color:var(--gold)">Investigator's Glossary</h3>
<button class="glossary-close" onclick="closeGlossary()">×</button>
</div>
<input class="glossary-search" id="glossarySearch" oninput="filterGlossary()" placeholder="Search terms..." type="text"/>
<div class="glossary-content" id="glossaryContent"></div>
</div>
</div>
<!-- Theme Toggle Button -->
<button aria-label="Toggle dark/light mode" class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle dark/light mode">
    🌙
  </button>
<!-- Certificate Overlay -->
<div aria-labelledby="certTitle" class="certificate-overlay" id="certificateOverlay" role="dialog">
<div class="certificate-container" id="certificateContainer">
<button aria-label="प्रमाणपत्र बंद करें" class="certificate-close" onclick="closeCertificate()">×</button>
<div class="certificate-seal">🏆</div>
<h1 class="certificate-title" id="certTitle">Certificate of Completion</h1>
<p class="certificate-subtitle">Publication Bias Detective Training Program</p>
<div class="certificate-body">
<p>यह प्रमाणित किया जाता है कि</p>
<div class="certificate-name" id="certName">Investigator Name</div>
<p>ने सफलतापूर्वक पूरा कर लिया है</p>
<p><strong style="color: var(--detective-blue); font-size: 1.2rem;">प्रकाशन पूर्वाग्रह जासूस पाठ्यक्रम</strong></p>
<p>व्यवस्थित समीक्षाओं और मेटा-विश्लेषणों में प्रकाशन पूर्वाग्रह की पहचान करने, मूल्यांकन करने और कम करने में दक्षता प्रदर्शित करना।</p>
</div>
<div class="certificate-date" id="certDate">Completed on: January 1, 2025</div>
<div class="certificate-id" id="certId">Certificate ID: PBD-000000</div>
<div class="certificate-actions">
<button class="certificate-btn primary" onclick="printCertificate()">Print Certificate</button>
<button class="certificate-btn secondary" onclick="closeCertificate()">Close</button>
</div>
</div>
</div>
 प्रमाणपत्र के लिए नाम इनपुट मॉडल 
<div aria-labelledby="nameInputTitle" class="name-input-modal" id="nameInputModal" role="dialog">
<div class="name-input-box">
<h3 id="nameInputTitle">Congratulations, Investigator!</h3>
<p style="color: rgba(255,255,255,0.7); margin-bottom: 1rem;">आपने सभी मॉड्यूल पूरे कर लिए हैं। अपने प्रमाणपत्र के लिए अपना नाम दर्ज करें:</p>
<input aria-label="आपका पूरा नाम" id="investigatorName" placeholder="आपका पूरा नाम" type="text">
<button onclick="generateCertificate()">Generate Certificate</button>
</input></div>
</div>
<script>
// ============================================================
// SIDEBAR TOGGLE
// ============================================================
function toggleSidebar() {
  var sidebar = document.querySelector('.sidebar');
  var overlay = document.querySelector('.sidebar-overlay');
  var btn = document.querySelector('.mobile-menu-toggle');
  if (sidebar) sidebar.classList.toggle('open');
  if (overlay) overlay.classList.toggle('show');
  if (btn) btn.setAttribute('aria-expanded', btn.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
}

// ============================================================
// GLOSSARY TERMS
// ============================================================
const glossaryTerms = [
  { term: "Publication Bias", def: "सकारात्मक/महत्वपूर्ण परिणामों वाले अध्ययनों को नकारात्मक/शून्य परिणामों वाले अध्ययनों की तुलना में अधिक बार प्रकाशित करने की प्रवृत्ति, साक्ष्य आधार को विकृत करती है।" },
  { term: "Funnel Plot", def: "A scatter plot of effect size vs. precision (or sample size). Asymmetry suggests possible publication bias or other small-study effects." },
  { term: "Egger's Test", def: "A statistical test for funnel plot asymmetry. Regresses standardized effect on precision. Significant result (p<0.10) suggests bias." },
  { term: "Begg's Test", def: "Rank correlation test between effect size and variance. Less powerful than Egger's but makes fewer assumptions." },
  { term: "ट्रिम करें और भरें", def: "वह विधि जो फ़नल के असममित भाग को 'छंटाई' करके, वास्तविक केंद्र का अनुमान लगाकर, फिर आरोपित अध्ययनों में 'भरकर' लापता अध्ययनों का अनुमान लगाती है।" },
  { term: "Contour-Enhanced Funnel Plot", def: "Funnel plot with significance contours (p=0.05, 0.01) overlaid. Helps distinguish publication bias from other causes of asymmetry." },
  { term: "File Drawer Problem", def: "अप्रकाशित अशक्त अध्ययनों के लिए रोसेंथल का शब्द शोधकर्ताओं के दराज में 'दखल' कर दिया गया, कभी प्रकाशन की रोशनी नहीं देखी गई।" },
  { term: "Fail-Safe N", def: "Number of null studies that would need to exist to reduce a significant meta-analytic result to non-significance. Higher = more robust." },
  { term: "Selection Model", def: "सांख्यिकीय मॉडल जो स्पष्ट रूप से पी-वैल्यू या प्रभाव आकार के फ़ंक्शन के रूप में प्रकाशन की संभावना को मॉडल करता है।" },
  { term: "P-Curve", def: "Distribution of significant p-values. A right-skewed p-curve (many p<0.025) suggests true effect; left-skewed or flat suggests p-hacking or no effect." },
  { term: "Small-Study Effects", def: "Phenomenon where smaller studies show larger effects. Publication bias is one cause; others include genuine heterogeneity or methodological differences." },
  { term: "Trial Registry", def: "डेटाबेस जहां परीक्षण शुरू होने से पहले पंजीकृत होते हैं (उदाहरण के लिए, क्लिनिकलट्रायल्स.जीओवी)। अप्रकाशित पूर्ण परीक्षणों का पता लगाने की अनुमति देता है।" },
  { term: "FOIA Request", def: "सूचना की स्वतंत्रता अधिनियम एफडीए जैसी नियामक एजेंसियों से अप्रकाशित डेटा प्राप्त करने का अनुरोध करता है।" },
  { term: "Outcome Reporting Bias", def: "परिणामों के आधार पर एक अध्ययन के भीतर कुछ परिणामों की चयनात्मक रिपोर्टिंग, लेकिन अन्य की नहीं।" },
  { term: "Spin", def: "भ्रामक रिपोर्टिंग जो डेटा वारंट की तुलना में अधिक अनुकूल परिणाम प्रस्तुत करती है, यहां तक ​​कि डेटा निर्माण के बिना भी।" },
  { term: "Grey Literature", def: "Research not published in peer-reviewed journals: dissertations, conference abstracts, government reports, etc." },
  { term: "PET-PEESE", def: "मानक त्रुटि के साथ परिशुद्धता-प्रभाव परीक्षण और परिशुद्धता-प्रभाव अनुमान। प्रकाशन पूर्वाग्रह को ठीक करने के लिए प्रतिगमन-आधारित तरीके।" },
  { term: "3PSM", def: "Three-Parameter Selection Model. Models selection probability as a step function at p=0.05." }
];

// ============================================================
// COURSE MODULES
// ============================================================
const modules = [
  // MODULE 0: THE GATEWAY
  {
    id: 0,
    title: "The Gateway",
    subtitle: "केस खोलना",
    estimatedMinutes: 15,
    slides: [
      {
        type: 'title',
        content: {
          title: "Publication Bias Detective",
          subtitle: "वह साक्ष्य जिसने कभी प्रकाश नहीं देखा",
          text: "आपका स्वागत है अन्वेषक। आप दबे हुए सबूतों, दबाए गए परीक्षणों और चिकित्सा सत्य की व्यवस्थित विकृति की छिपी हुई दुनिया में प्रवेश करने वाले हैं।"
        }
      },
      {
        type: 'quiz',
        content: {
          question: "PRE-ASSESSMENT: Before we begin, what do you think publication bias typically does to meta-analytic effect estimates?",
          options: [
            { id: 'a', text: "Makes them more accurate by filtering out low-quality studies", correct: false },
            { id: 'b', text: "Inflates them by selectively publishing positive results", correct: true },
            { id: 'c', text: "Has no systematic effect — biases cancel out", correct: false },
            { id: 'd', text: "Deflates them by suppressing the most dramatic findings", correct: false }
          ],
          explanation: "Correct! Publication bias typically INFLATES effect estimates. Positive and statistically significant results are more likely to be published, while negative, null, or inconvenient findings often remain hidden. This creates a systematic overestimate of treatment effects in the published literature. By the end of this course, you'll understand exactly how this happens and what you can do about it."
        }
      },
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "Define publication bias and explain why it occurs",
            "वास्तविक डेटा का उपयोग करके चिकित्सा में प्रकाशन पूर्वाग्रह की भयावहता का वर्णन करें",
            "Identify 3 high-profile cases where publication bias caused patient harm",
            "Recognize why systematic reviews without bias assessment are incomplete",
            "सकारात्मक, नकारात्मक और शून्य निष्कर्षों के बीच अंतर स्पष्ट करें"
          ]
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने इस बात पर विचार नहीं किया है कि एफडीए को सौंपे गए 74 एंटीडिप्रेसेंट परीक्षणों में से, प्रकाशित साहित्य से ऐसा प्रतीत होता है कि 94% सकारात्मक थे - जबकि एफडीए के स्वयं के रिकॉर्ड से पता चला कि केवल 51% सकारात्मक थे?"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE ZERO",
          title: "समस्या का परिमाण",
          source: "टर्नर एट अल., एनईजेएम 2008 - वह अध्ययन जिसने एक उद्योग को उजागर किया",
          timeline: [
            { year: "The Question", text: "Erick Turner, an FDA reviewer turned researcher, asked: What if we could see ALL the antidepressant trials — not just the published ones?", type: "normal" },
            { year: "The Method", text: "He obtained FDA records for 74 trials of 12 antidepressants. Then compared what FDA saw vs. what journals published.", type: "normal" },
            { year: "The Discovery", text: "Of 38 FDA-positive trials: 37 published (97%). Of 36 FDA-negative/questionable trials: only 14 published (39%). And of those 14, 11 were SPUN to appear positive.", type: "buried" },
            { year: "The Impact", text: "Published literature effect size: 0.41. Including unpublished: 0.31. A 32% INFLATION of apparent efficacy. Millions prescribed based on distorted evidence.", type: "revealed" }
          ],
          realData: {
            totalTrials: "74 trials submitted to FDA",
            publishedPositive: "94% appeared positive in literature",
            actualPositive: "51% प्रति एफडीए सकारात्मक थे",
            effectInflation: "32% overestimate in published literature"
          }
        }
      },
      {
        type: 'content',
        content: {
          title: "आपकी जांच टूलकिट",
          sections: [
            {
              heading: "Case File 1: The Buried Bodies",
              items: [
                "रेबॉक्सेटिन - वह दवा जिसमें 74% रोगी डेटा छिपाया गया था",
                "न्यूरोंटिन - $430 मिलियन की धोखाधड़ी",
                "Vioxx - वे मौतें जिनके बारे में पता तो था लेकिन बताया नहीं गया"
              ]
            },
            {
              heading: "Case File 2: The Funnel of Truth",
              items: [
                "Reading funnel plots — the detective's X-ray",
                "विषमता और इससे क्या पता चलता है",
                "Contour-enhanced plots — seeing significance boundaries"
              ]
            },
            {
              heading: "Case File 3: The Statistical Tests",
              items: [
                "Egger's regression — the mathematical detector",
                "Begg's rank correlation — the non-parametric approach",
                "When tests fail and why"
              ]
            },
            {
              heading: "केस फाइल 4: सुधार के तरीके",
              items: [
                "ट्रिम करें और भरें - गुमशुदगी का अनुमान लगाना",
                "Selection models — modeling the censorship",
                "पी-वक्र - सत्य का आकार"
              ]
            },
            {
              heading: "केस फाइल 5: द हंट",
              items: [
                "Trial registries — finding what was started",
                "एफडीए और ईएमए अनुरोध - नियामक पेपर ट्रेल",
                "Grey literature — the unpublished frontier"
              ]
            }
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "I",
          text: "सबूत की अनुपस्थिति अनुपस्थिति का सबूत नहीं है - यह दमन का सबूत हो सकता है।"
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "Publication bias inflates apparent treatment effects by ~30% on average",
            "टर्नर एंटीडिप्रेसेंट अध्ययन में प्रकाशित और वास्तविक सकारात्मक परीक्षणों के बीच 94% बनाम 51% विसंगति का पता चला",
            "गुम डेटा को तटस्थ नहीं माना जा सकता - यह व्यवस्थित रूप से अशक्त/नकारात्मक परिणामों के प्रति पक्षपाती है",
            "Every meta-analysis without bias assessment may be overestimating treatment effects",
            "Publication bias is not random error — it is systematic distortion"
          ],
          actionItem: "Before accepting any meta-analysis conclusion, ask: 'What efforts were made to find unpublished data?'"
        }
      }
    ]
  },

  // MODULE 1: THE BURIED BODIES
  {
    id: 1,
    title: "दफनाए गए शव",
    subtitle: "दमन में केस स्टडीज",
    estimatedMinutes: 25,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "Analyze 3 landmark cases of publication bias and their patient impact",
            "रीबॉक्सेटिन मामले में छिपे हुए डेटा के अनुपात की गणना करें",
            "उन वित्तीय और नियामक तंत्रों की व्याख्या करें जो दमन को सक्षम बनाते हैं",
            "चेतावनी के संकेतों को पहचानें कि प्रकाशित साक्ष्य अधूरे हो सकते हैं",
            "मौतों और विकलांगता में साक्ष्य छिपाने की मानवीय लागत का वर्णन करें"
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "I",
          text: "What is hidden shapes belief as powerfully as what is shown."
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने नहीं देखा कि कैसे फाइजर ने उन सबूतों को दबा दिया कि गैबापेंटिन उन स्थितियों के लिए काम नहीं करता था, जिन्हें उन्होंने प्रचारित किया था - फिर जब शव निकाले गए तो 430 मिलियन डॉलर का भुगतान किया?"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1A",
          title: "रिबॉक्सेटिन: 74% समाधान",
          source: "Eyding et al., BMJ 2010 — IQWiG's Systematic Investigation",
          timeline: [
            { year: "2000s", text: "Reboxetine marketed as an effective antidepressant. Published trials showed it worked. Doctors prescribed it. Patients took it.", type: "normal" },
            { year: "The Hunt", text: "जर्मन इंस्टीट्यूट फॉर क्वालिटी एंड एफिशिएंसी (IQWiG) ने फाइजर से सभी परीक्षण डेटा की मांग की - प्रकाशित और अप्रकाशित।", type: "normal" },
            { year: "The Exhumation", text: "They found: 74% of patient data had NEVER been published. 8 trials, 2,256 patients — buried.", type: "buried" },
            { year: "The Truth", text: "प्रकाशित डेटा: रेबॉक्सेटिन प्लेसीबो से काफी बेहतर है। सभी डेटा: कोई महत्वपूर्ण अंतर नहीं. प्रकाशित साहित्य एक क्यूरेटेड झूठ था।", type: "revealed" },
            { year: "The Verdict", text: "IQWiG ने रीबॉक्सेटिन के लाभ को 'सिद्ध नहीं' बताया। इसे कई देशों में वापस ले लिया गया या प्रतिबंधित कर दिया गया।", type: "revealed" }
          ],
          realData: {
            publishedPatients: "26% रोगी डेटा प्रकाशित किया गया",
            hiddenPatients: "74% रोगी डेटा दबा दिया गया",
            publishedEffect: "Significant benefit vs placebo",
            trueEffect: "No significant benefit vs placebo",
            hiddenTrials: "8 trials with 2,256 patients never published"
          }
        }
      },
      {
        type: 'statistic-card',
        content: {
          value: "74%",
          label: "रीबॉक्सेटीन रोगी डेटा प्रकाशन से छिपा दिया गया था",
          context: "प्रकाशित साहित्य 26% पर बनाया गया था साक्ष्य"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1B",
          title: "न्यूरोंटिन: ऑफ-लेबल मशीन",
          source: "Steinman et al., JAMA 2006 + DOJ Settlement 2004",
          timeline: [
            { year: "1994", text: "Gabapentin (Neurontin) approved by FDA for epilepsy. Limited market.", type: "normal" },
            { year: "The Strategy", text: "Parke-Davis/Pfizer promoted it for off-label uses: pain, bipolar, migraine. But trials for these uses were negative.", type: "normal" },
            { year: "The Burial", text: "आंतरिक दस्तावेजों से पता चला: नकारात्मक परीक्षणों को दबा दिया गया था। सकारात्मक दिखने वाले विश्लेषण चेरी-चुने गए थे। चिकित्सा लेखकों ने अनुकूल पेपर लिखे।", type: "buried" },
            { year: "The Evidence", text: "एक आंतरिक ईमेल: 'हम जो प्रकाशित करते हैं उसके बारे में हमें सावधान रहना होगा... डेटा अच्छा नहीं दिखता है।' अन्य: उन उपयोगों के लिए ड्राफ्ट प्रकाशन जहां डेटा 'सकारात्मक होना चाहिए।'", type: "buried" },
            { year: "The Settlement", text: "2004: Pfizer paid $430 million in criminal and civil penalties. But by then, Neurontin had generated $2.7 billion in off-label sales.", type: "revealed" }
          ],
          realData: {
            approvedUse: "Epilepsy only",
            offLabelSales: "90% बिक्री ऑफ-लेबल थी",
            settlement: "$430 million (criminal + civil)",
            revenue: "ऑफ-लेबल प्रचार से $2.7 बिलियन",
            ratio: "6:1 profit to penalty ratio"
          }
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1C",
          title: "Vioxx: The Deaths They Knew",
          source: "Krumholz et al., JAMA 2007 + Congressional Testimony",
          timeline: [
            { year: "1999", text: "Vioxx (rofecoxib) launched. Merck's blockbuster painkiller. Marketed as safer for stomach than older NSAIDs.", type: "normal" },
            { year: "2000", text: "VIGOR trial finds 5-fold increase in heart attacks vs. naproxen. Merck's interpretation: Naproxen is cardioprotective. Not: Vioxx is cardiotoxic.", type: "normal" },
            { year: "2000-2004", text: "Internal documents show Merck knew of cardiovascular signal. Training materials taught sales reps to 'DODGE' questions about CV safety.", type: "buried" },
            { year: "The Revelation", text: "APPROVe trial stopped: 2x heart attacks. Vioxx withdrawn. FDA scientist David Graham estimates: 88,000-140,000 excess heart attacks, ~30% fatal.", type: "revealed" },
            { year: "The Reckoning", text: "Merck settles for $4.85 billion. Internal documents revealed systematic suppression of safety signals.", type: "revealed" }
          ],
          realData: {
            yearsOnMarket: "5 years (1999-2004)",
            estimatedHeartAttacks: "88,000-140,000 excess cases",
            estimatedDeaths: "26,000-55,000",
            settlement: "$4.85 billion",
            internalKnowledge: "Cardiovascular signal known internally by 2000"
          }
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1D",
          title: "अध्ययन 329: वे बच्चे लुप्तप्राय",
          source: "Jureidini et al., BMJ 2015 — RIAT Reanalysis of GlaxoSmithKline Data",
          timeline: [
            { year: "2001", text: "अध्ययन 329 JAACAP में प्रकाशित। दावा किया गया: 'पैरॉक्सिटाइन आमतौर पर किशोरों में प्रमुख अवसाद के लिए अच्छी तरह से सहन किया जाता है और प्रभावी है।' लेखकों में प्रमुख शिक्षाविद् शामिल हैं।", type: "normal" },
            { year: "The Hidden", text: "आंतरिक जीएसके दस्तावेजों से पता चला: पैरॉक्सिटाइन समूह में आत्महत्या से संबंधित 8 घटनाएं बनाम प्लेसबो में 1 घटना। नशीली दवाओं से आत्मघाती प्रवृत्ति बढ़ी। इसे प्रकाशन से छिपाया गया था।", type: "buried" },
            { year: "The Spin", text: "प्रकाशित पेपर ने आत्मघाती घटनाओं को 'भावनात्मक अक्षमता' के रूप में पुनर्वर्गीकृत किया। गैर-पूर्व-निर्दिष्ट परिणामों पर स्विच करके प्रभावकारिता का दावा किया गया था। पेपर भूत-प्रेत से लिखा गया था।", type: "buried" },
            { year: "2004", text: "एफडीए ने बाल चिकित्सा अवसादरोधी दवाओं के लिए ब्लैक बॉक्स चेतावनी जारी की है। अध्ययन 329 सहित धोखाधड़ी के लिए जीएसके पर 3 बिलियन डॉलर (2012) का जुर्माना लगाया गया। यह दवा लाखों बच्चों को दी गई थी।", type: "revealed" },
            { year: "2015", text: "RIAT reanalysis using actual trial data: 'Paroxetine is neither safe nor effective.' The opposite of the original conclusion. Same data, honest analysis.", type: "revealed" }
          ],
          realData: {
            originalClaim: "प्रभावी और अच्छी तरह से सहन करने वाली",
            realityAfterReanalysis: "Neither safe nor effective",
            suicidalEvents: "8 in paroxetine vs 1 in placebo",
            settlement: "$3 billion (GSK total fraud settlement)",
            childrenExposed: "Millions prescribed worldwide before warning"
          }
        }
      },
      {
        type: 'death-toll',
        content: {
          number: "26,000–55,000",
          label: "Estimated excess deaths from Vioxx alone",
          source: "FDA scientist David Graham's congressional testimony, 2004"
        }
      },
      {
        type: 'oath',
        content: {
          header: "दफनाए गए सबूतों से",
          text: "By the trials that were hidden, and the patients who were harmed —<br><strong>the cost of suppression is measured in lives.</strong><br><br>Every buried study is a betrayal. Every spin is a deception.<br>The detective does not look away. The detective counts the cost."
        }
      },
      {
        type: 'contrast',
        content: {
          title: "नकारात्मक के सामने दो रास्ते डेटा",
          darkSide: {
            header: "छिपाने का मार्ग",
            items: [
              "नकारात्मक परीक्षणों को छुपाएं",
              "भाषा को मोड़ें ('भावनात्मक दायित्व' 'आत्मघाती' नहीं)",
              "Ghostwrite favorable papers",
              "Promote off-label use despite evidence",
              "Pay the fine as cost of doing business"
            ],
            consequence: "Result: Reboxetine prescribed as effective (it wasn't). Vioxx killed tens of thousands. Study 329 endangered children."
          },
          lightSide: {
            header: "का पथ पारदर्शिता",
            items: [
              "Publish all trials regardless of outcome",
              "Report adverse events accurately",
              "स्वतंत्र डेटा एक्सेस की अनुमति दें",
              "साक्ष्य का पालन करें, बाजार का नहीं",
              "Accept reduced profits for patient safety"
            ],
            consequence: "Result: Doctors can make informed decisions. Patients receive treatments that actually work. Trust in medicine is preserved."
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "समीक्षक की दुविधा",
          situation: "You're conducting a meta-analysis of a pain medication. You find 12 published trials — all positive, effect size d=0.45. A colleague mentions rumors of unpublished negative trials. The manufacturer won't share data. What do you do?",
          nodes: [
            {
              id: 'start',
              question: "आपके पास 12 सकारात्मक प्रकाशित परीक्षण हैं। क्या आप मेटा-विश्लेषण के साथ आगे बढ़ते हैं?",
              branches: [
                { id: 'a', text: "हां - उपलब्ध डेटा और नोट सीमाओं के साथ प्रकाशित करें", nextNode: 'publish' },
                { id: 'b', text: "आगे बढ़ने से पहले अप्रकाशित डेटा की तलाश करें", nextNode: 'hunt' },
                { id: 'c', text: "Apply statistical tests for publication bias", nextNode: 'test' }
              ]
            },
            {
              id: 'publish',
              type: 'outcome',
              consequence: 'bad',
              title: "रीबॉक्सेटिन रीप्ले",
              text: "Your meta-analysis shows strong efficacy (d=0.45). Guidelines cite it. Prescriptions increase. Two years later, regulatory investigation reveals 8 unpublished negative trials. True effect: d=0.15, non-significant. Your published meta-analysis contributed to patients receiving ineffective treatment.",
              realCase: "रीबॉक्सेटिन के साथ ठीक यही हुआ है। एकाधिक प्रकाशित मेटा-विश्लेषणों ने लाभ दिखाया - जब तक कि IQWiG ने अप्रकाशित डेटा प्राप्त नहीं किया और प्रभाव गायब नहीं हो गया।"
            },
            {
              id: 'hunt',
              question: "आप क्लीनिकलट्रायल्स.जीओवी खोजते हैं और बिना किसी प्रकाशित परिणाम के 6 पूर्ण परीक्षण पाते हैं। आप परीक्षणकर्ताओं से संपर्क करें और एफओआईए अनुरोध दर्ज करें। क्या होता है?",
              branches: [
                { id: 'd', text: "आपको 6 में से 4 परीक्षण डेटासेट प्राप्त होते हैं - 3 नकारात्मक हैं", nextNode: 'found' },
                { id: 'e', text: "अनुरोध अस्वीकृत या नजरअंदाज किए गए - आपके पास कोई नया डेटा नहीं है", nextNode: 'blocked' }
              ]
            },
            {
              id: 'found',
              type: 'outcome',
              consequence: 'good',
              title: "सच्चाई उभरती है",
              text: "Including the unpublished data: effect drops to d=0.22, barely significant. Your meta-analysis reports BOTH estimates, notes the discrepancy, and warns about likely publication bias. Clinicians can make informed decisions. Your work prevents another reboxetine.",
              realCase: "टर्नर ने एंटीडिप्रेसेंट्स और आइडिंग के साथ यही किया रीबॉक्सेटीन के साथ - सच्ची तस्वीर प्रकट करने के लिए नियामक डेटा प्राप्त करना।"
            },
            {
              id: 'blocked',
              question: "आप अप्रकाशित डेटा प्राप्त नहीं कर सकते। आपका फ़नल प्लॉट संदिग्ध लग रहा है. आप क्या रिपोर्ट करते हैं?",
              branches: [
                { id: 'f', text: "प्रभाव की रिपोर्ट करें लेकिन मजबूत चेतावनी और पूर्वाग्रह मूल्यांकन के साथ", nextNode: 'cautious' },
                { id: 'g', text: "Use trim-and-fill to estimate adjusted effect", nextNode: 'adjust' }
              ]
            },
            {
              id: 'cautious',
              type: 'outcome',
              consequence: 'neutral',
              title: "ईमानदार अज्ञात",
              text: "You report: 'Published trials suggest d=0.45, but funnel plot asymmetry and registry search indicate likely missing negative trials. We located 6 unpublished trials that could not be obtained. True effect is likely smaller.' GRADE assessment: downgrade for publication bias. You've flagged the problem even without solving it.",
              realCase: "GRADE स्पष्ट रूप से संदिग्ध प्रकाशन पूर्वाग्रह के लिए डाउनग्रेडिंग की अनुमति देता है। अनिश्चितता के बारे में पारदर्शिता झूठी सटीकता से अधिक मूल्यवान है।"
            },
            {
              id: 'adjust',
              type: 'outcome',
              consequence: 'neutral',
              title: "सांख्यिकीय सुधार",
              text: "Trim-and-fill imputes 5 missing studies. Adjusted effect: d=0.28. You report both estimates with explanation. Caveat: Trim-and-fill assumes publication bias is the ONLY cause of asymmetry, and doesn't recover the actual missing data. It's an approximation, not a solution.",
              realCase: "ट्रिम-एंड-फिल का व्यापक रूप से उपयोग किया जाता है लेकिन इसकी सीमाएं हैं। यह अधिक या कम सुधार कर सकता है। चयन मॉडल अधिक सटीक हो सकते हैं लेकिन चयन तंत्र के बारे में धारणाओं की आवश्यकता होती है।"
            },
            {
              id: 'test',
              question: "Egger's test: p=0.03 (significant asymmetry). Begg's test: p=0.08 (borderline). Funnel plot shows gap in bottom-left. What do you conclude?",
              branches: [
                { id: 'h', text: "Publication bias is confirmed — adjust the estimate", nextNode: 'confirmed' },
                { id: 'i', text: "परीक्षण विचारोत्तेजक हैं लेकिन निश्चित नहीं हैं - आगे की जांच करें", nextNode: 'investigate' }
              ]
            },
            {
              id: 'confirmed',
              type: 'outcome',
              consequence: 'bad',
              title: "अति आत्मविश्वासी निष्कर्ष",
              text: "You state 'publication bias confirmed' and apply trim-and-fill. But Egger's test has high false positive rate with few studies and high heterogeneity. The asymmetry might be due to genuine effect modification (smaller trials in sicker patients). You've made a statistical inference that requires clinical verification.",
              realCase: "Funnel plot asymmetry has many causes beyond publication bias: heterogeneity, methodological differences in small studies, true biology. Tests can't distinguish these."
            },
            {
              id: 'investigate',
              type: 'outcome',
              consequence: 'good',
              title: "व्यापक मूल्यांकन",
              text: "You use contour-enhanced funnel plots: missing studies are in non-significant regions (suggests publication bias, not heterogeneity). You check if smaller studies differ methodologically (they don't). You search registries (find unpublished trials). You report: 'Multiple lines of evidence suggest publication bias' with GRADE downgrade. Full transparency, appropriate uncertainty.",
              realCase: "Modern guidance recommends multiple approaches: visual assessment, statistical tests, registry searches, and clinical judgment. No single method is sufficient."
            }
          ]
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1E",
          title: "Avandia: The 83,000 Heart Attacks",
          source: "Nissen & Wolski, NEJM 2007 + Senate Finance Committee Investigation",
          timeline: [
            { year: "1999", text: "Rosiglitazone (Avandia) approved for diabetes. GlaxoSmithKline's blockbuster drug.", type: "normal" },
            { year: "छिपे हुए संकेत", text: "2000 तक, जीएसके के आंतरिक मेटा-विश्लेषण से पता चला कि हृदय संबंधी घटनाओं का जोखिम 30% बढ़ गया है। उन्होंने और अधिक विश्लेषण कराये - सभी ने एक ही संकेत दिखाया। कोई भी प्रकाशित नहीं किया गया।", type: "buried" },
            { year: "2007", text: "Cardiologist Steven Nissen obtains 42 trial datasets through legal discovery. His meta-analysis: 43% increased MI risk (OR 1.43, p=0.03). Published in NEJM.", type: "revealed" },
            { year: "The Toll", text: "FDA estimates: 83,000 excess heart attacks from 1999-2007. GSK had known since 2000. Seven years of silence. Seven years of prescriptions.", type: "revealed" },
            { year: "The Reckoning", text: "GSK ने $3 बिलियन का भुगतान किया (2012)। अवंदिया प्रतिबंधित। लेकिन क्षति हो चुकी थी - और प्रकाशित साहित्य ने इसे छुपाया था।", type: "revealed" }
          ],
          realData: {
            approvalYear: "1999",
            internalSignalYear: "2000",
            publicRevelationYear: "2007",
            yearsOfSuppression: "7 years",
            estimatedExcessMIs: "83,000",
            settlement: "$3 billion"
          }
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने यह नहीं सोचा है कि सात साल तक, एक कंपनी जानती थी कि उनकी दवा से दिल का दौरा पड़ता है - और कुछ नहीं कहा? जब सबूत कॉरपोरेट फाइलों में पड़े थे तब 83,000 दिल क्षतिग्रस्त हो गए थे?"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 1F",
          title: "घटती धोखाधड़ी: जब डेटा का आविष्कार किया गया था",
          source: "Erasmus MC Investigation 2012 + Bouri et al. BMJ 2014 Reanalysis",
          timeline: [
            { year: "Background", text: "डॉन पोल्डरमैन्स सर्जरी से पहले बीटा-ब्लॉकर्स पर दुनिया के अग्रणी विशेषज्ञ थे। उनके DECREASE परीक्षणों ने नाटकीय रूप से मृत्यु दर में कमी दिखाई। उनके काम के आधार पर दुनिया भर में दिशानिर्देश बदल गए।", type: "normal" },
            { year: "The Suspicion", text: "अन्य शोधकर्ता उनके परिणामों को दोहरा नहीं सके। उनके प्रभाव का आकार असंभव रूप से बड़ा था। डेटा पैटर्न बहुत साफ लग रहा था।", type: "normal" },
            { year: "2012", text: "इरास्मस मेडिकल सेंटर की जांच: पोल्डरमैन ने कई अध्ययनों में डेटा तैयार किया। उन्होंने रोगियों का आविष्कार किया। उसने परिणामों को गलत ठहराया।", type: "buried" },
            { year: "The Reanalysis", text: "Bouri et al. reanalyzed all beta-blocker trials EXCLUDING Poldermans' data. Without his studies: NO mortality benefit, possible HARM. Guidelines had been based on fraud.", type: "revealed" },
            { year: "The Cost", text: "European guidelines caused an estimated 10,000 excess deaths per year by recommending routine beta-blockers. Based on fabricated evidence.", type: "revealed" }
          ],
          realData: {
            fraudulentTrials: "DECREASE I, II, IV",
            originalClaim: "34% mortality reduction",
            truthWithoutFraud: "No benefit, possible harm",
            estimatedAnnualDeaths: "~10,000 excess deaths/year in Europe",
            guidelineImpact: "ESC guidelines changed worldwide practice"
          }
        }
      },
      {
        type: 'death-toll',
        content: {
          number: "10,000/year",
          label: "Estimated excess deaths in Europe from guidelines based on DECREASE fraud",
          source: "Bouri et al., Heart 2014"
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "व्हिसलब्लोअर क्रॉसरोड्स",
          situation: "You're a junior researcher at a pharmaceutical company. You've discovered that your company has 5 unpublished trials showing the drug increases cardiovascular events. The drug is already approved and generating $2 billion/year. Your supervisor tells you to focus on other projects and 'let the medical affairs team handle regulatory issues.' What do you do?",
          nodes: [
            {
              id: 'start',
              question: "आपको छिपे हुए नुकसान का सबूत मिला है। आपका करियर दांव पर है. आप क्या करते हैं?",
              branches: [
                { id: 'a', text: "Stay silent — it's above your pay grade", nextNode: 'silent' },
                { id: 'b', text: "Report internally through compliance channels", nextNode: 'internal' },
                { id: 'c', text: "Become a whistleblower — contact FDA or journalists", nextNode: 'whistleblow' }
              ]
            },
            {
              id: 'silent',
              type: 'outcome',
              consequence: 'bad',
              title: "चुप्पी का वजन",
              text: "आप चुप रहते हैं। दवा की बिक्री जारी है. दिल का दौरा पड़ता रहता है. वर्षों बाद, मुकदमेबाजी के माध्यम से सच्चाई सामने आती है। आपने पढ़ा कि हजारों लोगों को नुकसान हुआ. तुम्हें पता था. आपने कुछ नहीं कहा. आपने जो पैसा कमाया वह खून का पैसा था। आपने जिस करियर की रक्षा की, वह मिलीभगत पर आधारित था।",
              realCase: "कई फार्मास्युटिकल कर्मचारी Vioxx, Avandia और अन्य घोटालों के बारे में जानते थे। अधिकांश चुप रहे. कुछ लोगों ने बाद में गवाही दी कि अपराधबोध ने उन्हें कभी नहीं छोड़ा।"
            },
            {
              id: 'internal',
              question: "आप एक आंतरिक अनुपालन रिपोर्ट दाखिल करते हैं। सप्ताह बीत जाते हैं. अनुपालन अधिकारी आपको धन्यवाद देता है और कहता है 'मामला संभाला जा रहा है।' आप आगे क्या करेंगे?",
              branches: [
                { id: 'd', text: "Trust the process — compliance will handle it", nextNode: 'trust' },
                { id: 'e', text: "अनुवर्ती कार्रवाई करें और कार्रवाई के सबूत मांगें", nextNode: 'followup' },
                { id: 'f', text: "Document everything and prepare external escalation", nextNode: 'document' }
              ]
            },
            {
              id: 'trust',
              type: 'outcome',
              consequence: 'bad',
              title: "झूठा आश्वासन",
              text: "कुछ भी नहीं बदलेगा। महीनों बाद, आपको चुपचाप एक अलग डिवीजन में स्थानांतरित कर दिया जाता है। दवा जारी है. आप सीखते हैं कि 'अनुपालन प्रबंधन' का मतलब भविष्य की मुकदमेबाजी का बचाव कैसे किया जाए, इसकी कानूनी समीक्षा है, न कि मरीजों की सुरक्षा कैसे करें। आपकी रिपोर्ट दर्ज की गई - और परीक्षणों के साथ ही दफन कर दी गई।",
              realCase: "आंतरिक अनुपालन अक्सर कंपनी की रक्षा करता है, मरीजों की नहीं। जीएसके में चेरिल एकार्ड ने संघीय व्हिसलब्लोअर बनने से पहले वर्षों तक आंतरिक रूप से विनिर्माण समस्याओं की सूचना दी थी।"
            },
            {
              id: 'followup',
              type: 'outcome',
              consequence: 'neutral',
              title: "द पेपर ट्रेल",
              text: "आप मीटिंग नोट्स, एक्शन आइटम, नियामक फाइलिंग की मांग करते हैं। आपको बताया गया है कि यह 'विशेषाधिकार प्राप्त जानकारी' है। आपकी दृढ़ता नोट की गई है - सकारात्मक रूप से नहीं। आपको 'टीम खिलाड़ी नहीं' का लेबल दिया गया है। लेकिन आपने एक रिकॉर्ड बनाया है. जब घोटाला आखिरकार टूट जाता है, तो आपकी दस्तावेजी चिंताएं सबूत बन जाती हैं।",
              realCase: "Documentation protects whistleblowers legally. Peter Rost at Pfizer kept meticulous records that later proved invaluable in legal proceedings."
            },
            {
              id: 'document',
              type: 'outcome',
              consequence: 'good',
              title: "तैयार पथ",
              text: "You keep copies of everything. You consult a whistleblower attorney. You understand the False Claims Act and qui tam provisions. When internal channels fail, you're ready. Your documentation becomes the foundation for a federal case. You face retaliation — but you're protected by law, and you sleep at night.",
              realCase: "Successful whistleblowers like Cheryl Eckard and John Kopchinski prepared extensively before going external. Eckard received $96 million; Kopchinski received $51 million."
            },
            {
              id: 'whistleblow',
              question: "You decide to go external. But how?",
              branches: [
                { id: 'g', text: "Contact a journalist at a major newspaper", nextNode: 'journalist' },
                { id: 'h', text: "दस्तावेज़ीकरण के साथ सील के तहत एक क्वि टैम मुकदमा दायर करें", nextNode: 'quitam' },
                { id: 'i', text: "Report directly to FDA's MedWatch", nextNode: 'fda' }
              ]
            },
            {
              id: 'journalist',
              type: 'outcome',
              consequence: 'neutral',
              title: "सार्वजनिक रहस्योद्घाटन",
              text: "एक पत्रकार जांच करता है। कहानी टूट जाती है. लेकिन कानूनी सुरक्षा के बिना, आपको तुरंत निकाल दिया जाता है। कंपनी का दावा है कि आपने गोपनीयता का उल्लंघन किया है। आपको महंगी मुकदमेबाजी का सामना करना पड़ता है। सच्चाई सामने है - लेकिन आपका करियर और वित्त नष्ट हो गया है। पत्रकारिता उजागर करती है, लेकिन उजागर करने वाले की रक्षा नहीं करती।",
              realCase: "Many whistleblowers who went to media first faced devastating retaliation. Legal protection requires following specific procedures."
            },
            {
              id: 'quitam',
              type: 'outcome',
              consequence: 'good',
              title: "संरक्षित पथ",
              text: "A qui tam lawyer files under seal. The government investigates with your evidence. Years later, the case resolves: the company pays billions, patients are warned, and you receive 15-25% of the recovery. The process was long and stressful, but you're protected by law and rewarded for integrity.",
              realCase: "झूठा दावा अधिनियम 1986 से 70 बिलियन डॉलर से अधिक की वसूली कर चुका है। फार्मास्युटिकल मामलों का बड़ा हिस्सा है। वसूली में व्हिसलब्लोअर्स का हिस्सा होता है।"
            },
            {
              id: 'fda',
              type: 'outcome',
              consequence: 'neutral',
              title: "नियामक मार्ग",
              text: "एफडीए आपकी रिपोर्ट को गंभीरता से लेता है। वे कंपनी से दस्तावेज़ मांगते हैं. कंपनी वकील करती है. इस प्रक्रिया में वर्षों लग जाते हैं। अंततः, लेबल में एक चेतावनी जोड़ दी जाती है। लेकिन आपके पास कोई वित्तीय सुरक्षा नहीं है, कोई कानूनी सुरक्षा नहीं है। आपने सही काम किया - लेकिन सिस्टम ने ऐसा करने के लिए आपकी सुरक्षा नहीं की।",
              realCase: "एफडीए स्वैच्छिक रिपोर्टिंग पर निर्भर है और उसके पास सीमित प्रवर्तन शक्ति है। FDA वैज्ञानिक डेविड ग्राहम को अपने Vioxx विश्लेषण के लिए आंतरिक प्रतिशोध का सामना करना पड़ा।"
            }
          ]
        }
      },
      {
        type: 'legal-disclaimer',
        content: {
          text: "This educational content about whistleblowing is provided for informational purposes only and does NOT constitute legal advice. Whistleblower protections vary SIGNIFICANTLY by country, jurisdiction, employer type (government vs. private), and type of misconduct. The consequences of disclosure can be severe, including termination, blacklisting, and personal liability. INTERNATIONAL NOTE: The resources below are primarily US-focused. Many countries have different (often weaker) protections. EU Directive 2019/1937 provides baseline protections in Europe, but implementation varies. BEFORE taking any action on suspected misconduct, consult with a qualified attorney who specializes in whistleblower protection law in YOUR jurisdiction.",
          resources: [
            { name: "Government Accountability Project (US)", url: "https://whistleblower.org/" },
            { name: "National Whistleblower Center (US)", url: "https://www.whistleblowers.org/" },
            { name: "OSHA Whistleblower Protection Program (US)", url: "https://www.osha.gov/whistleblower" },
            { name: "Whistleblower Network News (International)", url: "https://whistleblowersblog.org/" },
            { name: "EU Whistleblower Directive Info", url: "https://ec.europa.eu/info/aid-development-cooperation-fundamental-rights/your-rights-eu/whistleblower-protection_en" }
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Scientists Discover Hidden Harm",
          darkSide: {
            header: "मूक गवाह",
            items: [
              "अप्रकाशित परीक्षण देखता है",
              "Raises concern once, is dismissed",
              "Accepts 'it's being handled'",
              "Focuses on other projects",
              "वर्षों बाद, मौतों के बारे में पढ़ता हूँ",
              "उन्होंने क्या नहीं किया, इस ज्ञान के साथ जीते हैं"
            ],
            consequence: "Result: Career preserved. Conscience damaged. When the scandal breaks, they weren't part of the cover-up — but they weren't part of the solution either."
          },
          lightSide: {
            header: "लगातार आवाज",
            items: [
              "Sees the same unpublished trials",
              "Documents everything meticulously",
              "Escalates through proper channels",
              "When channels fail, consults attorney",
              "Files protected disclosure",
              "Faces retaliation but persists"
            ],
            consequence: "Result: Career disrupted but rebuilt. Patients protected. Years later, receives recognition and compensation. Sleeps soundly knowing they acted when it mattered."
          }
        }
      },
      {
        type: 'clinical-guide',
        content: {
          title: "Red Flags for Publication Bias",
          items: [
            "सभी प्रकाशित परीक्षण सकारात्मक हैं (विशेषकर व्यक्तिपरक परिणामों के लिए)",
            "Effect sizes are implausibly large compared to mechanism",
            "Industry-sponsored trials have larger effects than independent trials",
            "Conference abstracts never became full publications",
            "Registered trials on ClinicalTrials.gov have no published results",
            "परिणाम सम्मेलनों में प्रस्तुत किए गए और फिर 'गायब' हो गए",
            "Internal documents (litigation, FOIA) reveal suppressed trials",
            "Funnel plot shows asymmetric gap in bottom-left quadrant"
          ]
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "जो छिपा है वह विश्वास को उतना ही शक्तिशाली रूप देता है जितना दिखाया जाता है। जासूस का पहला काम यह जानना है कि कुछ छिपा हुआ है।"
        }
      },
      {
        type: 'quiz',
        content: {
          question: "रीबॉक्सेटीन मामले में, कितने प्रतिशत रोगी डेटा कभी प्रकाशित नहीं किया गया था?",
          options: [
            { id: 'a', text: "26%", correct: false },
            { id: 'b', text: "51%", correct: false },
            { id: 'c', text: "74%", correct: true },
            { id: 'd', text: "94%", correct: false }
          ],
          explanation: "रीबॉक्सेटिन परीक्षणों से 74% रोगी डेटा कभी प्रकाशित नहीं किया गया था। केवल 26% ने इसे प्रकाशित साहित्य में शामिल किया। जब IQWiG ने सारा डेटा प्राप्त किया, तो दवा की स्पष्ट प्रभावकारिता गायब हो गई। यह मामला दर्शाता है कि क्यों अप्रकाशित डेटा प्रकाशित डेटा की मात्रा से अधिक मायने रखता है।"
        }
      },
      {
        type: 'protagonist-story',
        content: {
          name: "Dr. Erick Turner",
          role: "FDA Reviewer turned Whistleblower Researcher",
          narrative: "As an FDA medical reviewer, Erick Turner saw something troubling: antidepressant trials submitted to the FDA often had different results than what appeared in published journals. After leaving the FDA, he conducted the landmark 2008 study comparing FDA records to published literature for 74 antidepressant trials. What he found shocked medicine: while published literature suggested 94% of trials were positive, FDA records showed only 51% were truly positive.",
          quote: "साहित्य ऐसा लग रहा था जैसे यह वोबेगॉन झील से आया हो, जहां सभी बच्चे औसत से ऊपर हैं।",
          impact: "एनईजेएम में प्रकाशित उनके अध्ययन ने प्रकाशन पूर्वाग्रह को समझने के हमारे तरीके को मौलिक रूप से बदल दिया। इसने स्पष्ट प्रमाण प्रदान किया कि प्रकाशित चिकित्सा साहित्य व्यवस्थित रूप से उपचार प्रभावकारिता को बढ़ा-चढ़ाकर पेश करता है।"
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "Reboxetine case: 74% of patient data hidden, drug approval revoked when full data emerged",
            "Vioxx case: 88,000-140,000 excess heart attacks, company knew early",
            "Paroxetine Study 329: Suicide risk hidden, ghostwritten, led to $3 billion settlement",
            "Financial incentives powerfully drive selective publication",
            "Regulatory submissions often tell a different story than published papers"
          ],
          actionItem: "आपके द्वारा नियमित रूप से लिखी जाने वाली किसी भी दवा के लिए, FDA समीक्षाएँ या नियामक दस्तावेज़ खोजें - तुलना करें कि नियामकों ने क्या देखा और जो प्रकाशित किया गया था।"
        }
      }
    ]
  },

  // MODULE 2: THE FUNNEL OF TRUTH
  {
    id: 2,
    title: "सत्य की फ़नल",
    subtitle: "Visual Detection",
    estimatedMinutes: 20,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "Explain the statistical principles behind funnel plot asymmetry",
            "Interpret funnel plots and identify patterns suggesting publication bias",
            "Distinguish between small-study effects and true publication bias",
            "अपने स्वयं के मेटा-विश्लेषणों का आकलन करने के लिए इंटरैक्टिव फ़नल प्लॉट टूल का उपयोग करें",
            "Recognize limitations and confounders of funnel plot interpretation"
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "II",
          text: "फ़नल से पता चलता है कि जंगल क्या छुपाता है - जो प्रकाशित हुआ था उसका आकार, और जो प्रकाशित नहीं हुआ था उसकी छाया।"
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने नहीं देखा कि कैसे एक सममित फ़नल प्लॉट घोषित करता है: 'प्रकाशन सभी परिणामों के लिए निष्पक्ष था' - जबकि एक असममित फ़नल फुसफुसाता है: 'किसी ने वह चुना जो आप देखेंगे'?"
        }
      },
      {
        type: 'content',
        content: {
          title: "फ़नल का तर्क",
          sections: [
            {
              heading: "Why a Funnel Shape?",
              items: [
                "Large studies (top): precise estimates, cluster tightly around true effect",
                "Small studies (bottom): imprecise, scatter widely around true effect",
                "यदि सभी अध्ययन परिणामों की परवाह किए बिना प्रकाशित किए जाते हैं: सममित बिखराव",
                "यदि केवल महत्वपूर्ण परिणाम प्रकाशित किए जाते हैं: असममित बिखराव"
              ]
            },
            {
              heading: "Reading the X-Axis (Effect Size)",
              items: [
                "Horizontal position shows each study's effect estimate",
                "Pooled estimate typically shown as vertical line",
                "केंद्र से दूरी औसत से विचलन दर्शाती है"
              ]
            },
            {
              heading: "Y-अक्ष पढ़ना (परिशुद्धता)",
              items: [
                "Standard error (inverted: 0 at top, larger SE at bottom)",
                "OR sample size (larger at top)",
                "OR precision (1/SE, larger at top)",
                "Top = more precise = more confident estimates"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-funnel',
        content: {
          id: 'funnel-basic',
          title: "Interactive Funnel Plot",
          description: "अन्वेषण करें कि प्रकाशन पूर्वाग्रह फ़नल आकार को कैसे विकृत करता है। प्रभाव देखने के लिए बायस को चालू/बंद करें।"
        }
      },
      {
        type: 'content',
        content: {
          title: "विषमता: पूर्वाग्रह की अंगुली छाप",
          sections: [
            {
              heading: "गुम कोना",
              items: [
                "Bottom-left gap: Small, non-significant, negative studies missing",
                "यह क्लासिक प्रकाशन पूर्वाग्रह पैटर्न है",
                "अशक्त परिणामों वाले छोटे अध्ययन → दूर रखे गए, कभी प्रकाशित नहीं हुए",
                "Large studies published regardless (too big to bury)"
              ]
            },
            {
              heading: "But Asymmetry Has Other Causes",
              items: [
                "TRUE HETEROGENEITY: Small studies in sicker patients → larger effects (real)",
                "METHODOLOGICAL DIFFERENCES: Small studies less rigorous → inflated effects",
                "CHANCE: With few studies, asymmetry can occur randomly",
                "ARTEFACT: Some effect measures (OR) create asymmetry naturally"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-contour',
        content: {
          id: 'contour-funnel',
          title: "Contour-Enhanced Funnel Plot",
          description: "Contours show significance boundaries. If missing studies fall in non-significant regions, publication bias is likely. If they fall in significant regions, other explanations apply."
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 2A",
          title: "The HRT Reversal: When Observation Deceived",
          source: "WHI Trial, JAMA 2002 + Decades of Observational Studies",
          timeline: [
            { year: "1980s-90s", text: "अवलोकन संबंधी अध्ययनों से लगातार पता चला है: एचआरटी पर महिलाओं में हृदय रोग का जोखिम 40-50% कम था। मेटा-विश्लेषण ने इसकी पुष्टि की। दिशानिर्देशों ने कार्डियोप्रोटेक्शन के लिए एचआरटी की सिफारिश की।", type: "normal" },
            { year: "The Logic", text: "यह काम क्यों नहीं करेगा? एस्ट्रोजेन लिपिड प्रोफाइल में सुधार करता है। जीवविज्ञान समझ में आया. लगातार अवलोकन संबंधी डेटा ने इसे 'साबित' किया।", type: "normal" },
            { year: "2002", text: "महिला स्वास्थ्य पहल (डब्ल्यूएचआई) - पहला बड़ा यादृच्छिक परीक्षण - जल्दी बंद कर दिया गया। एचआरटी ने हृदय संबंधी घटनाओं में 29% की वृद्धि की। सबने जो विश्वास किया उसके विपरीत।", type: "revealed" },
            { year: "The Explanation", text: "Healthy user bias: Women who took HRT were healthier, more educated, more health-conscious. The 'protection' was confounding, not causation. And unpublished negative observational studies? Nobody looked for them.", type: "revealed" }
          ],
          realData: {
            observationalEstimate: "40-50% risk reduction",
            rctResult: "29% risk INCREASE",
            discrepancy: "Complete reversal",
            yearsOfWrongPractice: "20+ years",
            cause: "Healthy user bias + possible publication bias in observational studies"
          }
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने नहीं देखा कि कैसे बीस वर्षों तक, चिकित्सा समुदाय - 'मजबूत सबूत' के साथ - विश्वास करता रहा कि हार्मोन थेरेपी हृदय की रक्षा करती है? और कैसे एक यादृच्छिक परीक्षण से पता चला कि अवलोकन ने उन सभी को धोखा दिया था?"
        }
      },
      {
        type: 'oath',
        content: {
          header: "फ़नल की गवाही से",
          text: "The funnel plot does not lie — <strong>but it can be misread.</strong><br><br>Asymmetry is a witness, not a verdict.<br>It testifies that something is unusual.<br>It does not testify WHY.<br><br>The detective who sees asymmetry and cries 'bias!'<br>is no better than the one who sees symmetry and cries 'truth!'<br><br><strong>Both must investigate. Both must verify. Both must doubt.</strong>"
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "जर्नल संपादक की दुविधा",
          situation: "You're the editor of a major medical journal. A researcher submits a well-conducted trial showing NO effect of a popular supplement on cognitive function (null result, p=0.67). Three positive trials have been published elsewhere. The methods are rigorous. The sample size is adequate. Your reviewers are split — some say 'not novel enough,' others say 'important null finding.' What do you do?",
          nodes: [
            {
              id: 'start',
              question: "एक कठोर शून्य परीक्षण आपके डेस्क पर आता है। आपका निर्णय क्या है?",
              branches: [
                { id: 'a', text: "अस्वीकार करें - शून्य निष्कर्ष हमारे जर्नल के लिए पर्याप्त रोमांचक नहीं हैं", nextNode: 'reject' },
                { id: 'b', text: "Accept — null findings are scientifically important", nextNode: 'accept' },
                { id: 'c', text: "Request additional analyses to find 'something interesting'", nextNode: 'fish' }
              ]
            },
            {
              id: 'reject',
              type: 'outcome',
              consequence: 'bad',
              title: "पूर्वाग्रह पैदा करने वाला निर्णय",
              text: "You reject the null study. The researcher, demoralized, files it away. The published literature now contains 3 positive trials and 0 negative trials. Future meta-analysts will see only the positives. Your decision — multiplied across thousands of editors — IS publication bias. You didn't suppress evidence maliciously. You just found it boring.",
              realCase: "अध्ययन से पता चलता है कि शून्य परिणाम प्रकाशित होने की संभावना 50% कम है। अधिकांश जर्नल संपादक इसका कारण 'नवीनता की कमी' बताते हैं। संचयी प्रभाव साक्ष्य आधार को विकृत कर देता है।"
            },
            {
              id: 'accept',
              type: 'outcome',
              consequence: 'good',
              title: "काउंटर-कल्चरल चॉइस",
              text: "You accept the null study with an editorial on the importance of publishing negative results. Meta-analysts now have a more complete picture: 3 positive trials and 1 negative. The effect estimate shrinks. Clinicians make better-informed decisions. You've contributed to truth — even though it won't boost your impact factor.",
              realCase: "PLOS ONE और अन्य जर्नल अब स्पष्ट रूप से अशक्त परिणामों का स्वागत करते हैं। कुछ विशेष पत्रिकाएँ नकारात्मक निष्कर्षों पर ध्यान केंद्रित करती हैं। संस्कृति धीरे-धीरे बदल रही है।"
            },
            {
              id: 'fish',
              type: 'outcome',
              consequence: 'bad',
              title: "पी-हैकिंग आमंत्रण",
              text: "You ask: 'Did you check subgroups? Any secondary outcomes significant?' The researcher re-analyzes. In men over 65 with baseline cognitive impairment, there's a hint of effect (p=0.04). The paper is revised to emphasize this 'finding.' You've published — but you've also taught the researcher that fishing for significance is how to get published.",
              realCase: "यह गतिशील - संपादक 'दिलचस्प' पुनर्विश्लेषण का अनुरोध करते हैं - पी-हैकिंग और चयनात्मक रिपोर्टिंग का एक प्रमुख चालक है। यह झूठी सकारात्मकताएं पैदा करता है जो वास्तविक निष्कर्षों की तरह दिखती हैं।"
            }
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Funnels, Two Truths",
          darkSide: {
            header: "फ़नल जो सममित दिखाई देता है",
            items: [
              "15 studies form a beautiful symmetric cone",
              "Egger's test: p=0.45 (not significant)",
              "निष्कर्ष: 'प्रकाशन पूर्वाग्रह का कोई सबूत नहीं'",
              "BUT: Registry search not performed",
              "लेकिन: सभी अध्ययन उद्योग-वित्त पोषित",
              "BUT: 8 registered trials have no published results"
            ],
            consequence: "अप्रकाशित होने के कारण फ़नल साफ दिखता है अध्ययन की कभी योजना नहीं बनाई गई। ग्राफ से अनुपस्थिति ≠ वास्तविकता से अनुपस्थिति।"
          },
          lightSide: {
            header: "असममित दिखाई देने वाली फ़नल",
            items: [
              "12 अध्ययन स्पष्ट विषमता दिखाते हैं",
              "Egger's test: p=0.02 (significant)",
              "Initial conclusion: 'Publication bias!'",
              "लेकिन: छोटे अध्ययन बीमार रोगियों में थे",
              "BUT: Larger effects in severe disease is expected",
              "BUT: Stratified analysis shows no bias within severity groups"
            ],
            consequence: "वास्तविक होने के कारण फ़नल पक्षपाती लग रहा था विविधता. विषमता जीवविज्ञान थी, दमन नहीं। जांच से सच्चाई सामने आई।"
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "Interpreting Funnel Asymmetry",
          situation: "आपका फ़नल प्लॉट स्पष्ट विषमता दिखाता है - नीचे-बाएँ से अध्ययन गायब हैं। आपके मेटा-विश्लेषण में 15 अध्ययन हैं। आप इसकी व्याख्या कैसे करते हैं?",
          nodes: [
            {
              id: 'start',
              question: "आप लापता छोटे नकारात्मक अध्ययनों के साथ फ़नल प्लॉट विषमता देखते हैं। आपकी व्याख्या क्या है?",
              branches: [
                { id: 'a', text: "Publication bias is confirmed — small negative studies weren't published", nextNode: 'bias_confirmed' },
                { id: 'b', text: "Check where missing studies fall relative to significance contours", nextNode: 'contours' },
                { id: 'c', text: "जांचें कि क्या छोटे अध्ययन बड़े अध्ययनों से व्यवस्थित रूप से भिन्न होते हैं", nextNode: 'heterogeneity' }
              ]
            },
            {
              id: 'bias_confirmed',
              type: 'outcome',
              consequence: 'bad',
              title: "समयपूर्व निष्कर्ष",
              text: "You conclude publication bias without considering alternatives. But asymmetry can have multiple causes. If small studies enrolled sicker patients (common in proof-of-concept trials), larger effects are EXPECTED. Your 'bias' may be biology. Always consider: Is there a clinical reason small studies might differ?",
              realCase: "स्टर्न एट अल। (बीएमजे 2011) ने प्रलेखित किया कि 'छोटे अध्ययन प्रभाव' 'प्रकाशन पूर्वाग्रह' से बेहतर शब्द है क्योंकि कारण कई हैं।"
            },
            {
              id: 'contours',
              question: "You add contour enhancement. Missing studies fall clearly in the p>0.05 region (non-significant). What does this suggest?",
              branches: [
                { id: 'd', text: "Publication bias is the most likely explanation", nextNode: 'bias_likely' },
                { id: 'e', text: "Could still be heterogeneity — need more investigation", nextNode: 'more_check' }
              ]
            },
            {
              id: 'bias_likely',
              type: 'outcome',
              consequence: 'good',
              title: "सूचित मूल्यांकन",
              text: "Contour-enhanced plots show the 'missing' studies would have been non-significant. This pattern specifically suggests publication bias — studies weren't published BECAUSE they weren't significant. This doesn't prove bias exists, but it's the most parsimonious explanation. Report this finding with appropriate caveats.",
              realCase: "Peters et al. (JAMA 2008) introduced contour-enhanced funnel plots specifically to distinguish publication bias from heterogeneity."
            },
            {
              id: 'more_check',
              type: 'outcome',
              consequence: 'good',
              title: "गहन जांच",
              text: "You're right to be cautious. You also: (1) Check if small studies used different interventions/populations, (2) Run Egger's test (p=0.02), (3) Search registries for unpublished trials (find 3), (4) Compare industry vs. independent funding. Multiple lines of evidence strengthen your conclusion.",
              realCase: "कोक्रेन मार्गदर्शन किसी भी एक विधि पर भरोसा करने के खिलाफ सिफारिश करता है। दृश्य, सांख्यिकीय और अनुभवजन्य (रजिस्ट्री खोज) दृष्टिकोण को संयोजित किया जाना चाहिए।"
            },
            {
              id: 'heterogeneity',
              question: "You examine study characteristics. Small studies enrolled patients from specialty clinics; large studies enrolled from primary care. Severity differs. What now?",
              branches: [
                { id: 'f', text: "यह विषमता को समझाता है - यह विविधता है, पूर्वाग्रह नहीं", nextNode: 'heterogeneity_explains' },
                { id: 'g', text: "दोनों सत्य हो सकते हैं - उपसमूह विश्लेषण और पूर्वाग्रह मूल्यांकन की आवश्यकता है", nextNode: 'both_true' }
              ]
            },
            {
              id: 'heterogeneity_explains',
              type: 'outcome',
              consequence: 'neutral',
              title: "नैदानिक स्पष्टीकरण",
              text: "Specialty clinics enroll sicker patients who may respond more to treatment (higher baseline = more room to improve). The 'asymmetry' reflects genuine effect modification, not suppression. You should do subgroup analysis by setting and report effects separately. The funnel wasn't lying — you were asking it the wrong question.",
              realCase: "गहन देखभाल हस्तक्षेपों के परीक्षणों में, छोटे एकल-केंद्र अध्ययन अक्सर बहुकेंद्रीय परीक्षणों की तुलना में बड़ा प्रभाव दिखाते हैं - पूर्वाग्रह नहीं, बल्कि केस-मिक्स अंतर।"
            },
            {
              id: 'both_true',
              type: 'outcome',
              consequence: 'good',
              title: "सूक्ष्म सत्य",
              text: "Heterogeneity AND publication bias can coexist. You stratify by setting and STILL see asymmetry within strata. You report: 'Effect modification by setting accounts for SOME asymmetry; residual asymmetry suggests possible publication bias.' You've separated the explainable from the suspicious.",
              realCase: "यह स्तरित विश्लेषण स्वर्ण मानक है। पहले स्पष्ट करें कि आप चिकित्सकीय रूप से क्या कर सकते हैं, फिर पूर्वाग्रह के लिए अवशिष्ट विषमता का आकलन करें।"
            }
          ]
        }
      },
      {
        type: 'clinical-guide',
        content: {
          title: "Funnel Plot Interpretation Checklist",
          items: [
            "LOOK: Is there asymmetry? Which direction? Which corner is 'missing'?",
            "CONTOUR: Do missing studies fall in significant or non-significant regions?",
            "COUNT: Do you have at least 10 studies? (Fewer = unreliable assessment)",
            "CHECK: Do small and large studies differ systematically (population, setting, quality)?",
            "TEST: Run Egger's test — but remember it's suggestive, not definitive",
            "SEARCH: Are there unpublished registered trials?",
            "तुलना करें: क्या उद्योग-प्रायोजित अध्ययन स्वतंत्र अध्ययनों से भिन्न हैं?",
            "REPORT: Describe the assessment process, not just the conclusion"
          ]
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "फ़नल से पता चलता है कि जंगल क्या छुपाता है। इसके आकार को पढ़ना सीखें - लेकिन याद रखें, विषमता एक फिंगरप्रिंट है जो कई संदिग्धों से संबंधित हो सकती है।"
        }
      },
      {
        type: 'quiz',
        content: {
          question: "In a contour-enhanced funnel plot, if 'missing' studies would fall in the p>0.05 (non-significant) region, this most strongly suggests:",
          options: [
            { id: 'a', text: "अध्ययन के बीच विविधता", correct: false },
            { id: 'b', text: "Publication bias — non-significant studies weren't published", correct: true },
            { id: 'c', text: "मेटा-विश्लेषण में बहुत कम अध्ययन हैं", correct: false },
            { id: 'd', text: "प्रभाव माप अनुचित है", correct: false }
          ],
          explanation: "When missing studies fall in non-significant regions, it suggests they weren't published BECAUSE they weren't significant — the hallmark of publication bias. If missing studies fell in significant regions, other explanations (heterogeneity, different populations) would be more likely. Contour enhancement helps make this distinction."
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "फ़नल प्लॉट होना चाहिए सममित यदि कोई प्रकाशन पूर्वाग्रह नहीं है (बड़े अध्ययन क्लस्टर किए गए, छोटे अध्ययन फैल गए)",
            "Contour-enhanced funnel plots add significance regions to help distinguish bias from heterogeneity",
            "Missing studies in non-significant regions strongly suggest publication bias",
            "Missing studies in significant regions suggest other explanations (heterogeneity, true effect variation)",
            "Visual inspection is subjective — always combine with statistical tests"
          ],
          actionItem: "इंटरैक्टिव टूल के साथ फ़नल प्लॉट पढ़ने का अभ्यास करें। अंतराल पैटर्न की पहचान करना शुरू करें - लापता अध्ययन कहां गिरेंगे?"
        }
      }
    ]
  },

  // MODULE 3: THE STATISTICAL TESTS
  {
    id: 3,
    title: "The Tests",
    subtitle: "Statistical Detection",
    estimatedMinutes: 30,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "फ़नल प्लॉट विषमता के लिए एगर के प्रतिगमन परीक्षण की गणना और व्याख्या करें",
            "Explain when to use Begg's test vs Egger's test",
            "Recognize the limitations of statistical tests with <10 studies",
            "Interpret discordant test results (Egger's positive, Begg's negative)",
            "Apply appropriate thresholds (p<0.10) and understand why they differ from conventional p<0.05"
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "III",
          text: "आंख संदेह करती है, लेकिन परीक्षण मात्रा निर्धारित करता है। फिर भी कोई भी परीक्षण यह नहीं देख सकता कि वास्तव में क्या हुआ - केवल वही जो डेटा सुझाता है।"
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने इस बात पर विचार नहीं किया है कि एगर का प्रतिगमन छिपे हुए साक्ष्य के जटिल प्रश्न को एक पी-मूल्य तक कम कर देता है - शक्तिशाली फिर भी खतरनाक, विचारोत्तेजक फिर भी निर्णायक नहीं?"
        }
      },
      {
        type: 'content',
        content: {
          title: "Egger's Regression Test",
          sections: [
            {
              heading: "The Logic",
              items: [
                "Regress effect size (standardized by SE) against precision (1/SE)",
                "If NO bias: intercept should be near zero",
                "If bias toward positive results: positive intercept",
                "ढलान वास्तविक अंतर्निहित प्रभाव को दर्शाता है"
              ]
            },
            {
              heading: "The Equation",
              items: [
                "Effect/SE = intercept + slope × (1/SE)",
                "Test whether intercept differs from 0",
                "Significant p-value (typically p<0.10) suggests asymmetry",
                "More liberal threshold (0.10 vs 0.05) because test has low power"
              ]
            },
            {
              heading: "Limitations",
              items: [
                "Low power with <10 studies — may miss real bias",
                "High false positive rate with heterogeneity",
                "Assumes linear relationship between effect and precision",
                "Different variants exist (Egger, Peters, Harbord) for different outcomes"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-egger',
        content: {
          id: 'egger-test',
          title: "Egger's Test Calculator",
          description: "फ़नल प्लॉट के लिए एगर के प्रतिगमन परीक्षण की गणना करने के लिए अध्ययन डेटा दर्ज करें विषमता।"
        }
      },
      {
        type: 'content',
        content: {
          title: "Begg's Rank Correlation",
          sections: [
            {
              heading: "The Method",
              items: [
                "Correlate effect size ranks with variance ranks",
                "Uses Kendall's tau correlation",
                "If NO bias: no correlation (tau near 0)",
                "If bias: positive correlation (large effects with large variance)"
              ]
            },
            {
              heading: "एगर के साथ तुलना",
              items: [
                "Less powerful than Egger's (rank-based loses information)",
                "But makes fewer parametric assumptions",
                "Better for non-normally distributed effects",
                "Often reported alongside Egger's for completeness"
              ]
            }
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "Harbord's Test for Binary Outcomes",
          sections: [
            {
              heading: "बाइनरी डेटा के लिए एक अलग परीक्षण क्यों?",
              items: [
                "Egger's test has inflated Type I error with binary outcomes (OR, RR)",
                "प्रभाव और परिशुद्धता के बीच संबंध अनुपात के लिए गणितीय रूप से सीमित है",
                "हार्बर्ड का परीक्षण स्कोर-आधारित आँकड़ों का उपयोग करता है जो खाते हैं यह",
                "Peters' test is an alternative using sample size rather than SE"
              ]
            },
            {
              heading: "When to Use Harbord's vs Egger's",
              items: [
                "BINARY outcomes (OR, RR, RD): Use Harbord's or Peters' test",
                "CONTINUOUS outcomes (MD, SMD): Use Egger's test",
                "SURVIVAL outcomes (HR): Harbord's or modified tests",
                "नियम: परीक्षण को अपने प्रभाव माप से मिलाएं"
              ]
            },
            {
              heading: "Peters' Test (Alternative)",
              items: [
                "Regress effect on 1/n (inverse sample size) instead of SE",
                "Less prone to false positives than Egger's for OR",
                "Recommended by Cochrane for meta-analyses of odds ratios",
                "Similar interpretation: significant intercept suggests asymmetry"
              ]
            }
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "Newer Alternatives: Doi Plot and LFK Index",
          sections: [
            {
              heading: "Doi Plot",
              items: [
                "Plots Z-scores against a normal quantile (|Z|) axis",
                "Creates an asymmetric pattern that's easier to read than funnel plots",
                "प्रमुख विषमता: रेखा से स्पष्ट विचलन",
                "More sensitive to asymmetry patterns than traditional funnel"
              ]
            },
            {
              heading: "LFK Index",
              items: [
                "Quantifies Doi plot asymmetry as a single number",
                "LFK > 1 or < -1: Minor asymmetry",
                "LFK > 2 or < -2: Major asymmetry",
                "Provides objective measure rather than relying on visual assessment"
              ]
            },
            {
              heading: "When to Use",
              items: [
                "Consider as supplement to funnel plot + Egger's",
                "Particularly useful when visual assessment is ambiguous",
                "Available in some meta-analysis software (R metafor, Stata)",
                "Not yet universally adopted — mention if used"
              ]
            }
          ]
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 3A",
          title: "When Tests Disagree: The Statin Example",
          source: "Naci et al., BMJ 2013 — Meta-analysis of statins for mortality",
          timeline: [
            { year: "The Data", text: "29 trials of statins vs placebo/usual care for all-cause mortality. Forest plot shows significant benefit (RR 0.86). Funnel plot shows... some asymmetry.", type: "normal" },
            { year: "Egger's Test", text: "p = 0.12. Not significant at 0.10 threshold. Suggests no publication bias.", type: "normal" },
            { year: "Begg's Test", text: "p = 0.08. Borderline significant. Suggests possible publication bias.", type: "normal" },
            { year: "The Dilemma", text: "Tests disagree. Visual inspection shows some gap in bottom-left. What to conclude?", type: "buried" },
            { year: "The Resolution", text: "Authors report BOTH tests, note discordance, state 'some evidence of small-study effects.' Transparency > certainty.", type: "revealed" }
          ],
          realData: {
            eggerP: "p = 0.12 (not significant)",
            beggP: "p = 0.08 (borderline)",
            studies: "29 trials",
            visualAssessment: "Mild asymmetry visible",
            conclusion: "अनिश्चित - चेतावनियों के साथ रिपोर्ट किया गया"
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "Interpreting Discordant Tests",
          situation: "Your meta-analysis has 18 studies. Egger's test: p=0.04 (significant). Begg's test: p=0.21 (not significant). Visual inspection shows mild asymmetry. Your funnel has moderate heterogeneity (I²=55%). What do you conclude?",
          nodes: [
            {
              id: 'start',
              question: "एगर्स महत्वपूर्ण है, बेग्स नहीं है, दृश्य हल्की विषमता दिखाता है। आपकी व्याख्या क्या है?",
              branches: [
                { id: 'a', text: "Egger's is more powerful — publication bias is present", nextNode: 'egger_rules' },
                { id: 'b', text: "परीक्षण असहमत हैं - सबूत अनिर्णायक हैं", nextNode: 'inconclusive' },
                { id: 'c', text: "Check if heterogeneity could explain the discordance", nextNode: 'heterogeneity' }
              ]
            },
            {
              id: 'egger_rules',
              type: 'outcome',
              consequence: 'bad',
              title: "The Oversimplification",
              text: "While Egger's IS more powerful, it's also more prone to false positives when heterogeneity exists. Your I²=55% is substantial. The 'asymmetry' Egger's detected may be effect modification, not bias. Concluding 'bias present' without addressing heterogeneity is premature.",
              realCase: "स्टर्न एट अल। पता चला कि एगर के परीक्षण ने विविधता मौजूद होने पर टाइप I त्रुटि दर को बढ़ा दिया है। परीक्षण विषमता का पता लगाता है, विशेष रूप से पूर्वाग्रह का नहीं।"
            },
            {
              id: 'inconclusive',
              type: 'outcome',
              consequence: 'neutral',
              title: "ईमानदार मूल्यांकन",
              text: "You report: 'Evidence for publication bias is mixed. Egger's test was significant (p=0.04) but Begg's was not (p=0.21). Visual asymmetry is mild. In the presence of moderate heterogeneity (I²=55%), these tests have limited reliability. We cannot confidently assess publication bias.' This is honest but unhelpful for decision-making.",
              realCase: "कई मेटा-विश्लेषण इस असुविधाजनक मध्य मैदान तक पहुंचते हैं। अनिश्चितता के बारे में पारदर्शिता मूल्यवान है, लेकिन पाठकों को मार्गदर्शन की आवश्यकता है।"
            },
            {
              id: 'heterogeneity',
              question: "आप आगे की जांच करें। छोटे अध्ययन एशिया (विभिन्न आबादी) से थे, बड़े अध्ययन यूरोप/अमेरिका से थे। रोग की गंभीरता क्षेत्र के अनुसार भिन्न होती है। अब क्या?",
              branches: [
                { id: 'd', text: "विषमता विषमता को स्पष्ट करती है - यह प्रकाशन पूर्वाग्रह नहीं है", nextNode: 'explained' },
                { id: 'e', text: "क्षेत्र द्वारा स्तरीकृत विश्लेषण करें और स्तरों के भीतर परीक्षण करें", nextNode: 'stratify' }
              ]
            },
            {
              id: 'explained',
              type: 'outcome',
              consequence: 'good',
              title: "नैदानिक अंतर्दृष्टि",
              text: "The apparent 'asymmetry' reflects genuine regional differences in populations and disease. Asian populations had more severe disease (baseline risk 25% vs 15%), explaining larger effects in smaller trials. This is heterogeneity, not suppression. You report this finding — it's clinically important and explains the discordant tests.",
              realCase: "In cardiovascular trials, regional differences in baseline risk routinely cause heterogeneity that can mimic publication bias on funnel plots."
            },
            {
              id: 'stratify',
              type: 'outcome',
              consequence: 'good',
              title: "स्तरीकृत मूल्यांकन",
              text: "Within Asian studies (8 trials): no asymmetry, Egger p=0.45. Within European studies (10 trials): no asymmetry, Egger p=0.38. The POOLED asymmetry was confounded by region. Publication bias is now considered unlikely — the heterogeneity between regions created the apparent funnel asymmetry.",
              realCase: "Stratified funnel plots (by subgroup) can reveal that apparent bias is actually confounding by a third variable."
            }
          ]
        }
      },
      {
        type: 'clinical-guide',
        content: {
          title: "Statistical Test Interpretation Guide",
          items: [
            "SAMPLE SIZE: With <10 studies, tests have very low power — don't trust a negative result",
            "CONCORDANCE: If Egger's, Begg's, AND visual all agree, confidence is higher",
            "HETEROGENEITY: High I² inflates false positives for Egger's — interpret cautiously",
            "प्रभाव माप: OR के लिए पीटर्स परीक्षण का उपयोग करें (बाइनरी परिणामों के लिए एगर की तुलना में बेहतर गुण)",
            "REPORT BOTH: Always report Egger's AND visual assessment, note any discordance",
            "THRESHOLD: p<0.10 is conventional (not 0.05) because of low power",
            "NEVER CONCLUDE 'NO BIAS': A non-significant test doesn't prove absence of bias"
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "When Publication Bias Is Less of a Concern",
          sections: [
            {
              heading: "संकेत जो चिंता को कम करते हैं",
              items: [
                "HARD OUTCOMES: Mortality, hospitalization — harder to manipulate or spin than 'quality of life'",
                "LARGE TRIALS: Fewer small studies means less selective publishing opportunity",
                "PROSPECTIVE REGISTRATION: All trials registered before starting, with pre-specified outcomes",
                "INDEPENDENT REPLICATION: Non-industry trials confirm industry findings",
                "SYMMETRIC FUNNEL: Visual inspection shows no gap, tests negative, registry search finds no missing trials"
              ]
            },
            {
              heading: "संतुलित परिप्रेक्ष्य",
              items: [
                "Not every asymmetric funnel means suppression",
                "Not every meta-analysis of drug trials is biased",
                "Publication bias is ONE threat to validity — consider others too",
                "लक्ष्य सटीक मूल्यांकन है, अधिकतम संदेह नहीं"
              ]
            }
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Meta-Analyses: Different Risk Profiles",
          darkSide: {
            header: "HIGH RISK for Publication Bias",
            items: [
              "Subjective outcome (pain scores, depression scales)",
              "All trials industry-funded",
              "Multiple small trials, few large confirmatory",
              "No prospective registration",
              "Asymmetric funnel, all published trials positive",
              "Registry shows unpublished completed trials"
            ],
            consequence: "Interpretation: Treat effect estimates with high suspicion. Apply corrections, search for unpublished data, downgrade GRADE for bias."
          },
          lightSide: {
            header: "LOW RISK for Publication Bias",
            items: [
              "Objective outcome (all-cause mortality)",
              "Mix of industry and government-funded trials",
              "Includes large multicenter confirmatory trials",
              "Most trials prospectively registered",
              "सममित फ़नल, सकारात्मक और शून्य परिणामों का मिश्रण",
              "Registry search finds no missing completed trials"
            ],
            consequence: "Interpretation: Publication bias is a lesser concern (not zero, but modest). Focus assessment on other biases: allocation concealment, attrition, etc."
          }
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "The eye suspects, but the test quantifies. Yet remember: the test detects asymmetry, not bias. Asymmetry is a clue; bias is a conclusion that requires judgment."
        }
      },
      {
        type: 'quiz',
        content: {
          question: "Your meta-analysis has 8 studies. Egger's test gives p=0.23. You should conclude:",
          options: [
            { id: 'a', text: "No publication bias is present", correct: false },
            { id: 'b', text: "प्रकाशन पूर्वाग्रह मौजूद हो भी सकता है और नहीं भी - 8 अध्ययनों के साथ परीक्षण में कम शक्ति है", correct: true },
            { id: 'c', text: "मेटा-विश्लेषण वैध और निष्पक्ष है", correct: false },
            { id: 'd', text: "You need to use Begg's test instead", correct: false }
          ],
          explanation: "With only 8 studies, Egger's test has very low power to detect publication bias even when it exists. A non-significant result does NOT mean no bias — it means the test couldn't detect it. Cochrane recommends at least 10 studies for meaningful interpretation of these tests. You should report the test result but not over-interpret a negative finding."
        }
      },
      {
        type: 'common-mistakes',
        content: {
          mistakes: [
            { mistake: "Concluding 'no bias' from non-significant test", correction: "Non-significant tests may lack power — especially with <10 studies. Say 'insufficient evidence to detect bias.'" },
            { mistake: "Ignoring heterogeneity when interpreting Egger's", correction: "उच्च I² एगर के लिए झूठी सकारात्मक दर बढ़ाता है। पूर्वाग्रह का निष्कर्ष निकालने से पहले कन्फ़्यूडर की जाँच करें।" },
            { mistake: "Only using one test", correction: "Report Egger's AND visual assessment. Note concordance or discordance. Neither alone is sufficient." },
            { mistake: "Using standard p<0.05 threshold", correction: "Convention uses p<0.10 for publication bias tests because of low power. Adjust your interpretation." }
          ]
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "Egger's test: regression-based, more powerful but sensitive to heterogeneity",
            "Begg's test: rank-based, less powerful but more robust to distributional assumptions",
            "Use p<0.10 threshold (not 0.05) due to low power of these tests",
            "With <10 studies, tests have very limited value — rely more on visual assessment and external evidence",
            "Discordant tests often indicate heterogeneity is confounding the assessment"
          ],
          actionItem: "For your next meta-analysis, plan to report: visual funnel plot, Egger's test with p-value, sample size, and heterogeneity (I²) to contextualize findings."
        }
      }
    ]
  },

  // MODULE 4: THE CORRECTION
  {
    id: 4,
    title: "The Correction",
    subtitle: "पूर्वाग्रह के लिए समायोजन",
    estimatedMinutes: 35,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "ट्रिम-एंड-फिल विधि को लागू करें और व्याख्या करें और इसकी मान्यताओं को समझें",
            "Explain PET-PEESE regression and when it outperforms Trim-and-Fill",
            "मजबूतता का आकलन करने के लिए फेल-सेफ एन का उपयोग करें (उचित के साथ) चेतावनियाँ)",
            "चयन मॉडल (कोपास, 3PSM) और संवेदनशीलता विश्लेषण में उनकी भूमिका का वर्णन करें",
            "डेटा विशेषताओं के आधार पर उचित सुधार विधियां चुनें"
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "IV",
          text: "जो छिपा हुआ था उसका अनुमान लगाने के लिए छाया का अनुमान लगाना आवश्यक है, लेकिन कभी भी अनुमान लगाने की गलती न करें सत्य।"
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने उस ट्रिम-एंड-फिल 'आरोपित' अध्ययन पर विचार नहीं किया है जो कभी अस्तित्व में नहीं हो सकता है - एक सांख्यिकीय अनुमान, दबे हुए सबूतों की पुनर्प्राप्ति नहीं?"
        }
      },
      {
        type: 'content',
        content: {
          title: "ट्रिम और फिल विधि",
          sections: [
            {
              heading: "The Logic",
              items: [
                "1. TRIM: असममित पक्ष से सबसे चरम छोटे अध्ययन हटाएं",
                "2। अनुमान: शेष (सममित) अध्ययनों से एकत्रित प्रभाव की गणना करें",
                "3. FILL: Add imputed mirror-image studies to create symmetry",
                "4. RE-ESTIMATE: Calculate adjusted pooled effect including imputed studies"
              ]
            },
            {
              heading: "The Assumption",
              items: [
                "Asymmetry is ENTIRELY due to suppression of small negative studies",
                "'सच्चा' फ़नल वास्तविक प्रभाव के चारों ओर सममित होगा",
                "लापता अध्ययन देखे गए असममित अध्ययनों की दर्पण छवियां हैं"
              ]
            },
            {
              heading: "The Limitations",
              items: [
                "If asymmetry is due to heterogeneity (not bias), trim-and-fill OVERCORRECTS",
                "आरोपित अध्ययन काल्पनिक हैं - वे वास्तविक अप्रकाशित परीक्षणों का प्रतिनिधित्व नहीं कर सकते हैं",
                "वास्तविक लापता डेटा को पुनर्प्राप्त नहीं करता है - केवल अनुमान लगाता है कि वे क्या दिखा सकते हैं",
                "Performance varies; can under- or over-correct depending on true mechanism"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-trimfill',
        content: {
          id: 'trim-fill-tool',
          title: "विज़ुअलाइज़र को ट्रिम और भरें",
          description: "देखें कि कैसे ट्रिम-एंड-फिल लापता अध्ययनों को दर्शाता है और एकत्रित को समायोजित करता है प्रभाव।"
        }
      },
      {
        type: 'content',
        content: {
          title: "PET-PEESE: Precision-Effect Testing",
          sections: [
            {
              heading: "What is PET-PEESE?",
              items: [
                "An alternative to trim-and-fill that estimates bias-corrected effects via regression",
                "PET = Precision-Effect Test: regress effect on SE, intercept estimates bias-corrected effect",
                "PEESE = Precision-Effect Estimate with Standard Error: regress effect on SE², better when true effect exists",
                "Two-step conditional estimator: Use PET to test if effect exists, then PEESE to estimate it"
              ]
            },
            {
              heading: "दो-चरणीय प्रक्रिया",
              items: [
                "STEP 1 (PET): Regress effect sizes on standard errors (effect = β₀ + β₁×SE)",
                "If PET intercept β₀ is significant (p<0.10): True effect likely exists → use PEESE",
                "STEP 2 (PEESE): Regress effect sizes on variance (effect = β₀ + β₁×SE²)",
                "PEESE intercept provides bias-corrected effect estimate",
                "यदि PET महत्वपूर्ण नहीं है: पूर्वाग्रह से परे सच्चे प्रभाव के लिए कोई सबूत नहीं निकालें"
              ]
            },
            {
              heading: "ट्रिम-एंड-फिल पर लाभ",
              items: [
                "Better performance in simulations when publication bias is moderate to severe",
                "Provides explicit test of whether true effect exists after accounting for bias",
                "Less assumption-dependent than selection models",
                "Works with meta-regression framework — can include moderators"
              ]
            },
            {
              heading: "Limitations",
              items: [
                "विश्वसनीय के लिए 10+ अध्ययन की आवश्यकता है अनुमान",
                "Assumes linear relationship between effect and SE/variance",
                "Can over-correct when heterogeneity explains small-study effects",
                "PET can have low power to detect true effects"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-petpeese',
        content: {
          id: 'pet-peese-tool',
          title: "PET-PEESE Calculator",
          description: "PET और PEESE पूर्वाग्रह-सुधारित अनुमानों की गणना करने के लिए अपना मेटा-विश्लेषण डेटा दर्ज करें।"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 4A",
          title: "Trim-and-Fill vs Reality: The Antidepressant Test",
          source: "Turner et al. NEJM 2008 — Comparing estimate to FDA truth",
          timeline: [
            { year: "The Opportunity", text: "टर्नर के पास दोनों थे: प्रकाशित साहित्य और FDA की संपूर्ण परीक्षण रजिस्ट्री। इसने एक दुर्लभ परीक्षण की अनुमति दी: क्या ट्रिम-एंड-फिल अप्रकाशित डेटा का सही अनुमान लगाता है?", type: "normal" },
            { year: "Published Only", text: "Meta-analysis of published trials: effect size = 0.41 (strongly effective)", type: "normal" },
            { year: "Trim-and-Fill", text: "Applied to published data: imputes 6 studies, adjusted effect = 0.34. A 17% reduction.", type: "normal" },
            { year: "FDA Truth", text: "Including ALL FDA trials (published + unpublished): effect size = 0.31. True reduction was 24%.", type: "revealed" },
            { year: "The Verdict", text: "ट्रिम-एंड-फिल ने पूर्वाग्रह को कम करके आंका। इसमें कुछ हद तक सुधार हुआ, लेकिन पर्याप्त नहीं। कुछ भी नहीं से बेहतर, लेकिन वास्तविक डेटा का विकल्प नहीं।", type: "revealed" }
          ],
          realData: {
            publishedEffect: "d = 0.41",
            trimFillEffect: "d = 0.34 (17% reduction)",
            trueEffect: "d = 0.31 (24% reduction)",
            trimFillAccuracy: "~70% पूर्वाग्रह को ठीक किया गया"
          }
        }
      },
      {
        type: 'content',
        content: {
          title: "Selection Models",
          sections: [
            {
              heading: "The Concept",
              items: [
                "Explicitly model the PROBABILITY of publication",
                "P(published) depends on p-value, effect direction, or statistical significance",
                "देखे गए डेटा से चयन फ़ंक्शन पैरामीटर का अनुमान लगाएं",
                "Adjust effect estimate accounting for estimated selection"
              ]
            },
            {
              heading: "Common Selection Models",
              items: [
                "3PSM: Three-parameter selection model — step function at p=0.05",
                "Copas model: Continuous selection probability based on effect and variance",
                "Weight-function models: Flexible specification of selection weights"
              ]
            },
            {
              heading: "ट्रिम-एंड-फिल पर लाभ",
              items: [
                "Explicitly models the selection mechanism",
                "Can accommodate more complex selection patterns",
                "अनिश्चितता अंतराल प्रदान करता है जो चयन अनिश्चितता के लिए जिम्मेदार है"
              ]
            },
            {
              heading: "Disadvantages",
              items: [
                "चयन के बारे में धारणाओं की आवश्यकता है फ़ंक्शन",
                "कुछ अध्ययनों से अस्थिर हो सकता है",
                "Multiple models can give different answers"
              ]
            }
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "P-Curve Analysis",
          sections: [
            {
              heading: "The Logic",
              items: [
                "Examine the DISTRIBUTION of significant p-values (p<0.05)",
                "If true effect exists: p-curve should be RIGHT-SKEWED (many p<0.01)",
                "If no effect + selective reporting: p-curve is FLAT or LEFT-SKEWED",
                "If p-hacking: spikes just below 0.05"
              ]
            },
            {
              heading: "Interpretation",
              items: [
                "दाएं-तिरछा पी-वक्र: सच्चे प्रभाव के लिए साक्ष्य",
                "Flat p-curve: Suggests no true effect (or underpowered studies)",
                "Left-skewed: Suggests selective reporting or p-hacking",
                "Spike at 0.04-0.05: Classic p-hacking signature"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-pcurve',
        content: {
          id: 'pcurve-tool',
          title: "P-Curve Analyzer",
          description: "साक्ष्य मूल्य का आकलन करने के लिए महत्वपूर्ण अध्ययनों से पी-मान दर्ज करें।"
        }
      },
      {
        type: 'content',
        content: {
          title: "विफल-सुरक्षित एन (रोसेन्थल का) विधि)",
          sections: [
            {
              heading: "The Concept",
              items: [
                "आपके परिणाम को गैर-महत्वपूर्ण बनाने के लिए कितने अप्रकाशित अशक्त अध्ययनों की आवश्यकता होगी?",
                "यदि संख्या बड़ी है, तो प्रकाशन पूर्वाग्रह के लिए निष्कर्ष 'मजबूत' है",
                "यदि संख्या छोटी है, तो कुछ फ़ाइल-दराज अध्ययन आपके को निरस्त कर सकते हैं निष्कर्ष"
              ]
            },
            {
              heading: "The Formula",
              items: [
                "N = (ΣZ / 1.645)² - k, where k = number of studies",
                "Alternatively: N = k × (mean Z / 1.645)² - k",
                "Rule of thumb: N > 5k + 10 suggests robustness"
              ]
            },
            {
              heading: "Limitations (Important!)",
              items: [
                "Assumes missing studies have EXACTLY zero effect (unrealistic)",
                "Doesn't account for systematic bias in effect direction",
                "Can give misleadingly large N when effects are inflated",
                "आधुनिक तरीकों (चयन मॉडल, ट्रिम-एंड-फिल) को प्राथमिकता दी जाती है"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-failsafe',
        content: {
          id: 'failsafe-tool',
          title: "Fail-Safe N Calculator",
          description: "गणना करें कि आपके मेटा-विश्लेषणात्मक परिणाम को रद्द करने के लिए कितने अशक्त अध्ययनों की आवश्यकता होगी।"
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Approaches to Bias Correction",
          darkSide: {
            header: "अति आत्मविश्वासी विश्लेषक",
            items: [
              "Runs trim-and-fill once",
              "Reports adjusted estimate as 'true effect'",
              "Ignores model assumptions",
              "असंगत को खारिज करता है तरीके",
              "Claims bias has been 'corrected'"
            ],
            consequence: "Result: False precision. Readers believe the adjusted number. If assumptions wrong, they're misled. The overconfidence perpetuates poor practice."
          },
          lightSide: {
            header: "विनम्र विश्लेषक",
            items: [
              "Runs multiple methods (trim-fill, selection models, PET-PEESE)",
              "Reports a RANGE of plausible effects",
              "States assumptions explicitly",
              "Notes when methods disagree (that's informative!)",
              "Acknowledges uncertainty in all corrections"
            ],
            consequence: "परिणाम: ईमानदार अनिश्चितता। पाठक सीमाएँ देखते हैं। निर्णय लेने वाले जोखिम को समझते हैं। विज्ञान स्वीकृत सीमाओं के माध्यम से आगे बढ़ता है।"
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "सुधार विधि चुनना",
          situation: "Your meta-analysis shows significant funnel asymmetry (Egger p=0.02). You want to estimate a bias-adjusted effect. Which method should you use?",
          nodes: [
            {
              id: 'start',
              question: "आपने संभावित प्रकाशन पूर्वाग्रह का पता लगाया है। आप अपना अनुमान कैसे समायोजित करते हैं?",
              branches: [
                { id: 'a', text: "Use trim-and-fill — it's the most widely recognized", nextNode: 'trimfill' },
                { id: 'b', text: "Use a selection model — it models the mechanism", nextNode: 'selection' },
                { id: 'c', text: "असमायोजित अनुमान को चेतावनियों के साथ रिपोर्ट करें - सुधार अविश्वसनीय हैं", nextNode: 'noadjust' }
              ]
            },
            {
              id: 'trimfill',
              question: "4 अध्ययनों को ट्रिम-एंड-फिल करें। समायोजित प्रभाव OR 0.65 से OR 0.78 तक गिर जाता है। क्या आप इसे 'सही' प्रभाव के रूप में रिपोर्ट करते हैं?",
              branches: [
                { id: 'd', text: "हां - समायोजित अनुमान पूर्वाग्रह के लिए सही है", nextNode: 'overclaim' },
                { id: 'e', text: "Report both estimates as sensitivity analysis", nextNode: 'sensitivity' }
              ]
            },
            {
              id: 'overclaim',
              type: 'outcome',
              consequence: 'bad',
              title: "गलत निश्चितता",
              text: "एक अनुमानित तंत्र के लिए ट्रिम-एंड-फिल सही है। यदि विषमता आंशिक रूप से विषमता (पूर्वाग्रह नहीं) थी, तो आपने बहुत अधिक सुधार कर लिया है। यदि यह गंभीर पूर्वाग्रह था, तो आपने इसे कम कर दिया है। समायोजित अनुमान को 'सत्य' के रूप में प्रस्तुत करना गलत सटीकता देता है। आप नहीं जानते कि कौन सा परिदृश्य लागू होता है।",
              realCase: "टर्नर के एंटीडिप्रेसेंट विश्लेषण से पता चला है कि ट्रिम-एंड-फिल ने वास्तविक पूर्वाग्रह का केवल ~70% ही कैप्चर किया है - फिर भी पर्याप्त अवशिष्ट मुद्रास्फीति।"
            },
            {
              id: 'sensitivity',
              type: 'outcome',
              consequence: 'good',
              title: "ईमानदार रेंज",
              text: "आप रिपोर्ट करते हैं: 'अनएडजस्टेड या 0.65 (0.55-0.77). ट्रिम-एंड-फिल समायोजित या 0.78 (0.65-0.94)। वास्तविक प्रभाव संभवतः इसी सीमा के भीतर है।' आपने अनिश्चितता को उचित रूप से व्यक्त किया है। पाठक देख सकते हैं कि निष्कर्ष पूर्वाग्रह मान्यताओं के प्रति संवेदनशील हैं।",
              realCase: "यह दृष्टिकोण - असमायोजित और सीमा के रूप में समायोजित रिपोर्टिंग - कई पद्धतिविदों द्वारा अनुशंसित है।"
            },
            {
              id: 'selection',
              question: "आप एक 3-पैरामीटर चयन मॉडल चलाते हैं। यह OR 0.82 (0.68-0.99) देता है, जो ट्रिम-एंड-फिल की तुलना में अधिक पूर्वाग्रह का सुझाव देता है। एक कोपास मॉडल OR 0.75 (0.60-0.93) देता है, जो कम होने का संकेत देता है। आप क्या करते हैं?",
              branches: [
                { id: 'f', text: "मॉडलों का औसत निकालें", nextNode: 'average' },
                { id: 'g', text: "Report all models as sensitivity analyses showing range of plausible adjustments", nextNode: 'range' }
              ]
            },
            {
              id: 'average',
              type: 'outcome',
              consequence: 'bad',
              title: "मिथ्या संश्लेषण",
              text: "अलग-अलग धारणाओं वाले मॉडल का औसत आपको 'सच्चाई' नहीं देता है - यह आपको एक संख्या देता है जो किसी भी सार्थक मात्रा के अनुरूप नहीं हो सकता है। मॉडल असहमत हैं क्योंकि वे अलग-अलग धारणाएँ बनाते हैं। असहमति जानकारी है, कोई ऐसी चीज़ नहीं जिसे औसत करके निकाल दिया जाए।",
              realCase: "पूर्वाग्रह-सुधार में मॉडल औसत उचित भार के साथ उपयुक्त हो सकता है, लेकिन बिंदु अनुमानों का सरल औसत मॉडल अनिश्चितता को अस्पष्ट कर देता है जो कि प्रमुख खोज है।"
            },
            {
              id: 'range',
              type: 'outcome',
              consequence: 'good',
              title: "पूरी तस्वीर",
              text: "You report: 'Adjustments range from OR 0.75 (Copas) to OR 0.82 (3PSM). All adjusted estimates remain significant but are attenuated from the unadjusted OR 0.65. We cannot determine which selection model best represents the true mechanism, but results suggest the unadjusted estimate is inflated by approximately 15-25%.'",
              realCase: "मॉडल अनिश्चितता की यह पारदर्शी रिपोर्टिंग संवेदनशीलता विश्लेषण के लिए सर्वोत्तम प्रथाओं का पालन करती है।"
            },
            {
              id: 'noadjust',
              type: 'outcome',
              consequence: 'neutral',
              title: "रूढ़िवादी विकल्प",
              text: "You report the unadjusted effect with a clear warning: 'Funnel plot asymmetry suggests publication bias (Egger p=0.02). The reported effect (OR 0.65) is likely inflated. Bias-adjusted estimates vary depending on assumptions. Interpret with caution.' This is honest but may frustrate readers wanting a 'corrected' number.",
              realCase: "कुछ पद्धतिविदों का तर्क है कि यह एकमात्र रक्षात्मक दृष्टिकोण है - सुधार विश्वसनीय होने के लिए मॉडल पर बहुत अधिक निर्भर हैं।"
            }
          ]
        }
      },
      {
        type: 'clinical-guide',
        content: {
          title: "Bias Correction Best Practices",
          items: [
            "कभी भी यह दावा न करें कि समायोजित अनुमान 'सही' प्रभाव है - यह एक संवेदनशीलता विश्लेषण है",
            "REPORT BOTH: Original estimate AND adjusted estimate(s) as bounding scenarios",
            "TRY MULTIPLE METHODS: If they all agree, more confidence; if they disagree, that's important",
            "वास्तविक डेटा खोजें: रजिस्ट्री खोज और एफओआईए सांख्यिकीय सुधार से बेहतर हैं",
            "CONSIDER THE MECHANISM: Is asymmetry likely bias, heterogeneity, or both?",
            "STATE ASSUMPTIONS: Make clear what assumptions each correction method requires",
            "DOWNGRADE GRADE: If substantial bias likely, reduce certainty regardless of adjustment"
          ]
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "जो छिपा था उसका अनुमान लगाना परछाइयों का अनुमान लगाना है। सांख्यिकीय सुधार संवेदनशीलता विश्लेषण के उपकरण हैं, सत्य पुनर्प्राप्ति के नहीं। सत्य का एकमात्र निश्चित मार्ग वास्तविक छिपे हुए डेटा को ढूंढना है।"
        }
      },
      {
        type: 'quiz',
        content: {
          question: "ट्रिम-एंड-फिल आपके एकत्रित प्रभाव को OR 0.60 से OR 0.75 तक समायोजित करता है। आप क्या निष्कर्ष निकाल सकते हैं?",
          options: [
            { id: 'a', text: "वास्तविक प्रभाव OR 0.75 है", correct: false },
            { id: 'b', text: "वास्तविक प्रभाव OR 0.60 और OR 0.75 के बीच कहीं होता है", correct: false },
            { id: 'c', text: "यदि प्रकाशन पूर्वाग्रह विषमता का कारण है, तो प्रभाव OR 0.75 के करीब हो सकता है, लेकिन यह सुधार अनिश्चित है", correct: true },
            { id: 'd', text: "मेटा-विश्लेषण अविश्वसनीय है और इसे प्रकाशित नहीं किया जाना चाहिए", correct: false }
          ],
          explanation: "Trim-and-fill provides a plausible adjustment IF publication bias is the true cause of asymmetry AND IF the missing studies would be mirror-images of observed studies. These are strong assumptions. The adjusted estimate is a sensitivity analysis, not a definitive correction. Turner's comparison showed trim-and-fill only partially corrected for actual bias."
        }
      },
      {
        type: 'patient-communication',
        content: {
          scenario: "एक मरीज नई दवा के बारे में पूछता है। आप जानते हैं कि हालिया मेटा-विश्लेषण इसका समर्थन करता है, लेकिन आप प्रकाशन पूर्वाग्रह संबंधी चिंताओं से अवगत हैं।",
          script: "The research generally supports this medication, but I want to be honest with you — studies with positive results are more likely to get published than negative ones. The overall evidence suggests benefit, but the true effect might be somewhat smaller than the published studies show. Based on your specific situation, I think the potential benefits still outweigh the risks, but let's monitor closely and adjust if needed.",
          keyPoints: [
            "Acknowledge uncertainty without causing undue alarm",
            "Explain publication bias in accessible terms",
            "Frame in context of patient's individual risk-benefit",
            "Emphasize shared decision-making and monitoring"
          ]
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "ट्रिम-एंड-फिल दर्पण-छवि अध्ययनों को लागू करता है - सत्यापन अध्ययनों में ~70% पूर्वाग्रह को ठीक करता है",
            "PET-PEESE uses regression to estimate bias-corrected effects — two-step conditional estimator",
            "Selection models (3PSM, Copas) explicitly model publication probability — more flexible but complex",
            "P-curve analyzes distribution of p-values to detect p-hacking or evidential value",
            "सभी सुधार संवेदनशीलता विश्लेषण हैं, सत्य पुनर्प्राप्ति नहीं - वास्तविक डेटा ढूंढना हमेशा बेहतर होता है"
          ],
          actionItem: "अपने अगले मेटा-विश्लेषण के लिए, ट्रिम-एंड-फिल और पेट-पीज़ दोनों को संवेदनशीलता विश्लेषण के रूप में चलाएँ। अपने मुख्य अनुमान के साथ दोनों की रिपोर्ट करें।"
        }
      }
    ]
  },

  // MODULE 5: THE HUNT
  {
    id: 5,
    title: "The Hunt",
    subtitle: "छुपे हुए सबूत ढूँढना",
    estimatedMinutes: 25,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "अप्रकाशित अध्ययनों के लिए क्लिनिकलट्रायल्स.जीओवी और अन्य रजिस्ट्रियां खोजें",
            "File FOIA requests and navigate regulatory document access",
            "ग्रे साहित्य स्रोतों की गुणवत्ता और उपयोगिता का मूल्यांकन करें",
            "Contact trialists systematically to request unpublished data",
            "Build a comprehensive search strategy that goes beyond published literature"
          ]
        }
      },
      {
        type: 'principle',
        content: {
          number: "V",
          text: "Better to find one buried study than to impute ten imaginary ones."
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने नहीं देखा है कि क्लिनिकलट्रायल्स.जीओवी कैसे रिकॉर्ड करती है कि क्या शुरू किया गया था - और जो प्रकाशित किया गया था उसकी तुलना करने से परित्यक्त परिणामों के कब्रिस्तान का पता चलता है?"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 5A",
          title: "The Registry Detective: Ross's Investigation",
          source: "Ross et al., JAMA 2009 — Tracking trials from registration to publication",
          timeline: [
            { year: "The Method", text: "Ross identified all trials registered on ClinicalTrials.gov in 2002. Followed them for 5 years. Did they get published?", type: "normal" },
            { year: "The Findings", text: "Of 677 registered trials, only 46% published within 5 years. Positive trials: 61% published. Negative/null trials: 34% published.", type: "buried" },
            { year: "The Gap", text: "Industry-funded trials: 40% published. NIH-funded: 56%. Academic non-profit: 56%. Industry was worst at publishing.", type: "buried" },
            { year: "The Implication", text: "रजिस्ट्रियां उजागर करती हैं कि प्रकाशन में क्या कमी रह गई है। डॉक्टरों को दिखाई देने वाला साक्ष्य आधार मौजूदा साक्ष्य आधार के आधे से भी कम है।", type: "revealed" }
          ],
          realData: {
            registered: "677 trials in 2002",
            published5yr: "46% published within 5 years",
            positivePublished: "61%",
            negativePublished: "34%",
            industryPublished: "40%",
            academicPublished: "56%"
          }
        }
      },
      {
        type: 'content',
        content: {
          title: "Trial Registry Searching",
          sections: [
            {
              heading: "Key Registries",
              items: [
                "ClinicalTrials.gov — Largest, US-based, required for many trials",
                "ISRCTN — International, especially European trials",
                "EU Clinical Trials Register — European Medicines Agency database",
                "WHO ICTRP — Search portal for multiple registries worldwide",
                "Disease-specific registries (e.g., oncology, cardiovascular)"
              ]
            },
            {
              heading: "किसकी तलाश है",
              items: [
                "बिना किसी प्रकाशित परिणाम के पूर्ण परीक्षण",
                "Trials where 'completion date' was years ago",
                "Trials listed as 'terminated' — why?",
                "Discrepancies: registered primary outcome ≠ published primary outcome"
              ]
            },
            {
              heading: "Search Strategy",
              items: [
                "Search your drug/intervention in registry",
                "पूर्ण/समाप्त परीक्षणों के लिए फ़िल्टर करें",
                "आपके मेटा-विश्लेषण के साथ क्रॉस-रेफरेंस: आप कौन से परीक्षण चूक गए?",
                "अप्रकाशित डेटा के लिए परीक्षणकर्ताओं से संपर्क करें"
              ]
            }
          ]
        }
      },
      {
        type: 'tool-registry',
        content: {
          id: 'registry-tracker',
          title: "Registry Gap Finder",
          description: "Compare registered vs. published trials to identify potentially missing studies."
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "क्या आपने इस बात पर विचार नहीं किया है कि अब तक शुरू हुए सभी परीक्षणों में से लगभग आधे कभी प्रकाशित नहीं हुए हैं? विज्ञान के कब्रिस्तान में पुस्तकालय जितनी ही अध्ययन सामग्री होती है?"
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 5B",
          title: "सभी परीक्षण: तिजोरियाँ खोलने का आंदोलन",
          source: "AllTrials Campaign + Goldacre, Bad Pharma, 2012",
          timeline: [
            { year: "2012", text: "बेन गोल्डाक्रे ने 'बैड फार्मा' प्रकाशित किया। पूरे उद्योग में व्यवस्थित दमन के दस्तावेज़। पारदर्शिता का आह्वान.", type: "normal" },
            { year: "2013", text: "AllTrials campaign launches: 'All trials registered, all results reported.' Within months, 85,000 individuals and 600 organizations sign on.", type: "normal" },
            { year: "The Resistance", text: "Industry initially resists. Argues: proprietary data, competitive advantage, patient privacy. But pressure mounts.", type: "buried" },
            { year: "2015", text: "ईएमए ने नीति 0070 अपनाई: क्लिनिकल परीक्षण डेटा प्रकाशित किया जाएगा। जीएसके परीक्षण डेटा साझा करने के लिए प्रतिबद्ध है। ज्वार पलटने लगता है.", type: "revealed" },
            { year: "The Progress", text: "क्लिनिकलट्रायल्स.जीओवी को अब 1 वर्ष के भीतर परिणाम रिपोर्टिंग की आवश्यकता है। लेकिन प्रवर्तन कमज़ोर है. 2023 तक, ~30% परीक्षण अभी भी समय पर परिणाम नहीं देते हैं।", type: "revealed" }
          ],
          realData: {
            campaignSignatures: "85,000+ individuals, 600+ organizations",
            currentCompliance: "~70% of trials report results within required timeframe",
            remainingGap: "~30% still don't comply",
            enforcement: "Limited — fines rarely applied",
            progress: "Significant but incomplete"
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "पत्थरबाज़ शोधकर्ता",
          situation: "You're conducting a Cochrane review. You've identified 5 unpublished industry trials on ClinicalTrials.gov. You've emailed the company three times over 6 months. No response. The company's published trials show strong efficacy. You strongly suspect the unpublished trials are negative. What do you do?",
          nodes: [
            {
              id: 'start',
              question: "कंपनी डेटा शेयर नहीं करेगी. आप कैसे आगे बढ़ेंगे?",
              branches: [
                { id: 'a', text: "केवल प्रकाशित डेटा के साथ समीक्षा प्रकाशित करें", nextNode: 'publish_incomplete' },
                { id: 'b', text: "Escalate — formal data request through Cochrane", nextNode: 'escalate' },
                { id: 'c', text: "Try alternative routes — FOIA, EMA, litigation documents", nextNode: 'alternatives' }
              ]
            },
            {
              id: 'publish_incomplete',
              type: 'outcome',
              consequence: 'bad',
              title: "अपूर्ण सत्य",
              text: "Your review shows strong efficacy based on published trials. But you know 5 unpublished trials exist. You mention them in 'Limitations' but proceed anyway. Your review is cited by guidelines. The drug is widely adopted. Years later, when the unpublished data emerges, your review is discredited. You contributed to the distortion you were trying to assess.",
              realCase: "ज्ञात अप्रकाशित परीक्षणों के बावजूद आगे बढ़ने के लिए कई कोक्रेन समीक्षाओं की आलोचना की गई है। प्रकाशित करने का दबाव वैज्ञानिक सावधानी पर हावी हो सकता है।"
            },
            {
              id: 'escalate',
              question: "आप कोक्रेन के औपचारिक चैनलों के माध्यम से आगे बढ़ते हैं। कंपनी 'सारांश डेटा' के साथ प्रतिक्रिया देती है, लेकिन व्यक्तिगत रोगी डेटा के साथ नहीं। सारांश 'प्रकाशित परीक्षणों के समान परिणाम' दिखाता है। क्या आप इस पर भरोसा करते हैं?",
              branches: [
                { id: 'd', text: "Accept the summary — it's better than nothing", nextNode: 'accept_summary' },
                { id: 'e', text: "पूर्ण डेटा की मांग करें या इनकार का दस्तावेजीकरण करें", nextNode: 'demand_full' }
              ]
            },
            {
              id: 'accept_summary',
              type: 'outcome',
              consequence: 'neutral',
              title: "सीमित विजय",
              text: "You include the company's summary data. It shows modest effects, smaller than published trials. Your review now has more data — but you can't verify the company's summary. You note: 'Unpublished data provided by manufacturer; individual patient data not available for independent analysis.' You've documented the limitation transparently.",
              realCase: "कई समीक्षाएँ निर्माताओं से सारांश डेटा स्वीकार करती हैं। यह कुछ भी नहीं से बेहतर है, लेकिन स्वतंत्र सत्यापन संभव नहीं है।"
            },
            {
              id: 'demand_full',
              type: 'outcome',
              consequence: 'good',
              title: "दस्तावेज़ित इनकार",
              text: "The company refuses full data. You document every request, every refusal. Your review states: 'Manufacturer declined to provide individual patient data for 5 trials despite repeated requests. Summary data offered but not independently verifiable. Published evidence may overestimate efficacy.' This transparency is scientifically honest and puts the burden where it belongs.",
              realCase: "कोक्रेन की टैमीफ्लू समीक्षा में रोश के इनकारों के वर्षों का दस्तावेजीकरण किया गया है। इस दस्तावेज़ ने अंततः डेटा रिलीज़ के लिए नियामक दबाव में योगदान दिया।"
            },
            {
              id: 'alternatives',
              question: "आप FDA को FOIA अनुरोध दर्ज करते हैं। छह महीने बाद, आपको कुछ सुधारों के साथ नैदानिक ​​अध्ययन रिपोर्ट प्राप्त होती हैं। आपको क्या मिला?",
              branches: [
                { id: 'f', text: "अप्रकाशित परीक्षण वास्तव में नकारात्मक थे - आपके संदेह की पुष्टि हुई", nextNode: 'confirmed_negative' },
                { id: 'g', text: "अप्रकाशित परीक्षण सकारात्मक थे - आपका संदेह करना गलत था", nextNode: 'wrong_suspicion' }
              ]
            },
            {
              id: 'confirmed_negative',
              type: 'outcome',
              consequence: 'good',
              title: "सच्चाई प्राप्त हुई",
              text: "The FDA data reveals: 3 of 5 unpublished trials showed no significant effect. Combined with published trials, the pooled effect drops from d=0.45 to d=0.22. Your review now reflects reality, not marketing. You've demonstrated why persistence in data hunting matters. The extra 6 months of work prevented years of overestimation.",
              realCase: "यह वही है जो टर्नर ने अवसादरोधी दवाओं के साथ पाया और जो जेफरसन ने पाया टैमीफ्लू के साथ पाया गया। दृढ़ता रंग लाई।"
            },
            {
              id: 'wrong_suspicion',
              type: 'outcome',
              consequence: 'neutral',
              title: "ईमानदार आश्वासन",
              text: "The FDA data shows the unpublished trials were actually positive, similar to published results. Your suspicion was wrong. But you've now verified this independently. Your review is STRONGER because you checked. You report: 'Unpublished trials obtained via FOIA; results consistent with published trials.' Skepticism that's verified is still valuable skepticism.",
              realCase: "प्रत्येक अप्रकाशित परीक्षण नकारात्मक नहीं होता। लेकिन जानने का एकमात्र तरीका डेटा प्राप्त करना है। सत्यापन हमेशा सार्थक होता है।"
            }
          ]
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "CASE 5D",
          title: "FOIA रूट: FDA डेटा प्राप्त करना",
          source: "कई मामले - टर्नर, ज्यूरीडिनी और अन्य से सीखना",
          timeline: [
            { year: "The Problem", text: "निर्माता पूर्ण परीक्षण डेटा FDA को जमा करते हैं। लेकिन FDA को इसे सार्वजनिक करने की आवश्यकता नहीं है। अधिकांश डेटा गोपनीय रहता है।", type: "normal" },
            { year: "The Strategy", text: "Freedom of Information Act (FOIA) requests can pry open FDA files. Request clinical study reports (CSRs), medical reviews, statistical reviews.", type: "normal" },
            { year: "The Reality", text: "FOIA अनुरोधों में 6-24 महीने लगते हैं। डेटा को अक्सर संशोधित किया जाता है. लेकिन लगातार अनुरोध करने वालों ने महत्वपूर्ण अप्रकाशित डेटा को उजागर किया है।", type: "normal" },
            { year: "Turner's Approach", text: "टर्नर ने 12 अवसादरोधी दवाओं के लिए FDA दवा अनुमोदन पैकेज प्राप्त किया। इनमें सभी प्रस्तुत परीक्षण डेटा शामिल थे - प्रकाशित और अप्रकाशित। इससे उनका ऐतिहासिक NEJM अध्ययन संभव हुआ।", type: "revealed" },
            { year: "The Lesson", text: "नियामक डेटा स्वर्ण मानक है। यह वह दर्शाता है जो अनुमोदन के लिए प्रस्तुत किया गया था, न कि जो चुनिंदा रूप से प्रकाशित किया गया था।", type: "revealed" }
          ],
          realData: {
            typicalFOIAtime: "6-24 months",
            successRate: "Variable — depends on request specificity",
            dataQuality: "CSRs contain far more detail than publications",
            alternatives: "EMA provides some data proactively; Canada, Australia have similar processes"
          }
        }
      },
      {
        type: 'content',
        content: {
          title: "Grey Literature Sources",
          sections: [
            {
              heading: "Conference Abstracts",
              items: [
                "Many studies present at conferences but never publish in full",
                "आपके विषय के लिए खोज सम्मेलन की कार्यवाही",
                "सकारात्मक और नकारात्मक परिणाम दोनों सम्मेलनों में दिखाई दे सकते हैं",
                "Watch out: abstracts may have limited data quality"
              ]
            },
            {
              heading: "शोध प्रबंध और थीसिस",
              items: [
                "ProQuest Dissertations — extensive database",
                "OpenDOAR — repository search",
                "छात्र अशक्त निष्कर्ष प्रकाशित कर सकते हैं सहकर्मी समीक्षा से बच नहीं पाएंगे",
                "Often contain pilot studies or unpublished substudies"
              ]
            },
            {
              heading: "Regulatory Documents",
              items: [
                "FDA approval packages (drugs.fda.gov)",
                "EMA public assessment reports (ema.europa.eu)",
                "NICE technology appraisals (UK)",
                "PBAC public summary documents (Australia)"
              ]
            },
            {
              heading: "Litigation Documents",
              items: [
                "Drug litigation (Vioxx, Neurontin, SSRIs) unsealed internal documents",
                "Drug Industry Document Archive (DIDA) at UCSF",
                "PLoS Medicine often publishes analyses of litigation documents"
              ]
            }
          ]
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "गुमशुदा डेटा दुविधा",
          situation: "Your meta-analysis finds 15 published trials. A registry search reveals 8 more completed trials with no publications. You contact the trialists: 3 respond with 'negative results, not interesting enough to publish.' 5 don't respond. What do you do?",
          nodes: [
            {
              id: 'start',
              question: "You've found 8 unpublished trials. How do you proceed?",
              branches: [
                { id: 'a', text: "15 प्रकाशित परीक्षणों के साथ आगे बढ़ें - अप्रकाशित डेटा अनुपलब्ध है", nextNode: 'ignore' },
                { id: 'b', text: "अप्रकाशित डेटा प्राप्त करने के लिए अधिक प्रयास करें", nextNode: 'pursue' },
                { id: 'c', text: "Report both analyses: with 15 trials, and with imputation for the 8 missing", nextNode: 'dual' }
              ]
            },
            {
              id: 'ignore',
              type: 'outcome',
              consequence: 'bad',
              title: "विलफुल अंधापन",
              text: "अब आप जानते हैं कि 8 अप्रकाशित परीक्षण मौजूद हैं और कम से कम 3 संभावित रूप से नकारात्मक हैं। केवल 15 प्रकाशित परीक्षणों को प्रकाशित करना पूर्वाग्रह को कायम रखता है। आपने कब्रिस्तान की पहचान कर ली है लेकिन चले गए। आपका मेटा-विश्लेषण प्रभावकारिता को बढ़ा-चढ़ाकर पेश करेगा, जिससे संभावित रूप से रोगियों को नुकसान होगा।",
              realCase: "समीक्षक जो अप्रकाशित परीक्षणों की पहचान करते हैं और फिर उन्हें अनदेखा करते हैं, वे अज्ञानता का दावा नहीं कर सकते। सर्वोत्तम अभ्यास के लिए इन परीक्षणों और उनके संभावित प्रभाव का दस्तावेजीकरण करना आवश्यक है।"
            },
            {
              id: 'pursue',
              question: "आप गैर-उत्तरदाताओं को अनुवर्ती ईमेल भेजते हैं। आप 2 परीक्षणों के लिए FOIA अनुरोध दाखिल करते हैं जो FDA-विनियमित थे। आप सम्मेलन सार-संक्षेप खोजते हैं। आप क्या प्राप्त करते हैं?",
              branches: [
                { id: 'd', text: "2 परीक्षणों के लिए पूर्ण डेटा, 3 और के लिए सम्मेलन सार", nextNode: 'partial' },
                { id: 'e', text: "Nothing after 6 months of effort", nextNode: 'nothing' }
              ]
            },
            {
              id: 'partial',
              type: 'outcome',
              consequence: 'good',
              title: "विस्तारित साक्ष्य आधार",
              text: "You now have 17 trials with full data + 3 with abstract-level data. Primary analysis uses 17. Sensitivity analysis adds 3 abstract-level estimates. You report: 'Of 23 known trials, 15 were published. We obtained data for 5 additional trials (3 negative). Effect reduced from 0.45 to 0.34.' You've documented the bias and partially corrected it.",
              realCase: "प्रयास का यह स्तर - परीक्षणकर्ताओं, FOIA, सम्मेलन खोजों से संपर्क करना - महत्वपूर्ण पर कोक्रेन समीक्षाओं के लिए सर्वोत्तम अभ्यास माना जाता है प्रश्न।"
            },
            {
              id: 'nothing',
              type: 'outcome',
              consequence: 'neutral',
              title: "दस्तावेज़ विफलता",
              text: "You've exhausted reasonable options. Your review reports: 'We identified 8 unpublished completed trials (33% of known evidence base). Despite multiple contacts and FOIA requests, data could not be obtained. Three trialists confirmed negative results. Our effect estimate is likely inflated.' This is transparent and appropriately cautious.",
              realCase: "डेटा प्राप्त करने के असफल प्रयासों का दस्तावेजीकरण करना मूल्यवान है - यह पाठकों को पूर्वाग्रह के प्रति सचेत करता है और भविष्य के जांचकर्ताओं के लिए एक रिकॉर्ड बनाता है।"
            },
            {
              id: 'dual',
              type: 'outcome',
              consequence: 'neutral',
              title: "संवेदनशीलता दृष्टिकोण",
              text: "You report published analysis (15 trials, effect=0.45) and a 'worst case' sensitivity analysis assuming the 8 missing trials had null effects (23 trials, effect=0.28). This bounds the plausible effect. You note: 'True effect likely lies between these estimates, probably closer to lower bound given evidence that missing trials had negative results.'",
              realCase: "लापता डेटा के लिए संवेदनशीलता विश्लेषण एक वैध दृष्टिकोण है, लेकिन यह ध्यान दिया जाना चाहिए कि यह सिमुलेशन है, डेटा पुनर्प्राप्ति नहीं।"
            }
          ]
        }
      },
      {
        type: 'clinical-guide',
        content: {
          title: "द एविडेंस हंटर का चेकलिस्ट",
          items: [
            "REGISTRIES: Search ClinicalTrials.gov, ISRCTN, WHO ICTRP for completed unpublished trials",
            "CONTACT TRIALISTS: Email corresponding authors of missing trials — many will share data",
            "REGULATORY DATA: FOIA requests to FDA, EMA public assessment reports",
            "CONFERENCES: Search society meeting abstracts (often on Embase)",
            "DISSERTATIONS: ProQuest, institutional repositories",
            "LITIGATION: Drug Industry Document Archive for specific drugs",
            "DOCUMENT EVERYTHING: Record what you searched, what you found, what you couldn't get",
            "रिपोर्ट अंतराल: यहां तक कि असफल खोजें भी जानकारीपूर्ण हैं - आपको मिले लापता परीक्षणों की रिपोर्ट करें"
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "दो शोधकर्ताओं को समान गुम डेटा का सामना करना पड़ता है",
          darkSide: {
            header: "शोधकर्ता ए: व्यावहारिक",
            items: [
              "Finds 8 unpublished trials on registry",
              "Sends one email to each trialist",
              "Waits 2 weeks, gets no response",
              "प्रकाशित डेटा के साथ आगे बढ़ें केवल",
              "Reports 'comprehensive search performed'"
            ],
            consequence: "Result: Meta-analysis published showing strong effect (d=0.45). Guidelines cite it. Two years later, unpublished trials surface showing true effect d=0.22. Guidelines have to be revised."
          },
          lightSide: {
            header: "शोधकर्ता बी: जासूस",
            items: [
              "Finds same 8 unpublished trials",
              "Sends 3 follow-up emails over 3 months",
              "Files FOIA requests for FDA-regulated trials",
              "Searches conference abstracts manually",
              "Obtains 5 of 8 datasets (3 negative)"
            ],
            consequence: "Result: Meta-analysis published showing modest effect (d=0.28) with full transparency about missing data. Guidelines cite conservative estimate. No future revision needed."
          }
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "दिशानिर्देश लेखक की दुविधा",
          situation: "You're writing clinical guidelines for a treatment. The meta-analysis shows benefit (OR 0.70, p=0.001), but Egger's test is significant (p=0.03) and you've identified 6 unpublished trials on registries. The treatment is already widely used. What do you recommend?",
          nodes: [
            {
              id: 'start',
              question: "साक्ष्य प्रभावकारिता लेकिन संभावित प्रकाशन पूर्वाग्रह दिखाता है। आपके दिशानिर्देश में क्या है?",
              branches: [
                { id: 'a', text: "Strong recommendation — the meta-analysis shows clear benefit", nextNode: 'strong' },
                { id: 'b', text: "पूर्वाग्रह संबंधी चिंताओं के बारे में चेतावनी के साथ सशर्त अनुशंसा", nextNode: 'conditional' },
                { id: 'c', text: "आगे साक्ष्य की प्रतीक्षा करें - वर्तमान साक्ष्य अविश्वसनीय है", nextNode: 'await' }
              ]
            },
            {
              id: 'strong',
              type: 'outcome',
              consequence: 'bad',
              title: "अतिप्रतिबद्ध दिशानिर्देश",
              text: "आपकी मजबूत अनुशंसा व्यापक रूप से अपनाने को प्रेरित करती है। लेकिन वास्तविक प्रभाव (अप्रकाशित डेटा सहित) सुझाए गए प्रकाशित साक्ष्यों की तुलना में बहुत कमजोर है। मरीज़ों को इलाज से सीमांत लाभ तो होता है लेकिन नुकसान वास्तविक होता है। जब सच्चाई सामने आती है, तो आपके दिशानिर्देश की विश्वसनीयता को नुकसान पहुंचता है।",
              realCase: "यह पैटर्न टैमीफ्लू के साथ खेला गया - पक्षपातपूर्ण प्रकाशित साक्ष्यों के आधार पर मजबूत दिशानिर्देश सिफारिशें, भंडार पर अरबों खर्च किए गए, फिर कोक्रेन के पूर्ण-डेटा विश्लेषण ने न्यूनतम लाभ दिखाया।"
            },
            {
              id: 'conditional',
              question: "आप एक सशर्त सिफारिश लिखते हैं। आप अनिश्चितता को कैसे संप्रेषित करते हैं?",
              branches: [
                { id: 'd', text: "Note 'low certainty evidence' using GRADE, mention bias concerns briefly", nextNode: 'grade' },
                { id: 'e', text: "Full transparency: report both published and bias-adjusted estimates, explain missing trials", nextNode: 'transparent' }
              ]
            },
            {
              id: 'grade',
              type: 'outcome',
              consequence: 'neutral',
              title: "मानक दृष्टिकोण",
              text: "You downgrade for publication bias per GRADE. Your recommendation reads: 'Conditional recommendation, low certainty evidence.' But many readers don't understand what this means. Clinicians may still interpret it as 'probably works.' The nuance is lost.",
              realCase: "अध्ययन बताते हैं कि GRADE निश्चितता रेटिंग की अक्सर गलत व्याख्या की जाती है। 'कम निश्चितता' चिंता की डिग्री को पर्याप्त रूप से संप्रेषित नहीं करती है।"
            },
            {
              id: 'transparent',
              type: 'outcome',
              consequence: 'good',
              title: "पूरी तरह से सूचित दिशानिर्देश",
              text: "Your guideline states: 'Published trials suggest OR 0.70. However, we identified 6 unpublished trials and funnel plot asymmetry suggests the true effect may be weaker. Adjusted estimates range from OR 0.70-0.85. Until full data are available, benefits should not be overstated.' Clinicians can make informed decisions.",
              realCase: "इस पारदर्शी दृष्टिकोण की तेजी से अनुशंसा की जा रही है। 2023 PRISMA-P दिशानिर्देश सभी पूर्वाग्रह आकलन और उनके निहितार्थों की रिपोर्ट करने पर जोर देते हैं।"
            },
            {
              id: 'await',
              type: 'outcome',
              consequence: 'neutral',
              title: "रूढ़िवादी रुख",
              text: "Your guideline states: 'Insufficient evidence due to likely publication bias.' But the treatment is already widely used. Clinicians continue prescribing without guidance. Your conservative stance may be scientifically correct but practically unhelpful. Sometimes imperfect guidance is better than no guidance.",
              realCase: "सही सबूत की प्रतीक्षा करने और समय पर मार्गदर्शन प्रदान करने के बीच तनाव है। कुंजी पारदर्शी अनिश्चितता संचार है, मौन नहीं।"
            }
          ]
        }
      },
      {
        type: 'oath',
        content: {
          header: "द एविडेंस हंटर की शपथ",
          text: "I will not stop at the published literature.<br><strong>I will search the registries, contact the trialists, petition the regulators.</strong><br><br>I will document my search — what I found and what I could not find.<br>For the studies I cannot obtain are as important as those I can.<br><br>The buried evidence has a voice.<br><strong>I will be the one who listens.</strong>"
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "दस काल्पनिक अध्ययन थोपने से बेहतर है कि एक दबे हुए अध्ययन को खोजा जाए। जो जासूस रजिस्ट्री खोजता है, वह सौ के लायक है जो केवल आंकड़े चलाता है।"
        }
      },
      {
        type: 'quiz',
        content: {
          question: "You find that 40% of registered trials for your intervention have no published results 5 years after completion. This most likely indicates:",
          options: [
            { id: 'a', text: "परीक्षण अभी भी जारी हैं", correct: false },
            { id: 'b', text: "परिणाम नकारात्मक या अरुचिकर थे और प्रकाशित नहीं किए गए थे", correct: true },
            { id: 'c', text: "रजिस्ट्री की जानकारी गलत है", correct: false },
            { id: 'd', text: "परीक्षण अलग-अलग के तहत प्रकाशित किए गए थे नाम", correct: false }
          ],
          explanation: "Ross et al. found that non-publication 5 years after trial completion is strongly associated with negative/null results. Positive trials are published faster and more often. While some explanation (name changes, delayed publication) may apply to individual trials, systematic non-publication at this rate indicates publication bias. The published literature for this intervention is likely inflated."
        }
      },
      {
        type: 'protagonist-story',
        content: {
          name: "Dr. Tom Jefferson",
          role: "कोक्रेन शोधकर्ता और साक्ष्य हंटर",
          narrative: "Tom Jefferson spent years trying to get the complete clinical trial data for Tamiflu (oseltamivir). Despite Roche's claims of efficacy, when Jefferson and the Cochrane team finally obtained the full clinical study reports (35,000+ pages) through regulatory requests and persistent advocacy, they found the drug's benefits were far more modest than published papers suggested, and harms were understated.",
          quote: "हमें कई देशों के नियामकों को 67 अलग-अलग अनुरोध दाखिल करने पड़े। कंपनी ने हर मोड़ पर हमसे लड़ाई की। लेकिन जो डेटा वे नहीं चाहते थे कि हम देखें, वह उनके द्वारा प्रकाशित डेटा से बहुत अलग कहानी बताता है।",
          impact: "कोक्रेन ओसेल्टामिविर समीक्षा ने वैश्विक भंडारण सिफारिशों को बदल दिया और नैदानिक ​​​​परीक्षण पारदर्शिता में सुधार को बढ़ावा दिया। यह साबित हुआ कि लगातार साक्ष्य की तलाश स्थापित चिकित्सा सहमति को पलट सकती है।"
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "ClinicalTrials.gov और WHO ICTRP बताते हैं कि क्या शुरू किया गया था बनाम क्या प्रकाशित किया गया था",
            "FOIA/EMA अनुरोध पूर्ण नैदानिक ​​अध्ययन रिपोर्ट (सिर्फ जर्नल सार नहीं) तक पहुंच सकते हैं",
            "सीधे परीक्षणकर्ताओं से संपर्क करें - पूछने पर प्रतिक्रिया दर ~ 50% है अप्रकाशित डेटा के लिए विनम्रतापूर्वक",
            "Grey literature (conference abstracts, dissertations, regulatory documents) contains valuable hidden evidence",
            "अपनी खोज रणनीति का दस्तावेजीकरण करें - जो आप नहीं पा सके वह उतना ही महत्वपूर्ण है जितना आपने पाया"
          ],
          actionItem: "अपनी अगली व्यवस्थित समीक्षा से पहले, अपने प्रोटोकॉल में अनिवार्य चरणों के रूप में 'रजिस्ट्री खोज' और 'ट्रायललिस्ट संपर्क' जोड़ें। विनियामक अनुरोधों के लिए बजट समय."
        }
      }
    ]
  },

  // MODULE 6: THE CAPSTONE
  {
    id: 6,
    title: "The Capstone",
    subtitle: "Integration",
    estimatedMinutes: 30,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "सभी प्रकाशन पूर्वाग्रह का पता लगाने के तरीकों को एक सुसंगत मूल्यांकन में एकीकृत करें",
            "प्रकाशन पूर्वाग्रह जासूस के पांच सिद्धांतों को लागू करें",
            "Make ethical decisions when encountering evidence of suppression",
            "रोगी और सहकर्मियों को प्रकाशन पूर्वाग्रह के बारे में अनिश्चितता के बारे में बताएं",
            "अपने में प्रकाशन पूर्वाग्रह को संबोधित करने के लिए एक व्यक्तिगत कार्य योजना विकसित करें कार्य"
          ]
        }
      },
      {
        type: 'title',
        content: {
          title: "The Capstone",
          subtitle: "पूरी जांच",
          text: "आपने छिपे हुए को देखना, संदिग्ध का परीक्षण करना, अनुमान को समायोजित करना और दबे हुए का शिकार करना सीख लिया है। अब इन कौशलों को एक साथ लाएं।"
        }
      },
      {
        type: 'content',
        content: {
          title: "पब्लिकेशन बायस डिटेक्टिव के पांच सिद्धांत",
          sections: [
            {
              heading: "I. अनुपस्थिति सिद्धांत",
              items: ["सबूत की अनुपस्थिति अनुपस्थिति का सबूत नहीं है - यह दमन का सबूत हो सकता है।"]
            },
            {
              heading: "II. दृश्यता सिद्धांत",
              items: ["What is hidden shapes belief as powerfully as what is shown."]
            },
            {
              heading: "III. असममिति सिद्धांत",
              items: ["फ़नल से पता चलता है कि जंगल क्या छुपाता है - जो प्रकाशित हुआ था उसका आकार, और जो प्रकाशित नहीं हुआ था उसकी छाया।"]
            },
            {
              heading: "IV. अनिश्चितता सिद्धांत",
              items: ["आंख संदेह करती है, लेकिन परीक्षण मात्रा निर्धारित करता है। फिर भी कोई भी परीक्षण यह नहीं देख सकता कि वास्तव में क्या हुआ - केवल वही जो डेटा सुझाता है।"]
            },
            {
              heading: "V. पुनर्प्राप्ति सिद्धांत",
              items: ["Better to find one buried study than to impute ten imaginary ones."]
            }
          ]
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "FINAL CASE",
          title: "पूर्ण जांच: ओसेल्टामिविर (टैमीफ्लू)",
          source: "जेफरसन एट अल., कोक्रेन 2014 - छिपे हुए डेटा के लिए 4 साल की लड़ाई",
          timeline: [
            { year: "2009", text: "Cochrane begins review of neuraminidase inhibitors (Tamiflu, Relenza). Published trials suggest efficacy. Governments stockpile $billions worth.", type: "normal" },
            { year: "The Suspicion", text: "कोक्रेन लेखकों का ध्यान: 60% रोगी डेटा यहां से आया है अप्रकाशित निर्माता परीक्षण। प्रकाशित कागजात भूतलिखित थे। डेटा अनुरोध अस्वीकृत।", type: "normal" },
            { year: "2009-2012", text: "BMJ अभियान: 'डेटा खोलें।' क्लिनिकल अध्ययन रिपोर्ट के लिए रोशे से बार-बार अनुरोध। इनकारों और बातचीत के वर्षों।", type: "buried" },
            { year: "2013", text: "EMA grants access to regulatory documents. Roche finally releases 77 clinical study reports — 22,000 pages.", type: "revealed" },
            { year: "The Truth", text: "पूर्ण डेटा से पता चला: टैमीफ्लू ने लक्षण अवधि को ~17 घंटे ('दिन' नहीं) कम कर दिया। निमोनिया की रोकथाम के लिए कोई सबूत नहीं (दावा किया गया अस्पताल लाभ)। मतली/उल्टी का बढ़ना। WHO ने 'आवश्यक' से डाउनग्रेड करके 'पूरक' कर दिया है।", type: "revealed" }
          ],
          realData: {
            publishedClaim: "निमोनिया और अस्पताल में भर्ती होने की संख्या को कम करता है",
            fullDataReality: "निमोनिया की रोकथाम के लिए कोई सबूत नहीं है",
            symptomBenefit: "~17 hours symptom reduction",
            harms: "Increased nausea, vomiting, headache",
            stockpileWaste: "Billions in government stockpiles of overstated benefit"
          }
        }
      },
      {
        type: 'statistic-card',
        content: {
          value: "4 Years",
          label: "नैदानिक ​​​​अध्ययन रिपोर्ट प्राप्त करने के लिए जो सार्वजनिक होनी चाहिए थी",
          context: "The delay cost billions in misallocated pandemic preparedness"
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "Reading a Meta-Analysis: The Bias Detective's Checklist",
          situation: "A colleague sends you a meta-analysis showing that a new intervention significantly reduces mortality (OR 0.65, 95% CI 0.52-0.81, p<0.001). They want to change clinical practice based on this. Before agreeing, what do you check?",
          nodes: [
            {
              id: 'start',
              question: "मेटा-विश्लेषण प्रभावशाली परिणाम दिखाता है। आपका पहला प्रश्न क्या है?",
              branches: [
                { id: 'a', text: "कितने अध्ययन शामिल थे?", nextNode: 'studies' },
                { id: 'b', text: "क्या प्रकाशन पूर्वाग्रह का मूल्यांकन किया गया था?", nextNode: 'bias_check' },
                { id: 'c', text: "क्या अप्रकाशित परीक्षणों के लिए परीक्षण रजिस्ट्रियों की खोज की गई थी?", nextNode: 'registry' }
              ]
            },
            {
              id: 'studies',
              question: "मेटा-विश्लेषण में 8 अध्ययन शामिल हैं। पूर्वाग्रह मूल्यांकन के लिए इसका क्या अर्थ है?",
              branches: [
                { id: 'd', text: "Too few for reliable Egger's test — visual assessment only", nextNode: 'few_studies' },
                { id: 'e', text: "Enough for full bias assessment", nextNode: 'wrong_enough' }
              ]
            },
            {
              id: 'few_studies',
              type: 'outcome',
              consequence: 'good',
              title: "सीमा की सही पहचान की गई",
              text: "With only 8 studies, statistical tests for publication bias (Egger's, Begg's) have very low power. A non-significant test does NOT mean no bias. You should rely more on: (1) Visual funnel plot assessment, (2) Registry searches for unpublished trials, (3) Assessment of whether all studies are positive (suspicious). Statistical tests can neither confirm nor rule out bias.",
              realCase: "कोक्रेन मार्गदर्शन में कहा गया है कि फ़नल प्लॉट असममिति के लिए परीक्षणों का उपयोग तब नहीं किया जाना चाहिए जब 10 से कम अध्ययन हों।"
            },
            {
              id: 'wrong_enough',
              type: 'outcome',
              consequence: 'bad',
              title: "Overconfident in Tests",
              text: "8 अध्ययन एगर के परीक्षण के लिए अनुशंसित न्यूनतम 10 से कम है। इतने कम अध्ययनों के साथ, परीक्षण में झूठी नकारात्मक दरें अधिक हैं - यह अक्सर वास्तविक पूर्वाग्रह को नजरअंदाज कर देगा। 8 अध्ययनों के साथ एक गैर-महत्वपूर्ण परीक्षण से 'कोई पूर्वाग्रह नहीं' का निष्कर्ष निकालना उचित नहीं है। आपको अन्य तरीकों का उपयोग करने की आवश्यकता है।",
              realCase: "सिमुलेशन से पता चलता है कि एगर के परीक्षण में 10 अध्ययनों के साथ मध्यम पूर्वाग्रह का पता लगाने के लिए केवल ~50% शक्ति है, और कम के साथ और भी कम।"
            },
            {
              id: 'bias_check',
              question: "The methods section says 'Publication bias was assessed using Egger's test (p=0.34)'. What's your concern?",
              branches: [
                { id: 'f', text: "अच्छा है - उन्होंने पूर्वाग्रह के लिए परीक्षण किया और कोई नहीं पाया", nextNode: 'false_assurance' },
                { id: 'g', text: "A non-significant test doesn't prove no bias — what else did they do?", nextNode: 'deeper' }
              ]
            },
            {
              id: 'false_assurance',
              type: 'outcome',
              consequence: 'bad',
              title: "झूठा आश्वासन",
              text: "A non-significant Egger's test does NOT prove absence of bias. It means the test failed to detect asymmetry — which could be because there's no bias, OR because the test lacked power, OR because bias exists but isn't reflected in asymmetry. You need additional information: funnel plot inspection, registry search, assessment of study characteristics.",
              realCase: "कई मेटा-विश्लेषण बिना एगर के केवल पी-वैल्यू की रिपोर्ट करते हैं फ़नल प्लॉट या रजिस्ट्री खोजें। यह पूर्वाग्रह मूल्यांकन के लिए अपर्याप्त है।"
            },
            {
              id: 'deeper',
              type: 'outcome',
              consequence: 'good',
              title: "उपयुक्त संशयवाद",
              text: "You ask the right follow-up questions: Did they search trial registries? Did they show the funnel plot? Did they compare industry vs. independent trials? Did they contact authors of conference abstracts that never became papers? A single statistical test is the minimum, not the full assessment.",
              realCase: "Best practice includes: visual funnel plot, statistical tests, registry search, comparison by funding source, and contact with trialists."
            },
            {
              id: 'registry',
              type: 'outcome',
              consequence: 'good',
              title: "जासूस का पहला प्रश्न",
              text: "Registry searches are the most direct way to identify missing evidence. You check: Did the authors search ClinicalTrials.gov? Did they report how many registered trials had no published results? Did they try to obtain unpublished data? If they didn't search registries, the bias assessment is incomplete regardless of statistical tests.",
              realCase: "टर्नर के ऐतिहासिक अध्ययन से पता चला है कि रजिस्ट्री खोजें पर्याप्त अप्रकाशित साक्ष्य की पहचान कर सकती हैं जिन्हें सांख्यिकीय परीक्षण पता नहीं लगा सकते हैं।"
            }
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Readers of the Same Meta-Analysis",
          darkSide: {
            header: "द अनक्रिटिकल रीडर",
            items: [
              "Sees: 'OR 0.65, p<0.001, significant'",
              "Checks: 'Egger's p=0.34, no bias detected'",
              "Concludes: 'Strong evidence, change practice'",
              "Skips: Funnel plot, registry section, limitations",
              "Tells colleagues: 'The meta-analysis proves it works'"
            ],
            consequence: "परिणाम: बढ़े हुए सबूतों के आधार पर उपचार अपनाता है। बाद में पता चला कि अप्रकाशित परीक्षणों ने अप्रभावी प्रभाव दिखाया। मरीजों को यह समझाना होगा कि 'सिद्ध' इलाज से उन्हें मदद क्यों नहीं मिली।"
          },
          lightSide: {
            header: "द पब्लिकेशन बायस डिटेक्टिव",
            items: [
              "Sees same numbers, asks: 'What's missing?'",
              "Examines funnel plot: 'Gap in bottom-left'",
              "Checks registry search: 'None reported'",
              "Notes: 'All 8 trials industry-funded, all positive'",
              "Tells colleagues: 'Likely inflated, await independent data'"
            ],
            consequence: "Result: Maintains appropriate uncertainty. When full data emerge showing weaker effect, no surprise. Patients received honest communication about uncertainty from the start."
          }
        }
      },
      {
        type: 'oath',
        content: {
          header: "मरीजों द्वारा जिन्होंने सबूतों पर भरोसा किया",
          text: "For every inflated effect size, there was a patient who expected more benefit than they received.<br><br>For every buried negative trial, there was a patient who received a treatment that did not work.<br><br>For every spin, there was a doctor who believed what they read.<br><br><strong>The detective remembers: Numbers are not abstractions. They guide treatment. They shape lives.</strong><br><br>Vigilance in evidence assessment is not pedantry — it is care."
        }
      },
      {
        type: 'case-file',
        content: {
          caseNumber: "MEMORIAL CASE",
          title: "नंबरों के पीछे के चेहरे",
          source: "Multiple sources — The Human Cost of Publication Bias",
          timeline: [
            { year: "Reboxetine", text: "मरीजों ने एक दवा ली जो प्रभावी दिखी प्रकाशनों में लेकिन संपूर्ण डेटा में कोई लाभ नहीं दिखा। प्लेसीबो प्रभाव के साथ वर्षों तक उपचार, साथ ही दुष्प्रभाव, जबकि बेहतर विकल्प मौजूद थे।", type: "buried" },
            { year: "Vioxx", text: "26,000-55,000 अतिरिक्त मौतें। उन लोगों में दिल का दौरा, जिन्होंने अपने डॉक्टर पर भरोसा किया, जिन्होंने प्रकाशित साहित्य पर भरोसा किया, जिसमें सुरक्षा संकेत नहीं थे।", type: "buried" },
            { year: "Study 329", text: "बच्चों को सुरक्षा का दावा करने वाले भूत-लिखित पेपर के आधार पर पैरॉक्सिटिन दिया गया। आत्महत्या की घटनाएँ 8 गुना बढ़ गईं, लेकिन इसे छुपाया गया। झूठ बोलने वाले अखबार से किशोरों को नुकसान हुआ।", type: "buried" },
            { year: "DECREASE", text: "मनगढ़ंत आंकड़ों पर आधारित दिशानिर्देशों से यूरोप में प्रति वर्ष ~10,000 मौतें। मरीजों को सर्जरी से पहले बीटा-ब्लॉकर्स दिए गए क्योंकि एक धोखेबाज शोधकर्ता ने सबूत का आविष्कार किया था।", type: "buried" },
            { year: "Avandia", text: "83,000 अतिरिक्त दिल के दौरे। सात साल तक प्रिस्क्राइब किया गया जबकि कंपनी को हृदय संबंधी जोखिम के बारे में पता था। प्रकाशित साहित्य में कुछ भी गलत नहीं दिखाया गया।", type: "buried" }
          ],
          realData: {
            totalEstimatedDeaths: "अकेले इस पाठ्यक्रम के मामलों से 100,000+",
            commonThread: "प्रकाशित साक्ष्य जो व्यवस्थित रूप से अधूरे थे",
            responsibility: "Distributed — companies, journals, regulators, researchers",
            prevention: "Vigilant detection, transparency demands, systematic searching"
          }
        }
      },
      {
        type: 'death-toll',
        content: {
          number: "100,000+",
          label: "इस पाठ्यक्रम में शामिल मामलों से होने वाली मौतों का रूढ़िवादी अनुमान",
          source: "Vioxx (26-55k) + DECREASE (~10k/yr × several years) + Avandia (unknown fraction of 83k MIs) + others"
        }
      },
      {
        type: 'decision-tree',
        content: {
          title: "अगला चरण: आप क्या करेंगे क्या?",
          situation: "आपने यह पाठ्यक्रम पूरा कर लिया है। अब आप प्रकाशन पूर्वाग्रह देख सकते हैं, उसका परीक्षण कर सकते हैं, उसके लिए समायोजन कर सकते हैं और छिपे हुए साक्ष्य की तलाश कर सकते हैं। लेकिन क्रिया के बिना ज्ञान कुछ नहीं बदलता। आपने जो सीखा है उसका आप क्या करेंगे?",
          nodes: [
            {
              id: 'start',
              question: "आपने प्रकाशन पूर्वाग्रह जासूस के कौशल सीखे हैं। आप उनका उपयोग कैसे करेंगे?",
              branches: [
                { id: 'a', text: "In my own research — I'll be more vigilant about bias in literature I read", nextNode: 'personal' },
                { id: 'b', text: "As a reviewer — I'll demand better bias assessment in papers I review", nextNode: 'reviewer' },
                { id: 'c', text: "As an advocate — I'll push for transparency in my institution/field", nextNode: 'advocate' }
              ]
            },
            {
              id: 'personal',
              question: "आप व्यक्तिगत सतर्कता के लिए प्रतिबद्ध हैं। आप इसे कैसे लागू करेंगे?",
              branches: [
                { id: 'd', text: "Check funnel plots and bias assessments in every meta-analysis I read", nextNode: 'personal_good' },
                { id: 'e', text: "Search registries when making treatment decisions based on published evidence", nextNode: 'personal_great' }
              ]
            },
            {
              id: 'personal_good',
              type: 'outcome',
              consequence: 'good',
              title: "जानकार उपभोक्ता",
              text: "You become a critical reader of evidence. When a meta-analysis claims strong effects, you check: How many studies? Funnel plot shape? Registry search? This protects your patients from inflated claims. One alert clinician at a time, the distortion loses power.",
              realCase: "व्यक्तिगत सतर्कता मायने रखती है। यदि अधिक पाठकों ने रीबॉक्सेटीन मेटा-विश्लेषणों पर सवाल उठाया होता, तो दवा की जांच पहले ही की जा चुकी होती।"
            },
            {
              id: 'personal_great',
              type: 'outcome',
              consequence: 'good',
              title: "सक्रिय अन्वेषक",
              text: "अभ्यास बदलने से पहले, आप स्वयं क्लीनिकलट्रायल.जीओवी खोजें। आपको अप्रकाशित परीक्षण मिलते हैं जो मेटा-विश्लेषण से छूट गए। आप डेटा के लिए परीक्षणकर्ताओं को ईमेल करते हैं। आप वह जासूस बनें जिसके लिए इस पाठ्यक्रम ने आपको प्रशिक्षित किया है। आपके मरीज़ों को संपूर्ण साक्ष्य के आधार पर देखभाल मिलती है, न कि केवल प्रकाशित अंश के आधार पर।",
              realCase: "Clinicians who check registries before adopting new treatments are rare but invaluable. They catch problems before guidelines do."
            },
            {
              id: 'reviewer',
              question: "एक सहकर्मी समीक्षक के रूप में, आप जो प्रकाशित होता है उसे आकार दे सकते हैं। आपको क्या आवश्यकता होगी?",
              branches: [
                { id: 'f', text: "Demand funnel plots and Egger's tests in all meta-analyses", nextNode: 'reviewer_minimum' },
                { id: 'g', text: "Require registry searches and documentation of unpublished trials", nextNode: 'reviewer_thorough' }
              ]
            },
            {
              id: 'reviewer_minimum',
              type: 'outcome',
              consequence: 'neutral',
              title: "सांख्यिकीय द्वारपाल",
              text: "आपके द्वारा समीक्षा किए जाने वाले प्रत्येक मेटा-विश्लेषण में आपको पूर्वाग्रह मूल्यांकन की आवश्यकता होती है। लेखकों में अब फ़नल प्लॉट शामिल हैं। लेकिन रजिस्ट्री खोजों के बिना, सांख्यिकीय परीक्षण केवल समस्या का एक अंश ही पता लगाते हैं। आपने न्यूनतम सीमा बढ़ा दी है - एक सार्थक योगदान - लेकिन गहरी समस्या अभी भी बनी हुई है।",
              realCase: "Many journals now require bias assessment. Compliance has improved. But quality of assessment varies widely."
            },
            {
              id: 'reviewer_thorough',
              type: 'outcome',
              consequence: 'good',
              title: "संपूर्ण द्वारपाल",
              text: "You require: (1) Registry search with documentation of found/not found trials, (2) Contact attempts with trialists, (3) Comparison of published vs. registry-reported outcomes, (4) GRADE assessment incorporating bias risk. You reject meta-analyses that claim 'no publication bias' based on Egger's test alone. Standards rise.",
              realCase: "कोक्रेन के मानकों ने वैश्विक स्तर पर व्यवस्थित समीक्षाओं के लिए मानक बढ़ा दिए हैं। उच्च मानकों को लागू करने वाले व्यक्तिगत समीक्षक प्रणालीगत परिवर्तन लाते हैं।"
            },
            {
              id: 'advocate',
              question: "आप प्रणालीगत पारदर्शिता पर जोर देना चाहते हैं। आप अपनी वकालत कहां केंद्रित करेंगे?",
              branches: [
                { id: 'h', text: "सभी परीक्षणों और अनिवार्य परिणामों की रिपोर्टिंग का समर्थन करें", nextNode: 'advocate_policy' },
                { id: 'i', text: "Push my institution to adopt data sharing policies", nextNode: 'advocate_local' },
                { id: 'j', text: "दूसरों को प्रशिक्षित करें - इन कौशलों को सहकर्मियों और छात्रों तक फैलाएं", nextNode: 'advocate_teach' }
              ]
            },
            {
              id: 'advocate_policy',
              type: 'outcome',
              consequence: 'good',
              title: "नीति अधिवक्ता",
              text: "आप AllTrials पर हस्ताक्षर करते हैं। आप परीक्षण पारदर्शिता के बारे में विधायकों को लिखते हैं। आप FDAAA प्रवर्तन का समर्थन करते हैं। आप हज़ारों में से एक आवाज़ हैं - लेकिन हज़ारों आवाज़ें राजनीतिक इच्छाशक्ति पैदा करती हैं। परिणाम रिपोर्टिंग की आवश्यकता वाला 2007 का कानून इसलिए बना क्योंकि अधिवक्ताओं ने इसकी मांग की थी। अगले सुधार के लिए आपकी आवश्यकता है।",
              realCase: "ऑलट्रायल्स ने 90,000+ हस्ताक्षर एकत्र किए और ईएमए नीति को प्रभावित किया। व्यक्तिगत आवाज़ें एकत्रित होकर राजनीतिक ताकत बनती हैं।"
            },
            {
              id: 'advocate_local',
              type: 'outcome',
              consequence: 'good',
              title: "संस्थागत चैंपियन",
              text: "You push your hospital/university to require data sharing for all trials conducted there. You advocate for pre-registration policies. You work with the IRB to include transparency requirements. One institution at a time, the culture shifts. When everyone around you expects transparency, suppression becomes harder.",
              realCase: "कई शैक्षणिक चिकित्सा केंद्रों को अब पूर्व-पंजीकरण और परिणाम रिपोर्टिंग की आवश्यकता होती है। ये नीतियां आंतरिक वकालत से उभरीं।"
            },
            {
              id: 'advocate_teach',
              type: 'outcome',
              consequence: 'good',
              title: "The Multiplier",
              text: "You teach this course to your residents. You present at grand rounds. You write blog posts explaining funnel plots. Every person you train becomes another detective. The skills spread exponentially. One teacher creates hundreds of vigilant readers. This is how paradigms shift — one learner at a time, until critical mass is reached.",
              realCase: "साक्ष्य-आधारित चिकित्सा आंदोलन शिक्षण के माध्यम से फैल गया। प्रकाशन पूर्वाग्रह जागरूकता उसी तरह फैल रही है। आप इसे तेज़ कर सकते हैं।"
            }
          ]
        }
      },
      {
        type: 'contrast',
        content: {
          title: "Two Futures",
          darkSide: {
            header: "निरंतर मौन का भविष्य",
            items: [
              "Researchers continue hiding negative trials",
              "Journals continue rejecting null results",
              "Meta-analyses continue to inflate effects",
              "Guidelines continue to be based on incomplete evidence",
              "Patients continue receiving treatments that don't work",
              "अगला Vioxx होता है, और अगला, और अगला"
            ],
            consequence: "अगर कुछ नहीं बदला तो भविष्य. दमन और क्षति का चक्र जारी है. प्रकाशन पूर्वाग्रह का ज्ञान अकादमिक रहता है, कार्रवाई योग्य नहीं।"
          },
          lightSide: {
            header: "सतर्क जांच का भविष्य",
            items: [
              "Detectives check every meta-analysis for bias",
              "Reviewers demand registry searches before acceptance",
              "Clinicians verify evidence before changing practice",
              "Advocates push for transparency at every level",
              "Teachers spread the skills of detection",
              "दमन की लागत तब तक बढ़ती है जब तक कि यह लाभ से अधिक न हो जाए"
            ],
            consequence: "यदि आप कार्य करते हैं तो भविष्य। प्रत्येक जासूस, प्रत्येक समीक्षक, प्रत्येक वकील संतुलन बदलता है। प्रकाशन पूर्वाग्रह कठिन, जोखिम भरा और कम लाभदायक हो जाता है। सत्य को प्रकाश मिलता है।"
          }
        }
      },
      {
        type: 'oath',
        content: {
          header: "अंतिम प्रतिबद्धता",
          text: "I have learned to see what is hidden.<br>I have learned to test my suspicions.<br>I have learned to hunt for buried evidence.<br><br><strong>I will not let this knowledge remain unused.</strong><br><br>I will check the funnels. I will search the registries.<br>I will ask the questions no one wants asked.<br>I will document what I find and what I cannot find.<br><br><strong>I will be the detective the evidence needs.</strong>"
        }
      },
      {
        type: 'principle',
        content: {
          number: "OATH",
          text: "I will not accept the published literature as truth without investigation.\n\nI will look for what is hidden as carefully as I examine what is shown.\n\nI will test my suspicions statistically, but never mistake the test for certainty.\n\nI will hunt for buried evidence rather than impute imaginary studies.\n\nI will report what I find and what I cannot find — both are evidence.\n\nI will remember that behind every missing study are patients whose treatment was decided on incomplete evidence."
        }
      },
      {
        type: 'rhetoric',
        content: {
          question: "और जब आपने यह सब सीख लिया है - जब आप फ़नल की विषमता देख सकते हैं, सांख्यिकीय परीक्षणों की फुसफुसाहट सुन सकते हैं, और अभिलेखागार के माध्यम से एक जासूस की तरह रजिस्ट्रियों के माध्यम से शिकार कर सकते हैं - तो आप इस ज्ञान के साथ क्या करेंगे? चुप रहोगे या बोलोगे?"
        }
      },
      {
        type: 'cycle-return',
        content: {
          principle: "आप पहचान सीखने आए हैं. आप यह जानते हुए निकलें कि पता लगाना केवल शुरुआत है। जो जासूस सत्य का पता लगाता है उसे उसे प्रकट करने के लिए संघर्ष भी करना पड़ता है। वह साक्ष्य जिसने कभी प्रकाश नहीं देखा - केवल तभी ठीक हो सकता है जब आप इसे दिन में लाएंगे।"
        }
      },
      {
        type: 'redemption-story',
        content: {
          title: "Johnson & Johnson's DePuy Hip Implant Recall",
          narrative: "Not all stories of hidden data end in regulatory punishment. In 2010, Johnson & Johnson voluntarily recalled its DePuy ASR hip replacement system after internal analysis revealed higher-than-expected failure rates. While critics noted the recall came late (after ~93,000 implants), the company ultimately shared its internal data, funded revision surgeries, and established a patient monitoring registry. The DePuy case shows that companies CAN choose transparency when internal evidence shows harm — and that this path, while costly, is less destructive than prolonged concealment.",
          lesson: "नुकसान की खोज के बाद पारदर्शिता, अपूर्ण होते हुए भी, नुकसान को सीमित करती है और विश्वास का पुनर्निर्माण शुरू करती है। Vioxx (जहां मर्क ने कथित तौर पर वर्षों तक डेटा छुपाया था) के साथ विरोधाभास असुविधाजनक सबूतों के लिए दो संभावित कॉर्पोरेट प्रतिक्रियाएं दिखाता है। दोनों महंगे हैं, लेकिन एक वैज्ञानिक अखंडता को बरकरार रखता है।"
        }
      },
      {
        type: 'practice-case',
        content: {
          title: "अपने कौशल को लागू करना",
          scenario: "You're reviewing a meta-analysis of a new diabetes drug. The authors report OR = 0.65 (95% CI: 0.52-0.81) for cardiovascular events, based on 12 trials. They state 'Egger's test was non-significant (p=0.34), indicating no publication bias.' The funnel plot shows slight asymmetry in the lower-left. Registry search shows 18 trials were registered for this drug.",
          data: {
            headers: ["Study", "Effect (log OR)", "SE", "Published"],
            rows: [
              ["ADVANCE-1", "-0.52", "0.15", "Yes"],
              ["CARDIO-2", "-0.48", "0.18", "Yes"],
              ["SAFE-3", "-0.35", "0.22", "Yes"],
              ["TRIAL-4", "-0.61", "0.12", "Yes"],
              ["MULTI-5", "-0.28", "0.25", "Yes"],
              ["PILOT-6", "-0.41", "0.20", "Yes"],
              ["REG-7 to REG-18", "???", "???", "No (6 registered, no results)"]
            ]
          },
          questions: [
            "What concerns does the registry search raise?",
            "गैर-महत्वपूर्ण एगर का परीक्षण आश्वस्त क्यों नहीं है?",
            "इस प्रभाव अनुमान को स्वीकार करने से पहले आप क्या अनुशंसा करेंगे?"
          ],
          answers: [
            "18 registered trials but only 12 published = 33% missing. This gap strongly suggests selective publication. The 6 missing trials likely had less favorable results.",
            "12 अध्ययनों के साथ एगर के परीक्षण में कम शक्ति है। एक गैर-महत्वपूर्ण परिणाम पूर्वाग्रह से इंकार नहीं करता है - इसका मतलब है कि परीक्षण इसका पता नहीं लगा सका। दृश्य विषमता मौजूद है. दृश्य विषमता + रजिस्ट्री अंतर का संयोजन एगर के परीक्षण के आश्वासन से कहीं अधिक चिंताजनक है।",
            "6 अप्रकाशित परीक्षणों के जांचकर्ताओं से संपर्क करें। विनियामक डेटा के लिए फ़ाइल अनुरोध. संवेदनशीलता विश्लेषण के रूप में ट्रिम-एंड-फिल और पीईटी-पीज़ चलाएँ। ग्रेड मूल्यांकन में डाउनग्रेड निश्चितता। बिंदु अनुमान को विश्वसनीय न मानें।"
          ]
        }
      },
      {
        type: 'printable-checklist',
        content: {
          title: "Publication Bias Assessment Checklist",
          sections: [
            {
              heading: "1. Visual Assessment",
              items: [
                "Examine funnel plot for symmetry",
                "Note location of any gaps (significance regions?)",
                "Check if small studies cluster on one side",
                "Consider contour-enhanced funnel if available"
              ]
            },
            {
              heading: "2. Statistical Tests",
              items: [
                "Report Egger's test with p-value (threshold: p<0.10)",
                "Note number of studies (tests unreliable with <10)",
                "Report Begg's test if available",
                "Check if visual and statistical findings agree"
              ]
            },
            {
              heading: "3. Registry Search",
              items: [
                "Search ClinicalTrials.gov for intervention",
                "Search WHO ICTRP for international trials",
                "Compare registered vs. published trial count",
                "Document completion dates of unpublished trials"
              ]
            },
            {
              heading: "4. Additional Investigation",
              items: [
                "अप्रकाशित डेटा के लिए परीक्षणकर्ताओं से संपर्क करें",
                "Search conference abstracts and grey literature",
                "Check regulatory documents (FDA, EMA)",
                "Compare published outcomes to registered outcomes"
              ]
            },
            {
              heading: "5. Sensitivity Analysis",
              items: [
                "Run trim-and-fill and report adjusted estimate",
                "यदि 10+ अध्ययन उपलब्ध हैं तो PET-PEESE चलाएँ",
                "Calculate Fail-Safe N as heuristic",
                "Consider selection model if appropriate"
              ]
            },
            {
              heading: "6. Interpretation & Reporting",
              items: [
                "Document all searches (dates, terms, results)",
                "जो नहीं मिला और जो था उसकी भी रिपोर्ट करें",
                "Adjust GRADE certainty based on bias assessment",
                "State conclusions cautiously if bias suspected"
              ]
            }
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "Reporting Standards: PRISMA-PB and PROSPERO",
          sections: [
            {
              heading: "PRISMA Extension for Publication Bias (PRISMA-PB)",
              items: [
                "चेकलिस्ट आइटम 15: लापता परिणामों के कारण पूर्वाग्रह के जोखिम का आकलन करने के लिए उपयोग की जाने वाली विधियों का वर्णन करें",
                "Checklist item 22: Present assessments of risk of bias due to missing results",
                "Requires explicit statement about registry searches conducted",
                "पाए गए अध्ययनों की संख्या बनाम शामिल संख्या को कारणों सहित रिपोर्ट करना चाहिए"
              ]
            },
            {
              heading: "PROSPERO Registration",
              items: [
                "खोज शुरू करने से पहले अपनी व्यवस्थित समीक्षा पंजीकृत करें",
                "अपनी प्रकाशन पूर्वाग्रह मूल्यांकन विधियों को पूर्व-निर्दिष्ट करें",
                "Prevents selective reporting of bias assessments (ironic!)",
                "Available free at: crd.york.ac.uk/prospero"
              ]
            },
            {
              heading: "GRADE Assessment for Publication Bias",
              items: [
                "Rate DOWN one level if publication bias strongly suspected",
                "Consider: funnel asymmetry, registry gaps, industry funding pattern",
                "Document reasoning in GRADE evidence profile",
                "Even with bias-corrected estimates, uncertainty warrants downgrade"
              ]
            }
          ]
        }
      },
      {
        type: 'patient-communication',
        content: {
          scenario: "एक मरीज़ ऑनलाइन यह पढ़ने के बाद दवा बंद करना चाहता है कि अध्ययन 'छिपा हुआ' या 'पक्षपातपूर्ण' था।",
          script: "I understand your concern — you've read that some studies may not have been published, and that's a real issue in medicine. Let me explain what we know: while publication bias can inflate how well drugs appear to work, it doesn't mean treatments don't work at all. For your medication specifically, we have [X evidence]. The benefits we've seen in your case — [specific improvements] — are real. Let's review together whether continuing makes sense for you, but I wouldn't recommend stopping abruptly based on general concerns about bias.",
          keyPoints: [
            "Validate the concern — publication bias IS real",
            "Distinguish between inflated effects vs. no effects",
            "Ground discussion in patient's specific experience",
            "Avoid dismissing patient's research efforts",
            "Offer shared decision-making, not paternalism"
          ]
        }
      },
      {
        type: 'patient-communication',
        content: {
          scenario: "एक सहकर्मी मेटा-विश्लेषण के आधार पर एक नए उपचार की सिफारिश करता है। आपने देखा कि फ़नल प्लॉट असममित है और रजिस्ट्री लापता परीक्षणों को दिखाती है।",
          script: "Thanks for sharing this — it's an interesting option. I took a look at the meta-analysis and noticed a few things that give me pause. The funnel plot shows some asymmetry in the lower-left, and when I checked ClinicalTrials.gov, I found [X] registered trials that don't appear in the analysis. That pattern often indicates publication bias. The effect might be real, but probably smaller than the 40% reduction they report. Want to look at the registry data together? I think we should be cautious about changing our practice based on this until we understand what's missing.",
          keyPoints: [
            "प्रशंसा के साथ नेतृत्व करें, आलोचना के साथ नहीं",
            "आपने जो पाया उसके बारे में विशिष्ट रहें (अस्पष्ट संदेह नहीं)",
            "साक्ष्यों की एक साथ समीक्षा करने की पेशकश (सहयोगात्मक)",
            "यह मत कहो कि 'अध्ययन गलत है' - कहें कि 'प्रभाव बढ़ सकता है'",
            "Suggest appropriate caution, not rejection"
          ]
        }
      },
      {
        type: 'content',
        content: {
          title: "Questions Patients Can Ask Their Doctor",
          sections: [
            {
              heading: "उपचार साक्ष्य के बारे में",
              items: [
                "कितने अध्ययन इस उपचार का समर्थन करते हैं? क्या वे सभी प्रकाशित हुए थे?",
                "क्या दवा कंपनी ने अध्ययन के लिए धन दिया? क्या स्वतंत्र परीक्षण थे?",
                "क्या यह सिफ़ारिश एक व्यवस्थित समीक्षा पर आधारित है? क्या उन्होंने प्रकाशन संबंधी पूर्वाग्रह की जाँच की?",
                "इलाज के लिए आवश्यक संख्या क्या है? क्या यह सभी अध्ययनों पर आधारित है या केवल प्रकाशित अध्ययनों पर आधारित है?"
              ]
            },
            {
              heading: "About Uncertainty",
              items: [
                "आप इस सिफ़ारिश पर कितने आश्वस्त हैं?",
                "क्या लाभ अध्ययन के सुझाव से कम हो सकता है?",
                "क्या बेहतर साक्ष्य गुणवत्ता वाले उपचार मौजूद हैं?",
                "What would change your recommendation?"
              ]
            },
            {
              heading: "साझा निर्णय लेने के बारे में",
              items: [
                "अनिश्चितता को देखते हुए, मेरे पास क्या विकल्प हैं?",
                "यदि आप मेरी स्थिति में होते तो क्या करते?",
                "Can we try this and reassess in [timeframe]?",
                "मुझे क्या देखना चाहिए जिससे हमें पता चले कि यह काम नहीं कर रहा है?"
              ]
            }
          ]
        }
      },
      {
        type: 'quiz',
        content: {
          question: "POST-ASSESSMENT: A meta-analysis shows Drug X reduces mortality by 35% (OR 0.65, p<0.001). Egger's test is non-significant (p=0.28) with 8 studies. Registry shows 12 trials were registered. What's your assessment?",
          options: [
            { id: 'a', text: "पुख्ता सबूत - महत्वपूर्ण प्रभाव और कोई प्रकाशन पूर्वाग्रह नहीं पाया गया", correct: false },
            { id: 'b', text: "Uncertain — Egger's test underpowered, registry gap concerning, effect may be inflated", correct: true },
            { id: 'c', text: "Invalid — the meta-analysis should be rejected entirely", correct: false },
            { id: 'd', text: "More studies needed before any conclusion", correct: false }
          ],
          explanation: "Correct! Multiple red flags here: (1) Egger's test with only 8 studies has very low power — non-significant doesn't mean no bias; (2) 12 registered trials but only 8 published = 33% missing, suggesting selective publication; (3) The 35% effect may be inflated. You should: search for the 4 missing trials, run sensitivity analyses (trim-and-fill, PET-PEESE), and interpret with caution. Compare your answer to the pre-assessment — you've learned to see beyond p-values!"
        }
      },
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "The Five Principles: Absence, Visibility, Asymmetry, Uncertainty, Action",
            "अकेले जांच करना पर्याप्त नहीं है - सबूतों पर कार्रवाई की जानी चाहिए और साझा किया जाना चाहिए",
            "Every role matters: reader, reviewer, advocate, teacher",
            "Systemic change happens through accumulated individual actions",
            "The detective who finds truth must also fight to make it known"
          ],
          actionItem: "Before leaving this course, choose ONE concrete action: will you check funnel plots, demand registry searches, advocate for transparency, or teach others? Make a commitment and follow through."
        }
      }
    ]
  },

  // MODULE 7: CHRONICLES OF HIDDEN EVIDENCE
  {
    id: 7,
    title: "छिपे हुए साक्ष्य का इतिहास",
    subtitle: "Real Cases, Real Decisions",
    estimatedMinutes: 35,
    slides: [
      {
        type: 'learning-objectives',
        content: {
          intro: "By the end of this module, you will be able to:",
          objectives: [
            "Analyze 5 landmark cases of publication bias using real data",
            "Make clinical decisions when facing incomplete evidence",
            "Recognize patterns of data suppression across different therapeutic areas",
            "Apply the two-path framework to evaluate consequences of action vs. inaction",
            "परहेज को आंतरिक बनाएं: फ़नल देखता है कि शब्द क्या छिपाते हैं"
          ]
        }
      },
      {
        type: 'title',
        content: {
          title: "छिपे हुए साक्ष्य का इतिहास",
          subtitle: "पुरालेख से पाँच कहानियाँ",
          text: "हर कहानी एक सवाल से शुरू होती है. प्रत्येक एक विकल्प प्रस्तुत करता है। प्रत्येक वह प्रकट करता है जो छिपाया गया था। ये काल्पनिक नहीं हैं - ये घटित हुए हैं। मरीज असली थे. डेटा दबा दिया गया था. फ़नल ने सच बता दिया होगा."
        }
      },
      {
        type: 'principle',
        content: {
          number: "VI",
          text: "The funnel sees what words conceal."
        }
      },

      // STORY 1: THE PAROXETINE DECEPTION (Study 329)
      {
        type: 'story',
        content: {
          storyNumber: 1,
          title: "पैरॉक्सिटाइन धोखा",
          caseId: "Study 329",
          opening: "क्या आपने विचार किया है कि जब प्रकाशित रिकॉर्ड झूठ होता है तो क्या होता है?",
          stats: {
            header: "छिपा हुआ डेटा",
            items: [
              { value: "275", label: "Adolescents enrolled" },
              { value: "11", label: "Suicide events on paroxetine" },
              { value: "2", label: "Suicide events on placebo" },
              { value: "14", label: "Years until truth emerged" }
            ]
          },
          scenario: {
            title: "निर्णय बिंदु",
            text: "The year is 2002. You are a prescribing physician. A depressed teenager sits before you. The journal article on your desk — published in the prestigious Journal of the American Academy of Child & Adolescent Psychiatry — concludes that paroxetine is 'generally well tolerated and effective' for adolescent depression. You have two paths before you."
          },
          pathA: {
            header: "Path A: Trust the Published Paper",
            action: "आप सहकर्मी-समीक्षित साक्ष्य के आधार पर पैरॉक्सिटाइन लिखते हैं",
            steps: [
              "The published paper shows efficacy on some measures",
              "Safety section mentions some events but appears reassuring",
              "आप विश्वास के साथ नुस्खा लिखें",
              "Three weeks later, the patient attempts suicide"
            ],
            consequence: "आपने सबूतों का पालन किया. लेकिन सबूत अधूरे थे. जिस पेपर पर आपने भरोसा किया वह भूतलिखा था। मुख्य 'लेखक' ने कच्चा डेटा नहीं देखा था। आत्महत्या का संकेत - पैरॉक्सिटिन पर 5.5 गुना अधिक - बढ़िया प्रिंट और आंकड़ों में छिपा हुआ था।"
          },
          pathB: {
            header: "पथ बी: गुम डेटा पर सवाल उठाएं",
            action: "आप विसंगतियों को नोटिस करते हैं और गहराई से खोज करते हैं",
            steps: [
              "आप परीक्षण रजिस्ट्री की जाँच करें - प्राथमिक परिणाम बदल गए",
              "आपने देखा कि लेखक निर्माता के सलाहकार हैं",
              "आप एफडीए से नैदानिक ​​अध्ययन रिपोर्ट का अनुरोध करते हैं",
              "You discover 11 suicide-related events vs. 2 on placebo"
            ],
            consequence: "आपने सावधानी चुनी. आपने एक विकल्प निर्धारित किया. वर्षों बाद, जब सच्चाई सामने आई, तो आपको समझ आया कि आपके संदेह ने क्यों लोगों की जान बचाई। लेकिन 2002 में, इस रास्ते पर असाधारण सतर्कता की आवश्यकता थी - सिस्टम को छिपाने के लिए डिज़ाइन किया गया था।"
          },
          revelation: {
            header: "The Revelation",
            text: "It took 14 years for the full data to emerge. The paper was ghostwritten by a medical communications company. The named 'author' — a prominent academic — had not analyzed the data. The study actually showed paroxetine was neither safe nor effective. The restoring of Study 329 by RIAT researchers in 2015 exposed one of the greatest publication frauds in psychiatric history.",
            detail: "Source: Le Noury et al. BMJ 2015; Restoring Study 329"
          },
          refrain: "The funnel sees what words conceal."
        }
      },

      // STORY 2: THE REBOXETINE FUNNEL
      {
        type: 'story',
        content: {
          storyNumber: 2,
          title: "रिबॉक्सेटिन फ़नल",
          caseId: "NICE Submission / Eyding 2010",
          opening: "What appears when you plot effect against precision?",
          stats: {
            header: "दमन का परिमाण",
            items: [
              { value: "0.56", label: "Published effect size (SMD)" },
              { value: "0.07", label: "True effect size (with unpublished)" },
              { value: "74%", label: "मरीज़ का डेटा छिपाया गया" },
              { value: "8", label: "Trials never published" }
            ]
          },
          scenario: {
            title: "निर्णय बिंदु",
            text: "You are a health technology assessment analyst reviewing reboxetine for national reimbursement. The published meta-analysis shows a standardized mean difference of 0.56 — a moderate-to-large effect. The manufacturer wants approval. Millions in revenue depend on your recommendation. But something bothers you about the funnel plot."
          },
          pathA: {
            header: "Path A: Accept the Published Literature",
            action: "आप उपलब्ध साक्ष्यों के आधार पर अनुमोदन की अनुशंसा करते हैं",
            steps: [
              "Published trials consistently show benefit",
              "The effect size appears clinically meaningful",
              "आप सकारात्मक मूल्यांकन लिखें",
              "Reboxetine is approved and widely prescribed"
            ],
            consequence: "मरीजों को ऐसी दवा मिलती है जिसका समर्थन प्रकाशित साक्ष्यों से होता है। लेकिन उन रोगियों को कोई वास्तविक लाभ नहीं हुआ - क्योंकि प्रकाशित साक्ष्य कुल का केवल 26% था। जिन 74% पर कोई प्रभाव नहीं दिखा वह कंपनी की फाइलों में छिपा हुआ था।"
          },
          pathB: {
            header: "पथ बी: अप्रकाशित डेटा की मांग करें",
            action: "आप सभी परीक्षण डेटा की आवश्यकता के लिए अपने अधिकार का आह्वान करते हैं",
            steps: [
              "आपने देखा कि सभी प्रकाशित परीक्षण उद्योग-प्रायोजित हैं",
              "आप औपचारिक रूप से फाइजर से अप्रकाशित परीक्षण डेटा का अनुरोध करते हैं",
              "आप फ़नल पर सभी डेटा प्लॉट करते हैं - विषमता प्रकट होती है",
              "The true effect is 0.07: clinically meaningless"
            ],
            consequence: "पारदर्शिता की आपकी मांग धोखे को उजागर करती है। दवा का लाभ सिद्ध नहीं है. आपकी अनुशंसा रोगियों को अप्रभावी उपचार से बचाती है। IQWiG ने ठीक यही किया - और बाद में कई देशों में रीबॉक्सेटीन को वापस ले लिया गया या प्रतिबंधित कर दिया गया।"
          },
          revelation: {
            header: "The Revelation",
            text: "When Eyding and colleagues obtained all trial data, the truth was stark: 2,256 patients in 8 trials had been hidden. The published literature — the 'evidence' — was a curated selection designed to show what did not exist. The funnel plot of all data showed what the published plot concealed: a symmetric distribution around zero.",
            detail: "Source: Eyding et al. BMJ 2010"
          },
          refrain: "The funnel sees what words conceal."
        }
      },

      // STORY 3: THE GABAPENTIN GHOST
      {
        type: 'story',
        content: {
          storyNumber: 3,
          title: "गैबापेंटिन भूत",
          caseId: "Pfizer's Hidden Trials",
          opening: "How many trials can hide in plain sight?",
          stats: {
            header: "रजिस्ट्री गैप",
            items: [
              { value: "12", label: "Trials registered" },
              { value: "8", label: "Trials published" },
              { value: "4", label: "बिना किसी लाभ वाले परीक्षण - छुपे हुए" },
              { value: "$430M", label: "धोखाधड़ी के लिए समझौता" }
            ]
          },
          scenario: {
            title: "निर्णय बिंदु",
            text: "You are writing a systematic review on gabapentin for neuropathic pain. Your literature search returns 8 published trials, all showing benefit. The Cochrane methodology is clear: you must also search trial registries. When you do, you find 12 trials were registered. Four trials have vanished."
          },
          pathA: {
            header: "Path A: Review Only Published Literature",
            action: "आप 8 उपलब्ध परीक्षणों के साथ अपनी समीक्षा पूरी करें",
            steps: [
              "Your meta-analysis shows gabapentin is effective",
              "The forest plot shows consistent benefit across trials",
              "आप यह निष्कर्ष निकालते हैं कि गैबापेंटिन न्यूरोपैथिक दर्द के लिए काम करता है",
              "Guidelines cite your review; prescriptions increase"
            ],
            consequence: "आपकी समीक्षा साक्ष्य आधार का हिस्सा बन जाती है। लेकिन इसे रेत पर बनाया गया है - 33% परीक्षण गायब थे। 4 अप्रकाशित परीक्षणों से कोई लाभ नहीं हुआ। आपका ईमानदार कार्य एक विकृत सत्य को कायम रखता है क्योंकि आपने प्रकाशित रिकॉर्ड को पूर्ण मान लिया है।"
          },
          pathB: {
            header: "Path B: Hunt the Missing Trials",
            action: "आप प्रत्येक चैनल के माध्यम से 4 लापता परीक्षणों का अनुसरण करते हैं",
            steps: [
              "आप परीक्षण डेटा का अनुरोध करने के लिए फाइजर से संपर्क करते हैं - इनकार कर दिया",
              "You file a Freedom of Information request to FDA",
              "आपको मुकदमेबाजी खोज से आंतरिक दस्तावेज़ मिलते हैं",
              "4 लापता परीक्षणों से कोई लाभ नहीं दिखता: प्रभाव गायब हो जाता है"
            ],
            consequence: "Your persistence reveals the publication bias. Your review includes a prominent warning about missing data. Your conclusions are appropriately uncertain. When the Pfizer settlement documents later emerge, your caution is vindicated. The 4 trials showed exactly what you suspected: nothing."
          },
          revelation: {
            header: "The Revelation",
            text: "Internal Pfizer documents revealed explicit suppression strategy. One email stated: 'We have to be careful about what we publish.' Draft manuscripts were prepared only for trials where data 'should be positive.' The company paid $430 million in settlements — but had already earned $2.7 billion from off-label promotion. The penalty was the cost of doing business.",
            detail: "Source: Steinman et al. JAMA 2006; DOJ Settlement 2004"
          },
          refrain: "The funnel sees what words conceal."
        }
      },

      // STORY 4: THE TAMIFLU BILLIONS
      {
        type: 'story',
        content: {
          storyNumber: 4,
          title: "टैमीफ्लू बिलियन्स",
          caseId: "कोक्रेन ओसेल्टामिविर समीक्षा",
          opening: "छिपे हुए डेटा की लागत क्या है?",
          stats: {
            header: "का पैमाना निवेश",
            items: [
              { value: "$9B", label: "Global stockpile spending" },
              { value: "61%", label: "Published reduction in complications" },
              { value: "22,000", label: "Pages of hidden CSRs" },
              { value: "5", label: "डेटा प्राप्त करने के लिए वर्ष" }
            ]
          },
          scenario: {
            title: "निर्णय बिंदु",
            text: "आप महामारी संबंधी तैयारियों पर स्वास्थ्य मंत्रालय को सलाह देते हैं। बात 2009 की है। स्वाइन फ्लू फैल रहा है। प्रकाशित मेटा-विश्लेषण से पता चलता है कि टैमीफ्लू इन्फ्लूएंजा जटिलताओं को 61% तक कम कर देता है। दुनिया भर में सरकारें भंडारण कर रही हैं। आपके मंत्री पूछते हैं: क्या हमें टैमीफ्लू पर अरबों खर्च करने चाहिए? साक्ष्य स्पष्ट प्रतीत होते हैं।"
          },
          pathA: {
            header: "Path A: Trust the Published Meta-Analyses",
            action: "आप प्रकाशित साक्ष्य के आधार पर भंडारण की अनुशंसा करते हैं",
            steps: [
              "मेटा-विश्लेषण सम्मानित पत्रिकाओं में प्रकाशित होते हैं",
              "61% की कमी पर्याप्त लगती है",
              "You recommend $500 million in stockpile purchases",
              "The drugs sit in warehouses; the pandemic wanes"
            ],
            consequence: "Your recommendation followed the evidence that was available. But that evidence was based on published trials — and 60% of patient data came from unpublished manufacturer trials. The real effect on hospitalizations? Not significant. Your country spent hundreds of millions on drugs of uncertain benefit while other health needs went unfunded."
          },
          pathB: {
            header: "Path B: Demand Clinical Study Reports",
            action: "आप निर्णय में तब तक देरी करते हैं जब तक आप सब कुछ नहीं देख लेते डेटा",
            steps: [
              "आपने देखा कि प्रकाशित परीक्षण अप्रकाशित निर्माता डेटा का हवाला देते हैं",
              "आप पूर्ण डेटा जारी करने के लिए BMJ के अभियान का समर्थन करते हैं",
              "You wait as Cochrane spends 5 years pursuing Roche",
              "Finally: 77 clinical study reports, 22,000 pages"
            ],
            consequence: "Your patience is rewarded with truth. Tamiflu reduces symptom duration by 17 hours — not 'days' as marketed. No evidence it prevents pneumonia or hospitalization. It causes nausea and vomiting. Your recommendation: do not stockpile at pandemic scale. WHO downgrades it from 'essential' to 'complementary' medicine."
          },
          revelation: {
            header: "The Revelation",
            text: "The Cochrane review took 5 years because Roche refused to release Clinical Study Reports. When finally obtained through regulatory channels, 22,000 pages revealed what 10 years of published papers concealed: the benefit was marginal, the harms understated, the hospitalization claim unfounded. Billions in public money had been allocated based on incomplete evidence.",
            detail: "Source: Jefferson et al. Cochrane 2014; BMJ Open Data Campaign"
          },
          refrain: "The funnel sees what words conceal."
        }
      },

      // STORY 5: THE ANTIDEPRESSANT LANDSCAPE
      {
        type: 'story',
        content: {
          storyNumber: 5,
          title: "एंटीडिप्रेसेंट लैंडस्केप",
          caseId: "Turner et al. NEJM 2008",
          opening: "क्या होगा यदि आप देख सकें कि FDA क्या है देखा?",
          stats: {
            header: "प्रकाशित बनाम वास्तविक रिकॉर्ड",
            items: [
              { value: "74", label: "Trials in FDA database" },
              { value: "94%", label: "Published as positive" },
              { value: "51%", label: "Actually positive per FDA" },
              { value: "0.15", label: "True effect size (vs. 0.37 published)" }
            ]
          },
          scenario: {
            title: "निर्णय बिंदु",
            text: "You are updating national depression treatment guidelines. The published literature overwhelmingly supports antidepressant efficacy — 94% of published trials are positive. Effect sizes appear substantial. But you have access to something rare: the FDA's internal review documents. You can see what the journals did not print."
          },
          pathA: {
            header: "Path A: Follow the Published Literature",
            action: "You write guidelines based on journal publications",
            steps: [
              "आपकी साहित्य समीक्षा में पुख्ता सबूत मिलते हैं",
              "Effect size meta-analysis shows d = 0.37",
              "You recommend antidepressants as first-line treatment",
              "Patients and clinicians expect substantial benefit"
            ],
            consequence: "Your guidelines set expectations that often are not met. Patients try antidepressants expecting the large effects the literature suggests. When improvement is modest, they feel like failures. Clinicians question their skills. The mismatch between published promise and lived reality creates confusion, non-adherence, and therapeutic nihilism."
          },
          pathB: {
            header: "पथ बी: एफडीए समीक्षा डेटा शामिल करें",
            action: "आप सभी परीक्षणों का विश्लेषण करते हैं - प्रकाशित और अप्रकाशित",
            steps: [
              "आप 12 एंटीडिपेंटेंट्स के लिए FDA समीक्षा दस्तावेज़ प्राप्त करते हैं",
              "आपको पता चलता है कि 36 परीक्षण नकारात्मक या संदिग्ध थे",
              "उन 36 में से केवल 14 प्रकाशित हुए थे - और 11 सकारात्मक निकले थे",
              "True effect size: 0.15 (small, not 0.37)"
            ],
            consequence: "Your guidelines are honest about modest efficacy. They recommend antidepressants while acknowledging that benefits are real but smaller than published literature suggests. Patients have accurate expectations. Shared decision-making is possible because the truth is known. When improvement occurs, it is recognized; when it doesn't, alternatives are discussed without shame."
          },
          revelation: {
            header: "The Revelation",
            text: "Erick Turner's landmark study did what no one before had done: compare the FDA's complete record to the published literature. The result was devastating: selective publication inflated apparent efficacy by 32%. The published literature was not the evidence — it was a filtered, biased selection of the evidence. Turner's paper changed how we understand psychiatric drug trials forever.",
            detail: "Source: Turner et al. NEJM 2008"
          },
          refrain: "The funnel sees what words conceal."
        }
      },

      // SYNTHESIS SLIDE
      {
        type: 'content',
        content: {
          title: "The Pattern Across All Five Stories",
          sections: [
            {
              heading: "क्या था छुपे हुए",
              items: [
                "किशोरों में आत्महत्या की घटनाएं (अध्ययन 329)",
                "74% of patient data showing no benefit (Reboxetine)",
                "4 negative trials out of 12 registered (Gabapentin)",
                "22,000 pages of clinical study reports (Tamiflu)",
                "36 negative or questionable trials out of 74 (Antidepressants)"
              ]
            },
            {
              heading: "Who Hid It",
              items: [
                "Pharmaceutical companies with financial interests",
                "Medical communication firms ghostwriting papers",
                "Academic 'authors' who lent their names without seeing data",
                "जर्नल जो अधिमान्य रूप से सकारात्मक परिणाम प्रकाशित करते हैं",
                "नियामक जिनके पास डेटा था लेकिन उन्हें सार्वजनिक रिलीज की आवश्यकता नहीं थी"
              ]
            },
            {
              heading: "What Would Have Revealed It",
              items: [
                "Trial registry searches comparing registered to published",
                "Funnel plots showing asymmetric distributions",
                "Freedom of Information requests to regulatory agencies",
                "Comparison of published outcomes to pre-registered outcomes",
                "नैदानिक ​​अध्ययन के लिए लगातार मांग रिपोर्ट"
              ]
            }
          ]
        }
      },

      // DECISION TREE SYNTHESIS
      {
        type: 'decision-tree',
        content: {
          title: "The Two Paths: A Universal Pattern",
          situation: "In each story, someone faced a choice. The evidence before them seemed clear. The published record pointed one way. But the complete truth pointed another. The detective asks: What would I have done?",
          nodes: [
            {
              id: 'start',
              question: "आपको उपचार का समर्थन करने वाले प्रकाशित साक्ष्य मिलते हैं। सभी दृश्यमान परीक्षण सकारात्मक हैं। प्रभाव का आकार प्रभावशाली है. आपकी पहली प्रतिक्रिया क्या है?",
              branches: [
                { id: 'a', text: "Accept the evidence and act on it — published = peer-reviewed = reliable", nextNode: 'naive' },
                { id: 'b', text: "Ask: What might be missing? Check registries, request unpublished data", nextNode: 'vigilant' }
              ]
            },
            {
              id: 'naive',
              type: 'outcome',
              consequence: 'bad',
              title: "विश्वास का मार्ग",
              text: "You acted on what was visible. In the five cases you studied: you would have prescribed paroxetine to suicidal adolescents; recommended reboxetine that doesn't work; endorsed gabapentin for conditions it doesn't help; stockpiled billions in marginally effective Tamiflu; and set unrealistic expectations for antidepressants. Every published record seemed solid. Every one was incomplete.",
              realCase: "यह दशकों से चिकित्सा के लिए डिफ़ॉल्ट मार्ग था। अधिकांश दिशानिर्देश, अधिकांश निर्धारित निर्णय, अधिकांश रोगी अपेक्षाएं प्रकाशित साहित्य पर बनाई गई थीं जो व्यवस्थित रूप से लाभ को बढ़ा-चढ़ाकर पेश करती थीं।"
            },
            {
              id: 'vigilant',
              type: 'outcome',
              consequence: 'good',
              title: "जासूस का मार्ग",
              text: "You questioned what was missing. In each case, the answer was the same: hidden data that reversed or substantially weakened the conclusion. Your skepticism was not cynicism — it was protection. The patients whose lives depended on your decisions were served by your vigilance. The funnel plot, the registry search, the FOIA request — these are not academic exercises. They are shields.",
              realCase: "प्रकाशन पूर्वाग्रह का हर बड़ा मामला अंततः उन व्यक्तियों द्वारा उजागर किया गया था जिन्होंने प्रकाशित रिकॉर्ड को पूर्ण मानने से इनकार कर दिया था। उन्होंने पूछा: बाकी डेटा कहां है?"
            }
          ]
        }
      },

      // THE REFRAIN
      {
        type: 'oath',
        content: {
          header: "प्रकाशन पूर्वाग्रह जासूस से बचना",
          text: "In Paroxetine, the paper said 'safe' — <strong>the funnel sees what words conceal.</strong><br><br>In Reboxetine, the published effect was 0.56 — <strong>the funnel sees what words conceal.</strong><br><br>In Gabapentin, four trials vanished — <strong>the funnel sees what words conceal.</strong><br><br>In Tamiflu, billions were spent on hidden data — <strong>the funnel sees what words conceal.</strong><br><br>In antidepressants, 94% positive became 51% — <strong>the funnel sees what words conceal.</strong><br><br>What words conceal, the detective reveals."
        }
      },

      // KEY TAKEAWAYS
      {
        type: 'key-takeaways',
        content: {
          takeaways: [
            "Publication bias is not an abstract statistical concept — it has body counts",
            "Every case followed the same pattern: financial incentive → selective publication → patient harm",
            "पता लगाने के उपकरण (रजिस्ट्री खोज, फ़नल प्लॉट, FOIA) ने हर मामले में सच्चाई का खुलासा किया होगा",
            "प्रत्येक निर्णय बिंदु पर विकल्प था: विश्वास बनाम। सत्यापित करें",
            "फ़नल देखता है कि शब्द क्या छिपाते हैं - लेकिन केवल तभी जब आप देखना चुनते हैं"
          ],
          actionItem: "The next time you read a meta-analysis showing impressive effects, ask yourself: Which of the five stories does this most resemble? Then check the registry. Then look at the funnel. Then decide."
        }
      },

      // FINAL PRINCIPLE
      {
        type: 'cycle-return',
        content: {
          principle: "You have now walked through five chronicles of hidden evidence. In each, the published record lied — not through fabrication, but through omission. In each, patients were harmed by treatments that appeared effective but were not. In each, the funnel plot — that simple scatter of effect against precision — would have shown the asymmetry, the gap, the missing mass of hidden truth. Remember: The funnel sees what words conceal. See what it shows you."
        }
      }
    ]
  }
];

// ============================================================
// INTERACTIVE TOOLS
// ============================================================

// Basic Funnel Plot Tool
function renderFunnelTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-controls">
      <div class="tool-control">
        <label>True Effect Size</label>
        <input type="range" id="trueEffect" min="-1" max="1" step="0.1" value="0.3" oninput="updateFunnelPlot()">
        <span id="trueEffectVal">0.3</span>
      </div>
      <div class="tool-control">
        <label>Publication Bias</label>
        <select id="biasLevel" onchange="updateFunnelPlot()">
          <option value="none">None</option>
          <option value="mild">Mild</option>
          <option value="moderate" selected>Moderate</option>
          <option value="severe">Severe</option>
        </select>
      </div>
      <div class="tool-control">
        <label>Number of Studies</label>
        <input type="range" id="numStudies" min="10" max="50" step="5" value="25" oninput="updateFunnelPlot()">
        <span id="numStudiesVal">25</span>
      </div>
    </div>
    <div id="funnelPlotArea" class="plot-area"></div>
    <div id="funnelStats" style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;"></div>
  `;

  updateFunnelPlot();
}

function updateFunnelPlot() {
  const trueEffect = parseFloat(document.getElementById('trueEffect').value);
  const biasLevel = document.getElementById('biasLevel').value;
  const numStudies = parseInt(document.getElementById('numStudies').value);

  document.getElementById('trueEffectVal').textContent = trueEffect.toFixed(1);
  document.getElementById('numStudiesVal').textContent = numStudies;

  // Generate studies
  const studies = [];
  const biasProb = { none: 0, mild: 0.3, moderate: 0.5, severe: 0.7 };
  const suppressProb = biasProb[biasLevel];

  for (let i = 0; i < numStudies * 2; i++) {
    const se = 0.1 + Math.random() * 0.4; // SE between 0.1 and 0.5
    const effect = trueEffect + (Math.random() - 0.5) * se * 4; // scatter around true effect
    const z = effect / se;
    const pval = 2 * (1 - normalCDF(Math.abs(z)));

    // Publication bias: suppress non-significant negative small studies
    const isNegative = effect < trueEffect * 0.5;
    const isSmall = se > 0.25;
    const isNonSig = pval > 0.05;

    const suppress = isNegative && isSmall && isNonSig && Math.random() < suppressProb;

    if (!suppress && studies.length < numStudies) {
      studies.push({ effect, se, pval, suppressed: false });
    }
  }

  // Calculate pooled effect
  const weights = studies.map(s => 1 / (s.se * s.se));
  const sumW = weights.reduce((a, b) => a + b, 0);
  const pooledEffect = studies.reduce((sum, s, i) => sum + weights[i] * s.effect, 0) / sumW;

  // Max SE for contours
  const maxSE = Math.max(...studies.map(s => s.se)) * 1.1;
  const z_05 = 1.96;

  // Create traces
  const studyTrace = {
    x: studies.map(s => s.effect),
    y: studies.map(s => s.se),
    mode: 'markers',
    type: 'scatter',
    marker: {
      size: 10,
      color: studies.map(s => s.pval < 0.05 ? '#3b82f6' : '#94a3b8'),
      line: { color: '#ffffff', width: 1 }
    },
    text: studies.map((s, i) => `Study ${i+1}<br>Effect: ${s.effect.toFixed(2)}<br>SE: ${s.se.toFixed(2)}<br>p: ${s.pval.toFixed(3)}`),
    hoverinfo: 'text',
    name: 'Studies'
  };

  const pooledLine = {
    x: [pooledEffect, pooledEffect],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: '#d4af37', width: 2, dash: 'dash' },
    name: 'Pooled Effect'
  };

  const trueLine = {
    x: [trueEffect, trueEffect],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: '#22c55e', width: 2, dash: 'dot' },
    name: 'True Effect'
  };

  // Contour lines
  const leftContour = {
    x: [pooledEffect, pooledEffect - z_05 * maxSE],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: 'rgba(124,58,237,0.5)', width: 1, dash: 'dot' },
    showlegend: false
  };

  const rightContour = {
    x: [pooledEffect, pooledEffect + z_05 * maxSE],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: 'rgba(124,58,237,0.5)', width: 1, dash: 'dot' },
    showlegend: false
  };

  Plotly.newPlot('funnelPlotArea', [studyTrace, pooledLine, trueLine, leftContour, rightContour], {
    title: 'Funnel Plot',
    xaxis: { title: 'Effect Size', zeroline: true },
    yaxis: { title: 'Standard Error', autorange: 'reversed' },
    showlegend: true,
    legend: { x: 1.02, y: 1 },
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0.2)',
    font: { color: '#f5f5f0' }
  }, { responsive: true });

  // Stats
  const inflation = trueEffect !== 0 ? ((pooledEffect - trueEffect) / trueEffect * 100).toFixed(1) : 'N/A';
  const biasDesc = biasLevel === 'none' ? 'no' : biasLevel;
  const asymmetryDesc = biasLevel === 'none' ? 'symmetric (no gaps)' :
    biasLevel === 'mild' ? 'slightly asymmetric with minor gap in lower-left' :
    biasLevel === 'moderate' ? 'moderately asymmetric with visible gap in lower-left' :
    'निचले-बाएँ में बड़े अंतर के साथ गंभीर रूप से असममित (छोटे नकारात्मक अध्ययन गायब)';

  document.getElementById('funnelStats').innerHTML = `
    <div class="chart-description" aria-live="polite">
      Funnel plot showing ${numStudies} studies. True effect: ${trueEffect.toFixed(2)}.
      Observed pooled effect: ${pooledEffect.toFixed(2)} (${inflation === 'N/A' ? 'true effect is zero' : inflation > 0 ? inflation + '% inflation' : 'no inflation'}).
      Publication bias level: ${biasDesc}. Plot appears ${asymmetryDesc}.
    </div>
    <button onclick="this.previousElementSibling.classList.toggle('chart-description-visible')"
            style="font-size:0.75rem;padding:0.25rem 0.5rem;margin-bottom:0.75rem;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:4px;color:var(--cream);cursor:pointer;">
      Toggle Chart Description (Screen Reader)
    </button>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;text-align:center;">
      <div>
        <div style="color:#22c55e;font-size:1.5rem;font-weight:bold;">${trueEffect.toFixed(2)}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">True Effect</div>
      </div>
      <div>
        <div style="color:#d4af37;font-size:1.5rem;font-weight:bold;">${pooledEffect.toFixed(2)}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Observed (Pooled)</div>
      </div>
      <div>
        <div style="color:${inflation === 'N/A' ? '#888' : inflation > 10 ? '#dc2626' : '#16a34a'};font-size:1.5rem;font-weight:bold;">${inflation === 'N/A' ? 'N/A' : (inflation > 0 ? '+' : '') + inflation + '%'}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Inflation</div>
      </div>
    </div>
  `;
}

// Contour-Enhanced Funnel Plot
function renderContourTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-controls">
      <div class="tool-control">
        <label>Show Contours</label>
        <select id="showContours" onchange="updateContourPlot()">
          <option value="yes" selected>Yes</option>
          <option value="no">No</option>
        </select>
      </div>
      <div class="tool-control">
        <label>Bias Pattern</label>
        <select id="biasPattern" onchange="updateContourPlot()">
          <option value="none">No Bias (Symmetric)</option>
          <option value="pubBias" selected>Publication Bias</option>
          <option value="heterogeneity">Heterogeneity</option>
        </select>
      </div>
    </div>
    <div id="contourPlotArea" class="plot-area"></div>
    <div id="contourInterpret" style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;"></div>
  `;

  updateContourPlot();
}

function updateContourPlot() {
  const showContours = document.getElementById('showContours').value === 'yes';
  const biasPattern = document.getElementById('biasPattern').value;

  // Generate data based on pattern
  const studies = [];
  const trueEffect = 0.3;

  for (let i = 0; i < 30; i++) {
    let se, effect;

    if (biasPattern === 'none') {
      se = 0.1 + Math.random() * 0.35;
      effect = trueEffect + (Math.random() - 0.5) * se * 3;
    } else if (biasPattern === 'pubBias') {
      se = 0.1 + Math.random() * 0.35;
      effect = trueEffect + (Math.random() - 0.5) * se * 3;
      const z = effect / se;
      const pval = 2 * (1 - normalCDF(Math.abs(z)));
      if (effect < 0 && se > 0.2 && pval > 0.05 && Math.random() < 0.7) continue;
    } else { // heterogeneity
      se = 0.1 + Math.random() * 0.35;
      // Small studies have larger effects
      effect = trueEffect + (se > 0.25 ? 0.2 : 0) + (Math.random() - 0.5) * se * 2;
    }

    studies.push({ effect, se });
  }

  const maxSE = Math.max(...studies.map(s => s.se)) * 1.1;
  const pooledEffect = studies.reduce((s, st) => s + st.effect, 0) / studies.length;

  const traces = [];

  // Contour shading
  if (showContours) {
    // p > 0.05 region (non-significant)
    traces.push({
      x: [pooledEffect - 1.96 * maxSE, pooledEffect, pooledEffect + 1.96 * maxSE, pooledEffect - 1.96 * maxSE],
      y: [maxSE, 0, maxSE, maxSE],
      fill: 'toself',
      fillcolor: 'rgba(124,58,237,0.1)',
      line: { color: 'rgba(124,58,237,0.3)' },
      name: 'p < 0.05',
      showlegend: true
    });
  }

  // Studies
  traces.push({
    x: studies.map(s => s.effect),
    y: studies.map(s => s.se),
    mode: 'markers',
    type: 'scatter',
    marker: { size: 10, color: '#3b82f6', line: { color: '#fff', width: 1 } },
    name: 'Studies'
  });

  // Pooled line
  traces.push({
    x: [pooledEffect, pooledEffect],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: '#d4af37', width: 2, dash: 'dash' },
    name: 'Pooled'
  });

  Plotly.newPlot('contourPlotArea', traces, {
    title: 'Contour-Enhanced Funnel Plot',
    xaxis: { title: 'Effect Size' },
    yaxis: { title: 'Standard Error', autorange: 'reversed' },
    showlegend: true,
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0.2)',
    font: { color: '#f5f5f0' }
  }, { responsive: true });

  const interpretations = {
    none: "Symmetric funnel. No evidence of publication bias or small-study effects.",
    pubBias: "नीचे-बाएँ (गैर-महत्वपूर्ण क्षेत्र) में अंतर के साथ असममित फ़नल। यह पैटर्न प्रकाशन पूर्वाग्रह का सुझाव देता है - छोटे नकारात्मक अध्ययन प्रकाशित नहीं किए गए।",
    heterogeneity: "बड़े प्रभाव दिखाने वाले छोटे अध्ययनों के साथ असममित फ़नल। प्रकाशन पूर्वाग्रह या वास्तविक मतभेद (छोटे अध्ययनों में बीमार मरीज़) हो सकते हैं। नैदानिक ​​जांच की आवश्यकता है।"
  };

  document.getElementById('contourInterpret').innerHTML = `<strong>Interpretation:</strong> ${interpretations[biasPattern]}`;
}

// Egger's Test Tool
function renderEggerTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-description">Enter effect sizes and standard errors to calculate Egger's regression test.</div>
    <div class="tool-controls" style="flex-direction:column;">
      <textarea id="eggerData" rows="8" style="width:100%;background:rgba(0,0,0,0.3);color:#f5f5f0;border:1px solid rgba(255,255,255,0.2);border-radius:8px;padding:1rem;font-family:monospace;"># Effect, SE (one per line)
0.45, 0.12
0.32, 0.15
0.28, 0.18
0.51, 0.14
0.15, 0.22
0.38, 0.16
0.42, 0.13
0.55, 0.11
0.25, 0.19
0.33, 0.17</textarea>
      <button onclick="runEggerTest()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:var(--teal);border:none;border-radius:8px;color:white;cursor:pointer;font-weight:600;">Run Egger's Test</button>
    </div>
    <div id="eggerResults" style="margin-top:1.5rem;"></div>
  `;
}

function runEggerTest() {
  const dataText = document.getElementById('eggerData').value;
  const lines = dataText.split('\n').filter(l => l.trim() && !l.startsWith('#'));

  const yi = [], sei = [];
  lines.forEach(line => {
    const parts = line.split(',').map(p => parseFloat(p.trim()));
    if (parts.length >= 2 && !isNaN(parts[0]) && !isNaN(parts[1])) {
      yi.push(parts[0]);
      sei.push(parts[1]);
    }
  });

  if (yi.length < 3) {
    document.getElementById('eggerResults').innerHTML = '<p style="color:#dc2626;">Need at least 3 studies for Egger\'s test.</p>';
    return;
  }

  // Weighted least squares regression
  const vi = sei.map(s => s * s);
  const wi = vi.map(v => 1 / v);
  const precision = sei.map(s => 1 / s);
  const zi = yi.map((y, i) => y / sei[i]);

  const k = yi.length;
  const sumW = wi.reduce((a, b) => a + b, 0);
  const sumWx = precision.reduce((sum, x, i) => sum + wi[i] * x, 0);
  const sumWy = zi.reduce((sum, y, i) => sum + wi[i] * y, 0);
  const sumWxy = precision.reduce((sum, x, i) => sum + wi[i] * x * zi[i], 0);
  const sumWx2 = precision.reduce((sum, x, i) => sum + wi[i] * x * x, 0);

  const det = sumW * sumWx2 - sumWx * sumWx;
  const b0 = (sumWx2 * sumWy - sumWx * sumWxy) / det; // intercept
  const b1 = (sumW * sumWxy - sumWx * sumWy) / det;   // slope

  const residuals = zi.map((z, i) => z - (b0 + b1 * precision[i]));
  const sse = residuals.reduce((sum, r, i) => sum + wi[i] * r * r, 0);
  const mse = sse / (k - 2);

  const var_b0 = mse * sumWx2 / det;
  const se_b0 = Math.sqrt(var_b0);
  const t_val = b0 / se_b0;
  const p_val = 2 * (1 - tCDF(Math.abs(t_val), k - 2));

  const significant = p_val < 0.1;

  document.getElementById('eggerResults').innerHTML = `
    <div class="statistic-card" style="background:${significant ? 'rgba(220,38,38,0.2)' : 'rgba(22,163,74,0.2)'};border-color:${significant ? 'rgba(220,38,38,0.4)' : 'rgba(22,163,74,0.4)'};">
      <div style="font-size:1.5rem;font-weight:bold;color:${significant ? '#dc2626' : '#22c55e'};">
        ${significant ? 'Significant Asymmetry Detected' : 'No Significant Asymmetry'}
      </div>
      <div style="margin-top:1rem;display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;">
        <div>
          <div style="font-size:1.2rem;font-weight:bold;">${b0.toFixed(3)}</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Intercept (b0)</div>
        </div>
        <div>
          <div style="font-size:1.2rem;font-weight:bold;">${t_val.toFixed(2)}</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">t-statistic</div>
        </div>
        <div>
          <div style="font-size:1.2rem;font-weight:bold;">${p_val.toFixed(4)}</div>
          <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">p-value</div>
        </div>
      </div>
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;">
      <strong>Interpretation:</strong> ${significant
        ? 'p < 0.10 suggests funnel plot asymmetry. This MAY indicate publication bias, but could also reflect heterogeneity or other small-study effects. Investigate further.'
        : 'p >= 0.10 does not suggest asymmetry. However, with ' + k + 'अध्ययन, परीक्षण में सीमित शक्ति है। साक्ष्य का अभाव अनुपस्थिति का साक्ष्य नहीं है।'}
    </div>
  `;
}

// Trim and Fill Tool
function renderTrimFillTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-controls">
      <div class="tool-control">
        <label>Show Original Only</label>
        <input type="checkbox" id="originalOnly" onchange="updateTrimFill()">
      </div>
      <div class="tool-control">
        <label>Asymmetry Level</label>
        <select id="asymLevel" onchange="updateTrimFill()">
          <option value="low">Low</option>
          <option value="moderate" selected>Moderate</option>
          <option value="high">High</option>
        </select>
      </div>
    </div>
    <div id="trimFillPlotArea" class="plot-area"></div>
    <div id="trimFillResults" style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;"></div>
  `;

  updateTrimFill();
}

function updateTrimFill() {
  const originalOnly = document.getElementById('originalOnly').checked;
  const asymLevel = document.getElementById('asymLevel').value;

  const trueEffect = 0.25;
  const suppressProb = { low: 0.2, moderate: 0.5, high: 0.8 }[asymLevel];

  const observed = [];
  for (let i = 0; i < 40; i++) {
    const se = 0.08 + Math.random() * 0.35;
    const effect = trueEffect + (Math.random() - 0.5) * se * 3.5;
    const z = effect / se;
    const pval = 2 * (1 - normalCDF(Math.abs(z)));

    if (effect < 0.1 && se > 0.2 && pval > 0.05 && Math.random() < suppressProb) continue;
    observed.push({ effect, se });
  }

  // Simple trim-and-fill simulation
  const weights = observed.map(s => 1 / (s.se * s.se));
  const sumW = weights.reduce((a, b) => a + b, 0);
  const pooledObs = observed.reduce((sum, s, i) => sum + weights[i] * s.effect, 0) / sumW;

  // Find asymmetric studies and create mirror images
  const imputed = [];
  if (!originalOnly) {
    observed.forEach(s => {
      if (s.effect < pooledObs - 0.1 && s.se > 0.2) return; // keep these
      if (s.effect > pooledObs + 0.15 && s.se > 0.2) {
        // Impute mirror image
        const mirrorEffect = 2 * pooledObs - s.effect;
        imputed.push({ effect: mirrorEffect, se: s.se });
      }
    });
  }

  const allStudies = [...observed, ...imputed];
  const allWeights = allStudies.map(s => 1 / (s.se * s.se));
  const sumAllW = allWeights.reduce((a, b) => a + b, 0);
  const pooledAdj = allStudies.reduce((sum, s, i) => sum + allWeights[i] * s.effect, 0) / sumAllW;

  const maxSE = Math.max(...allStudies.map(s => s.se)) * 1.1;

  const traces = [
    {
      x: observed.map(s => s.effect),
      y: observed.map(s => s.se),
      mode: 'markers',
      marker: { size: 10, color: '#3b82f6', line: { color: '#fff', width: 1 } },
      name: 'Observed'
    }
  ];

  if (!originalOnly && imputed.length > 0) {
    traces.push({
      x: imputed.map(s => s.effect),
      y: imputed.map(s => s.se),
      mode: 'markers',
      marker: { size: 10, color: 'rgba(212,175,55,0)', symbol: 'circle-open', line: { color: '#d4af37', width: 2 } },
      name: 'Imputed (Trim-Fill)'
    });
  }

  traces.push({
    x: [pooledObs, pooledObs],
    y: [0, maxSE],
    mode: 'lines',
    line: { color: '#3b82f6', width: 2, dash: 'dash' },
    name: 'Original Pooled'
  });

  if (!originalOnly) {
    traces.push({
      x: [pooledAdj, pooledAdj],
      y: [0, maxSE],
      mode: 'lines',
      line: { color: '#d4af37', width: 2 },
      name: 'Adjusted Pooled'
    });
  }

  Plotly.newPlot('trimFillPlotArea', traces, {
    title: 'ट्रिम और भरण विश्लेषण',
    xaxis: { title: 'Effect Size' },
    yaxis: { title: 'Standard Error', autorange: 'reversed' },
    showlegend: true,
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0.2)',
    font: { color: '#f5f5f0' }
  }, { responsive: true });

  const change = ((pooledAdj - pooledObs) / pooledObs * 100).toFixed(1);
  document.getElementById('trimFillResults').innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;text-align:center;">
      <div>
        <div style="font-size:1.3rem;font-weight:bold;color:#3b82f6;">${pooledObs.toFixed(3)}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Original Effect</div>
      </div>
      <div>
        <div style="font-size:1.3rem;font-weight:bold;color:#d4af37;">${pooledAdj.toFixed(3)}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Adjusted Effect</div>
      </div>
      <div>
        <div style="font-size:1.3rem;font-weight:bold;">${imputed.length}</div>
        <div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Imputed Studies</div>
      </div>
    </div>
    <div style="margin-top:1rem;font-size:0.9rem;color:rgba(255,255,255,0.7);">
      Effect changed by ${change}% after trim-and-fill adjustment.
      <em>Note: Imputed studies are statistical estimates, not real recovered data.</em>
    </div>
  `;
}

// P-Curve Tool
function renderPCurveTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-description">Enter p-values from significant studies (p < 0.05) to analyze the p-curve.</div>
    <div class="tool-controls" style="flex-direction:column;">
      <textarea id="pcurveData" rows="6" style="width:100%;background:rgba(0,0,0,0.3);color:#f5f5f0;border:1px solid rgba(255,255,255,0.2);border-radius:8px;padding:1rem;font-family:monospace;"># Enter p-values (p < 0.05), one per line
0.001
0.012
0.003
0.045
0.028
0.015
0.008
0.041
0.022
0.009</textarea>
      <button onclick="runPCurve()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:var(--teal);border:none;border-radius:8px;color:white;cursor:pointer;font-weight:600;">Analyze P-Curve</button>
    </div>
    <div id="pcurvePlotArea" class="plot-area" style="min-height:300px;"></div>
    <div id="pcurveResults" style="margin-top:1rem;"></div>
  `;
}

function runPCurve() {
  const dataText = document.getElementById('pcurveData').value;
  const pvals = dataText.split('\n')
    .map(l => parseFloat(l.trim()))
    .filter(p => !isNaN(p) && p > 0 && p < 0.05);

  if (pvals.length < 5) {
    document.getElementById('pcurveResults').innerHTML = '<p style="color:#dc2626;">Need at least 5 significant p-values.</p>';
    return;
  }

  // Bin p-values
  const bins = [0, 0.01, 0.02, 0.03, 0.04, 0.05];
  const counts = [0, 0, 0, 0, 0];
  pvals.forEach(p => {
    for (let i = 0; i < 5; i++) {
      if (p > bins[i] && p <= bins[i + 1]) counts[i]++;
    }
  });

  // Expected under null (uniform)
  const expected = pvals.length / 5;

  const trace = {
    x: ['0-.01', '.01-.02', '.02-.03', '.03-.04', '.04-.05'],
    y: counts,
    type: 'bar',
    marker: { color: '#3b82f6' },
    name: 'Observed'
  };

  const expectedTrace = {
    x: ['0-.01', '.01-.02', '.02-.03', '.03-.04', '.04-.05'],
    y: [expected, expected, expected, expected, expected],
    type: 'scatter',
    mode: 'lines',
    line: { color: '#dc2626', dash: 'dash', width: 2 },
    name: 'Expected (Null)'
  };

  Plotly.newPlot('pcurvePlotArea', [trace, expectedTrace], {
    title: 'P-Curve Distribution',
    xaxis: { title: 'P-value Range' },
    yaxis: { title: 'Count' },
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0.2)',
    font: { color: '#f5f5f0' }
  }, { responsive: true });

  // Simple skewness assessment
  const below025 = pvals.filter(p => p < 0.025).length;
  const above025 = pvals.filter(p => p >= 0.025).length;
  const isRightSkewed = below025 > above025 * 1.5;
  const isFlat = Math.abs(below025 - above025) < pvals.length * 0.2;
  const isLeftSkewed = above025 > below025 * 1.5;

  let interpretation, color;
  if (isRightSkewed) {
    interpretation = "RIGHT-SKEWED: Many p-values well below 0.025. This suggests TRUE evidential value — a real effect exists.";
    color = '#22c55e';
  } else if (isLeftSkewed) {
    interpretation = "LEFT-SKEWED: Excess p-values near 0.05. This suggests P-HACKING or selective reporting.";
    color = '#dc2626';
  } else {
    interpretation = "FLAT: पी-मान लगभग एक समान। इससे पता चलता है कि या तो कोई सच्चा प्रभाव नहीं है या फिर गंभीर रूप से कमजोर अध्ययन।";
    color = '#f59e0b';
  }

  document.getElementById('pcurveResults').innerHTML = `
    <div class="statistic-card" style="border-color:${color}40;background:${color}20;">
      <div style="font-size:1.2rem;font-weight:bold;color:${color};">${interpretation}</div>
      <div style="margin-top:1rem;font-size:0.9rem;">
        P < 0.025: ${below025} studies (${(below025/pvals.length*100).toFixed(0)}%) |
        P >= 0.025: ${above025} studies (${(above025/pvals.length*100).toFixed(0)}%)
      </div>
    </div>
  `;
}

// Utility functions
function normalCDF(x) {
  const a1 =  0.254829592, a2 = -0.284496736, a3 = 1.421413741;
  const a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
  const sign = x < 0 ? -1 : 1;
  x = Math.abs(x) / Math.sqrt(2);
  const t = 1.0 / (1.0 + p * x);
  const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
  return 0.5 * (1.0 + sign * y);
}

// First set of tCDF/incompleteBeta/betaCF/lgamma removed (duplicate of lines below with different arg order)
// The canonical versions with correct negative-t handling are defined after the Failsafe N tool.

// Failsafe N Calculator Tool
function renderFailsafeTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-description">Calculate Rosenthal's Fail-Safe N — the number of null studies needed to make your result non-significant.</div>
    <div class="tool-controls" style="flex-direction:column;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
        <div class="tool-control">
          <label>Number of Studies (k)</label>
          <input type="number" id="failsafeK" value="15" min="2" max="200" style="width:100%;">
        </div>
        <div class="tool-control">
          <label>Mean Z-score (or enter individual z below)</label>
          <input type="number" id="failsafeMeanZ" value="2.5" step="0.1" style="width:100%;">
        </div>
      </div>
      <div class="tool-control" style="margin-top:1rem;">
        <label>OR enter individual Z-scores (comma-separated):</label>
        <input type="text" id="failsafeZscores" placeholder="2.1, 3.4, 1.8, 2.9, ..." style="width:100%;">
      </div>
      <button onclick="runFailsafeN()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:var(--teal);border:none;border-radius:8px;color:white;cursor:pointer;font-weight:600;">Calculate Fail-Safe N</button>
    </div>
    <div id="failsafeResults" style="margin-top:1.5rem;"></div>
  `;
}

function runFailsafeN() {
  let k, sumZ, meanZ;

  const zScoresInput = document.getElementById('failsafeZscores').value.trim();

  if (zScoresInput) {
    const zScores = zScoresInput.split(',').map(z => parseFloat(z.trim())).filter(z => !isNaN(z));
    k = zScores.length;
    sumZ = zScores.reduce((a, b) => a + b, 0);
    meanZ = sumZ / k;
  } else {
    k = parseInt(document.getElementById('failsafeK').value);
    meanZ = parseFloat(document.getElementById('failsafeMeanZ').value);
    sumZ = k * meanZ;
  }

  if (k < 2) {
    document.getElementById('failsafeResults').innerHTML = '<p style="color:#dc2626;">Need at least 2 studies.</p>';
    return;
  }

  // Rosenthal's Fail-Safe N formula: N = (sum(Z) / 1.645)^2 - k
  // Or equivalently: N = k * (meanZ / 1.645)^2 - k
  const criticalZ = 1.645; // one-tailed p = 0.05
  const failsafeN = Math.max(0, Math.pow(sumZ / criticalZ, 2) - k);
  const roundedN = Math.ceil(failsafeN);

  // Interpretation thresholds
  const threshold5k1 = 5 * k + 10; // Rosenthal's rule: N > 5k + 10 is robust
  const isRobust = roundedN > threshold5k1;

  const robustColor = isRobust ? '#22c55e' : '#dc2626';
  const robustText = isRobust
    ? `ROBUST: Fail-Safe N (${roundedN}) exceeds 5k + 10 (${threshold5k1}). Would need ${roundedN} null studies to nullify the effect.`
    : `FRAGILE: Fail-Safe N (${roundedN}) is less than 5k + 10 (${threshold5k1}). Result may be vulnerable to publication bias.`;

  document.getElementById('failsafeResults').innerHTML = `
    <div class="statistic-card" style="border-color:${robustColor}40;background:${robustColor}20;">
      <div style="font-size:3rem;font-weight:bold;color:${robustColor};">${roundedN}</div>
      <div style="font-size:1rem;margin-top:0.5rem;">Fail-Safe N (Rosenthal)</div>
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;">
      <strong style="color:${robustColor};">${robustText}</strong>
      <div style="margin-top:1rem;font-size:0.9rem;color:rgba(255,255,255,0.7);">
        <strong>Interpretation:</strong> ${roundedN} unpublished null studies would need to exist in file drawers to reduce your meta-analytic effect to non-significance.
      </div>
      <div style="margin-top:0.75rem;font-size:0.85rem;color:rgba(255,255,255,0.5);">
        <strong>Caveat:</strong> Fail-Safe N is criticized for assuming missing studies have exactly zero effect. Modern methods (selection models, trim-and-fill) are preferred. Use Fail-Safe N as a quick heuristic, not definitive evidence.
      </div>
    </div>
    <div style="margin-top:1rem;padding:1rem;background:rgba(124,58,237,0.1);border-radius:8px;font-size:0.85rem;">
      <strong>Formula:</strong> N = (ΣZ / 1.645)² - k = (${sumZ.toFixed(2)} / 1.645)² - ${k} = ${failsafeN.toFixed(1)}
    </div>
  `;
}

// PET-PEESE Calculator Tool
function renderPetPeeseTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div class="tool-description">Calculate PET-PEESE bias-corrected effect estimates from your meta-analysis data.</div>
    <div style="margin:1rem 0;">
      <label style="display:block;margin-bottom:0.5rem;color:var(--gold);">Enter study data (one per line: effect, SE)</label>
      <textarea id="petpeeseData" rows="8" placeholder="0.45, 0.12
0.32, 0.15
0.58, 0.18
0.21, 0.22
0.67, 0.11" style="width:100%;padding:0.75rem;background:rgba(0,0,0,0.3);border:1px solid var(--gold);border-radius:8px;color:white;font-family:monospace;"></textarea>
      <p style="font-size:0.8rem;color:rgba(255,255,255,0.5);margin-top:0.5rem;">Format: effect size, standard error (comma separated, one study per line)</p>
    </div>
    <button onclick="runPetPeese()" style="padding:0.75rem 1.5rem;background:var(--purple);border:none;border-radius:8px;color:white;cursor:pointer;font-weight:600;">Calculate PET-PEESE</button>
    <div id="petpeeseResults" style="margin-top:1.5rem;"></div>
  `;
}

function runPetPeese() {
  const dataText = document.getElementById('petpeeseData').value.trim();
  const lines = dataText.split('\n').filter(l => l.trim());

  if (lines.length < 5) {
    document.getElementById('petpeeseResults').innerHTML = '<p style="color:#dc2626;">Need at least 5 studies for reliable PET-PEESE estimates.</p>';
    return;
  }

  // Parse data
  const studies = [];
  for (const line of lines) {
    const [effect, se] = line.split(',').map(v => parseFloat(v.trim()));
    if (!isNaN(effect) && !isNaN(se) && se > 0) {
      studies.push({ effect, se, var: se * se });
    }
  }

  if (studies.length < 5) {
    document.getElementById('petpeeseResults').innerHTML = '<p style="color:#dc2626;">Could not parse enough valid data. Check format.</p>';
    return;
  }

  const k = studies.length;

  // Calculate weighted means for reference
  const weights = studies.map(s => 1 / s.var);
  const sumW = weights.reduce((a, b) => a + b, 0);
  const naiveEffect = studies.reduce((sum, s, i) => sum + weights[i] * s.effect, 0) / sumW;

  // PET: effect = b0 + b1 * SE (weighted by 1/variance)
  // Simple weighted least squares
  const meanSE = studies.reduce((sum, s, i) => sum + weights[i] * s.se, 0) / sumW;
  const ssxx_pet = studies.reduce((sum, s, i) => sum + weights[i] * Math.pow(s.se - meanSE, 2), 0);
  const ssxy_pet = studies.reduce((sum, s, i) => sum + weights[i] * (s.se - meanSE) * (s.effect - naiveEffect), 0);
  const b1_pet = ssxy_pet / ssxx_pet;
  const b0_pet = naiveEffect - b1_pet * meanSE;

  // Calculate SE of intercept for PET (proper WLS: Var(b0) = MSE * sum(w*x^2) / det)
  const residuals_pet = studies.map(s => s.effect - (b0_pet + b1_pet * s.se));
  const mse_pet = residuals_pet.reduce((sum, r, i) => sum + weights[i] * r * r, 0) / (k - 2);
  const sumWx2_pet = studies.reduce((sum, s, i) => sum + weights[i] * s.se * s.se, 0);
  const sumWx_pet = studies.reduce((sum, s, i) => sum + weights[i] * s.se, 0);
  const det_pet = sumW * sumWx2_pet - sumWx_pet * sumWx_pet;
  const se_b0_pet = Math.sqrt(mse_pet * sumWx2_pet / det_pet);
  const t_pet = b0_pet / se_b0_pet;
  const p_pet = 2 * (1 - tCDF(Math.abs(t_pet), k - 2));

  // PEESE: effect = b0 + b1 * variance
  const meanVar = studies.reduce((sum, s, i) => sum + weights[i] * s.var, 0) / sumW;
  const ssxx_peese = studies.reduce((sum, s, i) => sum + weights[i] * Math.pow(s.var - meanVar, 2), 0);
  const ssxy_peese = studies.reduce((sum, s, i) => sum + weights[i] * (s.var - meanVar) * (s.effect - naiveEffect), 0);
  const b1_peese = ssxy_peese / ssxx_peese;
  const b0_peese = naiveEffect - b1_peese * meanVar;

  // Calculate SE of intercept for PEESE (proper WLS)
  const residuals_peese = studies.map(s => s.effect - (b0_peese + b1_peese * s.var));
  const mse_peese = residuals_peese.reduce((sum, r, i) => sum + weights[i] * r * r, 0) / (k - 2);
  const sumWx2_peese = studies.reduce((sum, s, i) => sum + weights[i] * s.var * s.var, 0);
  const sumWx_peese = studies.reduce((sum, s, i) => sum + weights[i] * s.var, 0);
  const det_peese = sumW * sumWx2_peese - sumWx_peese * sumWx_peese;
  const se_b0_peese = Math.sqrt(mse_peese * sumWx2_peese / det_peese);

  // Conditional estimator: Use PET to test, PEESE to estimate
  const petSignificant = p_pet < 0.10;
  const conditionalEffect = petSignificant ? b0_peese : b0_pet;
  const conditionalLabel = petSignificant ? 'PEESE (true effect likely exists)' : 'PET (no evidence for true effect)';

  // Calculate percent reduction
  const reduction = ((naiveEffect - conditionalEffect) / naiveEffect * 100).toFixed(1);

  document.getElementById('petpeeseResults').innerHTML = `
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1.5rem;">
      <div style="padding:1rem;background:rgba(59,130,246,0.2);border-radius:8px;text-align:center;">
        <div style="font-size:1.8rem;font-weight:bold;color:#3b82f6;">${naiveEffect.toFixed(3)}</div>
        <div style="font-size:0.85rem;">Naive (Uncorrected)</div>
      </div>
      <div style="padding:1rem;background:rgba(168,85,247,0.2);border-radius:8px;text-align:center;">
        <div style="font-size:1.8rem;font-weight:bold;color:#a855f7;">${b0_pet.toFixed(3)}</div>
        <div style="font-size:0.85rem;">PET Intercept</div>
        <div style="font-size:0.75rem;color:rgba(255,255,255,0.5);">p = ${p_pet.toFixed(3)}</div>
      </div>
      <div style="padding:1rem;background:rgba(236,72,153,0.2);border-radius:8px;text-align:center;">
        <div style="font-size:1.8rem;font-weight:bold;color:#ec4899;">${b0_peese.toFixed(3)}</div>
        <div style="font-size:0.85rem;">PEESE Intercept</div>
      </div>
    </div>

    <div style="padding:1.5rem;background:rgba(34,197,94,0.2);border:2px solid rgba(34,197,94,0.4);border-radius:12px;margin-bottom:1.5rem;">
      <div style="font-size:0.9rem;color:#4ade80;margin-bottom:0.5rem;">CONDITIONAL ESTIMATE (Recommended)</div>
      <div style="font-size:2.5rem;font-weight:bold;color:#22c55e;">${conditionalEffect.toFixed(3)}</div>
      <div style="font-size:0.9rem;margin-top:0.5rem;">${conditionalLabel}</div>
      <div style="font-size:0.85rem;color:rgba(255,255,255,0.6);margin-top:0.5rem;">
        Bias correction: ${reduction > 0 ? reduction + '% reduction' : Math.abs(reduction) + '% increase'} from naive estimate
      </div>
    </div>

    <div style="padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.9rem;">
      <strong>Interpretation:</strong><br>
      ${petSignificant
        ? `PET intercept is significant (p=${p_pet.toFixed(3)} < 0.10), suggesting a true effect exists after accounting for bias. Use PEESE estimate (${b0_peese.toFixed(3)}) as the bias-corrected effect.`
        : `PET intercept is not significant (p=${p_pet.toFixed(3)} >= 0.10), suggesting no reliable evidence for a true effect after accounting for publication bias. The apparent effect may be largely due to bias.`
      }
    </div>

    <div style="margin-top:1rem;padding:1rem;background:rgba(124,58,237,0.1);border-radius:8px;font-size:0.8rem;color:rgba(255,255,255,0.6);">
      <strong>Technical notes:</strong> PET-PEESE uses weighted least squares with inverse-variance weights. The two-step conditional estimator tests for true effect with PET (threshold p<0.10), then uses PEESE if effect exists. With ${k} studies, these estimates have ${k < 10 ? 'limited' : 'moderate'} reliability.
    </div>
  `;
}

// Simple t-distribution CDF approximation
function tCDF(t, df) {
  const x = df / (df + t * t);
  const a = df / 2;
  const b = 0.5;
  // Incomplete beta function approximation
  if (t < 0) return 0.5 * incompleteBeta(x, a, b);
  return 1 - 0.5 * incompleteBeta(x, a, b);
}

function incompleteBeta(x, a, b) {
  // Simple approximation using continued fraction
  const bt = Math.exp(
    lgamma(a + b) - lgamma(a) - lgamma(b) + a * Math.log(x) + b * Math.log(1 - x)
  );
  if (x < (a + 1) / (a + b + 2)) {
    return bt * betacf(x, a, b) / a;
  }
  return 1 - bt * betacf(1 - x, b, a) / b;
}

function betacf(x, a, b) {
  const maxIt = 100;
  const eps = 1e-8;
  let qab = a + b;
  let qap = a + 1;
  let qam = a - 1;
  let c = 1;
  let d = 1 - qab * x / qap;
  if (Math.abs(d) < 1e-30) d = 1e-30;
  d = 1 / d;
  let h = d;
  for (let m = 1; m <= maxIt; m++) {
    let m2 = 2 * m;
    let aa = m * (b - m) * x / ((qam + m2) * (a + m2));
    d = 1 + aa * d;
    if (Math.abs(d) < 1e-30) d = 1e-30;
    c = 1 + aa / c;
    if (Math.abs(c) < 1e-30) c = 1e-30;
    d = 1 / d;
    h *= d * c;
    aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
    d = 1 + aa * d;
    if (Math.abs(d) < 1e-30) d = 1e-30;
    c = 1 + aa / c;
    if (Math.abs(c) < 1e-30) c = 1e-30;
    d = 1 / d;
    let del = d * c;
    h *= del;
    if (Math.abs(del - 1) < eps) break;
  }
  return h;
}

function lgamma(x) {
  const c = [76.18009172947146, -86.50532032941677, 24.01409824083091,
    -1.231739572450155, 0.001208650973866179, -0.000005395239384953];
  let y = x;
  let tmp = x + 5.5;
  tmp -= (x + 0.5) * Math.log(tmp);
  let ser = 1.000000000190015;
  for (let j = 0; j < 6; j++) ser += c[j] / ++y;
  return -tmp + Math.log(2.5066282746310005 * ser / x);
}

// Registry Gap Tool (placeholder visualization)
function renderRegistryTool(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  container.innerHTML = `
    <div style="text-align:center;padding:2rem;">
      <div style="font-size:4rem;margin-bottom:1rem;">🔍</div>
      <h3 style="color:var(--gold);margin-bottom:1rem;">Registry Gap Analysis</h3>
      <p style="color:rgba(255,255,255,0.7);margin-bottom:2rem;">Compare registered vs. published trials to identify evidence gaps.</p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;text-align:center;">
        <div style="padding:1.5rem;background:rgba(59,130,246,0.2);border-radius:12px;border:1px solid rgba(59,130,246,0.4);">
          <div style="font-size:2.5rem;font-weight:bold;color:#3b82f6;">23</div>
          <div>Registered Trials</div>
        </div>
        <div style="padding:1.5rem;background:rgba(22,163,74,0.2);border-radius:12px;border:1px solid rgba(22,163,74,0.4);">
          <div style="font-size:2.5rem;font-weight:bold;color:#22c55e;">15</div>
          <div>Published Results</div>
        </div>
      </div>
      <div style="margin-top:2rem;padding:1.5rem;background:rgba(220,38,38,0.2);border-radius:12px;border:1px solid rgba(220,38,38,0.4);">
        <div style="font-size:2rem;font-weight:bold;color:#dc2626;">8 Missing</div>
        <div>Trials completed but never published (35%)</div>
      </div>
      <p style="margin-top:1.5rem;font-size:0.9rem;color:rgba(255,255,255,0.5);">
        Search ClinicalTrials.gov for your intervention to identify potential missing studies.
      </p>
    </div>
  `;
}

// ============================================================
// CORE COURSE FUNCTIONALITY
// ============================================================
const STORAGE_KEY = 'publicationBiasDetective_v1';

let state = {
  currentModule: 0,
  currentSlide: 0,
  completedModules: [],
  certificateShown: false
};

function loadState() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) state = { ...state, ...JSON.parse(saved) };
  } catch (e) {
    console.warn('Corrupt state, using defaults');
  }
}

function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

function initCourse() {
  loadState();
  renderModuleList();
  renderSlide();
  updateProgress();

  // Keyboard navigation handled by setupKeyboardNavigation() — no duplicate listener here
}

function renderModuleList() {
  const list = document.getElementById('moduleList');
  list.innerHTML = modules.map((m, i) => `
    <div class="module-item ${i === state.currentModule ? 'active' : ''} ${state.completedModules.includes(i) ? 'completed' : ''}"
         onclick="goToModule(${i})">
      <div class="module-number">${i}</div>
      <div class="module-info">
        <div class="module-title">${m.title}</div>
        <div class="module-subtitle">${m.subtitle}</div>
        ${m.estimatedMinutes ? `<div class="module-time">${m.estimatedMinutes} min</div>` : ''}
      </div>
    </div>
  `).join('');
}

function renderSlide() {
  const module = modules[state.currentModule];
  const slide = module.slides[state.currentSlide];
  const container = document.getElementById('main-content');

  document.getElementById('moduleIndicator').textContent = `Case File ${module.id}: ${module.title}`;
  document.getElementById('slideCounter').textContent = `${state.currentSlide + 1} / ${module.slides.length}`;

  container.innerHTML = `<div class="slide active animate-in">${renderSlideContent(slide)}</div>`;

  document.getElementById('prevBtn').disabled = state.currentSlide === 0;
  document.getElementById('nextBtn').disabled = state.currentSlide === module.slides.length - 1;

  // Initialize tools
  setTimeout(() => {
    if (slide.type === 'tool-funnel') renderFunnelTool(slide.content.id);
    if (slide.type === 'tool-contour') renderContourTool(slide.content.id);
    if (slide.type === 'tool-egger') renderEggerTool(slide.content.id);
    if (slide.type === 'tool-trimfill') renderTrimFillTool(slide.content.id);
    if (slide.type === 'tool-petpeese') renderPetPeeseTool(slide.content.id);
    if (slide.type === 'tool-pcurve') renderPCurveTool(slide.content.id);
    if (slide.type === 'tool-registry') renderRegistryTool(slide.content.id);
    if (slide.type === 'tool-failsafe') renderFailsafeTool(slide.content.id);
  }, 100);
}

function renderSlideContent(slide) {
  switch(slide.type) {
    case 'title':
      const isMainTitle = slide.content.title === "Publication Bias Detective";
      const readingLevelHtml = isMainTitle ? `
        <div style="margin-top:1.5rem;">
          <span class="reading-level">Reading Level: Graduate/Professional</span>
        </div>
        <p style="font-size:0.85rem;color:rgba(255,255,255,0.5);margin-top:0.75rem;">
          Total Course Time: ~3 hours | Best for: Researchers, Clinicians, Systematic Reviewers
        </p>
      ` : '';
      return `<div style="text-align:center;padding:3rem;">
        <h1 class="slide-title" style="font-size:2.5rem;border:none;">${slide.content.title}</h1>
        <p style="font-size:1.3rem;color:var(--gold);margin-bottom:1.5rem;">${slide.content.subtitle}</p>
        <p style="font-size:1.1rem;opacity:0.8;max-width:600px;margin:0 auto;">${slide.content.text}</p>
        ${readingLevelHtml}
      </div>`;

    case 'principle':
      return `<div class="principle-display">
        <div class="principle-number">${slide.content.number}</div>
        <p class="principle-text">"${slide.content.text}"</p>
      </div>`;

    case 'rhetoric':
      return `<div class="rhetoric-question">${slide.content.question}</div>`;

    case 'case-file':
      return `<div class="case-file">
        <div class="case-file-header">
          <span class="case-number">${slide.content.caseNumber}</span>
          <div>
            <div class="case-title">${slide.content.title}</div>
            <div class="case-source">${slide.content.source}</div>
          </div>
        </div>
        <div class="evidence-timeline">
          ${slide.content.timeline.map(e => `
            <div class="timeline-event ${e.type || ''}">
              <div class="timeline-year">${e.year}</div>
              <div class="timeline-text">${e.text}</div>
            </div>
          `).join('')}
        </div>
        ${slide.content.realData ? `
          <div style="margin-top:1.5rem;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px;">
            <strong style="color:var(--gold);">Evidence Summary:</strong>
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:0.5rem;margin-top:0.75rem;">
              ${Object.entries(slide.content.realData).map(([k,v]) => `
                <div><span style="color:rgba(255,255,255,0.6);">${k}:</span> ${v}</div>
              `).join('')}
            </div>
          </div>
        ` : ''}
      </div>`;

    case 'statistic-card':
      return `<div class="statistic-card">
        <div class="statistic-value">${slide.content.value}</div>
        <div class="statistic-label">${slide.content.label}</div>
        <div class="statistic-context">${slide.content.context}</div>
      </div>`;

    case 'death-toll':
      return `<div class="death-toll">
        <div class="death-toll-number">${slide.content.number}</div>
        <div class="death-toll-label">${slide.content.label}</div>
        <div class="death-toll-source">${slide.content.source}</div>
      </div>`;

    case 'oath':
      return `<div class="oath-box">
        <div class="oath-header">${slide.content.header}</div>
        <div class="oath-text">${slide.content.text}</div>
      </div>`;

    case 'contrast':
      return `<div>
        <h2 class="slide-title">${slide.content.title}</h2>
        <div class="contrast-box">
          <div class="contrast-side dark">
            <div class="contrast-header">${slide.content.darkSide.header}</div>
            <ul class="contrast-items">
              ${slide.content.darkSide.items.map(i => `<li>${i}</li>`).join('')}
            </ul>
            <div class="contrast-consequence">${slide.content.darkSide.consequence}</div>
          </div>
          <div class="contrast-side light">
            <div class="contrast-header">${slide.content.lightSide.header}</div>
            <ul class="contrast-items">
              ${slide.content.lightSide.items.map(i => `<li>${i}</li>`).join('')}
            </ul>
            <div class="contrast-consequence">${slide.content.lightSide.consequence}</div>
          </div>
        </div>
      </div>`;

    case 'content':
      return `<div>
        <h2 class="slide-title">${slide.content.title}</h2>
        ${slide.content.sections.map(s => `
          <div class="method-box">
            <h3>${s.heading}</h3>
            ${s.items ? `<ul>${s.items.map(i => `<li>${i}</li>`).join('')}</ul>` : ''}
          </div>
        `).join('')}
      </div>`;

    case 'decision-tree':
      return renderDecisionTree(slide.content);

    case 'clinical-guide':
      return `<div class="clinical-guide">
        <h3>${slide.content.title}</h3>
        <ul>${slide.content.items.map(i => `<li>${i}</li>`).join('')}</ul>
      </div>`;

    case 'cycle-return':
      return `<div class="cycle-return">
        <p style="font-size:0.8rem;color:var(--gold);text-transform:uppercase;margin-bottom:0.5rem;">Return to the Principle</p>
        <p class="principle-recall">"${slide.content.principle}"</p>
      </div>`;

    case 'quiz':
      return renderQuiz(slide.content);

    case 'tool-funnel':
    case 'tool-contour':
    case 'tool-egger':
    case 'tool-trimfill':
    case 'tool-pcurve':
    case 'tool-registry':
    case 'tool-failsafe':
    case 'tool-petpeese':
      return `<div class="tool-panel">
        <div class="tool-header">
          <span class="tool-icon">🔧</span>
          <span class="tool-title">${slide.content.title}</span>
        </div>
        <p class="tool-description">${slide.content.description}</p>
        <div id="${slide.content.id}"></div>
      </div>`;

    case 'learning-objectives':
      return `<div class="learning-objectives">
        <div class="learning-objectives-header">
          <span class="objectives-icon">🎯</span>
          <span>Learning Objectives</span>
        </div>
        <p style="margin-bottom:1rem;opacity:0.9;">${slide.content.intro || 'By the end of this module, you will be able to:'}</p>
        <ul>
          ${slide.content.objectives.map(obj => `<li>${obj}</li>`).join('')}
        </ul>
      </div>`;

    case 'key-takeaways':
      return `<div class="key-takeaways">
        <div class="key-takeaways-header">
          <span class="takeaways-icon">✅</span>
          <span>Key Takeaways</span>
        </div>
        <ul>
          ${slide.content.takeaways.map(t => `<li>${t}</li>`).join('')}
        </ul>
        ${slide.content.actionItem ? `
          <div class="action-item">
            <strong>Action Item:</strong> ${slide.content.actionItem}
          </div>
        ` : ''}
      </div>`;

    case 'common-mistakes':
      return `<div class="common-mistakes">
        <div class="mistakes-header">
          <span class="mistakes-icon">⚠️</span>
          <span>Common Mistakes to Avoid</span>
        </div>
        <ul>
          ${slide.content.mistakes.map(m => `<li><strong>${m.mistake}:</strong> ${m.correction}</li>`).join('')}
        </ul>
      </div>`;

    case 'patient-communication':
      return `<div class="patient-communication">
        <div class="communication-header">
          <span class="communication-icon">💬</span>
          <span>Patient Communication Script</span>
        </div>
        <div class="scenario">${slide.content.scenario}</div>
        <div class="script-box">
          <div class="script-label">What to say:</div>
          <div class="script-text">"${slide.content.script}"</div>
        </div>
        ${slide.content.keyPoints ? `
          <div class="key-points">
            <strong>Key communication points:</strong>
            <ul>${slide.content.keyPoints.map(p => `<li>${p}</li>`).join('')}</ul>
          </div>
        ` : ''}
      </div>`;

    case 'protagonist-story':
      return `<div class="protagonist-story">
        <div class="protagonist-header">
          <div class="protagonist-name">${slide.content.name}</div>
          <div class="protagonist-role">${slide.content.role}</div>
        </div>
        <div class="protagonist-narrative">${slide.content.narrative}</div>
        ${slide.content.quote ? `
          <blockquote class="protagonist-quote">"${slide.content.quote}"</blockquote>
        ` : ''}
        ${slide.content.impact ? `
          <div class="protagonist-impact">
            <strong>Impact:</strong> ${slide.content.impact}
          </div>
        ` : ''}
      </div>`;

    case 'legal-disclaimer':
      return `<div class="legal-disclaimer">
        <div class="disclaimer-header">
          <span class="disclaimer-icon">⚖️</span>
          <span>Important Legal Notice</span>
        </div>
        <div class="disclaimer-text">${slide.content.text}</div>
        ${slide.content.resources ? `
          <div class="disclaimer-resources">
            <strong>Resources:</strong>
            <ul>${slide.content.resources.map(r => `<li><a href="${r.url}" target="_blank">${r.name}</a></li>`).join('')}</ul>
          </div>
        ` : ''}
      </div>`;

    case 'printable-checklist':
      return `<div class="printable-checklist">
        <div class="checklist-header">
          <span class="checklist-icon">📋</span>
          <span>${slide.content.title}</span>
        </div>
        <p class="print-instruction">Print this checklist to use when reading meta-analyses</p>
        ${slide.content.sections.map(section => `
          <div class="checklist-section">
            <h4>${section.heading}</h4>
            <ul>
              ${section.items.map(item => `<li><input type="checkbox" class="checklist-box"> ${item}</li>`).join('')}
            </ul>
          </div>
        `).join('')}
        <button class="print-btn" onclick="window.print()">🖨️ Print Checklist</button>
      </div>`;

    case 'practice-case':
      return `<div class="practice-case">
        <div class="practice-header">
          <span class="practice-icon">🔬</span>
          <span>Practice Case: ${slide.content.title}</span>
        </div>
        <div class="case-scenario">${slide.content.scenario}</div>
        ${slide.content.data ? `
          <div class="sample-data">
            <h4>Sample Data:</h4>
            <table class="data-table">
              <thead><tr>${slide.content.data.headers.map(h => `<th>${h}</th>`).join('')}</tr></thead>
              <tbody>${slide.content.data.rows.map(row => `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`).join('')}</tbody>
            </table>
          </div>
        ` : ''}
        <div class="practice-questions">
          <h4>Questions to consider:</h4>
          <ol>${slide.content.questions.map(q => `<li>${q}</li>`).join('')}</ol>
        </div>
        ${slide.content.answers ? `
          <details class="answers-reveal">
            <summary>Reveal Answers</summary>
            <ol>${slide.content.answers.map(a => `<li>${a}</li>`).join('')}</ol>
          </details>
        ` : ''}
      </div>`;

    case 'pre-assessment':
      return `<div class="pre-assessment">
        <div class="assessment-header">
          <span class="assessment-icon">📝</span>
          <span>Pre-Assessment: Test Your Current Knowledge</span>
        </div>
        <p>${slide.content.intro}</p>
        <div id="preAssessmentQuiz"></div>
      </div>`;

    case 'redemption-story':
      return `<div class="redemption-story">
        <div class="redemption-header">
          <span class="redemption-icon">🌟</span>
          <span>A Different Path: ${slide.content.title}</span>
        </div>
        <div class="redemption-narrative">${slide.content.narrative}</div>
        <div class="redemption-lesson">
          <strong>The Lesson:</strong> ${slide.content.lesson}
        </div>
      </div>`;

    case 'story':
      return `<div class="story-container">
        <div class="story-opening">${slide.content.opening}</div>

        <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;">
          <span style="background:var(--evidence-red);color:white;padding:0.5rem 1rem;border-radius:4px;font-weight:700;font-size:0.8rem;text-transform:uppercase;">Story ${slide.content.storyNumber}</span>
          <div>
            <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.8rem;color:var(--gold);margin:0;">${slide.content.title}</h2>
            <p style="font-size:0.85rem;color:rgba(255,255,255,0.6);margin:0;">${slide.content.caseId}</p>
          </div>
        </div>

        <div class="stats-box">
          <div class="stats-box-header">
            <span style="font-size:1.2rem;">📊</span>
            ${slide.content.stats.header}
          </div>
          ${slide.content.stats.items.map(item => `
            <div class="stat-item">
              <div class="stat-value">${item.value}</div>
              <div class="stat-label">${item.label}</div>
            </div>
          `).join('')}
        </div>

        <div class="interactive-decision-tree">
          <div class="decision-scenario">
            <div class="decision-scenario-title">${slide.content.scenario.title}</div>
            <p style="margin:0;line-height:1.7;">${slide.content.scenario.text}</p>
          </div>

          <div class="decision-path path-a" tabindex="0" role="button" onclick="this.classList.toggle('expanded')" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('expanded');}">
            <div class="path-header">
              <span style="font-size:1.2rem;">❌</span>
              ${slide.content.pathA.header}
              <span class="path-arrow">→</span>
            </div>
            <p style="margin:0.5rem 0;font-style:italic;color:rgba(255,255,255,0.8);">${slide.content.pathA.action}</p>
            <div class="story-timeline" style="margin:1rem 0;">
              ${slide.content.pathA.steps.map((step, i) => `
                <div class="timeline-step ${i === slide.content.pathA.steps.length - 1 ? 'danger' : ''}">
                  <div class="step-label">Step ${i + 1}</div>
                  <div class="step-content">${step}</div>
                </div>
              `).join('')}
            </div>
            <div class="path-consequence">
              <strong style="color:#fca5a5;">Consequence:</strong> ${slide.content.pathA.consequence}
            </div>
          </div>

          <div class="decision-path path-b" tabindex="0" role="button" onclick="this.classList.toggle('expanded')" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.classList.toggle('expanded');}">
            <div class="path-header">
              <span style="font-size:1.2rem;">✓</span>
              ${slide.content.pathB.header}
              <span class="path-arrow">→</span>
            </div>
            <p style="margin:0.5rem 0;font-style:italic;color:rgba(255,255,255,0.8);">${slide.content.pathB.action}</p>
            <div class="story-timeline" style="margin:1rem 0;">
              ${slide.content.pathB.steps.map((step, i) => `
                <div class="timeline-step ${i === slide.content.pathB.steps.length - 1 ? 'success' : ''}">
                  <div class="step-label">Step ${i + 1}</div>
                  <div class="step-content">${step}</div>
                </div>
              `).join('')}
            </div>
            <div class="path-consequence">
              <strong style="color:#86efac;">Consequence:</strong> ${slide.content.pathB.consequence}
            </div>
          </div>
        </div>

        <div class="revelation-box">
          <div class="revelation-header">✦ ${slide.content.revelation.header} ✦</div>
          <p class="revelation-text">${slide.content.revelation.text}</p>
          <p class="revelation-detail">${slide.content.revelation.detail}</p>
        </div>

        <div class="story-refrain">
          <p>"${slide.content.refrain}"</p>
        </div>
      </div>`;

    default:
      return `<p>Unknown slide type: ${slide.type}</p>`;
  }
}

// Store current decision tree nodes to avoid XSS risk from inline JSON
let currentDecisionNodes = [];

function renderDecisionTree(content) {
  // Store nodes in module-level variable for safe access
  currentDecisionNodes = content.nodes;
  return `<div class="decision-tree">
    <div class="decision-title">${content.title}</div>
    <div class="decision-situation">${content.situation}</div>
    <div id="decisionContent" aria-live="polite" aria-atomic="true">${renderDecisionNode(content.nodes[0])}</div>
  </div>`;
}

function renderDecisionNode(node) {
  if (node.type === 'outcome') {
    return `<div class="decision-outcome ${node.consequence}">
      <div class="outcome-title">${node.title}</div>
      <div class="outcome-text">${node.text}</div>
      <div class="outcome-case">${node.realCase}</div>
    </div>`;
  }

  return `<div class="decision-node">
    <div class="decision-question">${node.question}</div>
    <div class="decision-branches">
      ${node.branches.map(b => `
        <button class="decision-branch" data-next-node="${b.nextNode}" onclick="selectDecisionBranch(this.dataset.nextNode)" tabindex="0">
          ${b.text}
        </button>
      `).join('')}
    </div>
  </div>`;
}

function selectDecisionBranch(nodeId) {
  const node = currentDecisionNodes.find(n => n.id === nodeId);
  if (node) {
    document.getElementById('decisionContent').innerHTML = renderDecisionNode(node);
  }
}

function renderQuiz(content) {
  const quizKey = `${state.currentModule}-${state.currentSlide}`;
  return `<div class="quiz-container">
    <div class="quiz-question">${content.question}</div>
    <div class="quiz-options">
      ${content.options.map(opt => `
        <div class="quiz-option" data-id="${opt.id}" onclick="selectQuizOption('${opt.id}', ${opt.correct}, this)">
          ${opt.text}
        </div>
      `).join('')}
    </div>
    <div class="quiz-explanation">${content.explanation}</div>
  </div>`;
}

function selectQuizOption(id, correct, element) {
  document.querySelectorAll('.quiz-option').forEach(o => {
    o.style.pointerEvents = 'none';
    const module = modules[state.currentModule];
    const slide = module.slides[state.currentSlide];
    const opt = slide.content.options.find(op => op.id === o.dataset.id);
    if (opt?.correct) o.classList.add('correct');
  });
  if (!correct) element.classList.add('incorrect');
  document.querySelector('.quiz-explanation').classList.add('visible');
}

function prevSlide() {
  if (state.currentSlide > 0) {
    state.currentSlide--;
    renderSlide();
    saveState();
  }
}

function nextSlide() {
  const module = modules[state.currentModule];
  if (state.currentSlide < module.slides.length - 1) {
    state.currentSlide++;
    renderSlide();
    saveState();
    checkCourseCompletion();
  }
}

function goToModule(index) {
  if (index !== state.currentModule) {
    if (state.currentSlide === modules[state.currentModule].slides.length - 1 &&
        !state.completedModules.includes(state.currentModule)) {
      state.completedModules.push(state.currentModule);
    }
    state.currentModule = index;
    state.currentSlide = 0;
    renderModuleList();
    renderSlide();
    updateProgress();
    saveState();
  }
}

function updateProgress() {
  const percent = Math.round((state.completedModules.length / modules.length) * 100);
  document.getElementById('progressPercent').textContent = `${percent}%`;
  document.getElementById('progressFill').style.width = `${percent}%`;
}

function openGlossary() {
  document.getElementById('glossaryOverlay').classList.add('open');
  renderGlossary();
}

function closeGlossary() {
  document.getElementById('glossaryOverlay').classList.remove('open');
}

function renderGlossary(filter = '') {
  const filtered = glossaryTerms.filter(t =>
    t.term.toLowerCase().includes(filter.toLowerCase()) ||
    t.def.toLowerCase().includes(filter.toLowerCase())
  );
  document.getElementById('glossaryContent').innerHTML = filtered.map(t => `
    <div class="glossary-term">
      <strong style="color:var(--gold);">${t.term}</strong><br>
      <span style="color:rgba(255,255,255,0.7);">${t.def}</span>
    </div>
  `).join('');
}

function filterGlossary() {
  renderGlossary(document.getElementById('glossarySearch').value);
}

// ============================================================
// THEME TOGGLE (Dark/Light Mode)
// ============================================================
function toggleTheme() {
  const body = document.body;
  const toggle = document.getElementById('themeToggle');
  const isLight = body.classList.toggle('light-mode');
  toggle.textContent = isLight ? '☀️' : '🌙';
  toggle.setAttribute('aria-label', isLight ? 'Switch to dark mode' : 'Switch to light mode');
  localStorage.setItem('pubBiasTheme', isLight ? 'light' : 'dark');
}

function loadTheme() {
  const saved = localStorage.getItem('pubBiasTheme');
  if (saved === 'light') {
    document.body.classList.add('light-mode');
    document.getElementById('themeToggle').textContent = '☀️';
  }
}

// ============================================================
// CERTIFICATE OF COMPLETION
// ============================================================
function checkCourseCompletion() {
  // Check if all modules are completed
  if (state.completedModules.length >= modules.length - 1) {
    // Check if on last slide of last module
    const lastModule = modules[modules.length - 1];
    if (state.currentModule === modules.length - 1 &&
        state.currentSlide === lastModule.slides.length - 1 &&
        !state.certificateShown) {
      state.certificateShown = true;
      saveState();
      setTimeout(() => {
        document.getElementById('nameInputModal').classList.add('open');
        document.getElementById('investigatorName').focus();
      }, 1000);
    }
  }
}

function generateCertificate() {
  const name = document.getElementById('investigatorName').value.trim();
  if (!name) {
    alert('Please enter your name to generate the certificate.');
    return;
  }

  // Close name input modal
  document.getElementById('nameInputModal').classList.remove('open');

  // Generate certificate ID
  const certId = 'PBD-' + Date.now().toString(36).toUpperCase() + Math.random().toString(36).substr(2, 4).toUpperCase();

  // Format date
  const date = new Date().toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });

  // Update certificate
  document.getElementById('certName').textContent = name;
  document.getElementById('certDate').textContent = `Completed on: ${date}`;
  document.getElementById('certId').textContent = `Certificate ID: ${certId}`;

  // Show certificate
  document.getElementById('certificateOverlay').classList.add('open');
}

function closeCertificate() {
  document.getElementById('certificateOverlay').classList.remove('open');
}

function printCertificate() {
  const cert = document.getElementById('certificateContainer');
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Publication Bias Detective - Certificate</title>
      <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
      <style>
        body {
          margin: 0; padding: 2rem;
          font-family: 'Source Sans Pro', sans-serif;
          display: flex; justify-content: center; align-items: center;
          min-height: 100vh; background: #f5f5f5;
        }
        .cert {
          background: linear-gradient(135deg, #fdf6e3 0%, #fff8dc 50%, #fdf6e3 100%);
          border: 8px double #d4af37;
          border-radius: 12px;
          padding: 3rem;
          max-width: 700px;
          text-align: center;
          position: relative;
        }
        .seal {
          position: absolute; top: -30px; left: 50%;
          transform: translateX(-50%);
          width: 60px; height: 60px;
          background: linear-gradient(135deg, #d4af37, #c5a028);
          border-radius: 50%;
          display: flex; align-items: center; justify-content: center;
          font-size: 1.8rem;
        }
        h1 {
          font-family: 'Cormorant Garamond', serif;
          font-size: 2.5rem; color: #1e3a5f;
          text-transform: uppercase; letter-spacing: 0.15em;
          margin-top: 1rem;
        }
        .subtitle { color: #666; margin-bottom: 1.5rem; }
        .body { font-size: 1.1rem; color: #333; line-height: 1.8; margin: 1.5rem 0; }
        .name {
          font-family: 'Cormorant Garamond', serif;
          font-size: 2rem; font-weight: 700; color: #991b1b;
          border-bottom: 2px solid #d4af37;
          display: inline-block; padding: 0 2rem 0.5rem; margin: 1rem 0;
        }
        .date { font-size: 0.9rem; color: #666; margin-top: 1.5rem; }
        .id { font-size: 0.75rem; color: #999; margin-top: 0.5rem; font-family: monospace; }
        @media print {
          body { background: white; }
          .cert { box-shadow: none; }
        }
      </style>
    </head>
    <body>
      <div class="cert">
        <div class="seal">🏆</div>
        <h1>Certificate of Completion</h1>
        <p class="subtitle">Publication Bias Detective Training Program</p>
        <div class="body">
          <p>This is to certify that</p>
          <div class="name">${document.getElementById('certName').textContent}</div>
          <p>has successfully completed the</p>
          <p><strong style="color: #1e3a5f; font-size: 1.2rem;">Publication Bias Detective Course</strong></p>
          <p>demonstrating proficiency in identifying, assessing, and mitigating publication bias in systematic reviews and meta-analyses.</p>
        </div>
        <div class="date">${document.getElementById('certDate').textContent}</div>
        <div class="id">${document.getElementById('certId').textContent}</div>
      </div>
    </body>
    </html>
  `);
  printWindow.document.close();
  setTimeout(() => printWindow.print(), 500);
}

// ============================================================
// PDF EXPORT FOR CHECKLIST
// ============================================================
function exportChecklistPDF() {
  const checklistContent = `
PUBLICATION BIAS DETECTION CHECKLIST
=====================================

BEFORE STARTING
[ ] Registered protocol (PROSPERO) with bias assessment plan
[ ] Pre-specified primary outcome
[ ] Comprehensive search strategy including grey literature

SEARCH EXECUTION
[ ] Multiple databases (PubMed, Embase, Cochrane, etc.)
[ ] ClinicalTrials.gov + WHO ICTRP for registered trials
[ ] Conference abstracts and dissertations
[ ] Contact authors for unpublished data
[ ] No language restrictions (or justify if restricted)

VISUAL ASSESSMENT
[ ] Funnel plot (if ≥10 studies)
[ ] Contour-enhanced funnel plot
[ ] Doi plot with LFK index

STATISTICAL TESTS
[ ] Egger's test (continuous outcomes)
[ ] Harbord's or Peters' test (binary outcomes)
[ ] Begg's rank correlation
[ ] Document: k = ___, Egger p = ___

SENSITIVITY ANALYSES
[ ] Trim-and-fill (report adjusted estimate)
[ ] PET-PEESE (report conditional estimate)
[ ] Selection models (3PSM if available)
[ ] Compare with registered trial results

REPORTING
[ ] PRISMA flow diagram with reasons for exclusion
[ ] Table comparing published vs. unpublished studies
[ ] GRADE assessment for publication bias
[ ] Plain-language summary of bias impact

INTERPRETATION TEMPLATE
"Publication bias assessment: [Visual inspection / Statistical tests]
[suggested / did not suggest] the presence of small-study effects.
Sensitivity analyses [adjusted the pooled estimate from X to Y /
did not substantially change the results]. The certainty of evidence
was [downgraded / not downgraded] for publication bias."
`;

  // Create and download text file
  const blob = new Blob([checklistContent], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'publication-bias-checklist.txt';
  link.click();
  URL.revokeObjectURL(link.href);
}

// ============================================================
// SERVICE WORKER FOR OFFLINE ACCESS
// ============================================================
function registerServiceWorker() {
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      // Create inline service worker
      const swCode = `
const CACHE_NAME = 'pub-bias-detective-v1';
const urlsToCache = [
  './',
  './publication-bias-detective.html'
];

self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(response => {
        if (response) return response;
        return fetch(event.request).then(response => {
          if (!response || response.status !== 200) return response;
          const responseToCache = response.clone();
          caches.open(CACHE_NAME).then(cache => {
            cache.put(event.request, responseToCache);
          });
          return response;
        });
      })
  );
});
`;

      const blob = new Blob([swCode], { type: 'application/javascript' });
      const swUrl = URL.createObjectURL(blob);

      navigator.serviceWorker.register(swUrl)
        .then(reg => console.log('Service Worker registered for offline access'))
        .catch(err => console.log('Service Worker registration skipped:', err.message));
    });
  }
}

// ============================================================
// KEYBOARD NAVIGATION ENHANCEMENT
// ============================================================
function setupKeyboardNavigation() {
  document.addEventListener('keydown', (e) => {
    // Arrow key navigation for slides
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
      if (!e.target.matches('input, textarea, select')) {
        nextSlide();
      }
    } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
      if (!e.target.matches('input, textarea, select')) {
        prevSlide();
      }
    } else if (e.key === 'Escape') {
      closeGlossary();
      closeCertificate();
      document.getElementById('nameInputModal').classList.remove('open');
    }
  });

  // Make module items keyboard focusable
  document.querySelectorAll('.module-item').forEach((item, index) => {
    item.setAttribute('tabindex', '0');
    item.setAttribute('role', 'button');
    item.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        goToModule(index);
      }
    });
  });
}

// ============================================================
// SCORM/LMS COMPATIBILITY WRAPPER
// ============================================================
const SCORM = {
  initialized: false,

  init: function() {
    // Check for SCORM API
    if (typeof window.API !== 'undefined' || typeof window.API_1484_11 !== 'undefined') {
      const api = window.API_1484_11 || window.API;
      if (api) {
        api.Initialize('');
        this.initialized = true;
        // SCORM API initialized
      }
    }
    return this.initialized;
  },

  setProgress: function(percent) {
    if (!this.initialized) return;
    const api = window.API_1484_11 || window.API;
    if (api) {
      api.SetValue('cmi.progress_measure', (percent / 100).toFixed(2));
      api.Commit('');
    }
  },

  setComplete: function() {
    if (!this.initialized) return;
    const api = window.API_1484_11 || window.API;
    if (api) {
      api.SetValue('cmi.completion_status', 'completed');
      api.SetValue('cmi.success_status', 'passed');
      api.Commit('');
    }
  },

  terminate: function() {
    if (!this.initialized) return;
    const api = window.API_1484_11 || window.API;
    if (api) {
      api.Terminate('');
    }
  }
};

// Hook SCORM into progress updates
const originalUpdateProgress = updateProgress;
updateProgress = function() {
  originalUpdateProgress();
  const percent = Math.round((state.completedModules.length / modules.length) * 100);
  SCORM.setProgress(percent);
  if (percent >= 100) {
    SCORM.setComplete();
  }
};

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
  loadTheme();
  SCORM.init();
  registerServiceWorker();
  setTimeout(setupKeyboardNavigation, 100);
});

// Terminate SCORM on page unload
window.addEventListener('beforeunload', () => {
  SCORM.terminate();
});

document.addEventListener('DOMContentLoaded', initCourse);
</script>
<!-- Floating Glossary Button (visible on mobile) -->
<button aria-label="Open Glossary" class="floating-glossary" onclick="openGlossary()">
  📖
</button>
</body>
</html>
